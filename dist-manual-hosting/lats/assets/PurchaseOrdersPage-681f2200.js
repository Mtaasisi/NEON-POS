import{j as e,u as s,c as r,d as t,s as a}from"./index-222cfb29.js";import{r as l,R as i,b as o}from"./vendor-a2ff445a.js";import{q as n,c,a5 as d,aA as u,bE as m,a9 as p,Z as x,Q as h,x as g,Y as b,D as v,f as j,d as f,y,R as N,e as w,h as C,a2 as k,a7 as P,r as S,n as D,$ as O,ck as A}from"./ui-551a39a6.js";import{u as T}from"./useDialog-ddaadb89.js";import{B as $}from"./BackButton-e41d1482.js";import{C as F}from"./CBMCalculatorModal-f5dbe117.js";import{S as R}from"./SuppliersTab-a9a4cdaf.js";import{a as _}from"./routing-a2f0f6d2.js";import"./supabase-7e851d02.js";import"./SearchBar-2b6f451f.js";import"./SupplierForm-e7ec71ff.js";import"./forms-fd94c8fb.js";import"./zod-4c7d126c.js";import"./SupplierDetailsModal-8b57c375.js";const B=[{id:"view",label:"View Details",description:"See complete order information",icon:e.jsx(n,{className:"w-5 h-5"}),color:"bg-blue-500",hoverColor:"hover:bg-blue-50",onClick:()=>{}},{id:"duplicate",label:"Duplicate Order",description:"Create a copy of this order",icon:e.jsx(c,{className:"w-5 h-5"}),color:"bg-purple-500",hoverColor:"hover:bg-purple-50",onClick:()=>{}},{id:"pdf",label:"Generate PDF",description:"Download order as PDF document",icon:e.jsx(d,{className:"w-5 h-5"}),color:"bg-orange-500",hoverColor:"hover:bg-orange-50",onClick:()=>{}},{id:"payment",label:"Manage Payment",description:"Record or update payment status",icon:e.jsx(u,{className:"w-5 h-5"}),color:"bg-indigo-500",hoverColor:"hover:bg-indigo-50",onClick:()=>{}},{id:"quality",label:"Quality Check",description:"Mark items as quality verified",icon:e.jsx(m,{className:"w-5 h-5"}),color:"bg-teal-500",hoverColor:"hover:bg-teal-50",onClick:()=>{}}],L=({isOpen:s,onClose:r,position:t="right",items:a=B,triggerRef:n})=>{const c=l.useRef(null),[d,u]=l.useState({top:0,left:0,right:"auto"}),m=l.useRef(!1);l.useEffect(()=>{if(s&&(null==n?void 0:n.current)){const e=n.current.getBoundingClientRect(),s=12;let r="auto",a="auto";"right"===t?a=window.innerWidth-e.right+"px":r=`${e.left}px`,u({top:e.bottom+s,left:r,right:a}),m.current=!1}},[s,n,t]);const p=l.useCallback(()=>{m.current||(m.current=!0,r(),setTimeout(()=>{m.current=!1},100))},[r]);if(!s)return null;const x=e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed inset-0 z-[998] bg-transparent",onClick:e=>{e.preventDefault(),e.stopPropagation(),p()}}),e.jsx("div",{ref:c,className:"fixed w-80 bg-white rounded-2xl shadow-2xl border border-gray-100 z-[999] overflow-visible animate-in fade-in slide-in-from-top-2 duration-200",style:{top:`${d.top}px`,left:"auto"!==d.left?d.left:void 0,right:"auto"!==d.right?d.right:void 0,maxHeight:`calc(100vh - ${d.top}px - 20px)`,overflowY:"auto"},onClick:e=>{e.preventDefault(),e.stopPropagation()},children:e.jsx("div",{className:"py-3",children:a.map(s=>e.jsxs(i.Fragment,{children:[s.divider&&e.jsx("div",{className:"my-2 mx-4 border-t border-gray-200"}),e.jsxs("button",{onClick:()=>{s.onClick(),p()},className:`w-full flex items-start gap-4 px-5 py-3.5 transition-all duration-200 ${s.hoverColor} group`,children:[e.jsx("div",{className:`${s.color} rounded-full p-2.5 flex-shrink-0 group-hover:scale-110 transition-transform duration-200 shadow-md`,children:e.jsx("div",{className:"text-white",children:s.icon})}),e.jsxs("div",{className:"flex-1 text-left pt-0.5",children:[e.jsx("div",{className:"font-semibold text-gray-900 text-sm mb-0.5 group-hover:text-gray-900",children:s.label}),e.jsx("div",{className:"text-xs text-gray-500 leading-relaxed",children:s.description})]})]})]},s.id))})})]});return o.createPortal(x,document.body)},M=()=>{s();const o=_(),{confirm:B}=T(),{purchaseOrders:M,isLoading:q,error:E,loadPurchaseOrders:z,deletePurchaseOrder:G,approvePurchaseOrder:I,updatePurchaseOrder:Q}=r(),[U,Z]=l.useState("purchase-orders"),[V,Y]=l.useState(""),[H,K]=l.useState("all"),[W,J]=l.useState("createdAt"),[X]=l.useState("desc"),[ee,se]=l.useState(null),[re,te]=l.useState(!1),[ae,le]=l.useState(null),ie=i.useRef({});i.useEffect(()=>{const e=e=>{"Escape"===e.key&&ae&&le(null)};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[ae]);const oe=async()=>{Date.now();try{await z();Date.now();se(new Date)}catch(e){}};l.useEffect(()=>{oe()},[]),l.useEffect(()=>{M&&M.length},[M,q]);const ne=l.useMemo(()=>{let e=M||[];return V&&(e=e.filter(e=>{var s,r,t;return e.orderNumber.toLowerCase().includes(V.toLowerCase())||(null==(r=null==(s=e.supplier)?void 0:s.name)?void 0:r.toLowerCase().includes(V.toLowerCase()))||(null==(t=e.notes)?void 0:t.toLowerCase().includes(V.toLowerCase()))})),"all"!==H&&(e=e.filter(e=>e.status===H)),e.sort((e,s)=>{let r,t;switch(W){case"orderNumber":r=e.orderNumber,t=s.orderNumber;break;case"totalAmount":r=e.totalAmount,t=s.totalAmount;break;default:r=new Date(e.createdAt).getTime(),t=new Date(s.createdAt).getTime()}return"asc"===X?r>t?1:-1:r<t?1:-1}),e},[M,V,H,W,X]),ce=async e=>{if(await B("Are you sure you want to delete this purchase order?")){const s=await G(e);s.ok?D.success("Purchase order deleted successfully"):D.error(s.message||"Failed to delete purchase order")}},de=e=>{switch(e){case"draft":return"bg-gray-500 text-white shadow-sm";case"sent":return"bg-blue-600 text-white shadow-sm";case"partial_received":return"bg-orange-500 text-white shadow-sm";case"received":return"bg-sky-500 text-white shadow-sm";case"completed":return"bg-green-600 text-white shadow-sm";case"cancelled":return"bg-red-600 text-white shadow-sm";default:return"bg-gray-400 text-white shadow-sm"}},ue=s=>{switch(s){case"draft":return e.jsx(d,{className:"w-3 h-3"});case"sent":return e.jsx(P,{className:"w-3 h-3"});case"partial_received":return e.jsx(m,{className:"w-3 h-3"});case"received":return e.jsx(k,{className:"w-3 h-3"});case"completed":return e.jsx(f,{className:"w-3 h-3"});case"cancelled":return e.jsx(C,{className:"w-3 h-3"});default:return e.jsx(g,{className:"w-3 h-3"})}},me=(e,s="TSh")=>{const r="string"==typeof e?parseFloat(e)||0:e||0;if(!r||0===r)return"TSh 0";if("TSh"===s||"TZS"===s||!s){return`TSh ${r.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})}`}try{return new Intl.NumberFormat("en-TZ",{style:"currency",currency:s,minimumFractionDigits:0,maximumFractionDigits:0}).format(r)}catch(t){return`${s} ${r.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0})}`}},pe=e=>{if(!e)return"Not set";const s=new Date(e);return isNaN(s.getTime())?"Not set":s.toLocaleDateString("en-KE",{year:"numeric",month:"short",day:"numeric"})},xe=s=>{var r,t;const a=[],l=["draft","sent","partial_received","received","completed","cancelled"].includes(s.status)?s.status:"draft";switch(s.status,l){case"draft":a.push({type:"send",label:"Send to Supplier",icon:e.jsx(P,{className:"w-4 h-4"}),color:"bg-green-600 hover:bg-green-700",onClick:()=>ge(s.id)}),a.push({type:"delete",label:"Delete",icon:e.jsx(O,{className:"w-4 h-4"}),color:"bg-red-600 hover:bg-red-700",onClick:()=>ce(s.id)});break;case"sent":a.push({type:"receive",label:"Receive Items",icon:e.jsx(g,{className:"w-4 h-4"}),color:"bg-green-600 hover:bg-green-700",onClick:()=>o(`/lats/purchase-orders/${s.id}?action=receive`)});break;case"partial_received":const l=((null==(r=s.items)?void 0:r.reduce((e,s)=>e+(s.quantity||0),0))||0)-((null==(t=s.items)?void 0:t.reduce((e,s)=>e+(s.receivedQuantity||0),0))||0);a.push({type:"receive",label:`Continue (${l} left)`,icon:e.jsx(g,{className:"w-4 h-4"}),color:"bg-orange-600 hover:bg-orange-700",onClick:()=>o(`/lats/purchase-orders/${s.id}?action=receive`)});break;case"received":a.push({type:"complete",label:"Complete",icon:e.jsx(f,{className:"w-4 h-4"}),color:"bg-green-600 hover:bg-green-700",onClick:()=>be(s.id)});break;case"completed":a.push({type:"duplicate",label:"Duplicate",icon:e.jsx(c,{className:"w-4 h-4"}),color:"bg-blue-600 hover:bg-blue-700",onClick:()=>o(`/lats/purchase-order/create?duplicate=${s.id}`)})}return a.push({type:"more",label:"More",icon:e.jsx(A,{className:"w-4 h-4"}),color:"bg-gray-600 hover:bg-gray-700",onClick:e=>{e.stopPropagation(),le(ae===s.id?null:s.id)}}),a},he=s=>{const r=[];return r.push({id:"view",label:"View Details",description:"See complete order information",icon:e.jsx(n,{className:"w-5 h-5"}),color:"bg-blue-500",hoverColor:"hover:bg-blue-50",onClick:()=>o(`/lats/purchase-orders/${s.id}`)}),"draft"===s.status&&r.push({id:"edit",label:"Edit Order",description:"Modify order details and items",icon:e.jsx(S,{className:"w-5 h-5"}),color:"bg-green-500",hoverColor:"hover:bg-green-50",onClick:()=>o(`/lats/purchase-orders/${s.id}?edit=true`)}),r.push({id:"duplicate",label:"Duplicate Order",description:"Create a copy of this order",icon:e.jsx(c,{className:"w-5 h-5"}),color:"bg-purple-500",hoverColor:"hover:bg-purple-50",onClick:()=>o(`/lats/purchase-order/create?duplicate=${s.id}`)}),r.push({id:"pdf",label:"Generate PDF",description:"Download order as PDF document",icon:e.jsx(d,{className:"w-5 h-5"}),color:"bg-orange-500",hoverColor:"hover:bg-orange-50",onClick:()=>{D.success("Generating PDF..."),o(`/lats/purchase-orders/${s.id}?action=print`)}}),"completed"!==s.status&&"cancelled"!==s.status&&r.push({id:"payment",label:"Manage Payment",description:"Record or update payment status",icon:e.jsx(u,{className:"w-5 h-5"}),color:"bg-indigo-500",hoverColor:"hover:bg-indigo-50",onClick:()=>o(`/lats/purchase-orders/${s.id}?tab=payment`)}),"received"!==s.status&&"partial_received"!==s.status||r.push({id:"quality",label:"Quality Check",description:"Mark items as quality verified",icon:e.jsx(m,{className:"w-5 h-5"}),color:"bg-teal-500",hoverColor:"hover:bg-teal-50",onClick:()=>o(`/lats/purchase-orders/${s.id}?tab=quality`)}),r.push({id:"delete",label:"Delete Order",description:"Permanently remove this order from database",icon:e.jsx(O,{className:"w-5 h-5"}),color:"bg-red-500",hoverColor:"hover:bg-red-50",onClick:()=>ce(s.id),divider:!0}),r},ge=async e=>{try{const s=await I(e);if(s.ok){(await Q(e,{status:"sent"})).ok?D.success("Order approved and sent to supplier"):D.success("Order approved (send manually from details)")}else D.error(s.message||"Failed to approve order")}catch(s){D.error("Failed to process order")}},be=async e=>{try{const s=await Q(e,{status:"completed"});s.ok?D.success("Purchase order completed successfully"):D.error(s.message||"Failed to complete purchase order")}catch(s){D.error("Failed to complete purchase order")}};return e.jsxs("div",{className:"p-4 sm:p-6 max-w-7xl mx-auto space-y-6",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row justify-between items-start lg:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx($,{to:"/lats"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Purchase Orders"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Manage your purchase orders and inventory"})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsxs("button",{onClick:()=>te(!0),className:"flex items-center gap-2 px-4 py-2.5 rounded-lg font-medium bg-green-600 text-white hover:bg-green-700 transition-colors text-sm",title:"CBM Calculator",children:[e.jsx(p,{size:18}),"CBM"]}),e.jsxs("button",{onClick:async()=>{var e;try{D.loading("Creating automatic PO for iPhone 14 Pro 256GB Deep Purple...",{id:"auto-po"});const{data:s,error:t}=await a.from("lats_product_variants").select("\n          id,\n          product_id,\n          variant_name,\n          sku,\n          cost_price,\n          selling_price\n        ").eq("variant_name","iPhone 14 Pro 256GB Deep Purple").limit(1);if(t||!s||0===s.length)return void D.error("Could not find iPhone 14 Pro 256GB Deep Purple variant",{id:"auto-po"});const l=s[0],{data:i,error:n}=await a.from("lats_suppliers").select("id, name").eq("is_active",!0).limit(1);if(n||!i||0===i.length)return void D.error("No active suppliers found",{id:"auto-po"});const c={supplierId:i[0].id,expectedDelivery:new Date(Date.now()+2592e6).toISOString(),notes:"Auto-created PO for iPhone 14 Pro 256GB Deep Purple - Quantity: 2 | Status: Approved & Sent to Supplier",status:"sent",currency:"USD",paymentTerms:"Net 30",exchangeRate:1,baseCurrency:"TZS",exchangeRateSource:"manual",exchangeRateDate:(new Date).toISOString(),items:[{productId:l.product_id,variantId:l.id,quantity:2,costPrice:1e3,sellingPrice:l.selling_price||1200,minimumOrderQty:1,notes:"iPhone 14 Pro 256GB Deep Purple - Auto-generated"}]},d=await r.getState().createPurchaseOrder(c);d.ok?(D.success("✅ PO Created & Sent to Supplier! Total: $2000 | Ready for Payment",{id:"auto-po",duration:4e3}),await oe(),(null==(e=d.data)?void 0:e.id)&&setTimeout(()=>{o(`/lats/purchase-orders/${d.data.id}?tab=payment`)},1500)):D.error(d.message||"Failed to create purchase order",{id:"auto-po"})}catch(s){D.error("Failed to create automatic purchase order",{id:"auto-po"})}},className:"flex items-center gap-2 px-4 py-2.5 rounded-lg font-medium bg-purple-600 text-white hover:bg-purple-700 transition-colors text-sm shadow-lg hover:shadow-xl",title:"Auto-create PO for iPhone 14 Pro 256GB Deep Purple",children:[e.jsx(x,{size:18}),"Auto iPhone PO"]}),e.jsxs("button",{onClick:()=>o("/lats/purchase-order/create"),className:"flex items-center gap-2 px-4 py-2.5 rounded-lg font-medium bg-orange-600 text-white hover:bg-orange-700 transition-colors text-sm",children:[e.jsx(h,{size:18}),"Create PO"]})]})]}),e.jsxs("div",{className:"flex gap-2 border-b border-gray-200",children:[e.jsx("button",{onClick:()=>Z("purchase-orders"),className:"px-6 py-3 font-semibold text-sm rounded-t-lg transition-all duration-200 "+("purchase-orders"===U?"bg-gradient-to-r from-orange-500 to-amber-600 text-white shadow-lg":"bg-gray-100 text-gray-600 hover:bg-gray-200"),children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(g,{size:18}),e.jsx("span",{children:"Purchase Orders"})]})}),e.jsx("button",{onClick:()=>Z("suppliers"),className:"px-6 py-3 font-semibold text-sm rounded-t-lg transition-all duration-200 "+("suppliers"===U?"bg-gradient-to-r from-orange-500 to-amber-600 text-white shadow-lg":"bg-gray-100 text-gray-600 hover:bg-gray-200"),children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(b,{size:18}),e.jsx("span",{children:"Manage Suppliers"})]})})]}),"purchase-orders"===U?e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-3",children:[e.jsx("div",{className:"bg-blue-50 rounded-lg p-5 hover:bg-blue-100 transition-colors",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(g,{className:"w-7 h-7 text-blue-600 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"Total Orders"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:ne.length})]})]})}),e.jsx("div",{className:"bg-green-50 rounded-lg p-5 hover:bg-green-100 transition-colors",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(v,{className:"w-7 h-7 text-green-600 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"Total Value"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:me(ne.reduce((e,s)=>{if(s.totalAmount&&s.totalAmount>0)return e+s.totalAmount;if(s.items&&s.items.length>0){return e+s.items.reduce((e,s)=>e+(s.totalPrice||s.quantity*s.costPrice),0)}return e},0),"TSh")})]})]})}),e.jsx("div",{className:"bg-orange-50 rounded-lg p-5 hover:bg-orange-100 transition-colors",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(j,{className:"w-7 h-7 text-orange-600 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"Pending"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:ne.filter(e=>"draft"===e.status||"sent"===e.status||"partial_received"===e.status).length})]})]})}),e.jsx("div",{className:"bg-purple-50 rounded-lg p-5 hover:bg-purple-100 transition-colors",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(f,{className:"w-7 h-7 text-purple-600 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"Completed"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:ne.filter(e=>"received"===e.status).length})]})]})})]}),e.jsx(t,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"relative",children:[e.jsx(y,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-5 h-5"}),e.jsx("input",{type:"text",placeholder:"Search orders, suppliers, or notes...",value:V,onChange:e=>Y(e.target.value),className:"w-full pl-10 pr-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 transition-all text-gray-900"})]})}),e.jsxs("div",{className:"flex flex-wrap items-center gap-3",children:[e.jsxs("select",{value:H,onChange:e=>K(e.target.value),className:"px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 transition-all text-gray-900 bg-white",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"sent",children:"Sent"}),e.jsx("option",{value:"received",children:"Received"})]}),e.jsxs("select",{value:W,onChange:e=>J(e.target.value),className:"px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-500/20 transition-all text-gray-900 bg-white",children:[e.jsx("option",{value:"createdAt",children:"Date Created"}),e.jsx("option",{value:"orderNumber",children:"Order Number"}),e.jsx("option",{value:"totalAmount",children:"Total Amount"})]}),e.jsxs("button",{onClick:oe,disabled:q,className:"flex items-center gap-2 px-4 py-2.5 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50 transition-colors disabled:opacity-50 bg-white",children:[e.jsx(N,{className:"w-4 h-4 "+(q?"animate-spin":"")}),e.jsx("span",{className:"hidden sm:inline",children:"Refresh"})]}),ee&&e.jsxs("div",{className:"text-xs text-gray-600 bg-gray-100 px-3 py-2 rounded-lg",children:["Last: ",ee.toLocaleTimeString()]})]})]})}),E&&e.jsx(t,{className:"bg-red-50 border-red-200 p-4",children:e.jsxs("div",{className:"flex items-center gap-3 text-red-700",children:[e.jsx(w,{className:"w-5 h-5"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-semibold",children:"Error"}),e.jsx("p",{className:"text-sm",children:E})]})]})}),q?e.jsx(t,{className:"p-12",children:e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx(N,{className:"w-8 h-8 animate-spin text-blue-500"}),e.jsx("span",{className:"ml-4 text-gray-700 font-medium",children:"Loading purchase orders..."})]})}):0===ne.length?e.jsxs(t,{className:"p-12 text-center",children:[e.jsx(g,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:"No purchase orders found"}),e.jsx("p",{className:"text-gray-600 mb-6",children:V||"all"!==H?"Try adjusting your search or filters":"Get started by creating your first purchase order"}),!V&&"all"===H&&e.jsxs("button",{onClick:()=>o("/lats/purchase-order/create"),className:"inline-flex items-center gap-2 px-6 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-lg font-medium transition-colors",children:[e.jsx(h,{className:"w-4 h-4"}),e.jsx("span",{children:"Create Purchase Order"})]})]}):e.jsxs(t,{className:"overflow-hidden",children:[e.jsx("div",{className:"bg-gray-50 border-b border-gray-200 px-6 py-3",children:e.jsxs("div",{className:"grid grid-cols-12 gap-4 items-center text-xs font-semibold text-gray-700 uppercase",children:[e.jsx("div",{className:"col-span-2",children:"Order Details"}),e.jsx("div",{className:"col-span-2",children:"Supplier"}),e.jsx("div",{className:"col-span-2",children:"Financial"}),e.jsx("div",{className:"col-span-2",children:"Status"}),e.jsx("div",{className:"col-span-1 text-center",children:"Items"}),e.jsx("div",{className:"col-span-2",children:"Created Date"}),e.jsx("div",{className:"col-span-1 text-center",children:"Actions"})]})}),e.jsx("div",{className:"divide-y divide-gray-200",children:ne.map(s=>{var r;return e.jsx("div",{className:"hover:bg-gray-50 transition-colors",children:e.jsxs("div",{className:"grid grid-cols-12 gap-4 items-center px-6 py-4",children:[e.jsx("div",{className:"col-span-2",children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-500 rounded-lg flex items-center justify-center",children:e.jsx(g,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-bold text-gray-900",children:s.orderNumber}),e.jsx("p",{className:"text-sm text-gray-500",children:s.paymentTerms||"Net 30"})]})]})}),e.jsx("div",{className:"col-span-2",children:s.supplier?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 bg-orange-500 rounded-lg flex items-center justify-center",children:e.jsx("span",{className:"text-white text-sm font-bold",children:s.supplier.name.charAt(0).toUpperCase()})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:s.supplier.name}),e.jsx("p",{className:"text-xs text-gray-500",children:s.supplier.country||"Tanzania"})]})]}):e.jsx("span",{className:"text-gray-400 italic",children:"No supplier"})}),e.jsx("div",{className:"col-span-2",children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(v,{className:"w-4 h-4 text-green-600"}),e.jsx("span",{className:"font-bold text-gray-900",children:(()=>{if(s.totalAmount&&s.totalAmount>0)return me(s.totalAmount,s.currency);if(s.items&&s.items.length>0){const e=s.items.reduce((e,s)=>e+(s.totalPrice||s.quantity*s.costPrice),0);if(e>0)return me(e,s.currency)}return me(0,s.currency||"TSh")})()})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-xs text-gray-500 bg-gray-100 px-2 py-1 rounded-full",children:"TZS"===s.currency?"TSh":s.currency||"TSh"}),s.exchangeRate&&1!==s.exchangeRate&&s.totalAmountBaseCurrency&&e.jsx("span",{className:"text-xs text-blue-600",children:me(s.totalAmountBaseCurrency,"TSh")})]})]})}),e.jsx("div",{className:"col-span-2",children:e.jsxs("div",{className:"space-y-1",children:[e.jsxs("span",{className:`inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full text-xs font-semibold ${de(s.status)}`,children:[ue(s.status),e.jsx("span",{className:"capitalize",children:s.status.replace("_"," ")})]}),"partial_received"===s.status&&s.items&&s.items.length>0&&(()=>{const r=s.items.reduce((e,s)=>e+(s.quantity||0),0),t=s.items.reduce((e,s)=>e+(s.receivedQuantity||0),0),a=r>0?Math.round(t/r*100):0,l=r-t;return e.jsxs("div",{className:"mt-1",children:[e.jsxs("div",{className:"flex items-center gap-2 text-xs",children:[e.jsx("div",{className:"flex-1 bg-gray-200 rounded-full h-2 overflow-hidden",children:e.jsx("div",{className:"bg-orange-500 h-full transition-all duration-300",style:{width:`${a}%`}})}),e.jsxs("span",{className:"text-orange-700 font-semibold whitespace-nowrap",children:[a,"%"]})]}),e.jsxs("p",{className:"text-xs text-gray-600 mt-0.5",children:[t,"/",r," items • ",l," remaining"]})]})})()]})}),e.jsx("div",{className:"col-span-1 text-center",children:e.jsxs("div",{className:"flex items-center justify-center gap-1 text-sm font-medium text-gray-900",children:[e.jsx(g,{className:"w-4 h-4 text-gray-600"}),e.jsx("span",{children:(null==(r=s.items)?void 0:r.reduce((e,s)=>e+(s.quantity||0),0))||0})]})}),e.jsx("div",{className:"col-span-2",children:e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[e.jsx(j,{className:"w-4 h-4"}),e.jsx("span",{children:pe(s.createdAt)})]})}),e.jsx("div",{className:"col-span-1",children:e.jsx("div",{className:"flex items-center justify-end gap-2 relative",children:xe(s).map((r,t)=>e.jsxs("div",{className:"relative",children:[e.jsxs("button",{ref:"more"===r.type?e=>{ie.current[s.id]=e}:void 0,onClick:e=>{e.preventDefault(),e.stopPropagation(),r.onClick(e)},className:`flex items-center gap-1.5 px-3 py-2 text-white rounded-lg transition-colors text-xs font-medium ${r.color}`,title:r.label,children:[r.icon,e.jsx("span",{className:"hidden lg:inline",children:r.label})]}),"more"===r.type&&e.jsx(L,{isOpen:ae===s.id,onClose:()=>le(null),position:"right",items:he(s),triggerRef:{current:ie.current[s.id]}})]},`${r.type}-${t}`))})})]})},s.id)})})]})]}):e.jsx("div",{className:"mt-6",children:e.jsx(R,{})}),e.jsx(F,{isOpen:re,onClose:()=>te(!1)})]})};export{M as default};
