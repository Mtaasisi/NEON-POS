import{j as e,d as t,G as a,u as s,s as r}from"./index-222cfb29.js";import{r as o}from"./vendor-a2ff445a.js";import{B as n}from"./BackButton-e41d1482.js";import{a as i}from"./routing-a2f0f6d2.js";import{V as l,x as c,aM as d,t as m,a1 as p,a5 as h,aq as x,aA as g,y as u,aj as y,ai as f,ah as j,aa as v,ax as N,Y as b,Q as w,av as S}from"./ui-551a39a6.js";import{P as _}from"./PageErrorBoundary-d0d559c5.js";import{u as k}from"./useErrorHandler-ea2ee44d.js";import{E as A}from"./ErrorState-0516fc54.js";import"./supabase-7e851d02.js";const C=[{id:"pos-system",name:"POS System",description:"Point of Sale transactions",icon:l,path:"/pos",color:"from-blue-500 to-blue-600",category:"sales"},{id:"new-sale",name:"New Sale",description:"Start a new POS transaction",icon:l,path:"/pos",color:"from-blue-500 to-blue-600",category:"sales"},{id:"unified-inventory",name:"Unified Inventory",description:"Complete inventory and catalog management",icon:c,path:"/lats/unified-inventory",color:"from-purple-500 to-purple-600",category:"inventory"},{id:"stock-transfers",name:"Stock Transfers",description:"Transfer inventory between branches",icon:d,path:"/lats/stock-transfers",color:"from-blue-500 to-blue-600",category:"inventory"},{id:"add-customer",name:"Add Customer",description:"Create new customer profile",icon:m,path:"/lats/customers",color:"from-indigo-500 to-indigo-600",category:"customers"},{id:"whatsapp-chat",name:"WhatsApp Chat",description:"Open WhatsApp chat interface",icon:p,path:"/lats/whatsapp-chat",color:"from-green-500 to-green-600",category:"integration"},{id:"sales-report",name:"Sales Report",description:"Generate sales reports",icon:h,path:"/lats/sales-reports",color:"from-teal-500 to-teal-600",category:"reports"},{id:"loyalty-program",name:"Loyalty Program",description:"Manage customer loyalty",icon:x,path:"/lats/loyalty",color:"from-yellow-500 to-yellow-600",category:"customers"},{id:"payment-tracking",name:"Payment Tracking",description:"Track payment status",icon:g,path:"/lats/payments",color:"from-pink-500 to-pink-600",category:"analytics"},{id:"search-products",name:"Search Products",description:"Find products quickly",icon:u,path:"/lats/unified-inventory",color:"from-emerald-500 to-emerald-600",category:"inventory"},{id:"green-api-management",name:"Green API",description:"Manage WhatsApp integration",icon:p,path:"/lats/whatsapp-connection-manager",color:"from-green-500 to-green-600",category:"integration"},{id:"whatsapp-chat",name:"WhatsApp Chat",description:"Send and receive WhatsApp messages",icon:p,path:"/lats/whatsapp-chat",color:"from-green-500 to-green-600",category:"integration"},{id:"export-data",name:"Export Data",description:"Export reports and data",icon:y,path:"/lats/sales-reports",color:"from-cyan-500 to-cyan-600",category:"reports"},{id:"import-data",name:"Import Data",description:"Import products and customers",icon:f,path:"/lats/customers",color:"from-violet-500 to-violet-600",category:"inventory"},{id:"sales-analytics",name:"Sales Analytics",description:"Sales performance metrics",icon:j,path:"/lats/sales-analytics",color:"from-red-500 to-red-600",category:"analytics"},{id:"payment-settings",name:"Payment Settings",description:"Select provider and credentials",icon:v,path:"/lats/payment-settings",color:"from-slate-500 to-slate-700",category:"sales"},{id:"payment-history",name:"Payment History",description:"View all payment transactions",icon:h,path:"/lats/payment-history",color:"from-indigo-500 to-indigo-600",category:"analytics"},{id:"payment-analytics",name:"Payment Analytics",description:"Payment performance insights",icon:N,path:"/lats/payment-analytics",color:"from-purple-500 to-purple-600",category:"analytics"},{id:"beem-test",name:"Beem Test",description:"Test Beem Africa payment integration",icon:g,path:"/lats/beem-test",color:"from-blue-500 to-blue-600",category:"sales"}],P=({className:s="",variant:r="grid",category:o="all",maxItems:n})=>{const l=i(),c=C.filter(e=>"all"===o||e.category===o).slice(0,n);switch(r){case"list":return e.jsx("div",{className:`space-y-2 ${s}`,children:c.map(t=>{const r=t.icon;return e.jsx(a,{onClick:()=>l(t.path),icon:e.jsx(r,{size:18}),className:`w-full justify-start text-left p-4 ${s}`,variant:"secondary",children:e.jsxs("div",{className:"flex flex-col items-start",children:[e.jsx("span",{className:"font-medium text-gray-900",children:t.name}),e.jsx("span",{className:"text-sm text-gray-600",children:t.description})]})},t.id)})});case"compact":return e.jsx("div",{className:`flex flex-wrap gap-2 ${s}`,children:c.map(t=>{const s=t.icon;return e.jsx(a,{onClick:()=>l(t.path),icon:e.jsx(s,{size:16}),className:`bg-gradient-to-r ${t.color} text-white hover:scale-105 transition-transform duration-200`,variant:"primary",children:t.name},t.id)})});default:return e.jsx("div",{className:`grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 ${s}`,children:c.map(a=>{const s=a.icon;return e.jsx(t,{className:"cursor-pointer hover:scale-105 transition-transform duration-200",onClick:()=>l(a.path),children:e.jsxs("div",{className:"p-4 text-center",children:[e.jsx("div",{className:`w-12 h-12 mx-auto mb-3 rounded-lg bg-gradient-to-br ${a.color} flex items-center justify-center`,children:e.jsx(s,{size:24,className:"text-white"})}),e.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:a.name}),e.jsx("p",{className:"text-sm text-gray-600",children:a.description})]})},a.id)})})}},T=()=>{s();const c=i();o.useState("all");const{errorState:d,handleError:m,clearError:p,withErrorHandling:h}=k({maxRetries:3,showToast:!0,logToConsole:!0}),[x,g]=o.useState(!0),[u,y]=o.useState({metrics:{todaySales:0,todayOrders:0,totalProducts:0,activeCustomers:0,lowStockItems:0,pendingPayments:0,monthlyRevenue:0,monthlyGrowth:0},recentActivities:[],quickStats:[]});o.useEffect(()=>{(async()=>{await h(async()=>{var e,t,a,s,o,n;g(!0);try{const[i,l,c,d,m,p]=await Promise.all([r.from("lats_sales").select("total_amount").gte("created_at",(new Date).toISOString().split("T")[0]).eq("status","completed"),r.from("lats_sales").select("id").gte("created_at",(new Date).toISOString().split("T")[0]),r.from("lats_products").select("id, is_active").eq("is_active",!0),r.from("customers").select("id").eq("is_active",!0),r.from("lats_product_variants").select("id, quantity, min_quantity").lte("quantity",10),r.from("lats_sales").select("total_amount").gte("created_at",new Date((new Date).getFullYear(),(new Date).getMonth(),1).toISOString()).eq("status","completed")]),h=(null==(e=i.data)?void 0:e.reduce((e,t)=>e+("number"==typeof t.total_amount?t.total_amount:parseFloat(t.total_amount)||0),0))||0,x=(null==(t=l.data)?void 0:t.length)||0,g=(null==(a=c.data)?void 0:a.length)||0,u=(null==(s=d.data)?void 0:s.length)||0,f=(null==(o=m.data)?void 0:o.length)||0,j=(null==(n=p.data)?void 0:n.reduce((e,t)=>e+("number"==typeof t.total_amount?t.total_amount:parseFloat(t.total_amount)||0),0))||0,v=new Date((new Date).getFullYear(),(new Date).getMonth()-1,1),{data:N}=await r.from("lats_sales").select("total_amount").gte("created_at",v.toISOString()).lt("created_at",new Date((new Date).getFullYear(),(new Date).getMonth(),1).toISOString()).eq("status","completed"),b=(null==N?void 0:N.reduce((e,t)=>e+("number"==typeof t.total_amount?t.total_amount:parseFloat(t.total_amount)||0),0))||0,w=b>0?(j-b)/b*100:0;y({metrics:{todaySales:h,todayOrders:x,totalProducts:g,activeCustomers:u,lowStockItems:f,pendingPayments:0,monthlyRevenue:j,monthlyGrowth:Math.round(100*w)/100},recentActivities:[],quickStats:[]})}catch(i){y({metrics:{todaySales:0,todayOrders:0,totalProducts:0,activeCustomers:0,lowStockItems:0,pendingPayments:0,monthlyRevenue:0,monthlyGrowth:0},recentActivities:[],quickStats:[]})}g(!1)},"Loading dashboard data")})()},[h]);const f=e=>{try{c(e)}catch(t){m(t,"Navigation")}},j=e=>{try{return new Intl.NumberFormat("en-TZ",{style:"currency",currency:"TZS"}).format(e)}catch(t){return m(t,"Currency formatting"),`TZS ${e}`}};return d.hasError?e.jsx(A,{title:"Dashboard Error",message:d.errorMessage||void 0,error:d.error||void 0,action:{label:"Try Again",onClick:()=>{p(),window.location.reload()}},secondaryAction:{label:"Go Back",onClick:()=>c(-1)},showDetails:!0}):x?e.jsxs("div",{className:"p-4 sm:p-6 max-w-7xl mx-auto space-y-6",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(n,{to:"/dashboard"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"LATS System Dashboard"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Loading dashboard data..."})]})]}),e.jsx(t,{className:"p-8",children:e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),e.jsx("span",{className:"ml-3 text-gray-600",children:"Loading dashboard..."})]})})]}):e.jsx(_,{pageName:"LATS Dashboard",showDetails:!0,children:e.jsxs("div",{className:"p-4 sm:p-6 max-w-7xl mx-auto space-y-6",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row justify-between items-start lg:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(n,{to:"/dashboard"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"LATS System Dashboard"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Complete business management system"})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsx(a,{onClick:()=>f("/pos"),icon:e.jsx(l,{size:18}),className:"bg-gradient-to-r from-blue-500 to-blue-600 text-white",children:"Start New Sale"}),e.jsx(a,{onClick:()=>f("/lats/purchase-order/create"),icon:e.jsx(b,{size:18}),className:"bg-gradient-to-r from-orange-500 to-amber-600 text-white",children:"Create Purchase Order"}),e.jsx(a,{onClick:()=>f("/lats/add-product"),icon:e.jsx(w,{size:18}),className:"bg-gradient-to-r from-green-500 to-green-600 text-white",children:"Add Product"}),e.jsx(a,{onClick:()=>f("/lats/analytics"),icon:e.jsx(N,{size:18}),className:"bg-gradient-to-r from-purple-500 to-purple-600 text-white",children:"View Analytics"})]})]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(min(240px, 100%), 1fr))",gap:"clamp(1rem, 2vw, 1.5rem)",gridAutoRows:"1fr"},children:u.quickStats.map((a,s)=>{const r=a.icon;return e.jsx(t,{className:"bg-gradient-to-br from-white/80 to-white/60",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:a.title}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:a.value}),e.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[e.jsx("span",{className:"text-sm font-medium "+("positive"===a.changeType?"text-green-600":"text-red-600"),children:a.change}),e.jsx("span",{className:"text-xs text-gray-500",children:"from yesterday"})]})]}),e.jsx("div",{className:`p-3 rounded-full bg-gradient-to-br ${a.color}`,children:e.jsx(r,{className:"w-6 h-6 text-white"})})]})},s)})}),e.jsxs(t,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-gradient-to-br from-blue-100 to-indigo-100 rounded-lg",children:e.jsx(S,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"LATS System Navigation"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Access all LATS modules and features"})]})]}),e.jsx(P,{})]}),e.jsxs(t,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-gradient-to-br from-green-100 to-emerald-100 rounded-lg",children:e.jsx(S,{className:"w-5 h-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Recent Activities"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Latest system activities and updates"})]})]}),e.jsx("div",{className:"space-y-4",children:u.recentActivities.map(t=>{const a=t.icon;return e.jsxs("div",{className:"flex items-center gap-4 p-4 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:`p-2 rounded-full ${t.color.replace("text-","bg-").replace("-600","-100")}`,children:e.jsx(a,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-gray-900",children:t.title}),e.jsx("p",{className:"text-sm text-gray-600",children:t.description}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:t.time})]}),t.amount&&e.jsx("div",{className:"text-right",children:e.jsx("p",{className:"font-semibold text-gray-900",children:j(t.amount)})})]},t.id)})})]})]})})};export{T as default};
