import{aM as e,j as t}from"./index-222cfb29.js";import{R as s,r as a}from"./vendor-a2ff445a.js";import{n}from"./ui-551a39a6.js";import{g as r,a as i,G as o,W as l,M as c,N as d,S as u,b as x}from"./StatusSettingsSection-7ad006b2.js";import"./supabase-7e851d02.js";import"./routing-a2f0f6d2.js";var g={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},m=s.createContext&&s.createContext(g),h=globalThis&&globalThis.__assign||function(){return h=Object.assign||function(e){for(var t,s=1,a=arguments.length;s<a;s++)for(var n in t=arguments[s])Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n]);return e},h.apply(this,arguments)},b=globalThis&&globalThis.__rest||function(e,t){var s={};for(var a in e)Object.prototype.hasOwnProperty.call(e,a)&&t.indexOf(a)<0&&(s[a]=e[a]);if(null!=e&&"function"==typeof Object.getOwnPropertySymbols){var n=0;for(a=Object.getOwnPropertySymbols(e);n<a.length;n++)t.indexOf(a[n])<0&&Object.prototype.propertyIsEnumerable.call(e,a[n])&&(s[a[n]]=e[a[n]])}return s};function p(e){return e&&e.map(function(e,t){return s.createElement(e.tag,h({key:t},e.attr),p(e.child))})}function f(e){return function(t){return s.createElement(y,h({attr:h({},e.attr)},t),p(e.child))}}function y(e){var t=function(t){var a,n=e.attr,r=e.size,i=e.title,o=b(e,["attr","size","title"]),l=r||t.size||"1em";return t.className&&(a=t.className),e.className&&(a=(a?a+" ":"")+e.className),s.createElement("svg",h({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},t.attr,n,o,{className:a,style:h(h({color:e.color||t.color},t.style),e.style),height:l,width:l,xmlns:"http://www.w3.org/2000/svg"}),i&&s.createElement("title",null,i),e.children)};return void 0!==m?s.createElement(m.Consumer,null,function(e){return t(e)}):t(g)}function j(e){return f({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M23 19a2 2 0 0 1-2 2H3a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h4l2-3h6l2 3h4a2 2 0 0 1 2 2z"}},{tag:"circle",attr:{cx:"12",cy:"13",r:"4"}}]})(e)}function v(e){return f({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M12 20h9"}},{tag:"path",attr:{d:"M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"}}]})(e)}function w(e){return f({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M21 2l-2 2m-7.61 7.61a5.5 5.5 0 1 1-7.778 7.778 5.5 5.5 0 0 1 7.777-7.777zm0 0L15.5 7.5m0 0l3 3L22 7l-3-3m-3.5 3.5L19 4"}}]})(e)}function N(e){return f({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"15 3 21 3 21 9"}},{tag:"polyline",attr:{points:"9 21 3 21 3 15"}},{tag:"line",attr:{x1:"21",y1:"3",x2:"14",y2:"10"}},{tag:"line",attr:{x1:"3",y1:"21",x2:"10",y2:"14"}}]})(e)}function _(e){return f({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z"}}]})(e)}function k(e){return f({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"12",y1:"5",x2:"12",y2:"19"}},{tag:"line",attr:{x1:"5",y1:"12",x2:"19",y2:"12"}}]})(e)}function C(e){return f({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"23 4 23 10 17 10"}},{tag:"polyline",attr:{points:"1 20 1 14 7 14"}},{tag:"path",attr:{d:"M3.51 9a9 9 0 0 1 14.85-3.36L23 10M1 14l4.64 4.36A9 9 0 0 0 20.49 15"}}]})(e)}function S(e){return f({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M19 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11l5 5v11a2 2 0 0 1-2 2z"}},{tag:"polyline",attr:{points:"17 21 17 13 7 13 7 21"}},{tag:"polyline",attr:{points:"7 3 7 8 15 8"}}]})(e)}function I(e){return f({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"circle",attr:{cx:"12",cy:"12",r:"3"}},{tag:"path",attr:{d:"M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"}}]})(e)}function A(e){return f({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"polyline",attr:{points:"3 6 5 6 21 6"}},{tag:"path",attr:{d:"M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"}},{tag:"line",attr:{x1:"10",y1:"11",x2:"10",y2:"17"}},{tag:"line",attr:{x1:"14",y1:"11",x2:"14",y2:"17"}}]})(e)}function z(e){return f({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"1",y1:"1",x2:"23",y2:"23"}},{tag:"path",attr:{d:"M16.72 11.06A10.94 10.94 0 0 1 19 12.55"}},{tag:"path",attr:{d:"M5 12.55a10.94 10.94 0 0 1 5.17-2.39"}},{tag:"path",attr:{d:"M10.71 5.05A16 16 0 0 1 22.58 9"}},{tag:"path",attr:{d:"M1.42 9a15.91 15.91 0 0 1 4.7-2.88"}},{tag:"path",attr:{d:"M8.53 16.11a6 6 0 0 1 6.95 0"}},{tag:"line",attr:{x1:"12",y1:"20",x2:"12.01",y2:"20"}}]})(e)}function P(e){return f({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"path",attr:{d:"M5 12.55a11 11 0 0 1 14.08 0"}},{tag:"path",attr:{d:"M1.42 9a16 16 0 0 1 21.16 0"}},{tag:"path",attr:{d:"M8.53 16.11a6 6 0 0 1 6.95 0"}},{tag:"line",attr:{x1:"12",y1:"20",x2:"12.01",y2:"20"}}]})(e)}function L(e){return f({tag:"svg",attr:{viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:"2",strokeLinecap:"round",strokeLinejoin:"round"},child:[{tag:"line",attr:{x1:"18",y1:"6",x2:"6",y2:"18"}},{tag:"line",attr:{x1:"6",y1:"6",x2:"18",y2:"18"}}]})(e)}class W{static async checkInstanceState(e,t,s){try{return{stateInstance:(await r.getStateInstance(e,t)).stateInstance}}catch(a){return{stateInstance:"error",error:a.message}}}static async checkInstanceStateAlternative(e,t,s){try{return{stateInstance:(await r.getStateInstance(e,t)).stateInstance}}catch(a){return{stateInstance:"error",error:a.message}}}static async getInstanceInfo(e,t,s){try{const a=await i.getWaSettings(e,t,s);return{phoneNumber:a.phone,wid:a.deviceId,profileName:a.profileName,profilePictureUrl:a.avatar,countryInstance:a.countryInstance,typeAccount:a.typeAccount,stateInstance:a.stateInstance}}catch(a){throw a}}static async generateQRCode(e,t,s){try{return(await r.getQRCode(e,t)).qr}catch(a){throw a}}static async generateQRCodeWebSocket(e,t,s){try{if((await r.getQRCode(e,t)).qr)return null;throw new Error("Failed to generate QR code")}catch(a){throw a}}static async sendTestMessage(e,t,s,a){try{const t=`ðŸ§ª Test message from WhatsApp instance ${e} at ${(new Date).toLocaleString()}`;return{success:!0,message:"Test message sent successfully!",messageId:(await i.sendMessage({instanceId:e,chatId:`${a}@c.us`,message:t,messageType:"text"})).id}}catch(n){return{success:!1,error:n.message}}}static async logout(e,t,s){try{return await i.logout(e,t,s)}catch(a){throw a}}static async reboot(e,t,s){try{return await i.reboot(e,t,s)}catch(a){throw a}}static async updateApiToken(e,t,s,a){try{return await i.updateApiToken(e,t,s,a)}catch(n){throw n}}static async setProfilePicture(e,t,s){try{return await i.setProfilePicture(e,t,s)}catch(a){throw a}}static async getAuthorizationCode(e,t,s,a){try{return await i.getAuthorizationCode(e,t,s,a)}catch(n){throw n}}static async getSettings(e,t,s){try{return await i.getSettings(e,t,s)}catch(a){throw a}}static async setSettings(e,t,s,a){try{return await i.setSettings(e,t,s,a)}catch(n){throw n}}static async getWaSettings(e,t,s){try{return await i.getWaSettings(e,t,s)}catch(a){throw a}}}const M=()=>{const{instances:s,loading:i,fetchInstances:g,updateInstance:m,addInstance:h,deleteInstance:b,updateStatusesDebounced:p}=e();a.useState({});const[f,y]=a.useState(!1),[M,$]=a.useState(!1),[T,R]=a.useState(!1),[F,Q]=a.useState(!1),[D,G]=a.useState(!1),[O,B]=a.useState(!1),[E,U]=a.useState(!1),[H,V]=a.useState(!1),[q,Y]=a.useState(""),[J,K]=a.useState(null),[X,Z]=a.useState(null),[ee,te]=a.useState(!1),[se,ae]=a.useState(null),[ne,re]=a.useState(null),[ie,oe]=a.useState(null),[le,ce]=a.useState(null),[de,ue]=a.useState("255746605561"),[xe,ge]=a.useState(""),[me,he]=a.useState(null),[be,pe]=a.useState(""),[fe,ye]=a.useState(null),[je,ve]=a.useState(null),[we,Ne]=a.useState({}),[_e,ke]=a.useState(!1),[Ce,Se]=a.useState(!1),[Ie,Ae]=a.useState("general"),[ze,Pe]=a.useState(null),[Le,We]=a.useState({instance_id:"",api_token:"",instance_name:"",description:"",green_api_host:"https://api.green-api.com"}),[Me,$e]=a.useState({instance_id:"",api_token:"",instance_name:"",description:"",green_api_host:"https://api.green-api.com"});a.useEffect(()=>()=>{je&&je.close()},[]);const Te=e=>{switch(e){case"connected":return"text-green-600 bg-green-100";case"disconnected":return"text-red-600 bg-red-100";case"connecting":return"text-yellow-600 bg-yellow-100";case"blocked":return"text-red-800 bg-red-200";case"sleeping":return"text-purple-600 bg-purple-100";case"suspended":return"text-orange-700 bg-orange-200";default:return"text-gray-600 bg-gray-100"}},Re=e=>{switch(e){case"authorized":return"text-green-600 bg-green-100";case"notAuthorized":return"text-red-600 bg-red-100";case"starting":return"text-blue-600 bg-blue-100";case"blocked":return"text-red-800 bg-red-200";case"sleepMode":return"text-purple-600 bg-purple-100";case"yellowCard":return"text-orange-700 bg-orange-200";default:return"text-gray-600 bg-gray-100"}},Fe=e=>{switch(e){case"connected":return t.jsx(P,{className:"text-green-600"});case"disconnected":return t.jsx(z,{className:"text-red-600"});case"connecting":return t.jsx(C,{className:"text-yellow-600 animate-spin"});default:return t.jsx(I,{className:"text-gray-600"})}},Qe=async e=>{try{if(!de.trim())return void n.error("Please enter a phone number to send test message to");const t=await W.sendTestMessage(e.instance_id,e.api_token,e.green_api_host,de.trim());t.success?n.success(t.message||"Test message sent successfully!"):n.error(t.error||"Failed to send test message")}catch(t){n.error(`Failed to send test message: ${t.message}`)}},De=async e=>{try{ke(!0);let s=await r.loadSettingsFromDatabase(e.instance_id);if(s)Ne(s);else try{s=await r.getSettings(e.instance_id,e.api_token),Ne(s),await r.saveSettingsToDatabase(e.instance_id,s)}catch(t){s=r.getDefaultSettings(),Ne(s)}}catch(t){const e=r.getDefaultSettings();Ne(e),n.error("Using default settings")}finally{ke(!1)}};return t.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-green-50",children:[t.jsxs("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8",children:[t.jsxs("div",{className:"relative overflow-hidden bg-white rounded-2xl shadow-xl border border-gray-100 mb-8",children:[t.jsx("div",{className:"absolute top-0 right-0 w-96 h-96 bg-gradient-to-bl from-blue-100 to-transparent opacity-50 rounded-full -translate-y-48 translate-x-48"}),t.jsx("div",{className:"absolute bottom-0 left-0 w-72 h-72 bg-gradient-to-tr from-green-100 to-transparent opacity-50 rounded-full translate-y-36 -translate-x-36"}),t.jsx("div",{className:"relative px-6 sm:px-8 py-6",children:t.jsxs("div",{className:"flex flex-col space-y-6",children:[t.jsxs("div",{className:"text-center sm:text-left",children:[t.jsxs("div",{className:"flex items-center justify-center sm:justify-start mb-2",children:[t.jsx("div",{className:"w-12 h-12 bg-gradient-to-r from-green-500 to-blue-600 rounded-xl flex items-center justify-center mr-4",children:t.jsx(_,{className:"w-6 h-6 text-white"})}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"WhatsApp Hub"}),t.jsx("p",{className:"text-gray-600 mt-1",children:"Manage your WhatsApp instances and connections"})]})]}),t.jsxs("div",{className:"flex flex-wrap justify-center sm:justify-start gap-6 mt-4",children:[t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-2xl font-bold text-blue-600",children:s.length}),t.jsx("div",{className:"text-sm text-gray-500",children:"Total Instances"})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-2xl font-bold text-green-600",children:s.filter(e=>"connected"===e.status).length}),t.jsx("div",{className:"text-sm text-gray-500",children:"Connected"})]}),t.jsxs("div",{className:"text-center",children:[t.jsx("div",{className:"text-2xl font-bold text-orange-600",children:s.filter(e=>"authorized"===e.state_instance).length}),t.jsx("div",{className:"text-sm text-gray-500",children:"Authorized"})]})]})]}),t.jsxs("div",{className:"flex flex-col lg:flex-row gap-4",children:[t.jsxs("div",{className:"flex flex-wrap gap-3",children:[t.jsxs("button",{onClick:()=>$(!0),title:"Add a new WhatsApp instance to your account",className:"inline-flex items-center px-6 py-3 bg-gradient-to-r from-blue-600 to-blue-700 text-white font-medium rounded-xl shadow-lg hover:from-blue-700 hover:to-blue-800 focus:outline-none focus:ring-4 focus:ring-blue-200 transform hover:scale-105 transition-all duration-200",children:[t.jsx(k,{className:"w-5 h-5 mr-2"}),"Add"]}),t.jsxs("button",{onClick:g,disabled:i,title:"Refresh instances list and reload data from server",className:"inline-flex items-center px-4 py-3 bg-white border border-gray-200 text-gray-700 font-medium rounded-xl shadow-sm hover:bg-gray-50 focus:outline-none focus:ring-4 focus:ring-gray-200 disabled:opacity-50 transition-all duration-200",children:[t.jsx(C,{className:"w-4 h-4 mr-2 "+(i?"animate-spin":"")}),"Refresh"]})]}),t.jsxs("div",{className:"flex items-center bg-white rounded-xl border border-gray-200 shadow-sm p-1 lg:ml-auto",children:[t.jsx("input",{type:"text",value:de,onChange:e=>ue(e.target.value),placeholder:"Phone number for testing",title:"Enter phone number to send test messages to (format: 255746605561)",className:"flex-1 px-3 py-2 bg-transparent text-sm focus:outline-none min-w-0"}),t.jsxs("button",{onClick:()=>{s.length>0?Qe(s[0]):n.error("No instances available to send test message")},disabled:i||0===s.length,title:"Send a quick test message using the first available instance",className:"ml-2 inline-flex items-center px-4 py-2 bg-gradient-to-r from-orange-500 to-orange-600 text-white text-sm font-medium rounded-lg hover:from-orange-600 hover:to-orange-700 focus:outline-none focus:ring-2 focus:ring-orange-200 disabled:opacity-50 transition-all duration-200",children:[t.jsx(_,{className:"w-4 h-4 mr-1"}),"Quick Test"]})]})]})]})})]}),t.jsx("div",{className:"space-y-6",children:i&&0===s.length?t.jsxs("div",{className:"bg-white rounded-2xl shadow-xl border border-gray-100 p-16 text-center",children:[t.jsx("div",{className:"w-16 h-16 bg-gradient-to-r from-blue-500 to-blue-600 rounded-full flex items-center justify-center mx-auto mb-4",children:t.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-white"})}),t.jsx("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Loading WhatsApp Instances"}),t.jsx("p",{className:"text-gray-500",children:"Please wait while we fetch your instances..."})]}):0===s.length?t.jsxs("div",{className:"bg-white rounded-2xl shadow-xl border border-gray-100 p-16 text-center",children:[t.jsx("div",{className:"w-20 h-20 bg-gradient-to-r from-gray-100 to-gray-200 rounded-full flex items-center justify-center mx-auto mb-6",children:t.jsx(z,{className:"w-10 h-10 text-gray-400"})}),t.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-3",children:"No WhatsApp Instances Yet"}),t.jsx("p",{className:"text-gray-500 mb-8 max-w-md mx-auto",children:"Get started by creating your first WhatsApp instance to begin managing your connections"}),t.jsxs("button",{onClick:()=>$(!0),className:"inline-flex items-center px-8 py-4 bg-gradient-to-r from-blue-600 to-blue-700 text-white font-semibold rounded-xl shadow-lg hover:from-blue-700 hover:to-blue-800 focus:outline-none focus:ring-4 focus:ring-blue-200 transform hover:scale-105 transition-all duration-200",children:[t.jsx(k,{className:"w-5 h-5 mr-2"}),"Create Your First Instance"]})]}):t.jsx("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6",children:s.map(e=>t.jsxs("div",{className:"group relative bg-white rounded-2xl shadow-lg border border-gray-100 hover:shadow-2xl transition-all duration-300 overflow-hidden",children:[t.jsxs("div",{className:"relative p-6 pb-4",children:[t.jsx("div",{className:"absolute top-4 right-4",children:t.jsx("div",{className:"w-3 h-3 rounded-full "+("connected"===e.status?"bg-green-400 animate-pulse":"bg-gray-300")})}),t.jsxs("div",{className:"flex items-start space-x-4",children:[t.jsx("div",{className:"w-12 h-12 rounded-xl flex items-center justify-center "+("connected"===e.status?"bg-gradient-to-r from-green-500 to-green-600":"bg-gradient-to-r from-gray-400 to-gray-500"),children:t.jsx(_,{className:"w-6 h-6 text-white"})}),t.jsxs("div",{className:"flex-1 min-w-0",children:[t.jsx("h3",{className:"text-lg font-bold text-gray-900 truncate",children:e.instance_name||e.instance_id}),t.jsxs("p",{className:"text-sm text-gray-500 truncate",children:["ID: ",e.instance_id]}),e.phone_number&&t.jsxs("div",{className:"flex items-center mt-2 text-sm text-gray-600",children:[t.jsx(_,{className:"w-3 h-3 mr-1"}),e.phone_number]})]})]})]}),t.jsx("div",{className:"px-6 pb-4",children:t.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[t.jsxs("div",{className:`p-3 rounded-xl ${Te(e.status)}`,children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-xs font-medium text-gray-600",children:"Connection"}),Fe(e.status)]}),t.jsx("div",{className:"text-sm font-bold mt-1 capitalize",children:e.status})]}),t.jsxs("div",{className:`p-3 rounded-xl ${Re(e.state_instance)}`,children:[t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsx("span",{className:"text-xs font-medium text-gray-600",children:"State"}),t.jsx("div",{className:"w-2 h-2 rounded-full "+("authorized"===e.state_instance?"bg-green-500":"bg-orange-500")})]}),t.jsx("div",{className:"text-sm font-bold mt-1 capitalize",children:e.state_instance})]})]})}),e.description&&t.jsx("div",{className:"px-6 pb-4",children:t.jsx("div",{className:"p-3 bg-gray-50 rounded-xl",children:t.jsx("p",{className:"text-xs text-gray-600 line-clamp-2",children:e.description})})}),t.jsxs("div",{className:"p-6 pt-0 space-y-3",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[t.jsxs("button",{onClick:()=>(async e=>{try{const t=await W.checkInstanceState(e.instance_id,e.api_token,e.green_api_host);await m(e.instance_id,{state_instance:t.stateInstance,status:"authorized"===t.stateInstance?"connected":"disconnected",last_activity_at:(new Date).toISOString()},!0);const s="authorized"===t.stateInstance?"connected":"disconnected";t.error?n.error(`Failed to check status: ${t.error}`):"authorized"===t.stateInstance?n.success(`âœ… Instance ${e.instance_name||e.instance_id} is authorized and connected!`):n.error(`âš ï¸ Instance ${e.instance_name||e.instance_id} status: ${t.stateInstance} (${s})`)}catch(t){n.error(`Failed to check connection: ${t.message}`)}})(e),title:"Check connection status and verify instance authorization",className:"px-4 py-3 bg-gradient-to-r from-green-500 to-green-600 text-white text-sm font-medium rounded-xl hover:from-green-600 hover:to-green-700 focus:outline-none focus:ring-4 focus:ring-green-200 transition-all duration-200 flex items-center justify-center shadow-lg",children:[t.jsx(P,{className:"w-4 h-4 mr-2"}),"Status"]}),t.jsxs("button",{onClick:()=>Qe(e),title:"Send a test message to verify WhatsApp functionality",className:"px-4 py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white text-sm font-medium rounded-xl hover:from-orange-600 hover:to-orange-700 focus:outline-none focus:ring-4 focus:ring-orange-200 transition-all duration-200 flex items-center justify-center shadow-lg",children:[t.jsx(_,{className:"w-4 h-4 mr-2"}),"Test"]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[t.jsxs("button",{onClick:()=>(async e=>{try{te(!0),ae(e);const t=await W.generateQRCode(e.instance_id,e.api_token,e.green_api_host);t?(Z(t),G(!0),n.success(`QR code generated for ${e.instance_name||e.instance_id}`)):n.error("Failed to generate QR code")}catch(t){n.error(`Failed to generate QR code: ${t.message}`)}finally{te(!1)}})(e),title:"Generate QR code for WhatsApp authorization",className:"px-4 py-3 bg-blue-50 text-blue-700 text-sm font-medium rounded-xl hover:bg-blue-100 transition-all duration-200 flex items-center justify-center border border-blue-200",children:[t.jsx(N,{className:"w-4 h-4 mr-2"}),"QR"]}),t.jsxs("button",{onClick:()=>(async e=>{try{te(!0),ae(e),await W.generateQRCodeWebSocket(e.instance_id,e.api_token,e.green_api_host);const t=await W.generateQRCode(e.instance_id,e.api_token,e.green_api_host);t?(Z(t),G(!0),n.success("QR code generated successfully (using fallback method)")):n.error("Failed to generate QR code")}catch(t){n.error(`Failed to generate QR code via WebSocket: ${t.message}`)}finally{te(!1)}})(e),title:"Generate live QR code using WebSocket connection",className:"px-4 py-3 bg-purple-50 text-purple-700 text-sm font-medium rounded-xl hover:bg-purple-100 transition-all duration-200 flex items-center justify-center border border-purple-200",children:[t.jsx(P,{className:"w-4 h-4 mr-2"}),"Live"]})]}),t.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[t.jsxs("button",{onClick:()=>(e=>{K(e),$e({instance_id:e.instance_id,api_token:e.api_token,instance_name:e.instance_name||"",description:e.description||"",green_api_host:e.green_api_host||"https://api.green-api.com"}),R(!0)})(e),title:"Edit instance details, API token, and configuration",className:"px-4 py-2 bg-blue-50 text-blue-700 text-sm font-medium rounded-lg hover:bg-blue-100 transition-all duration-200 flex items-center justify-center border border-blue-200",children:[t.jsx(v,{className:"w-4 h-4 mr-2"}),"Edit"]}),t.jsxs("button",{onClick:()=>(async e=>{Y(e.instance_id),Pe(e),Q(!0),await De(e)})(e),title:"Configure Green API settings - Webhooks, Messages, Security & More",className:"px-4 py-2 bg-green-50 text-green-700 text-sm font-medium rounded-lg hover:bg-green-100 transition-all duration-200 flex items-center justify-center border border-green-200",children:[t.jsx(I,{className:"w-4 h-4 mr-2"}),"Green API"]})]})]}),t.jsx("button",{onClick:()=>(async e=>{if(confirm("Are you sure you want to delete this WhatsApp instance? This action cannot be undone."))try{y(!0),await b(e),n.success("Instance deleted successfully")}catch(t){n.error("Failed to delete instance")}finally{y(!1)}})(e.instance_id),className:"absolute top-4 left-4 p-2 bg-red-500 text-white rounded-lg opacity-0 group-hover:opacity-100 transition-all duration-200 hover:bg-red-600 focus:outline-none focus:ring-2 focus:ring-red-200",title:"Delete this WhatsApp instance permanently (cannot be undone)",children:t.jsx(A,{className:"w-4 h-4"})}),e.last_connected_at&&t.jsx("div",{className:"absolute bottom-2 right-2 opacity-0 group-hover:opacity-100 transition-opacity duration-200",children:t.jsxs("div",{className:"bg-black bg-opacity-75 text-white text-xs px-2 py-1 rounded",children:["Last: ",new Date(e.last_connected_at).toLocaleDateString()]})})]},e.id))})})]}),M&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4 z-50 backdrop-blur-sm",children:t.jsxs("div",{className:"relative bg-white rounded-3xl shadow-2xl max-w-lg w-full overflow-hidden",children:[t.jsxs("div",{className:"relative bg-gradient-to-r from-blue-600 to-blue-700 px-8 py-6",children:[t.jsxs("div",{className:"relative flex items-center",children:[t.jsx("div",{className:"w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center mr-4",children:t.jsx(k,{className:"w-6 h-6 text-white"})}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-2xl font-bold text-white",children:"Add Instance"}),t.jsx("p",{className:"text-blue-100 mt-1",children:"Create new WhatsApp instance"})]})]}),t.jsx("button",{onClick:()=>$(!1),className:"absolute top-4 right-4 p-2 text-white/80 hover:text-white hover:bg-white/20 rounded-xl transition-all duration-200",children:t.jsx(L,{className:"w-5 h-5"})})]}),t.jsx("div",{className:"p-8 space-y-6",children:t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Instance ID *"}),t.jsx("input",{type:"text",value:Le.instance_id,onChange:e=>We({...Le,instance_id:e.target.value}),className:"w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl shadow-sm focus:outline-none focus:ring-4 focus:ring-blue-200 focus:border-blue-500 transition-all duration-200",placeholder:"e.g., 1101123456"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"API Token *"}),t.jsx("input",{type:"password",value:Le.api_token,onChange:e=>We({...Le,api_token:e.target.value}),className:"w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl shadow-sm focus:outline-none focus:ring-4 focus:ring-blue-200 focus:border-blue-500 transition-all duration-200",placeholder:"Your Green API token"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Instance Name"}),t.jsx("input",{type:"text",value:Le.instance_name,onChange:e=>We({...Le,instance_name:e.target.value}),className:"w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl shadow-sm focus:outline-none focus:ring-4 focus:ring-blue-200 focus:border-blue-500 transition-all duration-200",placeholder:"Display name for this instance"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Description"}),t.jsx("textarea",{value:Le.description,onChange:e=>We({...Le,description:e.target.value}),className:"w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl shadow-sm focus:outline-none focus:ring-4 focus:ring-blue-200 focus:border-blue-500 transition-all duration-200 resize-none",rows:3,placeholder:"Optional description for this instance"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Green API Host"}),t.jsx("input",{type:"url",value:Le.green_api_host,onChange:e=>We({...Le,green_api_host:e.target.value}),className:"w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl shadow-sm focus:outline-none focus:ring-4 focus:ring-blue-200 focus:border-blue-500 transition-all duration-200",placeholder:"https://api.green-api.com"})]})]})}),t.jsxs("div",{className:"px-8 py-6 bg-gray-50 border-t border-gray-100 flex justify-end gap-4",children:[t.jsx("button",{onClick:()=>$(!1),className:"px-6 py-3 border border-gray-300 rounded-xl shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-4 focus:ring-gray-200 transition-all duration-200",children:"Cancel"}),t.jsx("button",{onClick:async()=>{try{if(!Le.instance_id||!Le.api_token)return void n.error("Instance ID and API Token are required");y(!0),await h({instance_id:Le.instance_id,api_token:Le.api_token,instance_name:Le.instance_name||Le.instance_id,description:Le.description,green_api_host:Le.green_api_host,green_api_url:`${Le.green_api_host}/waInstance${Le.instance_id}`,state_instance:"notAuthorized",status:"disconnected",is_active:!0,user_id:"",phone_number:void 0,wid:void 0,country_instance:void 0,type_account:void 0,last_connected_at:void 0,last_activity_at:void 0,profile_name:void 0,profile_picture_url:void 0}),n.success("WhatsApp instance created successfully!"),We({instance_id:"",api_token:"",instance_name:"",description:"",green_api_host:"https://api.green-api.com"}),$(!1)}catch(e){n.error("Failed to create instance")}finally{y(!1)}},disabled:f||!Le.instance_id||!Le.api_token,className:"px-8 py-3 border border-transparent rounded-xl shadow-lg text-sm font-semibold text-white bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 focus:outline-none focus:ring-4 focus:ring-blue-200 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 transform hover:scale-105",children:f?t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Creating..."]}):"Create"})]})]})}),T&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-60 flex items-center justify-center p-4 z-50 backdrop-blur-sm",children:t.jsxs("div",{className:"relative bg-white rounded-3xl shadow-2xl max-w-lg w-full overflow-hidden",children:[t.jsxs("div",{className:"relative bg-gradient-to-r from-blue-600 to-blue-700 px-8 py-6",children:[t.jsxs("div",{className:"relative flex items-center",children:[t.jsx("div",{className:"w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center mr-4",children:t.jsx(v,{className:"w-6 h-6 text-white"})}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-2xl font-bold text-white",children:"Edit Instance"}),t.jsx("p",{className:"text-blue-100 mt-1",children:"Update WhatsApp instance details"})]})]}),t.jsx("button",{onClick:()=>R(!1),className:"absolute top-4 right-4 p-2 text-white/80 hover:text-white hover:bg-white/20 rounded-xl transition-all duration-200",children:t.jsx(L,{className:"w-5 h-5"})})]}),t.jsx("div",{className:"p-8 space-y-6",children:t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Instance ID"}),t.jsx("input",{type:"text",value:Me.instance_id,disabled:!0,className:"w-full px-4 py-3 bg-gray-100 border border-gray-200 rounded-xl shadow-sm text-gray-600 cursor-not-allowed",placeholder:"Instance ID (cannot be changed)"}),t.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Instance ID cannot be modified"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"API Token *"}),t.jsx("input",{type:"password",value:Me.api_token,onChange:e=>$e({...Me,api_token:e.target.value}),className:"w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl shadow-sm focus:outline-none focus:ring-4 focus:ring-blue-200 focus:border-blue-500 transition-all duration-200",placeholder:"Your Green API token"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Instance Name"}),t.jsx("input",{type:"text",value:Me.instance_name,onChange:e=>$e({...Me,instance_name:e.target.value}),className:"w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl shadow-sm focus:outline-none focus:ring-4 focus:ring-blue-200 focus:border-blue-500 transition-all duration-200",placeholder:"Display name for this instance"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Description"}),t.jsx("textarea",{value:Me.description,onChange:e=>$e({...Me,description:e.target.value}),className:"w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl shadow-sm focus:outline-none focus:ring-4 focus:ring-blue-200 focus:border-blue-500 transition-all duration-200 resize-none",rows:3,placeholder:"Optional description for this instance"})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-semibold text-gray-700 mb-3",children:"Green API Host"}),t.jsx("input",{type:"url",value:Me.green_api_host,onChange:e=>$e({...Me,green_api_host:e.target.value}),className:"w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-xl shadow-sm focus:outline-none focus:ring-4 focus:ring-blue-200 focus:border-blue-500 transition-all duration-200",placeholder:"https://api.green-api.com"})]})]})}),t.jsxs("div",{className:"px-8 py-6 bg-gray-50 border-t border-gray-100 flex justify-end gap-4",children:[t.jsx("button",{onClick:()=>R(!1),className:"px-6 py-3 border border-gray-300 rounded-xl shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-4 focus:ring-gray-200 transition-all duration-200",children:"Cancel"}),t.jsx("button",{onClick:async()=>{try{if(!J||!Me.api_token)return void n.error("API Token is required");y(!0),await m(J.instance_id,{api_token:Me.api_token,instance_name:Me.instance_name,description:Me.description,green_api_host:Me.green_api_host,green_api_url:`${Me.green_api_host}/waInstance${Me.instance_id}`},!1),n.success("âœ… Instance updated successfully!"),R(!1),K(null),$e({instance_id:"",api_token:"",instance_name:"",description:"",green_api_host:"https://api.green-api.com"})}catch(e){n.error(`Failed to update instance: ${e.message}`)}finally{y(!1)}},disabled:f||!Me.api_token,className:"px-8 py-3 border border-transparent rounded-xl shadow-lg text-sm font-semibold text-white bg-gradient-to-r from-blue-600 to-blue-700 hover:from-blue-700 hover:to-blue-800 focus:outline-none focus:ring-4 focus:ring-blue-200 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200 transform hover:scale-105",children:f?t.jsxs("div",{className:"flex items-center",children:[t.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white mr-2"}),"Updating..."]}):"Update"})]})]})}),D&&se&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:t.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full",children:[t.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:t.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:["QR Code: ",se.instance_name||se.instance_id]})}),t.jsxs("div",{className:"p-6 text-center",children:[ee?t.jsx("div",{className:"animate-spin rounded-full h-16 w-16 border-b-2 border-blue-600 mx-auto"}):X&&t.jsx("img",{src:X,alt:"WhatsApp QR Code",className:"mx-auto max-w-full h-auto"}),t.jsx("p",{className:"text-sm text-gray-500 mt-4",children:"Scan this QR code to authorize your WhatsApp instance."}),je&&t.jsx("p",{className:"text-xs text-green-600 mt-2",children:"Live connection active - QR will update automatically"})]}),t.jsx("div",{className:"px-6 py-4 border-t border-gray-200 flex justify-end",children:t.jsx("button",{onClick:()=>{G(!1),Z(null),ae(null),je&&(je.close(),ve(null))},className:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500",children:"Close"})})]})}),O&&ne&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:t.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full",children:[t.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:t.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:["Update Profile Picture: ",ne.instance_name||ne.instance_id]})}),t.jsx("div",{className:"p-6",children:t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Image File"}),t.jsx("input",{type:"file",accept:"image/*",onChange:e=>{var t;return ye((null==(t=e.target.files)?void 0:t[0])||null)},className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),fe&&t.jsxs("div",{className:"text-sm text-gray-600",children:["Selected: ",fe.name]})]})}),t.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 flex justify-end gap-3",children:[t.jsx("button",{onClick:()=>{B(!1),re(null),ye(null)},className:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:"Cancel"}),t.jsx("button",{onClick:async()=>{if(fe&&ne)try{y(!0),await W.setProfilePicture(ne.instance_id,ne.api_token,fe),n.success("Profile picture updated successfully"),ye(null),re(null),B(!1),p()}catch(e){n.error(`Failed to upload profile picture: ${e.message}`)}finally{y(!1)}else n.error("Please select a file and instance")},disabled:f||!fe,className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 disabled:opacity-50",children:f?"Uploading...":"Upload"})]})]})}),E&&ie&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:t.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full",children:[t.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:t.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:["Get Authorization Code: ",ie.instance_name||ie.instance_id]})}),t.jsx("div",{className:"p-6",children:t.jsxs("div",{className:"space-y-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone Number"}),t.jsx("input",{type:"text",value:xe,onChange:e=>ge(e.target.value),placeholder:"e.g., 255746605561",className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]}),me&&t.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-md p-3",children:[t.jsx("p",{className:"text-sm font-medium text-green-800",children:"Authorization Code:"}),t.jsx("p",{className:"text-sm text-green-700 font-mono",children:me})]})]})}),t.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 flex justify-end gap-3",children:[t.jsx("button",{onClick:()=>{U(!1),oe(null),ge(""),he(null)},className:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:"Cancel"}),t.jsx("button",{onClick:async()=>{if(xe.trim()&&ie)try{y(!0);const e=await W.getAuthorizationCode(ie.instance_id,ie.api_token,xe.trim(),ie.green_api_host);he(e.code||"Authorization code retrieved"),n.success("Authorization code retrieved successfully")}catch(e){n.error(`Failed to get authorization code: ${e.message}`)}finally{y(!1)}else n.error("Please enter a phone number")},disabled:f||!xe.trim(),className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 disabled:opacity-50",children:f?"Getting...":"Get Code"})]})]})}),H&&le&&t.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:t.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-md w-full",children:[t.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:t.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:["Update API Token: ",le.instance_name||le.instance_id]})}),t.jsx("div",{className:"p-6",children:t.jsx("div",{className:"space-y-4",children:t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"New API Token"}),t.jsx("input",{type:"password",value:be,onChange:e=>pe(e.target.value),placeholder:"Enter new API token",className:"w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500"})]})})}),t.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 flex justify-end gap-3",children:[t.jsx("button",{onClick:()=>{V(!1),ce(null),pe("")},className:"px-4 py-2 border border-gray-300 rounded-md shadow-sm text-sm font-medium text-gray-700 bg-white hover:bg-gray-50",children:"Cancel"}),t.jsx("button",{onClick:async()=>{if(be.trim()&&le)try{y(!0),await W.updateApiToken(le.instance_id,le.api_token,be.trim(),le.green_api_host),n.success("API token updated successfully"),pe(""),ce(null),V(!1),p()}catch(e){n.error(`Failed to update API token: ${e.message}`)}finally{y(!1)}else n.error("Please enter a new API token")},disabled:f||!be.trim(),className:"px-4 py-2 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 disabled:opacity-50",children:f?"Updating...":"Update Token"})]})]})}),F&&ze&&t.jsx("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center p-4 z-50",children:t.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-5xl w-full max-h-[90vh] overflow-hidden flex flex-col",children:[t.jsx("div",{className:"relative bg-gradient-to-r from-green-500 to-green-600 px-8 py-6",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx("div",{className:"w-12 h-12 bg-white/20 rounded-xl flex items-center justify-center",children:t.jsx(I,{size:24,className:"text-white"})}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-2xl font-bold text-white",children:"Green API Settings"}),t.jsxs("p",{className:"text-green-100 mt-1",children:["Configure ",ze.instance_name||ze.instance_id]})]})]}),t.jsx("button",{onClick:()=>Q(!1),className:"p-2 text-white/80 hover:text-white hover:bg-white/20 rounded-xl transition-all duration-200",children:t.jsx(L,{size:24})})]})}),t.jsx("div",{className:"border-b border-gray-200 bg-gray-50",children:t.jsx("div",{className:"flex overflow-x-auto",children:[{id:"general",label:"General",icon:I},{id:"webhooks",label:"Webhooks",icon:P},{id:"messages",label:"Messages",icon:_},{id:"notifications",label:"Notifications",icon:_},{id:"security",label:"Security",icon:w},{id:"status",label:"Status",icon:P}].map(e=>t.jsxs("button",{onClick:()=>Ae(e.id),className:"flex items-center gap-2 px-6 py-4 text-sm font-medium whitespace-nowrap border-b-2 transition-colors "+(Ie===e.id?"border-green-500 text-green-600 bg-white":"border-transparent text-gray-500 hover:text-gray-700 hover:bg-gray-100"),children:[t.jsx(e.icon,{size:16}),e.label]},e.id))})}),t.jsxs("div",{className:"flex-1 overflow-y-auto p-8",children:[_e?t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsxs("div",{className:"text-center",children:[t.jsx(C,{className:"animate-spin mx-auto h-8 w-8 text-green-500 mb-4"}),t.jsx("p",{className:"text-gray-600",children:"Loading settings..."})]})}):t.jsxs(t.Fragment,{children:["general"===Ie&&t.jsx(o,{settings:we,setSettings:Ne}),"webhooks"===Ie&&t.jsx(l,{settings:we,setSettings:Ne}),"messages"===Ie&&t.jsx(c,{settings:we,setSettings:Ne}),"notifications"===Ie&&t.jsx(d,{settings:we,setSettings:Ne}),"security"===Ie&&t.jsx(u,{settings:we,setSettings:Ne}),"status"===Ie&&t.jsx(x,{settings:we,setSettings:Ne})]}),!_e&&t.jsxs("div",{className:"mt-8 pt-8 border-t border-gray-200",children:[t.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Instance Management"}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[t.jsxs("button",{onClick:()=>{re(ze),B(!0),Q(!1)},className:"p-4 bg-white border border-indigo-200 hover:border-indigo-300 hover:bg-indigo-50 rounded-xl transition-all duration-200 text-left",children:[t.jsxs("div",{className:"flex items-center mb-2",children:[t.jsx(j,{className:"w-5 h-5 text-indigo-600 mr-2"}),t.jsx("span",{className:"font-semibold text-indigo-800",children:"Profile Picture"})]}),t.jsx("p",{className:"text-sm text-gray-600",children:"Update profile picture"})]}),t.jsxs("button",{onClick:()=>{oe(ze),U(!0),Q(!1)},className:"p-4 bg-white border border-yellow-200 hover:border-yellow-300 hover:bg-yellow-50 rounded-xl transition-all duration-200 text-left",children:[t.jsxs("div",{className:"flex items-center mb-2",children:[t.jsx(w,{className:"w-5 h-5 text-yellow-600 mr-2"}),t.jsx("span",{className:"font-semibold text-yellow-800",children:"Auth Code"})]}),t.jsx("p",{className:"text-sm text-gray-600",children:"Get authorization code"})]}),t.jsxs("button",{onClick:()=>{Q(!1),(async e=>{if(confirm(`Are you sure you want to reboot instance ${e.instance_name||e.instance_id}?`))try{y(!0),await W.reboot(e.instance_id,e.api_token,e.green_api_host),n.success(`Instance ${e.instance_name||e.instance_id} reboot initiated`),setTimeout(()=>{p()},2e3)}catch(t){n.error(`Failed to reboot instance: ${t.message}`)}finally{y(!1)}})(ze)},className:"p-4 bg-white border border-orange-200 hover:border-orange-300 hover:bg-orange-50 rounded-xl transition-all duration-200 text-left",children:[t.jsxs("div",{className:"flex items-center mb-2",children:[t.jsx(C,{className:"w-5 h-5 text-orange-600 mr-2"}),t.jsx("span",{className:"font-semibold text-orange-800",children:"Reboot"})]}),t.jsx("p",{className:"text-sm text-gray-600",children:"Restart instance"})]})]})]})]}),t.jsxs("div",{className:"px-8 py-6 bg-gray-50 border-t border-gray-200 flex justify-end gap-4",children:[t.jsx("button",{onClick:()=>Q(!1),className:"px-6 py-3 border border-gray-300 rounded-xl text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 transition-colors",children:"Cancel"}),t.jsx("button",{onClick:async()=>{if(ze)try{Se(!0);const e=r.validateSettings(we);if(!e.isValid)return void n.error(`Invalid settings: ${e.errors.join(", ")}`);await r.setSettings(ze.instance_id,ze.api_token,we),await r.saveSettingsToDatabase(ze.instance_id,we),n.success("âœ… Settings saved successfully!"),Q(!1)}catch(e){n.error(`Failed to save settings: ${e.message}`)}finally{Se(!1)}},disabled:Ce||_e,className:"px-8 py-3 bg-gradient-to-r from-green-500 to-green-600 text-white rounded-xl font-medium hover:from-green-600 hover:to-green-700 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:Ce?t.jsxs(t.Fragment,{children:[t.jsx(C,{size:18,className:"animate-spin"}),"Saving..."]}):t.jsxs(t.Fragment,{children:[t.jsx(S,{size:18}),"Save Settings"]})})]})]})})]})};export{M as default};
