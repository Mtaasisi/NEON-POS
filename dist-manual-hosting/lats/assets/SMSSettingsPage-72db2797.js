import{_ as e}from"./supabase-7e851d02.js";import{s,j as r}from"./index-222cfb29.js";import{r as i}from"./vendor-a2ff445a.js";import{n as a}from"./ui-551a39a6.js";import"./routing-a2f0f6d2.js";const t=[{id:"mobishastra",name:"Mobishastra",apiUrl:"https://mshastra.com/sendurl.aspx",description:"Popular SMS provider in Tanzania",pricing:"~15 TZS per SMS"},{id:"sms_tanzania",name:"SMS Tanzania",apiUrl:"https://api.smstanzania.com/send",description:"Reliable SMS service for Tanzania",pricing:"~12 TZS per SMS"},{id:"bulksms",name:"BulkSMS",apiUrl:"https://api.bulksms.com/send",description:"International SMS provider",pricing:"~10 TZS per SMS"},{id:"custom",name:"Custom Provider",apiUrl:"",description:"Use your own SMS provider",pricing:"Varies"}],l=()=>{const[l,n]=i.useState([]),[d,o]=i.useState(!0),[c,m]=i.useState(!1),[u,p]=i.useState(!1),[x,g]=i.useState(""),[h,b]=i.useState({apiKey:"",apiUrl:"",price:"15"});i.useEffect(()=>{v()},[]);const v=async()=>{var e,r;try{o(!0);const{data:r,error:i}=await s.from("settings").select("*").or("key.eq.sms_provider_api_key,key.eq.sms_api_url,key.eq.sms_provider_password").order("key");if(i)return void("PGRST116"===i.code||(null==(e=i.message)?void 0:e.includes("does not exist"))||a.error("Failed to fetch SMS settings"));n(r||[]);const l=null==r?void 0:r.find(e=>"sms_provider_api_key"===e.key),d=null==r?void 0:r.find(e=>"sms_api_url"===e.key);null==r||r.find(e=>"sms_provider_password"===e.key);if(b({apiKey:(null==l?void 0:l.value)||"",apiUrl:(null==d?void 0:d.value)||"",price:"15"}),null==d?void 0:d.value){const e=t.find(e=>d.value.includes(e.apiUrl)||"custom"===e.id&&!t.some(e=>d.value.includes(e.apiUrl)));e&&g(e.id)}}catch(i){if((null==i?void 0:i.error)&&void 0!==(null==i?void 0:i.data)){const e=i.error;"PGRST116"===e.code||(null==(r=e.message)?void 0:r.includes("does not exist"))||a.error("Failed to fetch SMS settings")}}finally{o(!1)}},y=async()=>{try{const{smsService:s}=await e(()=>import("./index-222cfb29.js").then(e=>e.aU),["assets/index-222cfb29.js","assets/vendor-a2ff445a.js","assets/supabase-7e851d02.js","assets/routing-a2f0f6d2.js","assets/ui-551a39a6.js","assets/index-d3868143.css"]),r=await s.sendSMS("255700000000","Test SMS from LATS CHANCE - Configuration working!",{ai_enhanced:!1});r.success?a.success("SMS test successful! Check SMS logs for details."):a.error(`SMS test failed: ${r.error||"Unknown error"}`)}catch(s){a.error("SMS test failed. Check console for details.")}},j=e=>{var s;return(null==(s=l.find(s=>s.key===e))?void 0:s.value)||"Not configured"},S=e=>{const s=j(e);return"Not configured"===s?"❌":"sms_provider_api_key"===e&&s.length>0||"sms_api_url"===e&&s.includes("http")?"✅":"sms_price"!==e||isNaN(Number(s))?"⚠️":"✅"};return d?r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-6",children:r.jsx("div",{className:"max-w-4xl mx-auto",children:r.jsx("div",{className:"bg-white rounded-lg shadow-lg p-8",children:r.jsxs("div",{className:"animate-pulse",children:[r.jsx("div",{className:"h-8 bg-gray-200 rounded w-1/3 mb-6"}),r.jsxs("div",{className:"space-y-4",children:[r.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/2"}),r.jsx("div",{className:"h-4 bg-gray-200 rounded w-3/4"}),r.jsx("div",{className:"h-4 bg-gray-200 rounded w-1/4"})]})]})})})}):r.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-6",children:r.jsxs("div",{className:"max-w-4xl mx-auto",children:[r.jsxs("div",{className:"mb-8",children:[r.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"SMS Settings"}),r.jsx("p",{className:"text-gray-600",children:"Configure your SMS provider credentials and settings"})]}),r.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 mb-6",children:[r.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Current Configuration"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[r.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r.jsx("h3",{className:"font-medium text-gray-900",children:"API Key"}),r.jsx("span",{className:"text-2xl",children:S("sms_provider_api_key")})]}),r.jsx("p",{className:"text-sm text-gray-600",children:"Not configured"===j("sms_provider_api_key")?"Not configured":`${j("sms_provider_api_key").substring(0,10)}...`})]}),r.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r.jsx("h3",{className:"font-medium text-gray-900",children:"API URL"}),r.jsx("span",{className:"text-2xl",children:S("sms_api_url")})]}),r.jsx("p",{className:"text-sm text-gray-600 break-all",children:j("sms_api_url")})]}),r.jsxs("div",{className:"bg-gray-50 rounded-lg p-4",children:[r.jsxs("div",{className:"flex items-center justify-between mb-2",children:[r.jsx("h3",{className:"font-medium text-gray-900",children:"Price per SMS"}),r.jsx("span",{className:"text-2xl",children:S("sms_price")})]}),r.jsxs("p",{className:"text-sm text-gray-600",children:[j("sms_price")," TZS"]})]})]})]}),r.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6",children:[r.jsxs("div",{className:"flex items-center justify-between mb-6",children:[r.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:"Configure SMS Provider"}),r.jsx("button",{onClick:()=>p(!u),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:u?"Cancel":"Edit Settings"})]}),u?r.jsxs("div",{className:"space-y-6",children:[r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"SMS Provider"}),r.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:t.map(e=>r.jsxs("div",{className:"border-2 rounded-lg p-4 cursor-pointer transition-colors "+(x===e.id?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-gray-300"),onClick:()=>(e=>{g(e);const s=t.find(s=>s.id===e);s&&s.apiUrl&&b(e=>({...e,apiUrl:s.apiUrl}))})(e.id),children:[r.jsx("h3",{className:"font-medium text-gray-900",children:e.name}),r.jsx("p",{className:"text-sm text-gray-600 mt-1",children:e.description}),r.jsx("p",{className:"text-xs text-gray-500 mt-1",children:e.pricing})]},e.id))})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"API Key"}),r.jsx("input",{type:"text",value:h.apiKey,onChange:e=>b(s=>({...s,apiKey:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"Enter your SMS provider API key"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"API URL"}),r.jsx("input",{type:"url",value:h.apiUrl,onChange:e=>b(s=>({...s,apiUrl:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"https://your-sms-provider.com/api/send"})]}),r.jsxs("div",{children:[r.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Price per SMS (TZS)"}),r.jsx("input",{type:"number",value:h.price,onChange:e=>b(s=>({...s,price:e.target.value})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",placeholder:"15"})]}),r.jsxs("div",{className:"flex gap-4",children:[r.jsx("button",{onClick:async()=>{try{m(!0);const e=[{key:"sms_provider_api_key",value:h.apiKey},{key:"sms_api_url",value:h.apiUrl},{key:"sms_price",value:h.price}],{error:r}=await s.from("settings").upsert(e,{onConflict:"key"});if(r)return void a.error("Failed to save SMS settings");a.success("SMS settings saved successfully!"),p(!1),await v()}catch(e){a.error("Failed to save SMS settings")}finally{m(!1)}},disabled:c,className:"px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 disabled:opacity-50 transition-colors",children:c?"Saving...":"Save Settings"}),r.jsx("button",{onClick:y,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Test SMS"})]})]}):r.jsxs("div",{className:"text-center py-8",children:[r.jsx("p",{className:"text-gray-600 mb-4",children:'Click "Edit Settings" to configure your SMS provider'}),r.jsx("button",{onClick:y,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Test Current Configuration"})]})]}),r.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 mt-6",children:[r.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Need Help?"}),r.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[r.jsxs("div",{children:[r.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Popular SMS Providers"}),r.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[r.jsxs("li",{children:["• ",r.jsx("strong",{children:"Mobishastra:"})," https://mshastra.com/"]}),r.jsxs("li",{children:["• ",r.jsx("strong",{children:"SMS Tanzania:"})," https://smstanzania.com/"]}),r.jsxs("li",{children:["• ",r.jsx("strong",{children:"BulkSMS:"})," https://www.bulksms.com/"]})]})]}),r.jsxs("div",{children:[r.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Testing"}),r.jsxs("ul",{className:"text-sm text-gray-600 space-y-1",children:[r.jsxs("li",{children:["• Use phone number: ",r.jsx("code",{children:"255700000000"})," for testing"]}),r.jsx("li",{children:"• Test SMS will simulate success"}),r.jsx("li",{children:"• Check SMS logs for delivery status"})]})]})]})]})]})})};export{l as default};
