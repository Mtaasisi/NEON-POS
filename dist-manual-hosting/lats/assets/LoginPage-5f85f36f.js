import{u as e,j as r}from"./index-222cfb29.js";import{r as a}from"./vendor-a2ff445a.js";import{P as t}from"./PageErrorWrapper-024e3cfe.js";import{u as s}from"./useErrorHandler-ea2ee44d.js";import{M as l}from"./ModernLoadingOverlay-8a052a4d.js";import{a as o}from"./routing-a2f0f6d2.js";import{S as i,M as n,j as c,k as d}from"./ui-551a39a6.js";import"./supabase-7e851d02.js";import"./PageErrorBoundary-d0d559c5.js";import"./ErrorState-0516fc54.js";import"./CircularProgress-471d8e37.js";const g=()=>{const[g,m]=a.useState(()=>localStorage.getItem("recent_login_email")||""),[u,b]=a.useState(""),[h,p]=a.useState(!1),[x,f]=a.useState(()=>"true"===localStorage.getItem("rememberMe")),[y,j]=a.useState(()=>"dark"===localStorage.getItem("loginTheme"));a.useState(!1),a.useState(!1);const{login:w,error:v,clearError:N,isAuthenticated:S,loading:I}=e(),_=o(),{handleError:k,withErrorHandling:E}=s({maxRetries:3,showToast:!0,logToConsole:!0}),C=a.useCallback(()=>{const e=localStorage.getItem("postLoginRedirect");if(e)return localStorage.removeItem("postLoginRedirect"),e;const r=localStorage.getItem("navigationHistory");if(r)try{const e=JSON.parse(r),a=e[e.length-1];if(a&&"/login"!==a&&"/"!==a)return a;if(e.length>1){const r=e[e.length-2];if(r&&"/login"!==r&&"/"!==r)return r}}catch(a){}return"/dashboard"},[]);if(a.useEffect(()=>{localStorage.setItem("loginTheme",y?"dark":"light")},[y]),a.useEffect(()=>{(async()=>{await E(async()=>{if("true"===localStorage.getItem("rememberMe")){const e=localStorage.getItem("last_login_email")||"",r=localStorage.getItem("last_login_password")||"";e&&m(e),r&&b(r)}},"Loading saved credentials")})()},[E]),a.useEffect(()=>{if(!I&&S){const e=C();_(e,{replace:!0})}},[S,I,_,C]),I)return r.jsx(l,{message:"Checking authentication..."});if(S)return null;return r.jsxs(t,{pageName:"Login",showDetails:!1,children:[r.jsxs("div",{className:"min-h-screen h-screen w-screen flex items-center justify-center p-4 relative overflow-hidden "+(y?"bg-gray-900":"bg-gradient-to-br from-blue-50 via-white to-blue-100"),style:{backgroundImage:y?"none":"radial-gradient(circle at 20% 50%, rgba(59, 130, 246, 0.1) 0%, transparent 50%), radial-gradient(circle at 80% 20%, rgba(147, 51, 234, 0.1) 0%, transparent 50%), radial-gradient(circle at 40% 80%, rgba(16, 185, 129, 0.1) 0%, transparent 50%)"},children:[r.jsxs("div",{className:"absolute inset-0 overflow-hidden",children:[r.jsx("div",{className:"absolute top-20 left-20 w-72 h-72 bg-blue-400/20 rounded-full blur-3xl animate-pulse"}),r.jsx("div",{className:"absolute top-40 right-20 w-96 h-96 bg-purple-400/20 rounded-full blur-3xl animate-pulse",style:{animationDelay:"2s"}}),r.jsx("div",{className:"absolute -bottom-20 left-1/2 w-80 h-80 bg-indigo-400/20 rounded-full blur-3xl animate-pulse",style:{animationDelay:"4s"}})]}),r.jsx("div",{className:"fixed top-4 right-4 z-50",children:r.jsx("button",{onClick:()=>j(!y),className:"p-3 rounded-xl transition-all duration-200 shadow-lg backdrop-blur-sm "+(y?"bg-gray-800/90 text-yellow-400 hover:bg-gray-700 border border-gray-700":"bg-white/90 text-gray-700 hover:bg-white border border-gray-200"),"aria-label":"Toggle theme",children:y?r.jsx(i,{className:"h-5 w-5"}):r.jsx(n,{className:"h-5 w-5"})})}),r.jsx("div",{className:"relative w-full max-w-md",children:r.jsxs("div",{className:"relative bg-white/20 backdrop-blur-xl rounded-3xl border border-white/30 shadow-2xl p-8",children:[r.jsx("div",{className:"flex justify-center mb-6",children:r.jsx("img",{src:"/logo.svg",alt:"Dukani Pro Logo",className:"h-16 w-16 object-contain"})}),r.jsxs("div",{className:"text-center mb-8",children:[r.jsx("h1",{className:"text-2xl font-bold text-gray-800 mb-2",children:"Sign in with email"}),r.jsx("p",{className:"text-gray-600 text-sm",children:"Complete business management solution for repair shops and retail stores"})]}),r.jsxs("form",{onSubmit:async e=>{e.preventDefault(),g.trim()&&u.trim()?(await E(async()=>{p(!0),N();if(!(await w(g,u)))throw new Error("Login failed. Please check your credentials.");{localStorage.setItem("rememberMe",x.toString()),x?(localStorage.setItem("last_login_email",g),localStorage.setItem("last_login_password",u)):(localStorage.removeItem("last_login_email"),localStorage.removeItem("last_login_password")),localStorage.setItem("recent_login_email",g);const e=C();_(e)}},"Login process"),p(!1)):k(new Error("Please enter both email and password"),"Form validation")},className:"space-y-4",children:[r.jsxs("div",{className:"relative",children:[r.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:r.jsx(c,{className:"h-5 w-5 text-gray-400"})}),r.jsx("input",{id:"email",type:"email",value:g,onChange:e=>{try{m(e.target.value)}catch(r){k(r,"Email input")}},className:"w-full pl-10 pr-4 py-3 bg-gray-50 border border-gray-200 rounded-xl text-gray-900 placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",placeholder:"Email",required:!0,disabled:h,autoFocus:!0})]}),r.jsxs("div",{className:"relative",children:[r.jsx("div",{className:"absolute inset-y-0 left-0 pl-3 flex items-center pointer-events-none",children:r.jsx(d,{className:"h-5 w-5 text-gray-400"})}),r.jsx("input",{id:"password",type:"password",value:u,onChange:e=>{try{b(e.target.value)}catch(r){k(r,"Password input")}},className:"w-full pl-10 pr-4 py-3 bg-gray-50 border border-gray-200 rounded-xl text-gray-900 placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all duration-200",placeholder:"Password",required:!0,disabled:h})]}),r.jsxs("div",{className:"flex items-center justify-between",children:[r.jsxs("label",{className:"flex items-center cursor-pointer",children:[r.jsx("input",{type:"checkbox",checked:x,onChange:e=>f(e.target.checked),className:"w-4 h-4 text-blue-600 bg-gray-100 border-gray-300 rounded focus:ring-blue-500",disabled:h}),r.jsx("span",{className:"ml-2 text-sm text-gray-600",children:"Remember me"})]}),r.jsx("button",{type:"button",className:"text-sm text-blue-600 hover:text-blue-700 font-medium",onClick:()=>alert("Forgot password functionality - Contact your administrator"),children:"Forgot password?"})]}),v&&r.jsx("div",{className:"p-3 bg-red-50 border border-red-200 rounded-lg",children:r.jsx("p",{className:"text-sm text-red-600 font-medium",children:v})}),r.jsx("button",{type:"submit",disabled:h,className:"w-full bg-gray-800 text-white py-3 px-4 rounded-xl font-semibold hover:bg-gray-700 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:ring-offset-2 transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:h?r.jsxs("div",{className:"flex items-center justify-center",children:[r.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"}),"Signing in..."]}):"Get Started"})]})]})})]}),h&&r.jsx(l,{message:"Signing in..."})]})};export{g as default};
