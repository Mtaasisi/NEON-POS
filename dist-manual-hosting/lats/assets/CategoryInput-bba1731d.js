import{j as e}from"./index-222cfb29.js";import{r}from"./vendor-a2ff445a.js";import{T as t,b as s,ao as a,cq as l,cr as n}from"./ui-551a39a6.js";const o=({value:o,onChange:d,placeholder:i="Enter category name",required:c=!1,className:u="",categories:m,showSuggestions:x=!0,disabled:g=!1,error:b})=>{const[h,p]=r.useState(!1),[f,v]=r.useState([]),[y,j]=r.useState(""),[N,w]=r.useState(new Set),C=r.useRef(null),E=r.useRef(null),S=r.useMemo(()=>{const e=new Map,r=[];try{m.forEach(r=>{e.set(r.id,{...r,children:[]})}),m.forEach(t=>{const s=e.get(t.id);if(t.parentId&&e.has(t.parentId)){const r=e.get(t.parentId);r.children=r.children||[],r.children.push(s)}else r.push(s)})}catch(t){}return r},[m]),D=e=>{var r;d(e.id),j(e.name),p(!1),null==(r=C.current)||r.blur()};r.useEffect(()=>{const e=e=>{E.current&&!E.current.contains(e.target)&&C.current&&!C.current.contains(e.target)&&p(!1)};return document.addEventListener("mousedown",e),()=>document.removeEventListener("mousedown",e)},[]),r.useEffect(()=>{if(o){const e=m.find(e=>e.id===o);e&&j(e.name)}else j("")},[o,m]);const k=(r,t=0)=>{const d=r.children&&r.children.length>0,i=N.has(r.id),c=o===r.id;return e.jsxs("div",{children:[e.jsx("button",{type:"button",onClick:e=>{var t;e.preventDefault(),e.stopPropagation(),d?(t=r.id,w(e=>{const r=new Set(e);return r.has(t)?r.delete(t):r.add(t),r})):D(r)},onMouseDown:e=>{e.preventDefault(),d||D(r)},className:"w-full px-4 py-3 text-left hover:bg-gray-50 transition-colors border-b border-gray-100 last:border-b-0 focus:outline-none focus:bg-blue-50 "+(c?"bg-blue-50 border-blue-200":""),style:{paddingLeft:16+20*t+"px"},children:e.jsxs("div",{className:"flex items-center gap-3",children:[d?e.jsxs("div",{className:"flex items-center gap-2",children:[i?e.jsx(s,{className:"w-4 h-4 text-gray-500"}):e.jsx(a,{className:"w-4 h-4 text-gray-500"}),i?e.jsx(l,{className:"w-4 h-4 text-blue-500"}):e.jsx(n,{className:"w-4 h-4 text-gray-500"})]}):e.jsx("div",{className:"w-3 h-3 rounded-full border border-gray-300",style:{backgroundColor:r.color||"#3B82F6"}}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:`font-medium ${c?"text-blue-600":"text-gray-900"} flex items-center gap-2`,children:[r.icon&&e.jsx("span",{className:"text-lg",role:"img","aria-label":r.name,children:r.icon}),r.name]}),r.description&&e.jsx("div",{className:"text-sm text-gray-500 truncate",children:r.description})]}),c&&e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"})]})}),d&&i&&r.children&&e.jsx("div",{className:"border-l border-gray-200 ml-4",children:r.children.map(e=>k(e,t+1))})]},r.id)};return e.jsxs("div",{className:`relative ${u}`,children:[e.jsxs("div",{className:"relative",children:[e.jsx("input",{ref:C,type:"text",value:y,onChange:e=>(e=>{if(j(e),!x||!e.trim())return v([]),void p(!1);const r=m.filter(r=>r.name.toLowerCase().includes(e.toLowerCase()));v(r),p(r.length>0)})(e.target.value),onFocus:()=>{x&&!g&&m.length>0&&(v([]),p(!0))},className:`w-full py-3 pl-12 pr-12 bg-white/30 backdrop-blur-md border-2 rounded-lg focus:outline-none transition-colors ${b?"border-red-500 focus:border-red-600":"border-gray-300 focus:border-blue-500"} ${g?"opacity-50 cursor-not-allowed":""}`,placeholder:i,required:c,disabled:g,autoComplete:"off"}),e.jsx(t,{className:"absolute left-4 top-1/2 -translate-y-1/2 text-gray-500",size:18}),x&&e.jsx(s,{className:"absolute right-4 top-1/2 -translate-y-1/2 text-gray-500 transition-transform "+(h?"rotate-180":""),size:18})]}),b&&e.jsx("p",{className:"mt-1 text-sm text-red-600",children:b}),h&&x&&!g&&e.jsx("div",{ref:E,className:"absolute z-50 w-full mt-1 bg-white border border-gray-300 rounded-lg shadow-lg max-h-80 overflow-y-auto",children:y.trim()?f.length>0?f.map(r=>e.jsx("button",{type:"button",onClick:e=>{e.preventDefault(),e.stopPropagation(),D(r)},onMouseDown:e=>{e.preventDefault(),D(r)},className:"w-full px-4 py-3 text-left hover:bg-gray-50 transition-colors border-b border-gray-100 last:border-b-0 focus:outline-none focus:bg-blue-50 "+(o===r.id?"bg-blue-50 border-blue-200":""),children:e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-3 h-3 rounded-full border border-gray-300",style:{backgroundColor:r.color||"#3B82F6"}}),e.jsxs("div",{children:[e.jsxs("div",{className:`font-medium ${o===r.id?"text-blue-600":"text-gray-900"} flex items-center gap-2`,children:[r.icon&&e.jsx("span",{className:"text-lg",role:"img","aria-label":r.name,children:r.icon}),r.name]}),r.description&&e.jsx("div",{className:"text-sm text-gray-500 truncate",children:r.description})]}),o===r.id&&e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full"})]})},r.id)):e.jsx("div",{className:"px-4 py-3 text-gray-500 text-center",children:"No categories found"}):S.length>0?S.map(e=>k(e)):e.jsx("div",{className:"px-4 py-3 text-gray-500 text-center",children:"No categories available"})})]})};export{o as C};
