import{j as e,d as a,G as t,s}from"./index-222cfb29.js";import{r as i}from"./vendor-a2ff445a.js";import{as as l,I as r,g as n,aj as d,d as c,n as o,i as m,b7 as x,ax as p}from"./ui-551a39a6.js";import{a as u}from"./routing-a2f0f6d2.js";import"./supabase-7e851d02.js";const g=()=>{const[m,x]=i.useState(!1),[p,u]=i.useState(0);return e.jsxs(a,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(l,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Export All Products"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Download complete product catalog with all fields"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(r,{className:"w-5 h-5 text-blue-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-sm text-blue-800",children:[e.jsx("p",{className:"font-medium mb-1",children:"What's included in the export:"}),e.jsxs("ul",{className:"space-y-1 text-xs",children:[e.jsx("li",{children:"• All product details (name, description, SKU, barcode, etc.)"}),e.jsx("li",{children:"• Complete category and supplier information"}),e.jsx("li",{children:"• All variant details (price, stock, dimensions, attributes)"}),e.jsx("li",{children:"• Product status, metadata, and debut information"}),e.jsx("li",{children:"• Images and configuration settings"}),e.jsx("li",{children:"• Stock movement history and tracking"}),e.jsx("li",{children:"• One row per variant for complete data coverage"}),e.jsx("li",{children:"• All timestamps and audit information"})]})]})]})}),m&&e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Exporting products..."}),e.jsxs("span",{className:"text-gray-900 font-medium",children:[p,"%"]})]}),e.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:e.jsx("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-300",style:{width:`${p}%`}})})]}),e.jsx(t,{onClick:async()=>{x(!0),u(0);try{o.loading("Preparing product data for export...",{id:"export"}),u(20);const{data:e,error:a}=await s.from("lats_products").select("\n          *,\n          lats_categories(name, description, color),\n          lats_suppliers(name, contact_person, email, phone, address, website, notes),\n          lats_product_variants(*),\n          lats_stock_movements(\n            type,\n            quantity,\n            reason,\n            created_at\n          )\n        ").order("name");if(a)throw new Error(`Failed to fetch products: ${a.message}`);u(40),o.loading("Processing product data...",{id:"export"});const t=[];null==e||e.forEach(e=>{const a=e.lats_categories,s=e.lats_suppliers,i=e.lats_product_variants||[],l=e.lats_stock_movements||[],r=(i.length>0&&i.reduce((e,a)=>(a.quantity||0)>(e.quantity||0)?a:e),i.reduce((e,a)=>e+(a.selling_price||0)*(a.quantity||0),0)),n=l.length>0?l.reduce((e,a)=>new Date(a.created_at)>new Date(e.created_at)?a:e):null;0===i.length?t.push({id:e.id,name:e.name,description:e.description,shortDescription:e.short_description,sku:e.sku,barcode:e.barcode,categoryId:e.category_id,supplierId:e.supplier_id,images:e.images||[],isActive:e.is_active,totalQuantity:e.total_quantity||0,totalValue:e.total_value||0,condition:e.condition,debutDate:e.debut_date,debutNotes:e.debut_notes,debutFeatures:e.debut_features,metadata:e.metadata,createdAt:e.created_at,updatedAt:e.updated_at,categoryName:(null==a?void 0:a.name)||"Uncategorized",supplierName:(null==s?void 0:s.name)||"No Supplier",allVariants:[],variantId:"",variantSku:"",variantName:"",variantBarcode:"",costPrice:0,sellingPrice:0,quantity:0,minQuantity:0,maxQuantity:0,dimensions:"",variantCount:0,totalVariantsValue:0,lastStockMovement:n?{movement_type:n.movement_type,quantity:n.quantity,reason:n.reason,date:n.created_at}:void 0,category:a,supplier:s}):i.forEach(l=>{t.push({id:e.id,name:e.name,description:e.description,shortDescription:e.short_description,sku:e.sku,barcode:e.barcode,categoryId:e.category_id,supplierId:e.supplier_id,images:e.images||[],isActive:e.is_active,totalQuantity:e.total_quantity||0,totalValue:e.total_value||0,condition:e.condition,debutDate:e.debut_date,debutNotes:e.debut_notes,debutFeatures:e.debut_features,metadata:e.metadata,createdAt:e.created_at,updatedAt:e.updated_at,categoryName:(null==a?void 0:a.name)||"Uncategorized",supplierName:(null==s?void 0:s.name)||"No Supplier",allVariants:i.map(e=>({id:e.id,sku:e.sku,name:e.name,barcode:e.barcode,attributes:e.attributes,costPrice:e.cost_price,sellingPrice:e.selling_price,quantity:e.quantity,minQuantity:e.min_quantity,maxQuantity:null,dimensions:e.dimensions,createdAt:e.created_at,updatedAt:e.updated_at})),variantId:l.id,variantSku:l.sku,variantName:l.name,variantBarcode:l.barcode,costPrice:l.cost_price,sellingPrice:l.selling_price,quantity:l.quantity,minQuantity:l.min_quantity,maxQuantity:null,dimensions:l.dimensions?`${l.dimensions.length||0}L x ${l.dimensions.width||0}W x ${l.dimensions.height||0}H`:"",variantCount:i.length,totalVariantsValue:r,lastStockMovement:n?{movement_type:n.movement_type,quantity:n.quantity,reason:n.reason,date:n.created_at}:void 0,category:a,supplier:s})})}),u(60),o.loading("Generating Excel file...",{id:"export"});const i=[["Product ID","Product Name","Description","Short Description","SKU","Barcode","Category ID","Category Name","Category Description","Category Color","Supplier ID","Supplier Name","Supplier Contact Person","Supplier Email","Supplier Phone","Supplier Address","Supplier Website","Supplier Notes","Images","Active","Tax Rate (%)","Total Quantity","Total Value","Condition","Store Shelf","Debut Date","Debut Notes","Debut Features","Metadata","Variant ID","Variant SKU","Variant Name","Variant Barcode","Cost Price","Selling Price","Quantity","Min Quantity","Max Quantity","Dimensions (LxWxH)","Variant Attributes","All Variants Count","All Variants Data","Variant Count","Total Variants Value","Created Date","Updated Date","Last Stock Movement Type","Last Stock Movement Quantity","Last Stock Movement Reason","Last Stock Movement Date"].join(","),...t.map(e=>{var a,t,s,i,l,r,n,d,c,o,m,x,p,u,g;return[`"${e.id}"`,`"${(e.name||"").replace(/"/g,'""')}"`,`"${(e.description||"").replace(/"/g,'""')}"`,`"${(e.shortDescription||"").replace(/"/g,'""')}"`,`"${(e.sku||"").replace(/"/g,'""')}"`,`"${(e.barcode||"").replace(/"/g,'""')}"`,`"${(e.categoryId||"").replace(/"/g,'""')}"`,`"${(e.categoryName||"").replace(/"/g,'""')}"`,`"${((null==(a=e.category)?void 0:a.description)||"").replace(/"/g,'""')}"`,`"${((null==(t=e.category)?void 0:t.color)||"").replace(/"/g,'""')}"`,`"${(e.supplierId||"").replace(/"/g,'""')}"`,`"${(e.supplierName||"").replace(/"/g,'""')}"`,`"${((null==(s=e.supplier)?void 0:s.contact_person)||"").replace(/"/g,'""')}"`,`"${((null==(i=e.supplier)?void 0:i.email)||"").replace(/"/g,'""')}"`,`"${((null==(l=e.supplier)?void 0:l.phone)||"").replace(/"/g,'""')}"`,`"${((null==(r=e.supplier)?void 0:r.address)||"").replace(/"/g,'""')}"`,`"${((null==(n=e.supplier)?void 0:n.website)||"").replace(/"/g,'""')}"`,`"${((null==(d=e.supplier)?void 0:d.notes)||"").replace(/"/g,'""')}"`,`"${(e.images||[]).join(", ").replace(/"/g,'""')}"`,e.isActive?"Yes":"No",e.totalQuantity,e.totalValue,`"${(e.condition||"").replace(/"/g,'""')}"`,`"${(e.debutDate||"").replace(/"/g,'""')}"`,`"${(e.debutNotes||"").replace(/"/g,'""')}"`,`"${(e.debutFeatures||[]).join(", ").replace(/"/g,'""')}"`,`"${JSON.stringify(e.metadata||{}).replace(/"/g,'""')}"`,`"${(e.variantId||"").replace(/"/g,'""')}"`,`"${(e.variantSku||"").replace(/"/g,'""')}"`,`"${(e.variantName||"").replace(/"/g,'""')}"`,`"${(e.variantBarcode||"").replace(/"/g,'""')}"`,e.costPrice||0,e.sellingPrice||0,e.quantity||0,e.minQuantity||0,e.maxQuantity||0,`"${(e.dimensions||"").replace(/"/g,'""')}"`,`"${JSON.stringify((null==(o=null==(c=e.allVariants)?void 0:c.find(a=>a.id===e.variantId))?void 0:o.attributes)||{}).replace(/"/g,'""')}"`,(null==(m=e.allVariants)?void 0:m.length)||0,`"${JSON.stringify(e.allVariants||[]).replace(/"/g,'""')}"`,e.variantCount||0,e.totalVariantsValue||0,`"${new Date(e.createdAt).toLocaleDateString()}"`,`"${new Date(e.updatedAt).toLocaleDateString()}"`,`"${((null==(x=e.lastStockMovement)?void 0:x.movement_type)||"").replace(/"/g,'""')}"`,(null==(p=e.lastStockMovement)?void 0:p.quantity)||0,`"${((null==(u=e.lastStockMovement)?void 0:u.reason)||"").replace(/"/g,'""')}"`,`"${((null==(g=e.lastStockMovement)?void 0:g.date)||"").replace(/"/g,'""')}"`].join(",")})];u(80),o.loading("Downloading file...",{id:"export"});const l="\ufeff"+i.join("\n"),r=new Blob([l],{type:"text/csv;charset=utf-8;"}),n=window.URL.createObjectURL(r),d=document.createElement("a");d.href=n,d.download=`lats_products_export_${(new Date).toISOString().split("T")[0]}.csv`,document.body.appendChild(d),d.click(),document.body.removeChild(d),window.URL.revokeObjectURL(n),u(100),o.success(`✅ Successfully exported ${t.length} products!`,{id:"export"})}catch(e){o.error(`❌ Export failed: ${e.message}`,{id:"export"})}finally{x(!1),u(0)}},disabled:m,className:"w-full bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-4 rounded-lg transition-all duration-200 disabled:opacity-50 disabled:cursor-not-allowed",children:m?e.jsxs(e.Fragment,{children:[e.jsx(n,{className:"w-4 h-4 mr-2 animate-spin"}),"Exporting..."]}):e.jsxs(e.Fragment,{children:[e.jsx(d,{className:"w-4 h-4 mr-2"}),"Export All Products to Excel"]})}),e.jsx("div",{className:"bg-gray-50 border border-gray-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(c,{className:"w-4 h-4 text-green-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{className:"text-xs text-gray-600",children:[e.jsx("p",{className:"font-medium mb-1",children:"Export Tips:"}),e.jsxs("ul",{className:"space-y-1",children:[e.jsx("li",{children:"• File will be saved as CSV (compatible with Excel)"}),e.jsx("li",{children:"• Large exports may take a few moments"}),e.jsx("li",{children:"• All special characters are properly escaped"}),e.jsx("li",{children:"• Dates are formatted for easy reading"}),e.jsx("li",{children:"• One row per variant for complete data coverage"}),e.jsx("li",{children:"• JSON data (attributes, metadata) is preserved"}),e.jsx("li",{children:"• Stock movement history is included"}),e.jsx("li",{children:"• All relationships and foreign keys are resolved"})]})]})]})})]})]})},h=()=>{const s=u();return e.jsxs("div",{className:"p-4 sm:p-6 max-w-6xl mx-auto",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsxs(t,{onClick:()=>s("/dashboard"),className:"flex items-center gap-2",children:[e.jsx(m,{size:20}),"Back to Dashboard"]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Product Export Center"}),e.jsx("p",{className:"text-gray-600",children:"Export your complete product catalog with all data"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsxs(a,{className:"p-4 text-center",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-100 rounded-lg flex items-center justify-center mx-auto mb-3",children:e.jsx(x,{className:"w-6 h-6 text-blue-600"})}),e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:"Complete Data"}),e.jsx("div",{className:"text-sm text-gray-600",children:"All product fields included"})]}),e.jsxs(a,{className:"p-4 text-center",children:[e.jsx("div",{className:"w-12 h-12 bg-green-100 rounded-lg flex items-center justify-center mx-auto mb-3",children:e.jsx(l,{className:"w-6 h-6 text-green-600"})}),e.jsx("div",{className:"text-2xl font-bold text-green-600",children:"Excel Ready"}),e.jsx("div",{className:"text-sm text-gray-600",children:"CSV format for Excel"})]}),e.jsxs(a,{className:"p-4 text-center",children:[e.jsx("div",{className:"w-12 h-12 bg-purple-100 rounded-lg flex items-center justify-center mx-auto mb-3",children:e.jsx(p,{className:"w-6 h-6 text-purple-600"})}),e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:"Analytics Ready"}),e.jsx("div",{className:"text-sm text-gray-600",children:"Perfect for analysis"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsx(g,{})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs(a,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 bg-orange-100 rounded-lg flex items-center justify-center",children:e.jsx(d,{className:"w-5 h-5 text-orange-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Export Features"}),e.jsx("p",{className:"text-sm text-gray-600",children:"What you'll get"})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-2 h-2 bg-blue-500 rounded-full mt-2 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Product Information"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Name, description, SKU, tags"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full mt-2 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Relationships"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Category, brand, supplier names"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-2 h-2 bg-purple-500 rounded-full mt-2 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Variant Data"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Prices, stock levels, dimensions"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-2 h-2 bg-orange-500 rounded-full mt-2 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Metadata"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Status, dates, conditions"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-2 h-2 bg-red-500 rounded-full mt-2 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:"Calculations"}),e.jsx("p",{className:"text-xs text-gray-600",children:"Total quantities and values"})]})]})]})]}),e.jsxs(a,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 bg-indigo-100 rounded-lg flex items-center justify-center",children:e.jsx(l,{className:"w-5 h-5 text-indigo-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"File Format"}),e.jsx("p",{className:"text-sm text-gray-600",children:"CSV with Excel compatibility"})]})]}),e.jsxs("div",{className:"space-y-3 text-sm",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"File Type:"}),e.jsx("span",{className:"font-medium",children:"CSV (Comma Separated Values)"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Excel Compatible:"}),e.jsx("span",{className:"font-medium text-green-600",children:"Yes"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Encoding:"}),e.jsx("span",{className:"font-medium",children:"UTF-8 with BOM"})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Special Characters:"}),e.jsx("span",{className:"font-medium text-green-600",children:"Properly Escaped"})]})]})]}),e.jsxs(a,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-10 h-10 bg-teal-100 rounded-lg flex items-center justify-center",children:e.jsx(p,{className:"w-5 h-5 text-teal-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Use Cases"}),e.jsx("p",{className:"text-sm text-gray-600",children:"What you can do with the data"})]})]}),e.jsxs("div",{className:"space-y-2 text-sm",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-1.5 h-1.5 bg-teal-500 rounded-full"}),e.jsx("span",{className:"text-gray-700",children:"Inventory analysis and reporting"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-1.5 h-1.5 bg-teal-500 rounded-full"}),e.jsx("span",{className:"text-gray-700",children:"Price optimization studies"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-1.5 h-1.5 bg-teal-500 rounded-full"}),e.jsx("span",{className:"text-gray-700",children:"Stock level monitoring"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-1.5 h-1.5 bg-teal-500 rounded-full"}),e.jsx("span",{className:"text-gray-700",children:"Supplier performance analysis"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-1.5 h-1.5 bg-teal-500 rounded-full"}),e.jsx("span",{className:"text-gray-700",children:"Category performance review"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-1.5 h-1.5 bg-teal-500 rounded-full"}),e.jsx("span",{className:"text-gray-700",children:"Data backup and migration"})]})]})]})]})]})]})};export{h as default};
