import{u as e,c as s,j as t,G as a,d as r}from"./index-222cfb29.js";import{r as l}from"./vendor-a2ff445a.js";import{B as i}from"./BackButton-e41d1482.js";import{t as n,Q as c,d,aP as o,cm as x,y as m,ab as p,x as h,R as u,U as g,P as j,j as N,v,r as y,$ as f,n as b}from"./ui-551a39a6.js";import{A as w}from"./AddSupplierModal-247b2b34.js";import{u as S,S as C}from"./useSuccessModal-e8b7d685.js";import{a as A}from"./routing-a2f0f6d2.js";import"./supabase-7e851d02.js";import"./purchaseOrderUtils-e0e1d78b.js";import"./GlassInput-ba5c3c0d.js";import"./utils-fb833cf6.js";import"./charts-66cc82bb.js";import"./useBodyScrollLock-0216d39f.js";const k=()=>{const k=A(),{currentUser:L}=e(),E=S(),{suppliers:T,isLoading:M,error:P,loadSuppliers:B,createSupplier:_,updateSupplier:I,deleteSupplier:O}=s(),[R,D]=l.useState(""),[F,U]=l.useState(""),[z,G]=l.useState("all"),[Q,V]=l.useState(!1);l.useState([]);const[$,K]=l.useState(12),[q,H]=l.useState("grid"),J=l.useRef(null),[W,X]=l.useState(!1),[Y,Z]=l.useState(!1),[ee,se]=l.useState(null);l.useEffect(()=>{B()},[B]),l.useEffect(()=>{K(12)},[R,F,z]),l.useEffect(()=>{const e=new IntersectionObserver(e=>{e[0].isIntersecting&&le&&!M&&K(e=>e+12)},{threshold:.1}),s=J.current;return s&&e.observe(s),()=>{s&&e.unobserve(s)}},[le,M]);const te=l.useMemo(()=>[...new Set(T.map(e=>e.country).filter(Boolean))].sort(),[T]),ae=l.useMemo(()=>{let e=T;if(R.trim()){const s=R.toLowerCase();e=e.filter(e=>{var t,a,r;return e.name.toLowerCase().includes(s)||(null==(t=e.company_name)?void 0:t.toLowerCase().includes(s))||(null==(a=e.contactPerson)?void 0:a.toLowerCase().includes(s))||(null==(r=e.email)?void 0:r.toLowerCase().includes(s))})}return F&&(e=e.filter(e=>e.country===F)),"all"!==z&&(e=e.filter(e=>"active"===z?e.isActive:!e.isActive)),e},[T,R,F,z]),re=ae.slice(0,$),le=$<ae.length,ie=e=>{se(e),Z(!0)},ne=async e=>{if(confirm("⚠️ PERMANENT DELETE: Are you sure you want to permanently delete this supplier from the database? This action CANNOT be undone!")){const s=await O(e);s.ok?b.success("Supplier permanently deleted from database"):b.error(s.message||"Failed to delete supplier")}};return L?t.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-green-50 to-emerald-100",children:[t.jsx("div",{className:"bg-white border-b border-gray-200 shadow-sm",children:t.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:t.jsxs("div",{className:"flex items-center justify-between h-16",children:[t.jsxs("div",{className:"flex items-center gap-4",children:[t.jsx(i,{onClick:()=>k("/lats/purchase-orders")}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"p-2 bg-green-50 rounded-lg",children:t.jsx(n,{className:"w-6 h-6 text-green-600"})}),t.jsxs("div",{children:[t.jsx("h1",{className:"text-xl font-semibold text-gray-900",children:"Suppliers Management"}),t.jsx("p",{className:"text-sm text-gray-600",children:"Manage your supplier network"})]})]})]}),t.jsx("div",{className:"flex items-center gap-3",children:t.jsx(a,{onClick:()=>X(!0),icon:t.jsx(c,{size:18}),className:"bg-gradient-to-r from-green-500 to-emerald-600 text-white",children:"Add Supplier"})})]})})}),t.jsxs("div",{className:"max-w-7xl mx-auto p-4 sm:p-6 space-y-6",children:[t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[t.jsx(r,{className:"p-4",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"p-2 bg-green-50 rounded-lg",children:t.jsx(n,{className:"w-5 h-5 text-green-600"})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600",children:"Total Suppliers"}),t.jsx("p",{className:"text-xl font-semibold text-gray-900",children:T.length})]})]})}),t.jsx(r,{className:"p-4",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"p-2 bg-blue-50 rounded-lg",children:t.jsx(d,{className:"w-5 h-5 text-blue-600"})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600",children:"Active"}),t.jsx("p",{className:"text-xl font-semibold text-gray-900",children:T.filter(e=>e.isActive).length})]})]})}),t.jsx(r,{className:"p-4",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"p-2 bg-purple-50 rounded-lg",children:t.jsx(o,{className:"w-5 h-5 text-purple-600"})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600",children:"Countries"}),t.jsx("p",{className:"text-xl font-semibold text-gray-900",children:te.length})]})]})}),t.jsx(r,{className:"p-4",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"p-2 bg-orange-50 rounded-lg",children:t.jsx(x,{className:"w-5 h-5 text-orange-600"})}),t.jsxs("div",{children:[t.jsx("p",{className:"text-sm text-gray-600",children:"Currencies"}),t.jsx("p",{className:"text-xl font-semibold text-gray-900",children:[...new Set(T.map(e=>e.currency).filter(Boolean))].length})]})]})})]}),t.jsxs(r,{className:"p-6",children:[t.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-center justify-between",children:[t.jsx("div",{className:"flex-1 max-w-md",children:t.jsxs("div",{className:"relative",children:[t.jsx(m,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),t.jsx("input",{type:"text",placeholder:"Search suppliers...",value:R,onChange:e=>D(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"})]})}),t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsxs("button",{onClick:()=>V(!Q),className:"flex items-center gap-2 px-3 py-2 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-lg transition-colors",children:[t.jsx(p,{className:"w-4 h-4"}),"Filters"]}),t.jsxs("div",{className:"flex items-center bg-gray-100 rounded-lg p-1",children:[t.jsx("button",{onClick:()=>H("grid"),className:"p-2 rounded-md transition-colors "+("grid"===q?"bg-white text-green-600 shadow-sm":"text-gray-600"),children:t.jsx(h,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>H("list"),className:"p-2 rounded-md transition-colors "+("list"===q?"bg-white text-green-600 shadow-sm":"text-gray-600"),children:t.jsx(n,{className:"w-4 h-4"})})]})]})]}),Q&&t.jsx("div",{className:"mt-4 p-4 bg-gray-50 rounded-lg border border-gray-200",children:t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),t.jsxs("select",{value:z,onChange:e=>G(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500",children:[t.jsx("option",{value:"all",children:"All Status"}),t.jsx("option",{value:"active",children:"Active"}),t.jsx("option",{value:"inactive",children:"Inactive"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Country"}),t.jsxs("select",{value:F,onChange:e=>U(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500",children:[t.jsx("option",{value:"",children:"All Countries"}),te.map(e=>t.jsx("option",{value:e,children:e},e))]})]}),t.jsx("div",{className:"flex items-end",children:t.jsx("button",{onClick:()=>{D(""),U(""),G("all")},className:"w-full px-4 py-2 text-sm text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-lg transition-colors",children:"Clear Filters"})})]})})]}),t.jsxs(r,{className:"overflow-hidden",children:[M?t.jsxs("div",{className:"flex items-center justify-center py-12",children:[t.jsx(u,{className:"w-8 h-8 animate-spin text-green-500"}),t.jsx("span",{className:"ml-3 text-gray-600",children:"Loading suppliers..."})]}):0===ae.length?t.jsxs("div",{className:"text-center py-12",children:[t.jsx(n,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),t.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No suppliers found"}),t.jsx("p",{className:"text-gray-600 mb-6",children:R||F||"all"!==z?"No suppliers match your current filters":"Add your first supplier to get started"}),t.jsx(a,{onClick:()=>X(!0),icon:t.jsx(c,{size:20}),className:"bg-gradient-to-r from-green-500 to-emerald-600 text-white",children:"Add Supplier"})]}):"grid"===q?t.jsx("div",{className:"p-6",children:t.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:re.map(e=>t.jsxs("div",{className:"border border-gray-200 rounded-xl p-6 bg-white hover:shadow-lg transition-all duration-200",children:[t.jsx("div",{className:"flex items-start justify-between mb-4",children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-12 h-12 bg-gradient-to-br from-green-500 to-emerald-600 rounded-full flex items-center justify-center text-white font-bold text-lg",children:e.name.charAt(0)}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-semibold text-gray-900",children:e.name}),e.company_name&&t.jsx("p",{className:"text-sm text-gray-600",children:e.company_name})]})]})}),t.jsxs("div",{className:"space-y-2 mb-4",children:[e.contactPerson&&t.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[t.jsx(g,{className:"w-4 h-4"}),e.contactPerson]}),e.phone&&t.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[t.jsx(j,{className:"w-4 h-4"}),e.phone]}),e.email&&t.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[t.jsx(N,{className:"w-4 h-4"}),e.email]}),e.country&&t.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[t.jsx(v,{className:"w-4 h-4"}),e.country]})]}),t.jsxs("div",{className:"flex items-center justify-between pt-4 border-t border-gray-200",children:[t.jsxs("div",{className:"flex items-center gap-2",children:[e.currency&&t.jsx("span",{className:"px-2 py-1 bg-blue-50 text-blue-700 text-xs rounded-full",children:e.currency}),e.paymentTerms&&t.jsx("span",{className:"px-2 py-1 bg-purple-50 text-purple-700 text-xs rounded-full",children:e.paymentTerms})]}),t.jsxs("div",{className:"flex items-center gap-1",children:[t.jsx("button",{onClick:()=>ie(e),className:"p-2 text-blue-600 hover:text-blue-800 hover:bg-blue-50 rounded-lg transition-colors",title:"Edit supplier",children:t.jsx(y,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>ne(e.id),className:"p-2 text-red-600 hover:text-red-800 hover:bg-red-50 rounded-lg transition-colors",title:"Delete supplier",children:t.jsx(f,{className:"w-4 h-4"})})]})]})]},e.id))})}):t.jsxs("div",{children:[t.jsx("div",{className:"bg-gray-50 px-6 py-3 border-b border-gray-200",children:t.jsxs("div",{className:"grid grid-cols-5 gap-4",children:[t.jsx("div",{className:"font-medium text-gray-700",children:"Supplier"}),t.jsx("div",{className:"font-medium text-gray-700",children:"Contact"}),t.jsx("div",{className:"font-medium text-gray-700",children:"Location"}),t.jsx("div",{className:"font-medium text-gray-700",children:"Terms"}),t.jsx("div",{className:"font-medium text-gray-700",children:"Actions"})]})}),t.jsx("div",{className:"divide-y divide-gray-200",children:re.map(e=>t.jsx("div",{className:"px-6 py-4 hover:bg-gray-50 transition-colors",children:t.jsxs("div",{className:"grid grid-cols-5 gap-4 items-center",children:[t.jsx("div",{children:t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-green-500 to-emerald-600 rounded-full flex items-center justify-center text-white font-bold",children:e.name.charAt(0)}),t.jsxs("div",{children:[t.jsx("div",{className:"font-medium text-gray-900",children:e.name}),e.company_name&&t.jsx("div",{className:"text-sm text-gray-600",children:e.company_name})]})]})}),t.jsx("div",{children:t.jsxs("div",{className:"space-y-1",children:[e.contactPerson&&t.jsx("div",{className:"text-sm text-gray-900",children:e.contactPerson}),e.phone&&t.jsx("div",{className:"text-sm text-gray-600",children:e.phone})]})}),t.jsx("div",{children:e.country&&t.jsx("span",{className:"text-sm text-gray-900",children:e.country})}),t.jsx("div",{children:t.jsxs("div",{className:"space-y-1",children:[e.currency&&t.jsx("span",{className:"inline-block px-2 py-1 bg-blue-50 text-blue-700 text-xs rounded-full",children:e.currency}),e.paymentTerms&&t.jsx("div",{className:"text-xs text-gray-600",children:e.paymentTerms})]})}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("button",{onClick:()=>ie(e),className:"p-1 text-blue-600 hover:text-blue-800 hover:bg-blue-50 rounded",title:"Edit",children:t.jsx(y,{className:"w-4 h-4"})}),t.jsx("button",{onClick:()=>ne(e.id),className:"p-1 text-red-600 hover:text-red-800 hover:bg-red-50 rounded",title:"Delete",children:t.jsx(f,{className:"w-4 h-4"})})]})]})},e.id))})]}),ae.length>0&&t.jsx("div",{className:"px-6 py-4 bg-gray-50 border-t border-gray-200",children:t.jsxs("div",{className:"text-center",children:[t.jsxs("div",{className:"text-sm text-gray-600 mb-2",children:["Showing ",re.length," of ",ae.length," suppliers"]}),t.jsxs("div",{ref:J,className:"py-2",children:[le&&!M&&t.jsxs("div",{className:"flex items-center justify-center gap-2 text-blue-600",children:[t.jsx(u,{className:"w-4 h-4 animate-spin"}),t.jsx("span",{className:"text-sm",children:"Loading more suppliers..."})]}),!le&&re.length>0&&t.jsx("div",{className:"text-gray-500 text-sm",children:"✓ All suppliers loaded"})]})]})})]})]}),W&&t.jsx(w,{isOpen:W,onClose:()=>X(!1),onSupplierCreated:e=>{X(!1),B(),E.show(`Supplier "${e.name}" has been added successfully!`,{title:"Supplier Added",actionButtons:[{label:"View Suppliers",onClick:()=>{},variant:"primary"},{label:"Add Another",onClick:()=>X(!0),variant:"secondary"}]})}}),t.jsx(C,{...E.props})]}):null};export{k as default};
