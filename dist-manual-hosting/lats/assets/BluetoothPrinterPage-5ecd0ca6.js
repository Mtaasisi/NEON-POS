import{j as e,d as s,G as t}from"./index-222cfb29.js";import{r}from"./vendor-a2ff445a.js";import{u as l}from"./useBluetoothPrinter-08dc31b9.js";import{cc as a,R as i,d as n,h as c,aa as d,W as o,e as m,a8 as x,N as u,aQ as h,Z as p,i as b}from"./ui-551a39a6.js";import{a as g}from"./routing-a2f0f6d2.js";import"./supabase-7e851d02.js";const j=({className:b="",onPrinterConnected:g,onPrinterDisconnected:j})=>{var f;const{isInitialized:N,isConnected:y,isConnecting:v,isPrinting:w,connectedDevice:C,availableDevices:P,settings:S,error:k,initialize:T,requestDevice:D,connect:L,disconnect:z,print:B,printReceipt:E,printLabel:I,updateSettings:R,clearError:A}=l(),[U,H]=r.useState(!1),[W,Z]=r.useState(!1),[M,$]=r.useState("Test Print\nHello from LATS CHANCE!\n\nDate: "+(new Date).toLocaleString()),[O,X]=r.useState({title:"Test Product",barcode:"123456789",qrCode:"https://latschance.com",text:"Sample product description",price:"TZS 5,000",sku:"SKU-001",size:"M",color:"Blue"});return N?e.jsxs("div",{className:`space-y-4 ${b}`,children:[e.jsx(s,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-full "+(y?"bg-green-100":"bg-gray-100"),children:y?e.jsx(n,{className:"w-5 h-5 text-green-600"}):e.jsx(c,{className:"w-5 h-5 text-gray-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:"Bluetooth Printer"}),e.jsx("p",{className:"text-sm text-gray-600",children:y?`Connected to ${(null==C?void 0:C.name)||"Unknown Printer"}`:"Not connected"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(t,{onClick:()=>H(!U),variant:"ghost",size:"sm",children:e.jsx(d,{className:"w-4 h-4"})}),y?e.jsxs(t,{onClick:async()=>{await z(),j&&j()},variant:"secondary",size:"sm",disabled:v,children:[e.jsx(o,{className:"w-4 h-4 mr-1"}),"Disconnect"]}):e.jsxs(t,{onClick:D,variant:"primary",size:"sm",disabled:v,children:[e.jsx(a,{className:"w-4 h-4 mr-1"}),v?"Connecting...":"Connect"]})]})]})}),k&&e.jsx(s,{className:"p-4 border-l-4 border-red-500 bg-red-50",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(m,{className:"w-5 h-5 text-red-500 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm text-red-700",children:k}),e.jsx(t,{onClick:A,variant:"ghost",size:"sm",className:"mt-2",children:"Dismiss"})]})]})}),P.length>0&&!y&&e.jsxs(s,{className:"p-4",children:[e.jsx("h4",{className:"font-semibold mb-3",children:"Available Printers"}),e.jsx("div",{className:"space-y-2",children:P.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 border border-gray-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(x,{className:"w-5 h-5 text-blue-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.name}),e.jsx("p",{className:"text-sm text-gray-600",children:s.address})]})]}),e.jsx(t,{onClick:()=>(async e=>{await L(e)&&g&&g(e)})(s.id),variant:"primary",size:"sm",disabled:v,children:"Connect"})]},s.id))})]}),U&&e.jsxs(s,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"font-semibold",children:"Printer Settings"}),e.jsxs(t,{onClick:()=>{H(!1)},variant:"primary",size:"sm",children:[e.jsx(u,{className:"w-4 h-4 mr-1"}),"Save"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Paper Width (mm)"}),e.jsxs("select",{value:S.paperWidth,onChange:e=>R({paperWidth:Number(e.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:50,children:"50mm (Label)"}),e.jsx("option",{value:58,children:"58mm (Narrow)"}),e.jsx("option",{value:80,children:"80mm (Standard)"}),e.jsx("option",{value:112,children:"112mm (Wide)"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Print Copies"}),e.jsx("input",{type:"number",min:"1",max:"10",value:S.printCopies,onChange:e=>R({printCopies:Number(e.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Label Height (mm)"}),e.jsx("input",{type:"number",min:"10",max:"100",value:S.labelHeight,onChange:e=>R({labelHeight:Number(e.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"DPI (Dots Per Inch)"}),e.jsxs("select",{value:S.dpi,onChange:e=>R({dpi:Number(e.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:203,children:"203 DPI (Standard)"}),e.jsx("option",{value:300,children:"300 DPI (High Quality)"}),e.jsx("option",{value:600,children:"600 DPI (Ultra High)"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Default Print Type"}),e.jsxs("select",{value:S.defaultPrintType,onChange:e=>R({defaultPrintType:e.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"receipt",children:"Receipt"}),e.jsx("option",{value:"label",children:"Label"})]}),(null==(f=null==C?void 0:C.name)?void 0:f.toLowerCase().includes("xp-p301a"))&&e.jsx("p",{className:"text-xs text-blue-600 mt-1",children:"XP-P301A supports both receipt and label printing modes"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Auto-Connect"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:S.autoConnect,onChange:e=>R({autoConnect:e.target.checked}),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),e.jsx("span",{className:"ml-2 text-sm text-gray-600",children:"Automatically reconnect when available"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Connection Timeout (ms)"}),e.jsx("input",{type:"number",min:"1000",max:"30000",step:"1000",value:S.connectionTimeout,onChange:e=>R({connectionTimeout:Number(e.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]})]}),y&&e.jsxs(s,{className:"p-4",children:[e.jsxs("h4",{className:"font-semibold mb-3 flex items-center gap-2",children:[e.jsx(h,{className:"w-5 h-5"}),"Test Print"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Test Content"}),e.jsx("textarea",{value:M,onChange:e=>$(e.target.value),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter test content to print..."})]}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsxs(t,{onClick:async()=>{try{if(!y)return void alert("Please connect to a printer first");const e="TEST PRINT\nHello World!\nDate: "+(new Date).toLocaleString()+"\n\n\n\n\n";await B({content:e,copies:1}),alert("Test print sent successfully!")}catch(e){alert(`Test print failed: ${e.message}`)}},variant:"primary",disabled:w,className:"flex-1 min-w-[120px]",children:[e.jsx(x,{className:"w-4 h-4 mr-2"}),w?"Printing...":"Test Print"]}),e.jsxs(t,{onClick:async()=>{try{if(!y)return void alert("Please connect to a printer first");await E({header:"LATS CHANCE STORE",items:[{name:"Test Product 1",quantity:2,price:1e3,total:2e3},{name:"Test Product 2",quantity:1,price:1500,total:1500}],subtotal:3500,tax:630,discount:0,total:4130,paymentMethod:"Cash",cashier:"Test User",footer:"Thank you for your purchase!"})}catch(e){alert(`Test receipt print failed: ${e.message}`)}},variant:"secondary",disabled:w,className:"flex-1 min-w-[120px]",children:[e.jsx(x,{className:"w-4 h-4 mr-2"}),"Test Receipt"]}),e.jsxs(t,{onClick:async()=>{try{if(!y)return void alert("Please connect to a printer first");const e="RAW TEST\nSimple text\nNo commands\n\n\n\n\n";await B({content:e,copies:1}),alert("Raw test print sent successfully!")}catch(e){alert(`Raw test print failed: ${e.message}`)}},variant:"outline",disabled:w,className:"flex-1 min-w-[120px]",children:[e.jsx(h,{className:"w-4 h-4 mr-2"}),"Raw Test"]}),e.jsxs(t,{onClick:async()=>{try{if(!y)return void alert("Please connect to a printer first");const e="ULTRA SIMPLE\nJust text\nNo commands\nNo formatting\n\n\n\n\n";if(bluetoothPrinterService.characteristic){const s=(new TextEncoder).encode(e);await bluetoothPrinterService.characteristic.writeValue(s),alert("Ultra simple test sent directly!")}else alert("No characteristic available")}catch(e){alert(`Ultra simple test failed: ${e.message}`)}},variant:"outline",disabled:w,className:"flex-1 min-w-[120px]",children:[e.jsx(p,{className:"w-4 h-4 mr-2"}),"Ultra Simple"]})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h5",{className:"font-medium text-gray-900",children:"Label Printing"}),e.jsxs(t,{onClick:()=>Z(!W),variant:"ghost",size:"sm",children:[W?"Hide":"Show"," Label Form"]})]}),W&&e.jsxs("div",{className:"space-y-3 p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Title"}),e.jsx("input",{type:"text",value:O.title,onChange:e=>X({...O,title:e.target.value}),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Price"}),e.jsx("input",{type:"text",value:O.price,onChange:e=>X({...O,price:e.target.value}),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Barcode"}),e.jsx("input",{type:"text",value:O.barcode,onChange:e=>X({...O,barcode:e.target.value}),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"SKU"}),e.jsx("input",{type:"text",value:O.sku,onChange:e=>X({...O,sku:e.target.value}),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Size"}),e.jsx("input",{type:"text",value:O.size,onChange:e=>X({...O,size:e.target.value}),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Color"}),e.jsx("input",{type:"text",value:O.color,onChange:e=>X({...O,color:e.target.value}),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),e.jsx("textarea",{value:O.text,onChange:e=>X({...O,text:e.target.value}),rows:2,className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500"})]})]}),e.jsxs(t,{onClick:async()=>{try{if(!y)return void alert("Please connect to a printer first");await I(O)}catch(e){alert(`Test label print failed: ${e.message}`)}},variant:"secondary",disabled:w,className:"w-full",children:[e.jsx(x,{className:"w-4 h-4 mr-2"}),w?"Printing...":"Test Label"]})]})]})]})]}):e.jsx(s,{className:`p-6 ${b}`,children:e.jsxs("div",{className:"text-center",children:[e.jsx(a,{className:"w-12 h-12 mx-auto mb-4 text-blue-500"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Bluetooth Printer"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Initializing Bluetooth printer service..."}),e.jsxs(t,{onClick:T,variant:"primary",className:"w-full",children:[e.jsx(i,{className:"w-4 h-4 mr-2"}),"Initialize"]})]})})},f=()=>{const s=g();return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx("button",{onClick:()=>s(-1),className:"p-2 hover:bg-white hover:shadow-md rounded-lg transition-all duration-200",children:e.jsx(b,{className:"w-6 h-6 text-gray-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Bluetooth Printer Management"}),e.jsx("p",{className:"text-gray-600",children:"Connect and manage your Bluetooth thermal and label printers"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsx(j,{})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Quick Setup Guide"}),e.jsxs("div",{className:"space-y-3 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-6 h-6 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center text-xs font-semibold mt-0.5",children:"1"}),e.jsx("p",{children:"Make sure your Bluetooth printer is turned on and in pairing mode"})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-6 h-6 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center text-xs font-semibold mt-0.5",children:"2"}),e.jsx("p",{children:'Click "Connect" to search for available Bluetooth printers'})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-6 h-6 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center text-xs font-semibold mt-0.5",children:"3"}),e.jsx("p",{children:"Select your printer from the list and wait for connection"})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-6 h-6 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center text-xs font-semibold mt-0.5",children:"4"}),e.jsx("p",{children:'Use "Test Print" to verify the connection works properly'})]}),e.jsxs("div",{className:"mt-4 p-3 bg-blue-50 rounded-lg border border-blue-200",children:[e.jsx("h4",{className:"font-semibold text-blue-900 mb-2",children:"XP-P301A Specific Setup:"}),e.jsxs("ul",{className:"text-xs text-blue-800 space-y-1",children:[e.jsx("li",{children:"• Ensure battery is charged (3+ hours printing time)"}),e.jsx("li",{children:"• Use 25-80mm paper width for receipts"}),e.jsx("li",{children:"• Use 25-80mm label paper for labels"}),e.jsx("li",{children:"• Supports both ESC/POS and TSPL emulation"}),e.jsx("li",{children:"• 203 DPI resolution for crisp printing"}),e.jsx("li",{children:"• 70mm/s print speed"})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Supported Printers"}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[e.jsx("p",{className:"font-medium text-gray-700",children:"Thermal Receipt Printers:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 ml-2",children:[e.jsx("li",{children:"Star TSP100 series"}),e.jsx("li",{children:"Citizen CT-S310II"}),e.jsx("li",{children:"Epson TM-T88VI"}),e.jsx("li",{children:"Generic ESC/POS printers"})]}),e.jsx("p",{className:"font-medium text-gray-700 mt-3",children:"Dual Function Printers:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 ml-2",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Xprinter XP-P301A"})," (Receipt & Label)"]}),e.jsx("li",{children:"Other Xprinter mobile models"})]}),e.jsx("p",{className:"font-medium text-gray-700 mt-3",children:"Label Printers:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 ml-2",children:[e.jsx("li",{children:"Zebra ZD220"}),e.jsx("li",{children:"Zebra ZD420"}),e.jsx("li",{children:"Zebra ZD620"}),e.jsx("li",{children:"Brother QL-820NWB"}),e.jsx("li",{children:"Dymo LabelWriter 450"}),e.jsx("li",{children:"Generic label printers"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-3",children:"Most Bluetooth thermal and label printers with ESC/POS or ZPL support should work"})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Troubleshooting"}),e.jsxs("div",{className:"space-y-3 text-sm text-gray-600",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-700",children:"Can't find printer?"}),e.jsx("p",{className:"text-xs",children:"Make sure Bluetooth is enabled and printer is in pairing mode"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-700",children:"Connection fails?"}),e.jsx("p",{className:"text-xs",children:"Try restarting the printer and clearing browser Bluetooth cache"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-700",children:"Print not working?"}),e.jsx("p",{className:"text-xs",children:"Check paper and ensure printer is not in error state"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Browser Support"}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),e.jsx("span",{children:"Chrome 56+ (Recommended)"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),e.jsx("span",{children:"Edge 79+"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 bg-yellow-500 rounded-full"}),e.jsx("span",{children:"Firefox 55+ (Limited)"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full"}),e.jsx("span",{children:"Safari (Not supported)"})]})]})]})]})]})]})})};export{f as default};
