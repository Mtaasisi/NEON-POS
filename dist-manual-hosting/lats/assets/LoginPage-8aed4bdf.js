import{s as e,j as t}from"./index-222cfb29.js";import{r as s}from"./vendor-a2ff445a.js";import{bK as a,P as l,k as r,ak as o,q as i,z as n}from"./ui-551a39a6.js";import{a as c}from"./routing-a2f0f6d2.js";import"./supabase-7e851d02.js";s.createContext(void 0);const d=()=>{const d=c(),{login:u}=(()=>{const[t,a]=s.useState(null),[l,r]=s.useState(!0);return s.useEffect(()=>{(async()=>{try{const t=localStorage.getItem("customer_id");if(t){const{data:s,error:l}=await e.from("customers").select("*").eq("id",t).single();s&&!l&&a({id:s.id,name:s.name,email:s.email,phone:s.phone,profileImage:s.profile_image,loyaltyPoints:s.points||0,loyaltyTier:s.loyalty_tier,createdAt:s.created_at,lastPurchase:s.last_purchase_date})}}catch(t){}finally{r(!1)}})()},[]),{customer:t,loading:l,login:async(t,s)=>{try{r(!0);const{data:s,error:l}=await e.from("customers").select("*").eq("phone",t).single();if(l)throw new Error("Customer not found. Please register first.");if(s){const e={id:s.id,name:s.name,email:s.email,phone:s.phone,profileImage:s.profile_image,loyaltyPoints:s.points||0,loyaltyTier:s.loyalty_tier,createdAt:s.created_at,lastPurchase:s.last_purchase_date};a(e),localStorage.setItem("customer_id",s.id)}}catch(l){throw l}finally{r(!1)}},logout:async()=>{a(null),localStorage.removeItem("customer_id")},isAuthenticated:!!t}})(),[m,x]=s.useState(""),[h,p]=s.useState(""),[g,b]=s.useState(!1),[f,y]=s.useState(!1);return t.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-500 to-blue-700 flex flex-col",children:[t.jsxs("div",{className:"pt-12 pb-8 px-6 text-center",children:[t.jsx("div",{className:"w-20 h-20 bg-white rounded-full flex items-center justify-center mx-auto mb-4 shadow-lg",children:t.jsx(a,{size:40,className:"text-blue-600"})}),t.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Welcome Back!"}),t.jsx("p",{className:"text-blue-100",children:"Login to continue shopping"})]}),t.jsxs("div",{className:"flex-1 bg-white rounded-t-3xl px-6 py-8",children:[t.jsxs("form",{onSubmit:async e=>{if(e.preventDefault(),m)try{y(!0),await u(m,h),n.success("Login successful!"),d("/customer-portal/dashboard")}catch(t){n.error(t.message||"Login failed")}finally{y(!1)}else n.error("Please enter your phone number")},className:"space-y-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone Number"}),t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:t.jsx(l,{size:20,className:"text-gray-400"})}),t.jsx("input",{type:"tel",value:m,onChange:e=>x(e.target.value),placeholder:"0712345678",className:"w-full pl-12 pr-4 py-4 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 text-lg"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Password (Optional)"}),t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:t.jsx(r,{size:20,className:"text-gray-400"})}),t.jsx("input",{type:g?"text":"password",value:h,onChange:e=>p(e.target.value),placeholder:"Enter your password",className:"w-full pl-12 pr-12 py-4 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-blue-500 text-lg"}),t.jsx("button",{type:"button",onClick:()=>b(!g),className:"absolute inset-y-0 right-0 pr-4 flex items-center",children:g?t.jsx(o,{size:20,className:"text-gray-400"}):t.jsx(i,{size:20,className:"text-gray-400"})})]})]}),t.jsx("div",{className:"text-right",children:t.jsx("button",{type:"button",onClick:()=>n.info("Contact support for password reset"),className:"text-sm text-blue-600 font-medium hover:underline",children:"Forgot Password?"})}),t.jsx("button",{type:"submit",disabled:f,className:"w-full bg-blue-600 text-white py-4 rounded-xl font-bold text-lg hover:bg-blue-700 active:scale-95 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:f?t.jsxs("div",{className:"flex items-center justify-center gap-2",children:[t.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),t.jsx("span",{children:"Logging in..."})]}):"Login"}),t.jsxs("div",{className:"relative",children:[t.jsx("div",{className:"absolute inset-0 flex items-center",children:t.jsx("div",{className:"w-full border-t border-gray-300"})}),t.jsx("div",{className:"relative flex justify-center text-sm",children:t.jsx("span",{className:"px-4 bg-white text-gray-500",children:"OR"})})]}),t.jsx("button",{type:"button",onClick:()=>d("/customer-portal/products"),className:"w-full border-2 border-gray-300 text-gray-700 py-4 rounded-xl font-bold text-lg hover:bg-gray-50 active:scale-95 transition-all",children:"Continue as Guest"})]}),t.jsx("div",{className:"mt-8 text-center",children:t.jsxs("p",{className:"text-gray-600",children:["Don't have an account?"," ",t.jsx("button",{onClick:()=>d("/customer-portal/signup"),className:"text-blue-600 font-bold hover:underline",children:"Register"})]})}),t.jsx("div",{className:"mt-8 p-4 bg-blue-50 rounded-xl",children:t.jsxs("p",{className:"text-sm text-gray-600 text-center",children:["Need help? Contact us at"," ",t.jsx("a",{href:"tel:+255712345678",className:"text-blue-600 font-medium",children:"+255 712 345 678"})]})})]})]})};export{d as default};
