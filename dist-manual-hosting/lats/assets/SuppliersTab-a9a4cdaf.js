import{j as e,G as s,d as a,ac as t,ad as l,ae as r,af as i,ag as n}from"./index-222cfb29.js";import{r as c}from"./vendor-a2ff445a.js";import{S as o}from"./SearchBar-2b6f451f.js";import{Y as d,d as m,R as p,Q as x,e as u,aC as h,h as j,aP as f,r as g,$ as v,j as N,P as y,v as w,n as b}from"./ui-551a39a6.js";import{S as C}from"./SupplierForm-e7ec71ff.js";import{S}from"./SupplierDetailsModal-8b57c375.js";const L={TZ:"ðŸ‡¹ðŸ‡¿",AE:"ðŸ‡¦ðŸ‡ª",CN:"ðŸ‡¨ðŸ‡³",US:"ðŸ‡ºðŸ‡¸",CA:"ðŸ‡¨ðŸ‡¦",UK:"ðŸ‡¬ðŸ‡§",DE:"ðŸ‡©ðŸ‡ª",FR:"ðŸ‡«ðŸ‡·",JP:"ðŸ‡¯ðŸ‡µ",IN:"ðŸ‡®ðŸ‡³",BR:"ðŸ‡§ðŸ‡·",AU:"ðŸ‡¦ðŸ‡º",KE:"ðŸ‡°ðŸ‡ª",UG:"ðŸ‡ºðŸ‡¬",RW:"ðŸ‡·ðŸ‡¼",ET:"ðŸ‡ªðŸ‡¹",NG:"ðŸ‡³ðŸ‡¬",ZA:"ðŸ‡¿ðŸ‡¦",EG:"ðŸ‡ªðŸ‡¬",SA:"ðŸ‡¸ðŸ‡¦",TR:"ðŸ‡¹ðŸ‡·",RU:"ðŸ‡·ðŸ‡º",KR:"ðŸ‡°ðŸ‡·",SG:"ðŸ‡¸ðŸ‡¬",MY:"ðŸ‡²ðŸ‡¾",TH:"ðŸ‡¹ðŸ‡­",VN:"ðŸ‡»ðŸ‡³",ID:"ðŸ‡®ðŸ‡©",PH:"ðŸ‡µðŸ‡­"},E=()=>{const[E,_]=c.useState([]),[A,T]=c.useState([]),[k,z]=c.useState(!1),[R,F]=c.useState(""),[D,G]=c.useState("all"),[P,M]=c.useState(!1),[O,U]=c.useState(null),[I,K]=c.useState(!1),[$,B]=c.useState(null),[H,V]=c.useState(null),[Y,Z]=c.useState(!1),J=async()=>{try{z(!0),B(null);const e=await t();_(e),T(e)}catch(e){const s=e instanceof Error?e.message:"Failed to load suppliers";B(s),b.error(s)}finally{z(!1)}};c.useEffect(()=>{J()},[]),c.useEffect(()=>{let e=E;if("active"===D?e=e.filter(e=>!0===e.is_active):"inactive"===D&&(e=e.filter(e=>!1===e.is_active)),R.trim())if(R.length>=3){(async()=>{try{const e=await l(R);let s=e;"active"===D?s=e.filter(e=>!0===e.is_active):"inactive"===D&&(s=e.filter(e=>!1===e.is_active)),T(s)}catch(s){const a=e.filter(e=>{var s,a,t,l;return e.name.toLowerCase().includes(R.toLowerCase())||(null==(s=e.company_name)?void 0:s.toLowerCase().includes(R.toLowerCase()))||(null==(a=e.description)?void 0:a.toLowerCase().includes(R.toLowerCase()))||(null==(t=e.contact_person)?void 0:t.toLowerCase().includes(R.toLowerCase()))||(null==(l=e.email)?void 0:l.toLowerCase().includes(R.toLowerCase()))});T(a)}})()}else{const s=e.filter(e=>{var s,a,t,l;return e.name.toLowerCase().includes(R.toLowerCase())||(null==(s=e.company_name)?void 0:s.toLowerCase().includes(R.toLowerCase()))||(null==(a=e.description)?void 0:a.toLowerCase().includes(R.toLowerCase()))||(null==(t=e.contact_person)?void 0:t.toLowerCase().includes(R.toLowerCase()))||(null==(l=e.email)?void 0:l.toLowerCase().includes(R.toLowerCase()))});T(s)}else T(e)},[E,R,D]);const Q=()=>{U(null),M(!0)},W=e=>{U(e),M(!0),Z(!1)};return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("h2",{className:"text-2xl font-bold text-gray-900 flex items-center gap-2",children:[e.jsx(d,{className:"w-6 h-6 text-purple-600"}),"Supplier Management"]}),e.jsxs("p",{className:"text-gray-600 mt-1",children:["Manage suppliers and vendor relationships (",A.length," suppliers)"]}),e.jsxs("p",{className:"text-sm text-green-600 mt-1 flex items-center gap-1",children:[e.jsx(m,{className:"w-4 h-4"}),"New suppliers are automatically set to active"]})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(s,{onClick:()=>{J()},icon:e.jsx(p,{size:18}),className:"bg-gradient-to-r from-blue-500 to-blue-600 text-white",disabled:k,children:"Refresh"}),e.jsx(s,{onClick:Q,icon:e.jsx(x,{size:18}),className:"bg-gradient-to-r from-purple-500 to-purple-600 text-white",children:"Add Supplier"})]})]}),$&&e.jsx(a,{className:"p-4 border-red-200 bg-red-50",children:e.jsxs("div",{className:"flex items-center gap-2 text-red-700",children:[e.jsx(u,{size:20}),e.jsx("span",{className:"font-medium",children:"Error:"}),e.jsx("span",{children:$}),e.jsx(s,{onClick:()=>B(null),className:"ml-auto text-red-600 hover:text-red-800",size:"sm",children:"Dismiss"})]})}),e.jsx(a,{className:"p-4",children:e.jsxs("div",{className:"flex flex-col sm:flex-row gap-4",children:[e.jsx("div",{className:"flex-1",children:e.jsx(o,{placeholder:"Search suppliers by name, company, contact person, or email...",onSearch:F})}),e.jsxs("div",{className:"sm:w-48",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status Filter"}),e.jsxs("select",{value:D,onChange:e=>G(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-orange-500 focus:border-transparent",children:[e.jsx("option",{value:"all",children:"All Suppliers"}),e.jsx("option",{value:"active",children:"Active Only"}),e.jsx("option",{value:"inactive",children:"Inactive Only"})]})]})]})}),e.jsx(a,{className:"p-6",children:k?e.jsxs("div",{className:"flex items-center justify-center py-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-purple-600"}),e.jsx("span",{className:"ml-2 text-gray-600",children:"Loading suppliers..."})]}):0===A.length?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(h,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No suppliers found"}),e.jsx("p",{className:"text-gray-600 mb-4",children:R?"Try adjusting your search or clear the search field":"Get started by adding your first supplier"}),!R&&e.jsx(s,{onClick:Q,icon:e.jsx(x,{size:18}),className:"bg-gradient-to-r from-purple-500 to-purple-600 text-white",children:"Add First Supplier"})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:A.map(s=>e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-4 hover:shadow-md transition-shadow",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(d,{className:"w-5 h-5 text-purple-600"}),e.jsx("h3",{className:"font-medium text-gray-900",children:s.name}),s.is_active?e.jsx(m,{className:"w-4 h-4 text-green-500"}):e.jsx(j,{className:"w-4 h-4 text-red-500"})]}),e.jsxs("div",{className:"flex gap-1",children:[e.jsx("button",{onClick:()=>(e=>{V(e),Z(!0)})(s),className:"p-1 text-gray-400 hover:text-green-600 transition-colors",title:"View details",disabled:I,children:e.jsx(f,{size:16})}),e.jsx("button",{onClick:()=>W(s),className:"p-1 text-gray-400 hover:text-purple-600 transition-colors",title:"Edit supplier",disabled:I,children:e.jsx(g,{size:16})}),e.jsx("button",{onClick:()=>(async e=>{if(confirm("âš ï¸ PERMANENT DELETE: Are you sure you want to permanently delete this supplier from the database? This action CANNOT be undone!"))try{K(!0),await r(e),_(s=>s.filter(s=>s.id!==e)),T(s=>s.filter(s=>s.id!==e)),b.success("Supplier permanently deleted from database")}catch(s){const e=s instanceof Error?s.message:"Failed to delete supplier";b.error(e)}finally{K(!1)}})(s.id),className:"p-1 text-gray-400 hover:text-red-600 transition-colors",title:"Delete supplier",disabled:I,children:e.jsx(v,{size:16})})]})]}),e.jsxs("div",{className:"space-y-1 text-xs text-gray-500",children:[s.contact_person&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"font-medium",children:"Contact:"}),e.jsx("span",{children:s.contact_person})]}),s.email&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(N,{className:"w-3 h-3"}),e.jsx("a",{href:`mailto:${s.email}`,className:"text-blue-600 hover:underline",children:s.email})]}),s.phone&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(y,{className:"w-3 h-3"}),e.jsx("a",{href:`tel:${s.phone}`,className:"text-blue-600 hover:underline",children:s.phone})]}),s.city&&s.country&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(w,{className:"w-3 h-3"}),e.jsxs("span",{children:[s.city,", ",L[s.country]||"ðŸŒ"," ",s.country]})]}),s.payment_terms&&e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx("span",{className:"font-medium",children:"Payment Terms:"}),e.jsx("span",{className:"bg-blue-100 px-2 py-1 rounded font-medium text-blue-800",children:s.payment_terms})]})]})]},s.id))})}),P&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center p-4 z-50",children:e.jsx("div",{className:"w-full max-w-2xl max-h-[90vh] overflow-y-auto",children:e.jsx(C,{supplier:O||void 0,onSubmit:async e=>{try{if(K(!0),O){const s=await i(O.id,e);_(e=>e.map(e=>e.id===O.id?s:e)),T(e=>e.map(e=>e.id===O.id?s:e)),b.success("Supplier updated successfully")}else{const s=await n(e);_(e=>[...e,s]),T(e=>[...e,s]),b.success("Supplier created successfully")}M(!1),U(null)}catch(s){const e=s instanceof Error?s.message:"Failed to save supplier";b.error(e)}finally{K(!1)}},onCancel:()=>M(!1),loading:I})})}),H&&e.jsx(S,{supplier:H,isOpen:Y,onClose:()=>{Z(!1),V(null)},onEdit:e=>{W(e)}})]})};export{E as S};
