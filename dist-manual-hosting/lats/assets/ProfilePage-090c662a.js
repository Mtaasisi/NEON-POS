import{j as e}from"./index-222cfb29.js";import{r as s}from"./vendor-a2ff445a.js";import{c as a,M as l}from"./customerPortalService-ebbdd244.js";import{z as t,U as r,r as i,P as o,j as n,v as c,ao as d,aJ as m,am as x,k as u,bJ as f,a5 as g,a4 as h}from"./ui-551a39a6.js";import{a as j}from"./routing-a2f0f6d2.js";import"./supabase-7e851d02.js";const b=()=>{const b=j(),[p,v]=s.useState(null),[y,N]=s.useState(!0),[w,C]=s.useState(!1),[P,S]=s.useState(null);s.useEffect(()=>{k()},[]);const k=async()=>{try{N(!0);const e=localStorage.getItem("customer_id");if(!e)return void b("/customer-portal/login");const s=await a.getCustomerById(e);if(!s)throw new Error("Customer not found");const l={name:s.name,phone:s.phone,email:s.email,address:s.address,profileImage:s.profile_image};v(l),S(l)}catch(e){t.error("Failed to load profile")}finally{N(!1)}},z=[{icon:x,label:"Notifications",value:"Manage your notifications",action:()=>b("/customer-portal/notifications")},{icon:u,label:"Privacy & Security",value:"Password and security settings",action:()=>t.info("Feature coming soon")},{icon:f,label:"Help & Support",value:"Get help with your account",action:()=>t.info("Contact us at +255 712 345 678")},{icon:g,label:"Terms & Conditions",value:"Read our terms",action:()=>t.info("Feature coming soon")},{icon:h,label:"Privacy Policy",value:"Read our privacy policy",action:()=>t.info("Feature coming soon")}];return y?e.jsx(l,{title:"Profile",children:e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})})}):p?e.jsxs(l,{title:"Profile",children:[e.jsx("div",{className:"bg-gradient-to-br from-blue-600 to-blue-700 p-6 pb-8",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"w-24 h-24 bg-white rounded-full flex items-center justify-center mb-4 shadow-lg",children:p.profileImage?e.jsx("img",{src:p.profileImage,alt:p.name,className:"w-full h-full rounded-full object-cover"}):e.jsx(r,{size:48,className:"text-blue-600"})}),e.jsx("h2",{className:"text-2xl font-bold text-white mb-1",children:p.name}),e.jsx("p",{className:"text-blue-100",children:p.phone})]})}),w?e.jsx("div",{className:"px-4 py-6",children:e.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Edit Profile"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Full Name"}),e.jsx("input",{type:"text",value:(null==P?void 0:P.name)||"",onChange:e=>S(s=>s?{...s,name:e.target.value}:null),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),e.jsx("input",{type:"email",value:(null==P?void 0:P.email)||"",onChange:e=>S(s=>s?{...s,email:e.target.value}:null),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Address"}),e.jsx("textarea",{value:(null==P?void 0:P.address)||"",onChange:e=>S(s=>s?{...s,address:e.target.value}:null),rows:3,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{onClick:()=>{S(p),C(!1)},className:"flex-1 py-3 border-2 border-gray-300 text-gray-700 rounded-lg font-medium hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{onClick:async()=>{if(P)try{const e=localStorage.getItem("customer_id");if(!e)return;const s=await a.updateCustomerProfile(e,{name:P.name,email:P.email,address:P.address});if(!s.success)throw new Error(s.error);v(P),C(!1),t.success("Profile updated successfully")}catch(e){t.error("Failed to update profile")}},className:"flex-1 py-3 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700",children:"Save Changes"})]})]})]})}):e.jsx("div",{className:"px-4 py-6 space-y-4",children:e.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Personal Information"}),e.jsxs("button",{onClick:()=>C(!0),className:"text-blue-600 font-medium flex items-center gap-1",children:[e.jsx(i,{size:18}),"Edit"]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(r,{size:20,className:"text-gray-400 mt-1"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Full Name"}),e.jsx("div",{className:"font-medium text-gray-900",children:p.name})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(o,{size:20,className:"text-gray-400 mt-1"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Phone Number"}),e.jsx("div",{className:"font-medium text-gray-900",children:p.phone})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(n,{size:20,className:"text-gray-400 mt-1"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Email"}),e.jsx("div",{className:"font-medium text-gray-900",children:p.email||"Not provided"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(c,{size:20,className:"text-gray-400 mt-1"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Address"}),e.jsx("div",{className:"font-medium text-gray-900",children:p.address||"Not provided"})]})]})]})]})}),e.jsx("div",{className:"px-4 pb-4",children:e.jsx("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden",children:z.map((s,a)=>{const l=s.icon;return e.jsxs("button",{onClick:s.action,className:"w-full p-4 flex items-center justify-between hover:bg-gray-50 active:bg-gray-100 transition-colors border-b border-gray-100 last:border-b-0",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center",children:e.jsx(l,{size:20,className:"text-gray-600"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"font-medium text-gray-900",children:s.label}),e.jsx("div",{className:"text-xs text-gray-600",children:s.value})]})]}),e.jsx(d,{size:20,className:"text-gray-400"})]},a)})})}),e.jsx("div",{className:"px-4 pb-8",children:e.jsxs("button",{onClick:()=>{localStorage.removeItem("customer_id"),t.success("Logged out successfully"),b("/customer-portal/login")},className:"w-full py-4 bg-red-50 text-red-600 rounded-xl font-bold flex items-center justify-center gap-2 hover:bg-red-100 active:scale-95 transition-all",children:[e.jsx(m,{size:20}),"Logout"]})})]}):e.jsx(l,{title:"Profile",children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 px-4",children:[e.jsx("p",{className:"text-gray-600 mb-4",children:"Please login to view your profile"}),e.jsx("button",{onClick:()=>b("/customer-portal/login"),className:"px-6 py-3 bg-blue-600 text-white rounded-lg font-medium",children:"Login"})]})})};export{b as default};
