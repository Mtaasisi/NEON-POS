import{j as e,C as s,aK as a,aN as t,u as n}from"./index-222cfb29.js";import{r as i,R as l}from"./vendor-a2ff445a.js";import{R as r,bJ as o,ay as c,X as d,ai as m,aX as h,q as p,aa as u,Z as x,a9 as g,a4 as b,k as j,z as y,ah as _,ag as f,f as w,V as v,p as N,cI as k,cJ as C,a5 as S,b5 as P,u as T,b4 as D,a8 as I,s as A,x as R,Y as F,d as M,bO as E,t as z,aA as O,az as L,m as H,j as B,am as W,y as q,N as U,n as $}from"./ui-551a39a6.js";import{u as V}from"./useBodyScrollLock-0216d39f.js";import{u as J}from"./POSPageOptimized-2fe67e41.js";import{format as Q}from"./format-0f0b2647.js";import{u as Y}from"./useBusinessInfo-13b9c3ff.js";import"./supabase-7e851d02.js";import"./routing-a2f0f6d2.js";import"./rbac-bc517d81.js";import"./usePOSClickSounds-710a2a1b.js";import"./VariantProductCard-5f79965a.js";import"./robustImageService-2422a1f9.js";import"./productUtils-6e390a72.js";import"./GlassBadge-18f019e2.js";import"./utils-fb833cf6.js";import"./charts-66cc82bb.js";import"./SafeImage-bfaf74c6.js";import"./specificationUtils-8355804c.js";import"./PriceInput-e1556d5b.js";import"./CategoryInput-bba1731d.js";import"./AddCustomerModal-a69277f6.js";import"./CustomerForm-05944812.js";import"./phoneUtils-1ba19aca.js";import"./useSuccessModal-e8b7d685.js";import"./SuccessModalIcons-20b743c5.js";import"./search-674d386b.js";import"./ShareReceiptModal-4bab199d.js";import"./CustomerDetailModal-9e075bf1.js";import"./appointments-4d8aac45.js";import"./Modal-ccfa5014.js";import"./returns-0428af68.js";import"./whatsappService-37f3bd6b.js";import"./AppointmentModal-4524caae.js";import"./index-0096d614.js";import"./pdf-33d2fdad.js";import"./GlassInput-ba5c3c0d.js";import"./installmentService-e14bbda4.js";import"./TradeInContractModal-dd90079f.js";import"./toPropertyKey-7f87613e.js";import"./tradeInApi-966791f7.js";import"./paymentTrackingService-7b6db13e.js";import"./PaymentsPopupModal-70ab4c91.js";import"./draftService-0e50dcac.js";const K=({title:s,description:a,icon:t,children:n,isLoading:i=!1})=>i?e.jsxs("div",{className:"flex items-center justify-center p-8",children:[e.jsx(r,{className:"w-6 h-6 animate-spin text-blue-600"}),e.jsx("span",{className:"ml-2 text-gray-600",children:"Loading settings..."})]}):e.jsx("div",{className:"space-y-6",children:e.jsx("div",{className:"space-y-6",children:n})}),G=({content:s,position:a="top",maxWidth:t="300px"})=>{const[n,l]=i.useState(!1),[r,c]=i.useState(a),d=i.useRef(null),m=i.useRef(null);i.useEffect(()=>{if(n&&d.current&&m.current){const e=d.current,s=m.current.getBoundingClientRect(),t=e.getBoundingClientRect();let n=a;"top"===a&&s.top<t.height+10?n="bottom":"bottom"===a&&window.innerHeight-s.bottom<t.height+10?n="top":"left"===a&&s.left<t.width+10?n="right":"right"===a&&window.innerWidth-s.right<t.width+10&&(n="left"),c(n)}},[n,a]);return e.jsxs("div",{className:"relative inline-block",children:[e.jsx("button",{ref:m,type:"button",onMouseEnter:()=>l(!0),onMouseLeave:()=>l(!1),onFocus:()=>l(!0),onBlur:()=>l(!1),onClick:e=>{e.preventDefault(),e.stopPropagation(),l(!n)},className:"inline-flex items-center justify-center w-4 h-4 text-gray-400 hover:text-blue-600 transition-colors focus:outline-none focus:ring-2 focus:ring-blue-500 focus:ring-offset-1 rounded-full","aria-label":"Help",children:e.jsx(o,{className:"w-4 h-4"})}),n&&e.jsxs("div",{ref:d,className:`absolute z-[9999] ${(()=>{switch(r){case"top":default:return"bottom-full left-1/2 transform -translate-x-1/2 mb-2";case"bottom":return"top-full left-1/2 transform -translate-x-1/2 mt-2";case"left":return"right-full top-1/2 transform -translate-y-1/2 mr-2";case"right":return"left-full top-1/2 transform -translate-y-1/2 ml-2"}})()}`,style:{maxWidth:t},onClick:e=>e.stopPropagation(),children:[e.jsx("div",{className:"bg-gray-900 text-white text-sm rounded-lg shadow-xl p-3 leading-relaxed",children:"string"==typeof s?e.jsx("p",{className:"whitespace-pre-line",children:s}):s}),e.jsx("div",{className:`absolute w-0 h-0 border-4 ${(()=>{switch(r){case"top":default:return"top-full left-1/2 transform -translate-x-1/2 border-t-gray-900 border-l-transparent border-r-transparent border-b-transparent";case"bottom":return"bottom-full left-1/2 transform -translate-x-1/2 border-b-gray-900 border-l-transparent border-r-transparent border-t-transparent";case"left":return"left-full top-1/2 transform -translate-y-1/2 border-l-gray-900 border-t-transparent border-b-transparent border-r-transparent";case"right":return"right-full top-1/2 transform -translate-y-1/2 border-r-gray-900 border-t-transparent border-b-transparent border-l-transparent"}})()}`})]})]})},Z=({id:s,label:a,description:t,helpText:n,checked:i,onChange:l,disabled:r=!1})=>e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"font-medium text-gray-900",children:a}),n&&e.jsx(G,{content:n})]}),t&&e.jsx("div",{className:"text-sm text-gray-600 mt-1",children:t})]}),e.jsxs("label",{className:"relative inline-flex items-center cursor-pointer ml-4",children:[e.jsx("input",{type:"checkbox",id:s,checked:i,onChange:e=>l(e.target.checked),disabled:r,className:"sr-only peer"}),e.jsx("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600 "+(r?"opacity-50 cursor-not-allowed":"")})]})]}),X=({id:s,label:a,description:t,helpText:n,value:i,onChange:l,min:r,max:o,step:c=1,placeholder:d,disabled:m=!1})=>e.jsxs("div",{children:[e.jsxs("label",{htmlFor:s,className:"flex items-center gap-2 text-sm font-medium text-gray-700 mb-2",children:[e.jsx("span",{children:a}),n&&e.jsx(G,{content:n})]}),e.jsx("input",{type:"number",id:s,value:i||"",onChange:e=>{const s=parseFloat(e.target.value);l(isNaN(s)?0:s)},min:r,max:o,step:c,placeholder:d,disabled:m,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed"}),t&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:t})]}),ee=({id:s,label:a,description:t,helpText:n,value:i,onChange:l,placeholder:r,disabled:o=!1,multiline:c=!1,rows:d=3,type:m="text"})=>e.jsxs("div",{children:[e.jsxs("label",{htmlFor:s,className:"flex items-center gap-2 text-sm font-medium text-gray-700 mb-2",children:[e.jsx("span",{children:a}),n&&e.jsx(G,{content:n})]}),c?e.jsx("textarea",{id:s,value:i,onChange:e=>l(e.target.value),placeholder:r,disabled:o,rows:d,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none disabled:opacity-50 disabled:cursor-not-allowed"}):e.jsx("input",{type:m,id:s,value:i,onChange:e=>l(e.target.value),placeholder:r,disabled:o,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed"}),t&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:t})]}),se=({id:s,label:a,description:t,helpText:n,value:i,onChange:l,options:r,disabled:o=!1,multiple:c=!1})=>e.jsxs("div",{children:[e.jsxs("label",{htmlFor:s,className:"flex items-center gap-2 text-sm font-medium text-gray-700 mb-2",children:[e.jsx("span",{children:a}),n&&e.jsx(G,{content:n})]}),e.jsx("select",{id:s,value:i,onChange:e=>l(e.target.value),disabled:o,multiple:c,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed",children:r.map(s=>e.jsx("option",{value:s.value,children:s.label},s.value))}),t&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:t})]}),ae=({id:s,label:a,description:t,helpText:n,value:i,onChange:l,disabled:r=!1})=>e.jsxs("div",{children:[e.jsxs("label",{htmlFor:s,className:"flex items-center gap-2 text-sm font-medium text-gray-700 mb-2",children:[e.jsx("span",{children:a}),n&&e.jsx(G,{content:n})]}),e.jsx("input",{type:"time",id:s,value:i,onChange:e=>l(e.target.value),disabled:r,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed"}),t&&e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:t})]}),te=({title:s,description:a,helpText:t,icon:n,colorClass:i="bg-white border-gray-200",children:l})=>e.jsxs("div",{className:`p-6 rounded-xl border ${i}`,children:[e.jsxs("div",{className:"flex items-start gap-2 mb-4",children:[e.jsx("div",{className:"p-1 rounded mt-0.5",children:n}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:s}),t&&e.jsx(G,{content:t})]}),a&&e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:a})]})]}),e.jsx("div",{className:"space-y-4",children:l})]}),ne=i.forwardRef((a,t)=>{const{settings:n,setSettings:r,loading:o,saving:_,error:f,saveSettings:w,updateSettings:v,resetSettings:N}=s(),{t:k}=J(),[C,S]=i.useState(n.business_logo||null),[P,T]=i.useState(!1),D=i.useRef(null);l.useEffect(()=>{n.business_logo!==C&&S(n.business_logo||null)},[n.business_logo]);const I=async()=>{const e=await w(n);return e&&window.dispatchEvent(new CustomEvent("settingsUpdated",{detail:{type:"general"}})),e},A=async()=>{await N()},R=(e,s)=>{r(a=>({...a,[e]:s})),"font_size"===e&&F(s)},F=e=>{const s=document.documentElement;switch(e){case"tiny":s.style.fontSize="11px";break;case"extra-small":s.style.fontSize="12px";break;case"small":s.style.fontSize="14px";break;case"medium":s.style.fontSize="16px";break;case"large":s.style.fontSize="18px"}};l.useEffect(()=>{n.font_size&&F(n.font_size)},[n.font_size]);return i.useImperativeHandle(t,()=>({saveSettings:I,resetSettings:A})),o?e.jsxs("div",{className:"flex items-center justify-center p-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"}),e.jsx("span",{className:"ml-2 text-gray-600",children:"Loading settings..."})]}):f?e.jsx("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:e.jsxs("p",{className:"text-red-600",children:["Error: ",f]})}):e.jsxs(K,{isLoading:o,children:[e.jsx(te,{title:k("general.businessInfo"),icon:e.jsx(c,{className:"w-5 h-5"}),helpText:k("general.businessInfoHelp"),children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-12 gap-4",children:[e.jsx("div",{className:"lg:col-span-3",children:e.jsxs("div",{className:"h-full flex flex-col",children:[e.jsx("div",{className:"flex-1 flex items-center justify-center mb-3",children:C?e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"w-48 h-48 border-2 border-gray-200 rounded-lg overflow-hidden bg-white flex items-center justify-center",children:e.jsx("img",{src:C,alt:"Business Logo",className:"max-w-full max-h-full object-contain"})}),e.jsx("button",{type:"button",onClick:()=>{S(null),R("business_logo",null),D.current&&(D.current.value=""),y.success("Logo removed. Remember to save settings.")},className:"absolute -top-2 -right-2 bg-red-500 text-white rounded-full p-1 hover:bg-red-600 transition-colors",title:"Remove logo",children:e.jsx(d,{className:"w-4 h-4"})})]}):e.jsx("div",{className:"w-48 h-48 border-2 border-dashed border-gray-300 rounded-lg flex items-center justify-center bg-white",children:e.jsx(m,{className:"w-10 h-10 text-gray-400"})})}),e.jsx("input",{ref:D,type:"file",accept:"image/*",onChange:async e=>{var s;const a=null==(s=e.target.files)?void 0:s[0];if(a)if(a.type.startsWith("image/"))if(a.size>2097152)y.error("Image size should be less than 2MB");else{T(!0);try{const e=new FileReader;e.onloadend=()=>{const s=e.result;S(s),R("business_logo",s),y.success("Logo uploaded successfully! Remember to save settings.")},e.onerror=()=>{y.error("Failed to read image file")},e.readAsDataURL(a)}catch(t){y.error("Failed to upload logo")}finally{T(!1)}}else y.error("Please upload an image file")},className:"hidden",id:"logo-upload"}),e.jsxs("label",{htmlFor:"logo-upload",className:"w-full inline-flex items-center justify-center gap-2 px-4 py-2 border-2 border-gray-200 rounded-lg text-sm font-medium text-gray-700 bg-white hover:bg-gray-50 cursor-pointer transition-colors "+(P?"opacity-50 cursor-not-allowed":""),children:[e.jsx(m,{className:"w-4 h-4"}),k(P?"general.uploading":C?"general.changeLogo":"general.uploadLogo")]})]})}),e.jsx("div",{className:"lg:col-span-9",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(ee,{label:k("general.businessName"),value:n.business_name||"",onChange:e=>R("business_name",e),placeholder:"My Store"}),e.jsx(ee,{label:k("general.businessPhone"),value:n.business_phone||"",onChange:e=>R("business_phone",e),placeholder:"+255 123 456 789"}),e.jsx(ee,{label:k("general.businessEmail"),value:n.business_email||"",onChange:e=>R("business_email",e),placeholder:"info@mystore.com"}),e.jsx(ee,{label:k("general.businessWebsite"),value:n.business_website||"",onChange:e=>R("business_website",e),placeholder:"www.mystore.com"}),e.jsx("div",{className:"sm:col-span-2",children:e.jsx(ee,{label:k("general.businessAddress"),value:n.business_address||"",onChange:e=>R("business_address",e),placeholder:"123 Main Street, City, Country"})})]})})]})}),e.jsx(te,{title:k("interface.title"),icon:e.jsx(h,{className:"w-5 h-5"}),helpText:k("interface.help"),children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsx(se,{label:k("interface.theme"),value:n.theme,onChange:e=>R("theme",e),options:[{value:"light",label:k("interface.light")},{value:"dark",label:k("interface.dark")},{value:"auto",label:k("interface.auto")}]}),e.jsx(se,{label:k("interface.language"),value:n.language,onChange:e=>R("language",e),options:[{value:"en",label:k("interface.english")},{value:"sw",label:k("interface.swahili")},{value:"fr",label:k("interface.french")}]}),e.jsx(se,{label:k("interface.fontSize"),value:n.font_size,onChange:e=>R("font_size",e),options:[{value:"tiny",label:`${k("interface.tiny")} (11px)`},{value:"extra-small",label:`${k("interface.extraSmall")} (12px)`},{value:"small",label:`${k("interface.small")} (14px)`},{value:"medium",label:`${k("interface.medium")} (16px)`},{value:"large",label:`${k("interface.large")} (18px)`}]}),e.jsx(ee,{label:k("interface.currency"),value:n.currency,onChange:e=>R("currency",e),placeholder:"TZS"}),e.jsx(ee,{label:k("interface.dateFormat"),value:n.date_format,onChange:e=>R("date_format",e),placeholder:"DD/MM/YYYY"}),e.jsx(se,{label:k("interface.timeFormat"),value:n.time_format,onChange:e=>R("time_format",e),options:[{value:"12",label:k("interface.12hour")},{value:"24",label:k("interface.24hour")}]})]})}),e.jsx(te,{title:"Display Settings",icon:e.jsx(p,{className:"w-5 h-5"}),helpText:"Chagua ni taarifa gani zinaonekana kwenye product cards za POS.",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(Z,{label:"Show Product Images",checked:n.show_product_images,onChange:e=>R("show_product_images",e),helpText:"Onyesha picha za bidhaa kwenye POS grid."}),e.jsx(Z,{label:"Show Stock Levels",checked:n.show_stock_levels,onChange:e=>R("show_stock_levels",e),helpText:"Onyesha idadi ya stock kwa kila bidhaa."}),e.jsx(Z,{label:"Show Prices",checked:n.show_prices,onChange:e=>R("show_prices",e),helpText:"Onyesha bei kwenye product cards."}),e.jsx(Z,{label:"Show Barcodes",checked:n.show_barcodes,onChange:e=>R("show_barcodes",e),helpText:"Onyesha barcode kwenye product cards."})]})}),e.jsxs(te,{title:"Product Grid Settings",icon:e.jsx(p,{className:"w-5 h-5"}),helpText:e.jsxs("div",{children:[e.jsx("p",{className:"mb-2",children:"Dhibiti layout ya product grid kwenye POS."}),e.jsx("p",{className:"mb-2",children:e.jsx("strong",{children:"Recommendations:"})}),e.jsxs("ul",{className:"list-disc pl-4 space-y-1",children:[e.jsx("li",{children:"Screen ndogo: 2-3 bidhaa kwa row"}),e.jsx("li",{children:"Screen wastani: 3-4 bidhaa kwa row"}),e.jsx("li",{children:"Monitor kubwa: 4-6 bidhaa kwa row"}),e.jsx("li",{children:"Ultra-wide: 6-8 bidhaa kwa row"})]})]}),children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(se,{label:"Products Per Row",value:n.products_per_row.toString(),onChange:e=>R("products_per_row",parseInt(e)),options:[{value:"2",label:"2 Products"},{value:"3",label:"3 Products"},{value:"4",label:"4 Products (Default)"},{value:"5",label:"5 Products"},{value:"6",label:"6 Products"},{value:"8",label:"8 Products"}]}),e.jsx(X,{label:"Custom Amount",value:n.products_per_row,onChange:e=>R("products_per_row",e),min:2,max:12,step:1,helpText:"Weka namba kati ya 2 na 12."})]}),e.jsx("div",{className:"mt-4",children:e.jsx(se,{label:"Products Per Page",value:n.products_per_page.toString(),onChange:e=>R("products_per_page",parseInt(e)),options:[{value:"12",label:"12 Products"},{value:"16",label:"16 Products"},{value:"20",label:"20 Products (Default)"},{value:"24",label:"24 Products"},{value:"30",label:"30 Products"},{value:"40",label:"40 Products"},{value:"50",label:"50 Products"},{value:"100",label:"100 Products"}],helpText:"Jumla ya bidhaa za kuonyesha kwa page."})})]}),e.jsx(te,{title:"Behavior Settings",icon:e.jsx(u,{className:"w-5 h-5"}),helpText:"Dhibiti jinsi POS inavyofanya kazi wakati unachangia.",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(Z,{label:"Auto Complete Search",checked:n.auto_complete_search,onChange:e=>R("auto_complete_search",e),helpText:"Onyesha search suggestions wakati unaandika."}),e.jsx(Z,{label:"Confirm Delete",checked:n.confirm_delete,onChange:e=>R("confirm_delete",e),helpText:"Uliza confirmation kabla ya kufuta item."}),e.jsx(Z,{label:"Show Confirmations",checked:n.show_confirmations,onChange:e=>R("show_confirmations",e),helpText:"Onyesha success messages baada ya kumaliza action."}),e.jsx(Z,{label:"Enable Sound Effects",checked:n.enable_sound_effects,onChange:e=>R("enable_sound_effects",e),helpText:"Play sounds wakati unapiga buttons."}),e.jsx(Z,{label:"Enable Animations",checked:n.enable_animations,onChange:e=>R("enable_animations",e),helpText:"Enable smooth transitions na animations."})]})}),e.jsx(te,{title:"Performance Settings",icon:e.jsx(x,{className:"w-5 h-5"}),helpText:"Optimize jinsi POS inavyopakia data kwa speed ya haraka.",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(Z,{label:"Enable Caching",checked:n.enable_caching,onChange:e=>R("enable_caching",e),helpText:"Save data kwa muda ili POS ipake haraka."}),e.jsx(Z,{label:"Enable Lazy Loading",checked:n.enable_lazy_loading,onChange:e=>R("enable_lazy_loading",e),helpText:"Pakia picha na data wakati inahitajika tu."}),e.jsx(X,{label:"Cache Duration (seconds)",value:n.cache_duration,onChange:e=>R("cache_duration",e),min:60,max:3600,step:30,helpText:"Muda wa kukeep cached data kabla ya refresh."}),e.jsx(X,{label:"Max Search Results",value:n.max_search_results,onChange:e=>R("max_search_results",e),min:10,max:200,step:10,helpText:"Maximum ya bidhaa za kuonyesha kwenye search results."})]})}),e.jsx(te,{title:"Tax Settings",icon:e.jsx(g,{className:"w-5 h-5"}),helpText:"Weka automatic tax calculation kwa sales.",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(Z,{label:"Enable Tax",checked:n.enable_tax,onChange:e=>R("enable_tax",e),helpText:"Calculate na ongeza tax automatically kwa sales."}),n.enable_tax&&e.jsx(X,{label:"Tax Rate (%)",value:n.tax_rate,onChange:e=>R("tax_rate",e),min:0,max:50,step:.1,helpText:"Percent ya tax kwa sales (mfano: 18 kwa 18% VAT)."})]})}),e.jsx(te,{title:"Hardware Settings",icon:e.jsx(x,{className:"w-5 h-5"}),helpText:"Weka barcode scanner na vifaa vingine.",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(Z,{label:"Enable Barcode Scanner",checked:n.show_barcodes,onChange:e=>R("show_barcodes",e),helpText:"Scan barcode kuongeza bidhaa haraka kwenye cart."}),e.jsx(Z,{label:"Play Sound on Scan",checked:n.enable_sound_effects,onChange:e=>R("enable_sound_effects",e),helpText:"Play sound wakati barcode imescan successfully."})]})}),e.jsx(te,{title:"Notifications & Alerts",icon:e.jsx(u,{className:"w-5 h-5"}),helpText:"Chagua ni notifications gani zinaonekana kwenye POS.",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(Z,{label:"Low Stock Alerts",checked:n.show_stock_levels,onChange:e=>R("show_stock_levels",e),helpText:"Pata notification wakati stock inaisha."}),e.jsx(Z,{label:"Payment Confirmations",checked:n.show_confirmations,onChange:e=>R("show_confirmations",e),helpText:"Onyesha confirmation messages baada ya payment."})]})}),e.jsx(te,{title:"Security Settings",icon:e.jsx(b,{className:"w-5 h-5"}),helpText:e.jsxs("div",{children:[e.jsx("p",{className:"mb-2",children:e.jsx("strong",{children:"Security Tips:"})}),e.jsxs("ul",{className:"list-disc pl-4 space-y-1",children:[e.jsx("li",{children:"Tumia passcode ambayo unakumbuka lakini ni secure"}),e.jsx("li",{children:'Usitumie "1111" au "1234"'}),e.jsx("li",{children:"Badilisha passcode mara kwa mara"}),e.jsx("li",{children:"Share na wafanyakazi authorized tu"})]})]}),children:e.jsx("div",{className:"bg-amber-50 border-2 border-amber-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(j,{className:"w-5 h-5 text-amber-600 mt-1 flex-shrink-0"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Day Closing Passcode"}),e.jsx("div",{className:"max-w-sm",children:e.jsx(ee,{label:"",value:n.day_closing_passcode||"1234",onChange:e=>R("day_closing_passcode",e),placeholder:"Weka passcode",type:"password",helpText:"Inahitajika kufunga na kufungua siku."})})]})]})})})]})});ne.displayName="GeneralSettingsTab";const ie=l.memo(ne),le=i.forwardRef((s,t)=>{const[n,r]=i.useState({enableDynamicPricing:!0,presets:{happyHour:{id:"happy_hour",name:"Happy Hour",description:"Discount during specific hours",enabled:!1,startTime:"18:00",endTime:"21:00",discountPercent:15},bulkDiscount:{id:"bulk_discount",name:"Bulk Buy Discount",description:"Discount for buying multiple items",enabled:!0,minQuantity:10,discountPercent:10},loyaltyDiscount:{id:"loyalty_discount",name:"VIP Customer Discount",description:"Automatic discount for loyal customers",enabled:!0,discountPercent:5}},showAdvanced:!1}),[o,c]=i.useState(!1);l.useEffect(()=>{(async()=>{c(!0);try{const e=await a.loadDynamicPricingSettings();e&&r({enableDynamicPricing:e.enable_dynamic_pricing??!0,presets:{happyHour:{id:"happy_hour",name:"Happy Hour",description:"Discount during specific hours",enabled:e.enable_time_based_pricing??!1,startTime:e.time_based_start_time??"18:00",endTime:e.time_based_end_time??"21:00",discountPercent:e.time_based_discount_percent??15},bulkDiscount:{id:"bulk_discount",name:"Bulk Buy Discount",description:"Discount for buying multiple items",enabled:e.enable_bulk_pricing??!0,minQuantity:e.bulk_discount_threshold??10,discountPercent:e.bulk_discount_percent??10},loyaltyDiscount:{id:"loyalty_discount",name:"VIP Customer Discount",description:"Automatic discount for loyal customers",enabled:e.enable_loyalty_pricing??!0,discountPercent:e.loyalty_discount_percent??5}},showAdvanced:!1})}catch(e){}finally{c(!1)}})()},[]);const d=async()=>{try{const e={enable_dynamic_pricing:n.enableDynamicPricing,enable_loyalty_pricing:n.presets.loyaltyDiscount.enabled,enable_bulk_pricing:n.presets.bulkDiscount.enabled,enable_time_based_pricing:n.presets.happyHour.enabled,enable_customer_pricing:!1,enable_special_events:!1,loyalty_discount_percent:n.presets.loyaltyDiscount.discountPercent,loyalty_points_threshold:1e3,loyalty_max_discount:20,bulk_discount_enabled:n.presets.bulkDiscount.enabled,bulk_discount_threshold:n.presets.bulkDiscount.minQuantity||10,bulk_discount_percent:n.presets.bulkDiscount.discountPercent,time_based_discount_enabled:n.presets.happyHour.enabled,time_based_start_time:n.presets.happyHour.startTime||"18:00",time_based_end_time:n.presets.happyHour.endTime||"21:00",time_based_discount_percent:n.presets.happyHour.discountPercent,customer_pricing_enabled:!1,vip_customer_discount:10,regular_customer_discount:5,special_events_enabled:!1,special_event_discount_percent:20};return await a.saveDynamicPricingSettings(e),y.success("Pricing settings saved successfully!"),!0}catch(e){return y.error("Failed to save pricing settings"),!1}},m=async()=>{const e={enableDynamicPricing:!0,presets:{happyHour:{id:"happy_hour",name:"Happy Hour",description:"Discount during specific hours",enabled:!1,startTime:"18:00",endTime:"21:00",discountPercent:15},bulkDiscount:{id:"bulk_discount",name:"Bulk Buy Discount",description:"Discount for buying multiple items",enabled:!0,minQuantity:10,discountPercent:10},loyaltyDiscount:{id:"loyalty_discount",name:"VIP Customer Discount",description:"Automatic discount for loyal customers",enabled:!0,discountPercent:5}},showAdvanced:!1};return r(e),localStorage.setItem("lats-pos-pricing",JSON.stringify(e)),y.success("Pricing settings reset to defaults"),!0},h=(e,s)=>{r(a=>({...a,presets:{...a.presets,[e]:{...a.presets[e],enabled:s}}}))},p=(e,s,a)=>{r(t=>({...t,presets:{...t.presets,[e]:{...t.presets[e],[s]:a}}}))};return i.useImperativeHandle(t,()=>({saveSettings:d,resetSettings:m})),e.jsxs(K,{isLoading:o,children:[e.jsx(te,{title:"Dynamic Pricing",icon:e.jsx(_,{className:"w-5 h-5"}),helpText:"Enable automatic pricing rules and discounts that apply during checkout.",children:e.jsx(Z,{id:"enable_dynamic_pricing",label:"Enable Dynamic Pricing",checked:n.enableDynamicPricing,onChange:e=>r(s=>({...s,enableDynamicPricing:e})),helpText:"Master switch to enable/disable all automatic pricing rules and discounts."})}),e.jsx(te,{title:"Discount Presets",icon:e.jsx(f,{className:"w-5 h-5"}),helpText:"Pre-configured discount rules you can enable with one click.",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"border-2 border-gray-200 rounded-lg p-4 bg-white",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(w,{className:"w-5 h-5 text-orange-600"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900",children:"Happy Hour"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Discount during specific hours"})]})]}),e.jsx(Z,{id:"preset_happy_hour",label:"",checked:n.presets.happyHour.enabled,onChange:e=>h("happyHour",e),disabled:!n.enableDynamicPricing,helpText:"Apply discount automatically during specified time period each day."})]}),n.presets.happyHour.enabled&&n.enableDynamicPricing&&e.jsx("div",{className:"pt-4 border-t border-gray-200",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-3 gap-4",children:[e.jsx(ae,{id:"happy_hour_start",label:"Start Time",value:n.presets.happyHour.startTime||"18:00",onChange:e=>p("happyHour","startTime",e),helpText:"When the discount period begins."}),e.jsx(ae,{id:"happy_hour_end",label:"End Time",value:n.presets.happyHour.endTime||"21:00",onChange:e=>p("happyHour","endTime",e),helpText:"When the discount period ends."}),e.jsx(X,{id:"happy_hour_discount",label:"Discount %",value:n.presets.happyHour.discountPercent,onChange:e=>p("happyHour","discountPercent",e),min:1,max:50,step:1,helpText:"Percentage off during happy hour."})]})})]}),e.jsxs("div",{className:"border-2 border-gray-200 rounded-lg p-4 bg-white",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(v,{className:"w-5 h-5 text-blue-600"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900",children:"Bulk Buy Discount"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Discount for buying multiple items"})]})]}),e.jsx(Z,{id:"preset_bulk_discount",label:"",checked:n.presets.bulkDiscount.enabled,onChange:e=>h("bulkDiscount",e),disabled:!n.enableDynamicPricing,helpText:"Reward customers who buy in larger quantities with automatic discounts."})]}),n.presets.bulkDiscount.enabled&&n.enableDynamicPricing&&e.jsx("div",{className:"pt-4 border-t border-gray-200",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(X,{id:"bulk_min_quantity",label:"Minimum Quantity",value:n.presets.bulkDiscount.minQuantity||10,onChange:e=>p("bulkDiscount","minQuantity",e),min:2,max:100,step:1,helpText:"How many items needed to qualify for discount."}),e.jsx(X,{id:"bulk_discount_percent",label:"Discount %",value:n.presets.bulkDiscount.discountPercent,onChange:e=>p("bulkDiscount","discountPercent",e),min:1,max:50,step:1,helpText:"Discount percentage for bulk purchases."})]})})]}),e.jsxs("div",{className:"border-2 border-gray-200 rounded-lg p-4 bg-white",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(N,{className:"w-5 h-5 text-purple-600"}),e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900",children:"VIP Customer Discount"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Automatic discount for loyal customers"})]})]}),e.jsx(Z,{id:"preset_loyalty_discount",label:"",checked:n.presets.loyaltyDiscount.enabled,onChange:e=>h("loyaltyDiscount",e),disabled:!n.enableDynamicPricing,helpText:"Apply automatic discount to VIP or loyalty program members."})]}),n.presets.loyaltyDiscount.enabled&&n.enableDynamicPricing&&e.jsx("div",{className:"pt-4 border-t border-gray-200",children:e.jsx("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:e.jsx(X,{id:"loyalty_discount_percent",label:"Discount %",value:n.presets.loyaltyDiscount.discountPercent,onChange:e=>p("loyaltyDiscount","discountPercent",e),min:1,max:25,step:1,helpText:"Discount percentage for VIP customers."})})})]})]})})]})});le.displayName="DynamicPricingSimplifiedTab";const re=l.memo(le),oe=({settings:s,businessInfo:a})=>{const[t,n]=i.useState(.5),l={transactionId:"TXN-2025-001234",receiptNumber:s.enable_receipt_numbering?s.receipt_number_format.replace("{YEAR}","2025").replace("{NUMBER}","001234"):"RCP-001234",date:(new Date).toLocaleDateString(),time:(new Date).toLocaleTimeString(),cashier:"John Doe",customer:{name:"Jane Smith",phone:"+255 712 345 678"},items:[{name:"Product A",sku:"SKU-001",barcode:"1234567890123",qty:2,price:15e3,total:3e4},{name:"Product B",sku:"SKU-002",barcode:"9876543210987",qty:1,price:25e3,total:25e3},{name:"Product C",sku:"SKU-003",barcode:"5555555555555",qty:3,price:8e3,total:24e3}],subtotal:79e3,discount:5e3,tax:13320,grandTotal:87320,payment:{method:"Cash",amount:9e4,change:2680}},r=s.receipt_template||"standard",o="compact"===r,c="detailed"===r,d="a4"===r,m=d?"210mm":`${s.receipt_width}mm`,h=d?"14px":`${s.receipt_font_size}px`;return e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 sticky top-6",children:[e.jsx("div",{className:"text-sm font-medium text-gray-500 mb-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1 text-center",children:[e.jsxs("div",{children:["Live Preview - ",r.charAt(0).toUpperCase()+r.slice(1)," Template"]}),d&&e.jsx("div",{className:"text-xs text-gray-400 mt-1",children:"A4 Size: 210mm Ã— 297mm"})]}),d&&e.jsxs("div",{className:"flex items-center gap-2 ml-4",children:[e.jsx("button",{onClick:()=>n(Math.max(.3,t-.1)),className:"p-1 hover:bg-gray-100 rounded",title:"Zoom Out",children:e.jsx(k,{className:"w-4 h-4"})}),e.jsxs("span",{className:"text-xs font-mono",children:[Math.round(100*t),"%"]}),e.jsx("button",{onClick:()=>n(Math.min(1,t+.1)),className:"p-1 hover:bg-gray-100 rounded",title:"Zoom In",children:e.jsx(C,{className:"w-4 h-4"})})]})]})}),e.jsx("div",{className:d?"overflow-auto max-h-[calc(100vh-220px)] bg-gray-100 p-4":"",children:e.jsx("div",{className:"bg-white border mx-auto overflow-hidden "+(d?"border-2 border-gray-400 shadow-2xl origin-top":"border border-gray-300"),style:{width:m,maxWidth:"100%",fontSize:h,fontFamily:d?"Arial, sans-serif":"monospace",height:d?"297mm":"auto",minHeight:d?"297mm":"auto",aspectRatio:d?"210/297":void 0,transform:d?`scale(${t})`:void 0,transformOrigin:d?"top center":void 0},children:e.jsxs("div",{className:""+(d?"p-8 space-y-4":"p-4 "+(o?"space-y-1":"space-y-2")),children:[d?e.jsx(e.Fragment,{children:e.jsxs("div",{className:"flex justify-between items-start border-b-2 border-gray-800 pb-4 mb-4",children:[e.jsxs("div",{className:"flex-1",children:[s.show_business_logo&&(null==a?void 0:a.logo)&&e.jsx("img",{src:a.logo,alt:"Logo",className:"h-16 object-contain mb-2"}),s.show_business_name&&e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:(null==a?void 0:a.name)||"inauzwa"}),s.show_business_address&&e.jsx("div",{className:"text-sm text-gray-700 mt-1",children:(null==a?void 0:a.address)||"123 Business Street, City"}),e.jsxs("div",{className:"text-sm text-gray-700 mt-1 space-y-0.5",children:[s.show_business_phone&&e.jsxs("div",{children:["Phone: ",(null==a?void 0:a.phone)||"+255 123 456 789"]}),s.show_business_email&&e.jsxs("div",{children:["Email: ",(null==a?void 0:a.email)||"info@business.com"]}),s.show_business_website&&e.jsxs("div",{children:["Web: ",(null==a?void 0:a.website)||"www.business.com"]})]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("div",{className:"text-3xl font-bold text-gray-900",children:"INVOICE"}),s.enable_receipt_numbering&&e.jsxs("div",{className:"text-sm text-gray-600 mt-1",children:["Receipt #: ",e.jsx("span",{className:"font-semibold",children:l.receiptNumber})]})]})]})}):e.jsxs(e.Fragment,{children:[s.show_business_logo&&(null==a?void 0:a.logo)&&!o&&e.jsx("div",{className:"text-center mb-2",children:e.jsx("img",{src:a.logo,alt:"Logo",className:"h-12 mx-auto object-contain"})}),e.jsxs("div",{className:"text-center border-b border-dashed border-gray-400 pb-2",children:[s.show_business_name&&e.jsx("div",{className:"font-bold "+(o?"text-base":"text-lg"),children:(null==a?void 0:a.name)||"inauzwa"}),s.show_business_address&&!o&&e.jsx("div",{className:"text-xs",children:(null==a?void 0:a.address)||"123 Business Street, City"}),s.show_business_phone&&e.jsx("div",{className:"text-xs",children:(null==a?void 0:a.phone)||"+255 123 456 789"}),s.show_business_email&&!o&&(c||s.show_business_email)&&e.jsx("div",{className:"text-xs",children:(null==a?void 0:a.email)||"info@business.com"}),s.show_business_website&&!o&&(c||s.show_business_website)&&e.jsx("div",{className:"text-xs",children:(null==a?void 0:a.website)||"www.business.com"})]})]}),d?e.jsxs("div",{className:"grid grid-cols-2 gap-8 text-sm bg-gray-50 p-4 rounded",children:[e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-gray-900 mb-2",children:"Invoice Details"}),s.show_transaction_id&&e.jsxs("div",{className:"flex justify-between mb-1",children:[e.jsx("span",{className:"text-gray-600",children:"Transaction ID:"}),e.jsx("span",{className:"font-medium",children:l.transactionId})]}),s.show_date_time&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between mb-1",children:[e.jsx("span",{className:"text-gray-600",children:"Date:"}),e.jsx("span",{className:"font-medium",children:l.date})]}),e.jsxs("div",{className:"flex justify-between mb-1",children:[e.jsx("span",{className:"text-gray-600",children:"Time:"}),e.jsx("span",{className:"font-medium",children:l.time})]})]}),s.show_cashier_name&&e.jsxs("div",{className:"flex justify-between mb-1",children:[e.jsx("span",{className:"text-gray-600",children:"Cashier:"}),e.jsx("span",{className:"font-medium",children:l.cashier})]})]}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-gray-900 mb-2",children:"Customer Details"}),s.show_customer_name&&e.jsxs("div",{className:"flex justify-between mb-1",children:[e.jsx("span",{className:"text-gray-600",children:"Name:"}),e.jsx("span",{className:"font-medium",children:l.customer.name})]}),s.show_customer_phone&&e.jsxs("div",{className:"flex justify-between mb-1",children:[e.jsx("span",{className:"text-gray-600",children:"Phone:"}),e.jsx("span",{className:"font-medium",children:l.customer.phone})]})]})]}):e.jsxs("div",{className:`text-xs ${o?"space-y-0.5":"space-y-1"} border-b border-dashed border-gray-400 pb-2`,children:[s.show_transaction_id&&!o&&(c||s.show_transaction_id)&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Transaction ID:"}),e.jsx("span",{className:"font-semibold",children:l.transactionId})]}),s.enable_receipt_numbering&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Receipt #:"}),e.jsx("span",{className:"font-semibold",children:l.receiptNumber})]}),s.show_date_time&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Date:"}),e.jsx("span",{children:l.date})]}),!o&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Time:"}),e.jsx("span",{children:l.time})]})]}),s.show_cashier_name&&!o&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Cashier:"}),e.jsx("span",{children:l.cashier})]}),s.show_customer_name&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Customer:"}),e.jsx("span",{children:l.customer.name})]}),s.show_customer_phone&&!o&&(c||s.show_customer_phone)&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Phone:"}),e.jsx("span",{children:l.customer.phone})]})]}),d?e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"font-semibold text-lg text-gray-900 mb-3",children:"Items"}),e.jsxs("table",{className:"w-full text-sm",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"border-b-2 border-gray-800 text-left",children:[e.jsx("th",{className:"pb-2 font-semibold",children:"#"}),s.show_product_names&&e.jsx("th",{className:"pb-2 font-semibold",children:"Item"}),s.show_product_skus&&e.jsx("th",{className:"pb-2 font-semibold",children:"SKU"}),s.show_quantities&&e.jsx("th",{className:"pb-2 font-semibold text-center",children:"Qty"}),s.show_unit_prices&&e.jsx("th",{className:"pb-2 font-semibold text-right",children:"Price"}),e.jsx("th",{className:"pb-2 font-semibold text-right",children:"Total"})]})}),e.jsx("tbody",{children:l.items.map((a,t)=>e.jsxs("tr",{className:"border-b border-gray-200",children:[e.jsx("td",{className:"py-2",children:t+1}),s.show_product_names&&e.jsxs("td",{className:"py-2",children:[e.jsx("div",{className:"font-medium",children:a.name}),s.show_product_barcodes&&e.jsx("div",{className:"text-xs text-gray-500",children:a.barcode})]}),s.show_product_skus&&e.jsx("td",{className:"py-2 text-gray-600",children:a.sku}),s.show_quantities&&e.jsx("td",{className:"py-2 text-center",children:a.qty}),s.show_unit_prices&&e.jsx("td",{className:"py-2 text-right",children:Q.money(a.price)}),e.jsx("td",{className:"py-2 text-right font-medium",children:Q.money(a.total)})]},t))})]})]}):e.jsxs("div",{className:"text-xs border-b border-dashed border-gray-400 pb-2",children:[e.jsx("div",{className:"font-bold mb-1",children:"ITEMS"}),l.items.map((a,t)=>e.jsx("div",{className:o?"mb-0.5":"mb-1",children:o?e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{children:[a.name," x",a.qty]}),e.jsx("span",{className:"font-semibold",children:a.total.toLocaleString()})]}):e.jsxs(e.Fragment,{children:[s.show_product_names&&e.jsx("div",{className:"font-semibold",children:a.name}),e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[s.show_product_skus&&!o&&e.jsxs("div",{className:"text-gray-600",children:["SKU: ",a.sku]}),s.show_product_barcodes&&(c||s.show_product_barcodes)&&!o&&e.jsx("div",{className:"text-gray-600",children:a.barcode}),s.show_quantities&&s.show_unit_prices&&e.jsxs("div",{children:[a.qty," x ",Q.money(a.price)]})]}),e.jsx("div",{className:"font-semibold",children:Q.money(a.total)})]})]})},t))]}),d?e.jsx("div",{className:"flex justify-end mt-6",children:e.jsxs("div",{className:"w-80 bg-gray-50 p-4 rounded border border-gray-300",children:[e.jsxs("div",{className:"space-y-2 text-sm",children:[s.show_subtotal&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-700",children:"Subtotal:"}),e.jsx("span",{className:"font-medium",children:Q.money(l.subtotal)})]}),s.show_discounts&&s.show_discount_total&&l.discount>0&&e.jsxs("div",{className:"flex justify-between text-green-600",children:[e.jsx("span",{children:"Discount:"}),e.jsxs("span",{className:"font-medium",children:["-",Q.money(l.discount)]})]}),s.show_tax&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-700",children:"Tax (18%):"}),e.jsx("span",{className:"font-medium",children:Q.money(l.tax)})]}),s.show_grand_total&&e.jsxs("div",{className:"flex justify-between font-bold text-lg border-t-2 border-gray-800 pt-2 mt-2",children:[e.jsx("span",{children:"TOTAL:"}),e.jsx("span",{children:Q.money(l.grandTotal)})]})]}),(s.show_payment_method||s.show_change_amount)&&e.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-300 text-sm space-y-1",children:[s.show_payment_method&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-700",children:"Payment Method:"}),e.jsx("span",{className:"font-medium",children:l.payment.method})]}),s.show_change_amount&&l.payment.change>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-700",children:"Cash Received:"}),e.jsx("span",{className:"font-medium",children:Q.money(l.payment.amount)})]}),e.jsxs("div",{className:"flex justify-between font-semibold text-green-600",children:[e.jsx("span",{children:"Change:"}),e.jsx("span",{children:Q.money(l.payment.change)})]})]})]})]})}):e.jsxs("div",{className:"text-xs "+(o?"space-y-0.5":"space-y-1"),children:[s.show_subtotal&&!o&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Subtotal:"}),e.jsx("span",{children:Q.money(l.subtotal)})]}),s.show_discounts&&s.show_discount_total&&l.discount>0&&!o&&e.jsxs("div",{className:"flex justify-between text-green-600",children:[e.jsx("span",{children:"Discount:"}),e.jsxs("span",{children:["-",Q.money(l.discount)]})]}),s.show_tax&&!o&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Tax (18%):"}),e.jsx("span",{children:Q.money(l.tax)})]}),s.show_grand_total&&e.jsxs("div",{className:`flex justify-between font-bold ${o?"text-sm":"text-base"} border-t border-gray-400 pt-1 mt-1`,children:[e.jsx("span",{children:"TOTAL:"}),e.jsx("span",{children:Q.money(l.grandTotal)})]})]}),!d&&(s.show_payment_method||s.show_change_amount)&&e.jsxs("div",{className:"text-xs space-y-1 border-t border-dashed border-gray-400 pt-2",children:[s.show_payment_method&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Payment Method:"}),e.jsx("span",{children:l.payment.method})]}),s.show_change_amount&&l.payment.change>0&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{children:"Cash:"}),e.jsx("span",{children:Q.money(l.payment.amount)})]}),e.jsxs("div",{className:"flex justify-between font-semibold",children:[e.jsx("span",{children:"Change:"}),e.jsx("span",{children:Q.money(l.payment.change)})]})]})]}),(s.show_footer_message||s.show_return_policy)&&e.jsxs("div",{className:(d?"text-sm mt-8 pt-6 border-t-2 border-gray-800":"text-xs text-center border-t border-dashed border-gray-400 pt-2 mt-2")+" space-y-2",children:[s.show_footer_message&&s.footer_message&&e.jsx("div",{className:""+(d?"text-center text-base font-medium text-gray-700":"font-medium"),children:s.footer_message}),s.show_return_policy&&s.return_policy_text&&e.jsxs("div",{className:""+(d?"text-xs text-gray-600 bg-gray-50 p-3 rounded":"text-gray-600 text-[10px]"),children:[e.jsx("span",{className:d?"font-semibold":"",children:"Return Policy: "}),s.return_policy_text]})]})]})})})]})},ce=i.forwardRef((s,a)=>{J();const{settings:n,setSettings:l,loading:r,error:o,saveSettings:c,resetSettings:d}=t(),{businessInfo:m}=Y(),h=async()=>await c(n),x=async()=>await d(),g=(e,s)=>{l(a=>({...a,[e]:s}))};return i.useImperativeHandle(a,()=>({saveSettings:h,resetSettings:x})),r?e.jsxs("div",{className:"flex items-center justify-center p-8",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"}),e.jsx("span",{className:"ml-2 text-gray-600",children:"Loading settings..."})]}):o?e.jsx("div",{className:"p-4 bg-red-50 border border-red-200 rounded-lg",children:e.jsxs("p",{className:"text-red-600",children:["Error: ",o]})}):e.jsx(K,{isLoading:r,children:e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"space-y-6",children:[e.jsx(te,{title:"Receipt Template",icon:e.jsx(S,{className:"w-5 h-5"}),helpText:"Chagua receipt template na customize size kwa printer yako.",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx(se,{id:"receipt_template",label:"Receipt Template",value:n.receipt_template,onChange:e=>g("receipt_template",e),options:[{value:"standard",label:"Standard - 80mm thermal (recommended)"},{value:"compact",label:"Compact - 58mm thermal"},{value:"detailed",label:"Detailed - 80mm with all info"},{value:"a4",label:"A4 - Full page invoice"},{value:"custom",label:"Custom - Your preferences"}]}),e.jsxs("div",{className:"mt-2 text-xs text-gray-500",children:["compact"===n.receipt_template&&"ðŸ“‹ Compact: Shows only essential info - great for 58mm thermal printers!","standard"===n.receipt_template&&"ðŸ“‹ Standard: Balanced layout for 80mm thermal printers","detailed"===n.receipt_template&&"ðŸ“‹ Detailed: All information on 80mm thermal paper","a4"===n.receipt_template&&"ðŸ“‹ A4: Full-page invoice format (210mm) - professional look!","custom"===n.receipt_template&&"ðŸ“‹ Custom: Use your own settings below"]})]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(X,{id:"receipt_width",label:"Receipt Width (mm)",value:n.receipt_width,onChange:e=>g("receipt_width",e),min:40,max:120,step:5}),e.jsx(X,{id:"receipt_font_size",label:"Font Size (px)",value:n.receipt_font_size,onChange:e=>g("receipt_font_size",e),min:8,max:16,step:1})]})]})}),e.jsx(te,{title:"Taarifa za Duka",icon:e.jsx(P,{className:"w-5 h-5"}),helpText:"Chagua ni taarifa gani za duka zinaonekana kwenye receipt.",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(Z,{id:"show_business_logo",label:"Show Logo",checked:n.show_business_logo,onChange:e=>g("show_business_logo",e)}),e.jsx(Z,{id:"show_business_name",label:"Show Name",checked:n.show_business_name,onChange:e=>g("show_business_name",e)}),e.jsx(Z,{id:"show_business_address",label:"Show Address",checked:n.show_business_address,onChange:e=>g("show_business_address",e)}),e.jsx(Z,{id:"show_business_phone",label:"Show Phone",checked:n.show_business_phone,onChange:e=>g("show_business_phone",e)}),e.jsx(Z,{id:"show_business_email",label:"Show Email",checked:n.show_business_email,onChange:e=>g("show_business_email",e)}),e.jsx(Z,{id:"show_business_website",label:"Show Website",checked:n.show_business_website,onChange:e=>g("show_business_website",e)})]})}),e.jsx(te,{title:"Transaction Details",icon:e.jsx(T,{className:"w-5 h-5"}),helpText:"Choose which transaction information to display on receipts.",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(Z,{id:"show_transaction_id",label:"Transaction ID",checked:n.show_transaction_id,onChange:e=>g("show_transaction_id",e)}),e.jsx(Z,{id:"show_date_time",label:"Date & Time",checked:n.show_date_time,onChange:e=>g("show_date_time",e)}),e.jsx(Z,{id:"show_cashier_name",label:"Cashier Name",checked:n.show_cashier_name,onChange:e=>g("show_cashier_name",e)}),e.jsx(Z,{id:"show_customer_name",label:"Customer Name",checked:n.show_customer_name,onChange:e=>g("show_customer_name",e)}),e.jsx(Z,{id:"show_customer_phone",label:"Customer Phone",checked:n.show_customer_phone,onChange:e=>g("show_customer_phone",e)})]})}),e.jsx(te,{title:"Product Details",icon:e.jsx(D,{className:"w-5 h-5"}),helpText:"Control which product information appears in the receipt line items.",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(Z,{id:"show_product_names",label:"Product Names",checked:n.show_product_names,onChange:e=>g("show_product_names",e)}),e.jsx(Z,{id:"show_product_skus",label:"Product SKUs",checked:n.show_product_skus,onChange:e=>g("show_product_skus",e)}),e.jsx(Z,{id:"show_product_barcodes",label:"Barcodes",checked:n.show_product_barcodes,onChange:e=>g("show_product_barcodes",e)}),e.jsx(Z,{id:"show_quantities",label:"Quantities",checked:n.show_quantities,onChange:e=>g("show_quantities",e)}),e.jsx(Z,{id:"show_unit_prices",label:"Item Prices",checked:n.show_unit_prices,onChange:e=>g("show_unit_prices",e)}),e.jsx(Z,{id:"show_discounts",label:"Discounts",checked:n.show_discounts,onChange:e=>g("show_discounts",e)})]})}),e.jsx(te,{title:"Totals & Summary",icon:e.jsx(u,{className:"w-5 h-5"}),helpText:"Choose which summary totals to show at the bottom of receipts.",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(Z,{id:"show_subtotal",label:"Subtotal",checked:n.show_subtotal,onChange:e=>g("show_subtotal",e)}),e.jsx(Z,{id:"show_tax",label:"Tax",checked:n.show_tax,onChange:e=>g("show_tax",e)}),e.jsx(Z,{id:"show_discount_total",label:"Discount Total",checked:n.show_discount_total,onChange:e=>g("show_discount_total",e)}),e.jsx(Z,{id:"show_grand_total",label:"Grand Total",checked:n.show_grand_total,onChange:e=>g("show_grand_total",e)}),e.jsx(Z,{id:"show_payment_method",label:"Payment Method",checked:n.show_payment_method,onChange:e=>g("show_payment_method",e)}),e.jsx(Z,{id:"show_change_amount",label:"Change Amount",checked:n.show_change_amount,onChange:e=>g("show_change_amount",e)})]})}),e.jsx(te,{title:"Print Settings",icon:e.jsx(I,{className:"w-5 h-5"}),helpText:"Weka automatic printing na options za duplicate receipt.",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(Z,{id:"auto_print_receipt",label:"Auto Print",checked:n.auto_print_receipt,onChange:e=>g("auto_print_receipt",e)}),e.jsx(Z,{id:"print_duplicate_receipt",label:"Print Duplicate",checked:n.print_duplicate_receipt,onChange:e=>g("print_duplicate_receipt",e)}),e.jsx(Z,{id:"enable_email_receipt",label:"Email Receipt",checked:n.enable_email_receipt,onChange:e=>g("enable_email_receipt",e)}),e.jsx(Z,{id:"enable_sms_receipt",label:"SMS Receipt",checked:n.enable_sms_receipt,onChange:e=>g("enable_sms_receipt",e)})]})}),e.jsx(te,{title:"WhatsApp PDF & Receipt Sharing",icon:e.jsx(A,{className:"w-5 h-5"}),helpText:"Send beautifully formatted PDF receipts directly to customers' WhatsApp.",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(Z,{id:"enable_whatsapp_pdf",label:"Enable WhatsApp PDF Receipts",checked:n.enable_whatsapp_pdf??!1,onChange:e=>g("enable_whatsapp_pdf",e),helpText:"Allow sending receipts as PDF via WhatsApp"}),n.enable_whatsapp_pdf&&e.jsxs("div",{className:"pl-4 space-y-4 border-l-2 border-green-300",children:[e.jsx(Z,{id:"whatsapp_pdf_auto_send",label:"Auto-send PDF after payment",checked:n.whatsapp_pdf_auto_send??!1,onChange:e=>g("whatsapp_pdf_auto_send",e),helpText:n.whatsapp_pdf_auto_send?"âœ… PDF will be sent automatically":"Manual: Staff clicks 'Send PDF' button"}),e.jsx(Z,{id:"whatsapp_pdf_show_preview",label:"Show preview before sending",checked:n.whatsapp_pdf_show_preview??!1,onChange:e=>g("whatsapp_pdf_show_preview",e),helpText:"Allow staff to review PDF before sending"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(se,{id:"whatsapp_pdf_format",label:"PDF Format",value:n.whatsapp_pdf_format||"a4",onChange:e=>g("whatsapp_pdf_format",e),options:[{value:"a4",label:"A4 (210 x 297 mm) - Standard"},{value:"letter",label:"Letter (216 x 279 mm) - US Standard"},{value:"thermal",label:"Thermal (80mm width)"}]}),e.jsx(se,{id:"whatsapp_pdf_quality",label:"PDF Quality",value:n.whatsapp_pdf_quality||"standard",onChange:e=>g("whatsapp_pdf_quality",e),options:[{value:"high",label:"High Quality (larger file)"},{value:"standard",label:"Standard Quality (recommended)"},{value:"compressed",label:"Compressed (smaller file)"}]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Include in PDF"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(Z,{id:"whatsapp_pdf_include_logo",label:"Business Logo",checked:n.whatsapp_pdf_include_logo??!0,onChange:e=>g("whatsapp_pdf_include_logo",e)}),e.jsx(Z,{id:"whatsapp_pdf_include_images",label:"Item Images",checked:n.whatsapp_pdf_include_images??!1,onChange:e=>g("whatsapp_pdf_include_images",e)}),e.jsx(Z,{id:"whatsapp_pdf_include_qr",label:"QR Code",checked:n.whatsapp_pdf_include_qr??!0,onChange:e=>g("whatsapp_pdf_include_qr",e)}),e.jsx(Z,{id:"whatsapp_pdf_include_barcode",label:"Barcode",checked:n.whatsapp_pdf_include_barcode??!1,onChange:e=>g("whatsapp_pdf_include_barcode",e)})]})]}),e.jsx(ee,{id:"whatsapp_pdf_message",label:"WhatsApp Message (sent with PDF)",value:n.whatsapp_pdf_message||"Thank you for your purchase! Please find your receipt attached.",onChange:e=>g("whatsapp_pdf_message",e),placeholder:"Message sent with PDF...",helpText:"This message will be sent along with the PDF receipt"}),e.jsxs("button",{type:"button",className:"flex items-center gap-2 px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 transition-colors",onClick:()=>{alert("PDF Preview coming soon!")},children:[e.jsx(p,{className:"w-4 h-4"}),"Preview PDF Receipt"]})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-3",children:"Other Sharing Options"}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(Z,{id:"enable_email_pdf",label:"Enable Email PDF",checked:n.enable_email_pdf??!0,onChange:e=>g("enable_email_pdf",e)}),e.jsx(Z,{id:"enable_print_pdf",label:"Enable Print PDF",checked:n.enable_print_pdf??!0,onChange:e=>g("enable_print_pdf",e)}),e.jsx(Z,{id:"enable_download_pdf",label:"Enable Download PDF",checked:n.enable_download_pdf??!0,onChange:e=>g("enable_download_pdf",e)}),e.jsx(Z,{id:"show_share_button",label:"Show Share Button",checked:n.show_share_button??!0,onChange:e=>g("show_share_button",e)})]})]})]})}),e.jsx(te,{title:"Receipt Numbering",icon:e.jsx(S,{className:"w-5 h-5"}),helpText:"Configure automatic receipt numbering with custom prefixes and formats.",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(Z,{id:"enable_receipt_numbering",label:"Enable Receipt Numbering",checked:n.enable_receipt_numbering,onChange:e=>g("enable_receipt_numbering",e)}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(ee,{id:"receipt_number_prefix",label:"Receipt Prefix",value:n.receipt_number_prefix,onChange:e=>g("receipt_number_prefix",e),placeholder:"RCP"}),e.jsx(X,{id:"receipt_number_start",label:"Start Number",value:n.receipt_number_start,onChange:e=>g("receipt_number_start",e),min:1,max:999999,step:1})]}),e.jsx(ee,{id:"receipt_number_format",label:"Number Format",value:n.receipt_number_format,onChange:e=>g("receipt_number_format",e),placeholder:"RCP-{YEAR}-{NUMBER}",helpText:"Use {YEAR} for year, {NUMBER} for auto-increment number"})]})}),e.jsx(te,{title:"Footer Message",icon:e.jsx(S,{className:"w-5 h-5"}),helpText:"Weka message ya mwisho kwenye receipt yako.",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(Z,{id:"show_footer_message",label:"Show Footer Message",checked:n.show_footer_message,onChange:e=>g("show_footer_message",e)}),e.jsx(ee,{id:"footer_message",label:"Footer Message",value:n.footer_message,onChange:e=>g("footer_message",e),placeholder:"Asante kwa kununua!"}),e.jsx(Z,{id:"show_return_policy",label:"Show Return Policy",checked:n.show_return_policy,onChange:e=>g("show_return_policy",e)}),e.jsx(ee,{id:"return_policy_text",label:"Return Policy Text",value:n.return_policy_text,onChange:e=>g("return_policy_text",e),placeholder:"Returns accepted within 7 days with receipt"})]})})]}),e.jsx("div",{className:"lg:block hidden",children:e.jsx("div",{className:"sticky top-6",children:e.jsxs("div",{className:"bg-gradient-to-r from-purple-50 to-blue-50 border-2 border-purple-200 rounded-lg p-4 shadow-lg",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx(p,{className:"w-6 h-6 text-purple-600"}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Live Preview"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Real-time preview"})]})]}),e.jsx("div",{className:"mt-4 max-h-[calc(100vh-200px)] overflow-y-auto",children:e.jsx(oe,{settings:n,businessInfo:{name:(null==m?void 0:m.name)||"",address:(null==m?void 0:m.address)||"",phone:(null==m?void 0:m.phone)||"",email:(null==m?void 0:m.email)||"",website:(null==m?void 0:m.website)||"",logo:(null==m?void 0:m.logo)||void 0}})})]})})})]})})});ce.displayName="ImprovedReceiptSettings";const de=l.memo(ce),me=i.forwardRef((s,a)=>{J();const[t,n]=i.useState({enableDelivery:!1,enableLoyaltyProgram:!0,enableCustomerProfiles:!0,enablePaymentTracking:!0,enableDynamicPricing:!0}),[r]=i.useState(!1);l.useEffect(()=>{try{const e=localStorage.getItem("lats-pos-features");e&&n(JSON.parse(e))}catch(e){}},[]);const o=async()=>{try{return localStorage.setItem("lats-pos-features",JSON.stringify(t)),y.success("Features saved successfully!"),!0}catch(e){return y.error("Failed to save features"),!1}},c=async()=>{const e={enableDelivery:!1,enableLoyaltyProgram:!0,enableCustomerProfiles:!0,enablePaymentTracking:!0,enableDynamicPricing:!0};return n(e),localStorage.setItem("lats-pos-features",JSON.stringify(e)),y.success("Features reset to defaults"),!0},d=(e,s)=>{n(a=>({...a,[e]:s}))};return i.useImperativeHandle(a,()=>({saveSettings:o,resetSettings:c})),e.jsx(K,{isLoading:r,children:e.jsx(te,{title:"Optional Features",icon:e.jsx(R,{className:"w-5 h-5"}),helpText:"Chagua features unazotaka. Features ambazo haziko enabled hazitaonekana kwenye POS.",children:e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"bg-white border-2 border-gray-200 rounded-lg p-4 hover:border-blue-300 transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[e.jsx("div",{className:"p-2 bg-blue-50 rounded-lg",children:e.jsx(F,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-1",children:"Delivery Management"}),e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Weka delivery orders, driver assignment, na tracking."}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("span",{className:"text-xs px-2 py-1 bg-blue-50 text-blue-700 rounded",children:"Driver Tracking"}),e.jsx("span",{className:"text-xs px-2 py-1 bg-blue-50 text-blue-700 rounded",children:"Delivery Areas"}),e.jsx("span",{className:"text-xs px-2 py-1 bg-blue-50 text-blue-700 rounded",children:"Fee Management"})]})]})]}),e.jsx(Z,{id:"enable-delivery",label:"",checked:t.enableDelivery,onChange:e=>d("enableDelivery",e)})]}),t.enableDelivery&&e.jsx("div",{className:"mt-3 pt-3 border-t border-gray-200",children:e.jsxs("div",{className:"flex items-center gap-2 text-sm text-green-600",children:[e.jsx(M,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium",children:"Active"}),e.jsx("span",{className:"text-gray-500",children:"- Delivery options zitaonekana kwenye POS"})]})})]}),e.jsxs("div",{className:"bg-white border-2 border-gray-200 rounded-lg p-4 hover:border-purple-300 transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[e.jsx("div",{className:"p-2 bg-purple-50 rounded-lg",children:e.jsx(E,{className:"w-5 h-5 text-purple-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-1",children:"Loyalty Program"}),e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Wapa customers points, track loyalty tiers, na discounts."}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("span",{className:"text-xs px-2 py-1 bg-purple-50 text-purple-700 rounded",children:"Points System"}),e.jsx("span",{className:"text-xs px-2 py-1 bg-purple-50 text-purple-700 rounded",children:"Member Discounts"}),e.jsx("span",{className:"text-xs px-2 py-1 bg-purple-50 text-purple-700 rounded",children:"Rewards"})]})]})]}),e.jsx(Z,{id:"enable-loyalty",label:"",checked:t.enableLoyaltyProgram,onChange:e=>d("enableLoyaltyProgram",e)})]}),t.enableLoyaltyProgram&&e.jsx("div",{className:"mt-3 pt-3 border-t border-gray-200",children:e.jsxs("div",{className:"flex items-center gap-2 text-sm text-green-600",children:[e.jsx(M,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium",children:"Active"}),e.jsx("span",{className:"text-gray-500",children:"- Loyalty features ziko enabled kwenye POS"})]})})]}),e.jsxs("div",{className:"bg-white border-2 border-gray-200 rounded-lg p-4 hover:border-green-300 transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[e.jsx("div",{className:"p-2 bg-green-50 rounded-lg",children:e.jsx(z,{className:"w-5 h-5 text-green-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-1",children:"Customer Profiles"}),e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Save taarifa za customers, historia ya manunuzi, na preferences."}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("span",{className:"text-xs px-2 py-1 bg-green-50 text-green-700 rounded",children:"Purchase History"}),e.jsx("span",{className:"text-xs px-2 py-1 bg-green-50 text-green-700 rounded",children:"Contact Info"}),e.jsx("span",{className:"text-xs px-2 py-1 bg-green-50 text-green-700 rounded",children:"Preferences"})]})]})]}),e.jsx(Z,{id:"enable-customer-profiles",label:"",checked:t.enableCustomerProfiles,onChange:e=>d("enableCustomerProfiles",e)})]}),t.enableCustomerProfiles&&e.jsx("div",{className:"mt-3 pt-3 border-t border-gray-200",children:e.jsxs("div",{className:"flex items-center gap-2 text-sm text-green-600",children:[e.jsx(M,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium",children:"Active"}),e.jsx("span",{className:"text-gray-500",children:"- Customer selection inapatikana kwenye POS"})]})})]}),e.jsxs("div",{className:"bg-white border-2 border-gray-200 rounded-lg p-4 hover:border-orange-300 transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[e.jsx("div",{className:"p-2 bg-orange-50 rounded-lg",children:e.jsx(O,{className:"w-5 h-5 text-orange-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-1",children:"Payment Tracking"}),e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Track partial payments, payment plans, na deni za customers."}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("span",{className:"text-xs px-2 py-1 bg-orange-50 text-orange-700 rounded",children:"Partial Payments"}),e.jsx("span",{className:"text-xs px-2 py-1 bg-orange-50 text-orange-700 rounded",children:"Payment Plans"}),e.jsx("span",{className:"text-xs px-2 py-1 bg-orange-50 text-orange-700 rounded",children:"Balance Tracking"})]})]})]}),e.jsx(Z,{id:"enable-payment-tracking",label:"",checked:t.enablePaymentTracking,onChange:e=>d("enablePaymentTracking",e)})]}),t.enablePaymentTracking&&e.jsx("div",{className:"mt-3 pt-3 border-t border-gray-200",children:e.jsxs("div",{className:"flex items-center gap-2 text-sm text-green-600",children:[e.jsx(M,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium",children:"Active"}),e.jsx("span",{className:"text-gray-500",children:"- Payment tracking iko enabled"})]})})]}),e.jsxs("div",{className:"bg-white border-2 border-gray-200 rounded-lg p-4 hover:border-yellow-300 transition-colors",children:[e.jsxs("div",{className:"flex items-start justify-between gap-4",children:[e.jsxs("div",{className:"flex items-start gap-3 flex-1",children:[e.jsx("div",{className:"p-2 bg-yellow-50 rounded-lg",children:e.jsx(x,{className:"w-5 h-5 text-yellow-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-1",children:"Dynamic Pricing"}),e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Weka bei special kwa wakati fulani, bulk discounts, na promotions."}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx("span",{className:"text-xs px-2 py-1 bg-yellow-50 text-yellow-700 rounded",children:"Happy Hour"}),e.jsx("span",{className:"text-xs px-2 py-1 bg-yellow-50 text-yellow-700 rounded",children:"Bulk Discounts"}),e.jsx("span",{className:"text-xs px-2 py-1 bg-yellow-50 text-yellow-700 rounded",children:"Promotions"})]})]})]}),e.jsx(Z,{id:"enable-dynamic-pricing",label:"",checked:t.enableDynamicPricing,onChange:e=>d("enableDynamicPricing",e)})]}),t.enableDynamicPricing&&e.jsx("div",{className:"mt-3 pt-3 border-t border-gray-200",children:e.jsxs("div",{className:"flex items-center gap-2 text-sm text-green-600",children:[e.jsx(M,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium",children:"Active"}),e.jsx("span",{className:"text-gray-500",children:"- Dynamic pricing rules ziko applied"})]})})]})]})})})});me.displayName="FeaturesTab";const he=l.memo(me),pe=i.forwardRef((s,a)=>{var t,n,r,o,c,m,h,p,x,g,_,f,w;const[v,N]=i.useState({mode:"simple",defaultRole:"cashier",customPermissions:{enable_pos_access:!0,enable_sales_access:!0,enable_refunds_access:!1,enable_discount_access:!1,enable_inventory_view:!0,enable_inventory_edit:!1,enable_product_creation:!1,enable_customer_view:!0,enable_customer_creation:!0,enable_daily_reports:!1,enable_financial_reports:!1,enable_settings_access:!1,enable_user_management:!1}}),[k,C]=i.useState(!1),[S,P]=i.useState(!1);i.useState(!1),l.useEffect(()=>{try{const e=localStorage.getItem("lats-pos-permissions");e&&N(JSON.parse(e))}catch(e){}},[]);const T=async()=>{C(!0);try{return localStorage.setItem("lats-pos-permissions",JSON.stringify(v)),y.success("Permissions saved successfully!"),!0}catch(e){return y.error("Failed to save permissions"),!1}finally{C(!1)}},D=async()=>{const e={mode:"simple",defaultRole:"cashier",customPermissions:{enable_pos_access:!0,enable_sales_access:!0,enable_refunds_access:!1,enable_discount_access:!1,enable_inventory_view:!0,enable_inventory_edit:!1,enable_product_creation:!1,enable_customer_view:!0,enable_customer_creation:!0,enable_daily_reports:!1,enable_financial_reports:!1,enable_settings_access:!1,enable_user_management:!1}};return N(e),localStorage.setItem("lats-pos-permissions",JSON.stringify(e)),y.success("Permissions reset to defaults"),!0},I=e=>{N(s=>({...s,defaultRole:e}))},A=(e,s)=>{N(a=>({...a,customPermissions:{...a.customPermissions,[e]:s}}))};i.useImperativeHandle(a,()=>({saveSettings:T,resetSettings:D}));const R={cashier:{title:"Cashier",description:"Basic sales and customer service access",permissions:[{text:"Process sales",allowed:!0},{text:"View products and prices",allowed:!0},{text:"View inventory levels",allowed:!0},{text:"Create/edit customers",allowed:!0},{text:"Cannot issue refunds",allowed:!1},{text:"Cannot access reports",allowed:!1},{text:"Cannot change settings",allowed:!1}]},manager:{title:"Manager",description:"Full operational access with reports",permissions:[{text:"Everything Cashier can do",allowed:!0},{text:"Process refunds",allowed:!0},{text:"Apply discounts",allowed:!0},{text:"Manage inventory",allowed:!0},{text:"Create/edit products",allowed:!0},{text:"View daily reports",allowed:!0},{text:"Cannot access system settings",allowed:!1},{text:"Cannot manage users",allowed:!1}]},admin:{title:"Administrator",description:"Complete system access",permissions:[{text:"Everything Manager can do",allowed:!0},{text:"View financial reports",allowed:!0},{text:"Access system settings",allowed:!0},{text:"Manage users",allowed:!0},{text:"Configure POS",allowed:!0},{text:"Full access to all features",allowed:!0}]},custom:{title:"Custom",description:"Create your own permission set",permissions:[{text:"Configure specific permissions",allowed:!0},{text:"Mix and match access levels",allowed:!0},{text:"Fine-grained control",allowed:!0}]}};return e.jsxs(K,{isLoading:S,children:[e.jsx(te,{title:"Permission Mode",icon:e.jsx(b,{className:"w-5 h-5"}),helpText:"Choose between simple role-based permissions or advanced custom permissions.",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"font-medium text-gray-900",children:"Use Simple Mode"}),e.jsx("p",{className:"text-sm text-gray-500",children:"Quick role-based permissions vs. custom granular control"})]}),e.jsxs("button",{onClick:()=>N(e=>({...e,mode:"simple"===e.mode?"advanced":"simple"})),className:"px-4 py-2 bg-white border-2 border-blue-300 text-blue-700 rounded-lg hover:bg-blue-50 font-medium transition-colors",children:["Switch to ","simple"===v.mode?"Advanced":"Simple"," Mode"]})]})}),"simple"===v.mode&&e.jsx(te,{title:"Role-Based Permissions",icon:e.jsx(z,{className:"w-5 h-5"}),helpText:"Choose a pre-configured role with built-in permission sets. Best for most businesses.",children:e.jsx("div",{className:"space-y-4",children:["cashier","manager","admin"].map(s=>e.jsx("div",{className:"border-2 rounded-lg p-4 cursor-pointer transition-all "+(v.defaultRole===s?"border-blue-500 bg-blue-50":"border-gray-200 hover:border-blue-300 bg-white"),onClick:()=>I(s),children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("input",{type:"radio",checked:v.defaultRole===s,onChange:()=>I(s),className:"w-5 h-5 text-blue-600"}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold text-gray-900",children:R[s].title}),e.jsx("p",{className:"text-sm text-gray-600",children:R[s].description})]})]}),e.jsx("ul",{className:"ml-8 mt-3 space-y-1",children:R[s].permissions.map((s,a)=>e.jsxs("li",{className:"text-sm flex items-start gap-2",children:[s.allowed?e.jsx(L,{className:"w-4 h-4 text-green-600 mt-0.5 flex-shrink-0"}):e.jsx(d,{className:"w-4 h-4 text-gray-400 mt-0.5 flex-shrink-0"}),e.jsx("span",{className:s.allowed?"text-green-700":"text-gray-500",children:s.text})]},a))})]}),v.defaultRole===s&&e.jsx("div",{className:"px-3 py-1 bg-blue-500 text-white text-sm font-medium rounded",children:"Selected"})]})},s))})}),"advanced"===v.mode&&e.jsxs(te,{title:"Custom Permissions",icon:e.jsx(j,{className:"w-5 h-5"}),helpText:"Fine-grained control over user permissions. Make sure you understand what each permission does to avoid security issues.",children:[e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h4",{className:"font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(z,{className:"w-5 h-5 text-blue-600"}),"POS & Sales"]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(Z,{id:"perm_pos_access",label:"Enable POS Access",checked:(null==(t=v.customPermissions)?void 0:t.enable_pos_access)??!0,onChange:e=>A("enable_pos_access",e),helpText:"Allow user to access the POS system."}),e.jsx(Z,{id:"perm_sales_access",label:"Enable Sales Access",checked:(null==(n=v.customPermissions)?void 0:n.enable_sales_access)??!0,onChange:e=>A("enable_sales_access",e),helpText:"Allow user to make sales transactions."}),e.jsx(Z,{id:"perm_refunds_access",label:"Process Refunds",checked:(null==(r=v.customPermissions)?void 0:r.enable_refunds_access)??!1,onChange:e=>A("enable_refunds_access",e),helpText:"Allow user to process customer refunds."}),e.jsx(Z,{id:"perm_discount_access",label:"Apply Discounts",checked:(null==(o=v.customPermissions)?void 0:o.enable_discount_access)??!1,onChange:e=>A("enable_discount_access",e),helpText:"Allow user to apply discounts to sales."})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h4",{className:"font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(u,{className:"w-5 h-5 text-green-600"}),"Inventory & Products"]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(Z,{id:"perm_inventory_view",label:"View Inventory",checked:(null==(c=v.customPermissions)?void 0:c.enable_inventory_view)??!0,onChange:e=>A("enable_inventory_view",e),helpText:"View inventory levels and product information."}),e.jsx(Z,{id:"perm_inventory_edit",label:"Edit Inventory",checked:(null==(m=v.customPermissions)?void 0:m.enable_inventory_edit)??!1,onChange:e=>A("enable_inventory_edit",e),helpText:"Update stock quantities and inventory data."}),e.jsx(Z,{id:"perm_product_creation",label:"Create Products",checked:(null==(h=v.customPermissions)?void 0:h.enable_product_creation)??!1,onChange:e=>A("enable_product_creation",e),helpText:"Add new products to the system."})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h4",{className:"font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(z,{className:"w-5 h-5 text-purple-600"}),"Customers"]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(Z,{id:"perm_customer_view",label:"View Customers",checked:(null==(p=v.customPermissions)?void 0:p.enable_customer_view)??!0,onChange:e=>A("enable_customer_view",e),helpText:"View customer information and history."}),e.jsx(Z,{id:"perm_customer_creation",label:"Create/Edit Customers",checked:(null==(x=v.customPermissions)?void 0:x.enable_customer_creation)??!0,onChange:e=>A("enable_customer_creation",e),helpText:"Add and update customer records."})]})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("h4",{className:"font-semibold text-gray-900 flex items-center gap-2",children:[e.jsx(j,{className:"w-5 h-5 text-red-600"}),"Reports & Administration"]}),e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(Z,{id:"perm_daily_reports",label:"View Daily Reports",checked:(null==(g=v.customPermissions)?void 0:g.enable_daily_reports)??!1,onChange:e=>A("enable_daily_reports",e),helpText:"Access daily sales and activity reports."}),e.jsx(Z,{id:"perm_financial_reports",label:"View Financial Reports",checked:(null==(_=v.customPermissions)?void 0:_.enable_financial_reports)??!1,onChange:e=>A("enable_financial_reports",e),helpText:"View financial reports and analytics."}),e.jsx(Z,{id:"perm_settings_access",label:"Access Settings",checked:(null==(f=v.customPermissions)?void 0:f.enable_settings_access)??!1,onChange:e=>A("enable_settings_access",e),helpText:"Access and modify system settings."}),e.jsx(Z,{id:"perm_user_management",label:"Manage Users",checked:(null==(w=v.customPermissions)?void 0:w.enable_user_management)??!1,onChange:e=>A("enable_user_management",e),helpText:"Add, edit, and remove user accounts."})]})]})]})]})});pe.displayName="UserPermissionsSimplifiedTab";const ue=l.memo(pe),xe=i.forwardRef((s,a)=>{J();const[t,n]=i.useState({whatsappEnabled:!0,whatsappAutoSend:!1,whatsappShowPreview:!0,whatsappIncludeLogo:!0,whatsappIncludeItems:!0,whatsappMessage:"Thank you for your purchase! Here's your invoice:",smsEnabled:!0,smsAutoSend:!1,smsTemplate:"Thank you! Total: {total}. Balance: {balance}. Ref: {invoice_no}",smsIncludeTotal:!0,smsIncludeBalance:!0,emailEnabled:!0,emailAutoSend:!1,emailSubject:"Your Invoice from {business_name}",emailTemplate:"Thank you for your purchase. Please find your invoice attached.",emailAttachPDF:!0,notifyOnPayment:!0,notifyOnRefund:!0,notifyLowStock:!0,notifyNewCustomer:!1}),[r,o]=i.useState(!1),[c,d]=i.useState(!1),[m,h]=i.useState(!1),[u,x]=i.useState(!1);l.useEffect(()=>{try{const e=localStorage.getItem("lats-pos-notifications");e&&n(JSON.parse(e))}catch(e){}},[]);const g=async()=>{h(!0);try{return localStorage.setItem("lats-pos-notifications",JSON.stringify(t)),y.success("Notification settings saved successfully!"),!0}catch(e){return y.error("Failed to save notification settings"),!1}finally{h(!1)}},b=async()=>{const e={whatsappEnabled:!0,whatsappAutoSend:!1,whatsappShowPreview:!0,whatsappIncludeLogo:!0,whatsappIncludeItems:!0,whatsappMessage:"Asante kwa kununua! Hii hapa invoice yako:",smsEnabled:!0,smsAutoSend:!1,smsTemplate:"Asante! Jumla: {total}. Deni: {balance}. Ref: {invoice_no}",smsIncludeTotal:!0,smsIncludeBalance:!0,emailEnabled:!0,emailAutoSend:!1,emailSubject:"Your Invoice from {business_name}",emailTemplate:"Asante kwa kununua. Invoice iko attached.",emailAttachPDF:!0,notifyOnPayment:!0,notifyOnRefund:!0,notifyLowStock:!0,notifyNewCustomer:!1};return n(e),localStorage.setItem("lats-pos-notifications",JSON.stringify(e)),y.success("Notification settings reset to defaults"),!0},j=(e,s)=>{n(a=>({...a,[e]:s}))};i.useImperativeHandle(a,()=>({saveSettings:g,resetSettings:b}));const _={invoice_no:"INV-2024-001",business_name:"My Store",business_phone:"+255 123 456 789",customer_name:"John Doe",items:[{name:"Product 1",quantity:2,price:1e4},{name:"Product 2",quantity:1,price:25e3}],subtotal:45e3,tax:4500,total:49500,paid:3e4,balance:19500,date:(new Date).toLocaleDateString()},f=()=>{let e=t.smsTemplate;return e=e.replace("{total}",Q.money(_.total)),e=e.replace("{balance}",Q.money(_.balance)),e=e.replace("{invoice_no}",_.invoice_no),e=e.replace("{business_name}",_.business_name),e=e.replace("{customer_name}",_.customer_name),e};return e.jsxs(K,{isLoading:u,children:[e.jsx(te,{title:"WhatsApp Invoice",icon:e.jsx(A,{className:"w-5 h-5"}),helpText:"Tuma invoice kwenye WhatsApp ya customer na items, totals, na payment info.",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(Z,{id:"whatsapp_enabled",label:"Enable WhatsApp Integration",checked:t.whatsappEnabled,onChange:e=>j("whatsappEnabled",e),helpText:"Send detailed invoices with items, totals, and payment info directly to customers' WhatsApp."}),t.whatsappEnabled&&e.jsxs("div",{className:"space-y-4 pl-6 border-l-4 border-green-200",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(Z,{id:"whatsapp_auto_send",label:"Auto-send after payment",checked:t.whatsappAutoSend,onChange:e=>j("whatsappAutoSend",e),helpText:"Automatically send invoice to customer's WhatsApp after payment completion."}),e.jsx(Z,{id:"whatsapp_show_preview",label:"Show preview before sending",checked:t.whatsappShowPreview,onChange:e=>j("whatsappShowPreview",e),helpText:"Allow staff to review the message before sending it."}),e.jsx(Z,{id:"whatsapp_include_logo",label:"Include business logo",checked:t.whatsappIncludeLogo,onChange:e=>j("whatsappIncludeLogo",e),helpText:"Add your business logo to the WhatsApp message."}),e.jsx(Z,{id:"whatsapp_include_items",label:"Include item details",checked:t.whatsappIncludeItems,onChange:e=>j("whatsappIncludeItems",e),helpText:"Show individual items and quantities in the message."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(ee,{id:"whatsapp_opening",label:"Opening Message",value:t.whatsappMessage,onChange:e=>j("whatsappMessage",e),placeholder:"Thank you for your purchase! Here's your invoice:",multiline:!0,rows:2,helpText:e.jsxs("div",{children:[e.jsx("p",{className:"mb-2",children:e.jsx("strong",{children:"Available Variables:"})}),e.jsxs("div",{className:"grid grid-cols-2 gap-1 text-xs",children:[e.jsx("span",{children:"{invoice_no}"}),e.jsx("span",{children:"{customer_name}"}),e.jsx("span",{children:"{total}"}),e.jsx("span",{children:"{paid}"}),e.jsx("span",{children:"{balance}"}),e.jsx("span",{children:"{date}"}),e.jsx("span",{children:"{business_name}"}),e.jsx("span",{children:"{business_phone}"})]})]})}),e.jsx(ee,{id:"whatsapp_closing",label:"Closing Message (Optional)",value:t.whatsappClosingMessage||"",onChange:e=>j("whatsappClosingMessage",e),placeholder:"Thank you for your business!",multiline:!0,rows:2,helpText:"Optional message shown at the end of the invoice."})]}),e.jsxs("button",{onClick:()=>o(!r),className:"flex items-center gap-2 px-4 py-2 border-2 border-gray-200 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx(p,{className:"w-4 h-4"}),r?"Hide Preview":"Show Preview"]}),r&&e.jsx("div",{className:"bg-gray-50 border-2 border-gray-200 rounded-lg p-4",children:e.jsx("pre",{className:"whitespace-pre-wrap text-sm text-gray-800 font-mono",children:(()=>{let e=t.whatsappMessage+"\n\n";return e+=`ðŸ“„ Invoice: ${_.invoice_no}\n`,e+=`ðŸ“… Date: ${_.date}\n`,e+=`ðŸ‘¤ Customer: ${_.customer_name}\n\n`,t.whatsappIncludeItems&&(e+="ðŸ›’ Items:\n",_.items.forEach(s=>{e+=`  â€¢ ${s.name} x${s.quantity} - ${Q.money(s.price)}\n`}),e+="\n"),e+=`ðŸ’° Total: ${Q.money(_.total)}\n`,e+=`âœ… Paid: ${Q.money(_.paid)}\n`,e+=`ðŸ“Š Balance: ${Q.money(_.balance)}\n\n`,e+=`ðŸ“ž Contact: ${_.business_phone}\n`,e+="\nThank you for your business! ðŸ™",e})()})})]})]})}),e.jsx(te,{title:"SMS Invoice",icon:e.jsx(H,{className:"w-5 h-5"}),helpText:"Tuma invoice summary kwa SMS kwa customer.",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(Z,{id:"sms_enabled",label:"Enable SMS Integration",checked:t.smsEnabled,onChange:e=>j("smsEnabled",e),helpText:"Send short invoice notifications to customers via SMS."}),t.smsEnabled&&e.jsxs("div",{className:"space-y-4 pl-6 border-l-4 border-blue-200",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(Z,{id:"sms_auto_send",label:"Auto-send after payment",checked:t.smsAutoSend,onChange:e=>j("smsAutoSend",e),helpText:"Automatically send SMS after payment completion."}),e.jsx(Z,{id:"sms_include_total",label:"Include total amount",checked:t.smsIncludeTotal,onChange:e=>j("smsIncludeTotal",e),helpText:"Show total amount in the SMS message."}),e.jsx(Z,{id:"sms_include_balance",label:"Include balance due",checked:t.smsIncludeBalance,onChange:e=>j("smsIncludeBalance",e),helpText:"Show remaining balance in the SMS message."})]}),e.jsx(ee,{id:"sms_template",label:"SMS Template",value:t.smsTemplate,onChange:e=>j("smsTemplate",e),placeholder:"Thank you! Total: {total}. Balance: {balance}. Ref: {invoice_no}",multiline:!0,rows:3,helpText:e.jsxs("div",{children:[e.jsx("p",{className:"mb-2",children:e.jsx("strong",{children:"Variables:"})}),e.jsxs("div",{className:"grid grid-cols-2 gap-1 text-xs",children:[e.jsx("span",{children:"{total}"}),e.jsx("span",{children:"{balance}"}),e.jsx("span",{children:"{paid}"}),e.jsx("span",{children:"{invoice_no}"}),e.jsx("span",{children:"{business_name}"}),e.jsx("span",{children:"{customer_name}"})]}),e.jsx("p",{className:"mt-2 text-xs",children:"Keep under 160 chars to avoid splitting."})]})}),e.jsxs("button",{onClick:()=>d(!c),className:"flex items-center gap-2 px-4 py-2 border-2 border-gray-200 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",children:[e.jsx(p,{className:"w-4 h-4"}),c?"Hide Preview":"Show Preview"]}),c&&e.jsxs("div",{className:"bg-gray-50 border-2 border-gray-200 rounded-lg p-4",children:[e.jsx("p",{className:"text-sm text-gray-800 mb-2",children:f()}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Character count: ",f().length," / 160"]})]})]})]})}),e.jsx(te,{title:"Email Invoice",icon:e.jsx(B,{className:"w-5 h-5"}),helpText:"Tuma invoice PDF kwa email ya customer.",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx(Z,{id:"email_enabled",label:"Enable Email Integration",checked:t.emailEnabled,onChange:e=>j("emailEnabled",e),helpText:"Send professional invoices to customers via email."}),t.emailEnabled&&e.jsxs("div",{className:"space-y-4 pl-6 border-l-4 border-purple-200",children:[e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(Z,{id:"email_auto_send",label:"Auto-send after payment",checked:t.emailAutoSend,onChange:e=>j("emailAutoSend",e),helpText:"Automatically send email after payment completion."}),e.jsx(Z,{id:"email_attach_pdf",label:"Attach PDF invoice",checked:t.emailAttachPDF,onChange:e=>j("emailAttachPDF",e),helpText:"Include formatted PDF as email attachment."})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsx(ee,{id:"email_subject",label:"Email Subject",value:t.emailSubject,onChange:e=>j("emailSubject",e),placeholder:"Your Invoice from {business_name}",helpText:"Subject line for the email. Use variables like {business_name}, {invoice_no}."}),e.jsx(ee,{id:"email_body",label:"Email Body",value:t.emailTemplate,onChange:e=>j("emailTemplate",e),placeholder:"Dear {customer_name}, Thank you for your purchase!",multiline:!0,rows:6,helpText:e.jsxs("div",{children:[e.jsx("p",{className:"mb-2",children:e.jsx("strong",{children:"Variables:"})}),e.jsxs("div",{className:"grid grid-cols-2 gap-1 text-xs",children:[e.jsx("span",{children:"{business_name}"}),e.jsx("span",{children:"{customer_name}"}),e.jsx("span",{children:"{invoice_no}"}),e.jsx("span",{children:"{total}"}),e.jsx("span",{children:"{paid}"}),e.jsx("span",{children:"{balance}"})]})]})})]})]})]})}),e.jsx(te,{title:"General Notifications",icon:e.jsx(W,{className:"w-5 h-5"}),helpText:"Control which system events trigger notifications to staff and customers.",children:e.jsxs("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[e.jsx(Z,{id:"notify_on_payment",label:"Notify on successful payment",checked:t.notifyOnPayment,onChange:e=>j("notifyOnPayment",e),helpText:"Show notification when a payment is completed successfully."}),e.jsx(Z,{id:"notify_on_refund",label:"Notify on refund",checked:t.notifyOnRefund,onChange:e=>j("notifyOnRefund",e),helpText:"Alert when a refund is processed."}),e.jsx(Z,{id:"notify_low_stock",label:"Low stock alerts",checked:t.notifyLowStock,onChange:e=>j("notifyLowStock",e),helpText:"Get alerted when products are running low on inventory."}),e.jsx(Z,{id:"notify_new_customer",label:"New customer registration",checked:t.notifyNewCustomer,onChange:e=>j("notifyNewCustomer",e),helpText:"Receive notification when a new customer is added."})]})})]})});xe.displayName="NotificationsSettingsTab";const ge=l.memo(xe),be=i.forwardRef(({isOpen:s,onClose:a,activeTab:t,onTabChange:r},o)=>{const{currentUser:c}=n(),m=(null==c?void 0:c.role)||"customer-care",h="admin"===m,{t:p}=J(),[x,g]=i.useState(t||(h?"general":"receipt")),[b,j]=i.useState(!1),[y,_]=i.useState("");l.useEffect(()=>{t&&t!==x&&g(t)},[t,x]);const f=i.useRef(null),w=i.useRef(null),v=i.useRef(null),N=i.useRef(null),k=i.useRef(null),C=i.useRef(null),S=i.useMemo(()=>[{id:"general",name:p("settings.general"),keywords:["interface","theme","language","currency","display","barcode","scanner","security","passcode"],roles:["admin"]},{id:"pricing",name:p("settings.pricing"),keywords:["pricing","discount","happy hour","bulk","loyalty","promotions"],roles:["admin"]},{id:"receipt",name:p("settings.receipt"),keywords:["receipt","print","template","logo","format"],roles:["admin","customer-care"]},{id:"notifications",name:p("settings.notifications"),keywords:["notifications","alerts","whatsapp","sms","email","invoice","send","auto","manual"],roles:["admin","customer-care"]},{id:"features",name:p("settings.features"),keywords:["features","delivery","loyalty","customer","payment tracking","enable","disable"],roles:["admin"]},{id:"permissions",name:p("settings.permissions"),keywords:["permissions","access","user","role","security","cashier","manager","admin"],roles:["admin"]}],[]),P=i.useMemo(()=>S.filter(e=>e.roles.includes(m)),[S,m]),T=i.useMemo(()=>{if(!y.trim())return P;const e=y.toLowerCase();return P.filter(s=>s.name.toLowerCase().includes(e)||s.keywords.some(s=>s.includes(e)))},[y,P]),D=async()=>{var e,s,a,t,n,i;j(!0);try{switch(x){case"general":if(null==(e=f.current)?void 0:e.saveSettings)return await f.current.saveSettings();break;case"pricing":if(null==(s=w.current)?void 0:s.saveSettings)return await w.current.saveSettings();break;case"receipt":if(null==(a=v.current)?void 0:a.saveSettings)return await v.current.saveSettings();break;case"features":if(null==(t=N.current)?void 0:t.saveSettings)return await N.current.saveSettings();break;case"permissions":if(null==(n=k.current)?void 0:n.saveSettings)return await k.current.saveSettings();break;case"notifications":if(null==(i=C.current)?void 0:i.saveSettings)return await C.current.saveSettings();break;default:return $.error(`Unknown settings tab: ${x}`),!1}throw new Error(`No save function available for ${x} settings`)}catch(l){return $.error(`Failed to save ${x} settings. Please try again.`),!1}finally{j(!1)}};return i.useImperativeHandle(o,()=>({saveCurrentTabSettings:D})),V(s),s?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed bg-black/50",onClick:e=>{e.target===e.currentTarget&&a()},style:{left:"var(--sidebar-width, 0px)",top:"var(--topbar-height, 64px)",right:0,bottom:0,zIndex:35}}),e.jsx("div",{className:"fixed flex items-center justify-center p-4",style:{left:"var(--sidebar-width, 0px)",top:"var(--topbar-height, 64px)",right:0,bottom:0,zIndex:50,pointerEvents:"none"},children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-6xl w-full max-h-[90vh] flex flex-col",style:{pointerEvents:"auto"},children:[e.jsxs("div",{className:"p-6 border-b border-gray-200 flex-shrink-0",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(u,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:p("settings.posSettings")}),e.jsx("p",{className:"text-xs text-gray-500",children:p("settings.configure")})]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("div",{className:"relative",children:[e.jsx(q,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400 w-4 h-4"}),e.jsx("input",{type:"text",placeholder:p("settings.searchSettings"),value:y,onChange:e=>{_(e.target.value)},className:"pl-10 pr-4 py-2 border-2 border-gray-200 rounded-lg focus:outline-none focus:border-blue-500 transition-colors text-gray-900 w-64"})]}),e.jsx("button",{onClick:()=>{a()},className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(d,{className:"w-6 h-6"})})]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("div",{className:"flex rounded-lg bg-gray-100 p-1 gap-1 overflow-x-auto",children:T.map(s=>e.jsx("button",{type:"button",onClick:e=>{e.stopPropagation(),g(s.id),null==r||r(s.id)},className:`flex-1 px-4 py-2.5 text-base font-medium rounded-md transition-all whitespace-nowrap ${((e,s)=>{if(!s)return"text-gray-600 hover:text-gray-900 hover:bg-gray-50";return{general:"bg-blue-600 text-white shadow-lg",pricing:"bg-green-600 text-white shadow-lg",receipt:"bg-purple-600 text-white shadow-lg",notifications:"bg-orange-600 text-white shadow-lg",features:"bg-indigo-600 text-white shadow-lg",permissions:"bg-pink-600 text-white shadow-lg"}[e]||"bg-white text-gray-900 shadow-sm"})(s.id,x===s.id)}`,children:s.name},s.id))}),0===T.length&&y&&e.jsxs("div",{className:"text-gray-500 text-sm py-2 text-center mt-2",children:[p("settings.noSettingsFound"),' "',y,'"']})]})]}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:["general"===x&&e.jsx(ie,{ref:f}),"pricing"===x&&e.jsx(re,{ref:w}),"receipt"===x&&e.jsx(de,{ref:v}),"notifications"===x&&e.jsx(ge,{ref:C}),"features"===x&&e.jsx(he,{ref:N}),"permissions"===x&&e.jsx(ue,{ref:k})]}),e.jsxs("div",{className:"flex gap-3 p-6 border-t border-gray-200 bg-white flex-shrink-0",children:[e.jsx("button",{type:"button",onClick:()=>{a()},className:"flex-1 px-4 py-3 border-2 border-gray-200 rounded-lg text-gray-700 font-medium hover:bg-gray-50 transition-colors",children:p("common.cancel")}),e.jsx("button",{type:"button",onClick:()=>{D()},disabled:b,className:"flex-1 px-4 py-3 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:b?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),p("settings.saving")]}):e.jsxs(e.Fragment,{children:[e.jsx(U,{className:"w-5 h-5"}),p("settings.saveSettings")]})})]})]})})]}):null});be.displayName="POSSettingsModal";export{be as default};
