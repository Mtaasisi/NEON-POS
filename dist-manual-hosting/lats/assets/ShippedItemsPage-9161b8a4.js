import{av as e,aw as t,ax as r,c as s,u as a,j as i,G as l,d}from"./index-222cfb29.js";import{r as n}from"./vendor-a2ff445a.js";import{B as c}from"./BackButton-e41d1482.js";import{Y as o,Q as m,x as u,f as p,d as x,A as g,y as h,ab as v,R as y,q as f,n as j}from"./ui-551a39a6.js";import{p as N}from"./draftService-0e50dcac.js";import{a as b}from"./purchaseOrderUtils-e0e1d78b.js";import{a as w,d as I}from"./routing-a2f0f6d2.js";import"./supabase-7e851d02.js";const k=e()(t(r((e,t)=>({isLoading:!1,isCreating:!1,isUpdating:!1,isDeleting:!1,error:null,purchaseOrders:[],currentPO:null,shippedItems:[],cartItems:[],selectedSupplier:null,selectedCurrency:{code:"TZS",name:"Tanzanian Shilling",symbol:"TZS",flag:"ðŸ‡¹ðŸ‡¿"},expectedDelivery:"",paymentTerms:"net_30",notes:"",filters:{searchQuery:"",statusFilter:"all",supplierFilter:"",dateRange:{start:"",end:""},sortBy:"createdAt",sortOrder:"desc"},selectedOrders:[],loadPurchaseOrders:async()=>{e({isLoading:!0,error:null});try{const t=s.getState();await t.loadPurchaseOrders();const{purchaseOrders:r}=t;e({purchaseOrders:r,isLoading:!1})}catch(t){e({error:"Failed to load purchase orders",isLoading:!1})}},getPurchaseOrder:async t=>{e({isLoading:!0,error:null});try{if(!t){return void e({error:"Purchase order ID is required",isLoading:!1})}if("string"!=typeof t){return void e({error:"Invalid purchase order ID type: Expected string, got "+typeof t,isLoading:!1})}const r=t.trim();if(""===r){return void e({error:"Purchase order ID cannot be empty or whitespace only",isLoading:!1})}if(!/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(r)){return void e({error:`Invalid purchase order ID format: "${r}". Expected UUID format.`,isLoading:!1})}const a=s.getState(),i=await a.getPurchaseOrder(r);if(i.ok&&i.data)e({currentPO:i.data,isLoading:!1});else{const t=i.message||"Failed to get purchase order from server";e({error:t,isLoading:!1})}}catch(r){let s="Failed to get purchase order";r instanceof Error&&(s=r.message.includes("network")||r.message.includes("fetch")?"Network error: Please check your internet connection and try again":r.message.includes("timeout")?"Request timeout: The server is taking too long to respond":r.message.includes("permission")||r.message.includes("unauthorized")?"Permission denied: You do not have access to this purchase order":r.message.includes("not found")?`Purchase order with ID "${t}" not found`:`Error: ${r.message}`),e({error:s,isLoading:!1})}},createPurchaseOrder:async r=>{e({isCreating:!0,error:null});try{const a=s.getState(),i=await a.createPurchaseOrder(r);return i.ok&&(await t().loadPurchaseOrders(),t().clearCart()),e({isCreating:!1}),i}catch(a){return e({error:"Failed to create purchase order",isCreating:!1}),{ok:!1,message:"Failed to create purchase order"}}},updatePurchaseOrder:async(r,a)=>{e({isUpdating:!0,error:null});try{const i=s.getState(),l=await i.updatePurchaseOrder(r,a);return l.ok&&await t().loadPurchaseOrders(),e({isUpdating:!1}),l}catch(i){return e({error:"Failed to update purchase order",isUpdating:!1}),{ok:!1,message:"Failed to update purchase order"}}},deletePurchaseOrder:async r=>{e({isDeleting:!0,error:null});try{const a=s.getState(),i=await a.deletePurchaseOrder(r);return i.ok&&await t().loadPurchaseOrders(),e({isDeleting:!1}),i}catch(a){return e({error:"Failed to delete purchase order",isDeleting:!1}),{ok:!1,message:"Failed to delete purchase order"}}},receivePurchaseOrder:async r=>{e({isUpdating:!0,error:null});try{const a=s.getState(),i=await a.receivePurchaseOrder(r);return i.ok&&await t().loadPurchaseOrders(),e({isUpdating:!1}),i}catch(a){return e({error:"Failed to receive purchase order",isUpdating:!1}),{ok:!1,message:"Failed to receive purchase order"}}},loadShippedItems:async t=>{e({isLoading:!0,error:null});try{const r=s.getState(),a=await r.getShippedItems(t);a.ok&&a.data?e({shippedItems:a.data,isLoading:!1}):e({error:"Failed to load shipped items",isLoading:!1})}catch(r){e({error:"Failed to load shipped items",isLoading:!1})}},updateShippedItem:async(r,a)=>{e({isUpdating:!0,error:null});try{const i=s.getState();if((await i.updateShippedItem(r,a)).ok){const s=t().shippedItems.map(e=>e.id===r?{...e,...a}:e);e({shippedItems:s,isUpdating:!1})}else e({error:"Failed to update shipped item",isUpdating:!1})}catch(i){e({error:"Failed to update shipped item",isUpdating:!1})}},markItemAsReceived:async(r,a,i)=>{e({isUpdating:!0,error:null});try{const l=s.getState();if((await l.markShippedItemAsReceived(r,a,i)).ok){const s=t().shippedItems.map(e=>e.id===r?{...e,receivedQuantity:a,status:"received",notes:i||e.notes}:e);e({shippedItems:s,isUpdating:!1})}else e({error:"Failed to mark item as received",isUpdating:!1})}catch(l){e({error:"Failed to mark item as received",isUpdating:!1})}},reportDamage:async(r,a)=>{e({isUpdating:!0,error:null});try{const i=s.getState();if((await i.reportShippedItemDamage(r,a)).ok){const s=t().shippedItems.map(e=>e.id===r?{...e,status:"damaged",damageReport:a,notes:a}:e);e({shippedItems:s,isUpdating:!1})}else e({error:"Failed to report damage",isUpdating:!1})}catch(i){e({error:"Failed to report damage",isUpdating:!1})}},addToCart:(t,r,s=1)=>{const a=r.costPrice||.7*t.price;e(e=>{const i=e.cartItems.find(e=>e.productId===t.id&&e.variantId===r.id);if(i)return{cartItems:e.cartItems.map(e=>e.id===i.id?{...e,quantity:e.quantity+s,totalPrice:(e.quantity+s)*a}:e)};{const i={id:`${t.id}-${r.id}-${Date.now()}`,productId:t.id,variantId:r.id,name:t.name,variantName:r.name,sku:r.sku,costPrice:a,quantity:s,totalPrice:a*s,currentStock:r.stockQuantity,category:t.categoryName,images:t.images||[]};return{cartItems:[...e.cartItems,i]}}})},updateCartItemQuantity:(r,s)=>{s<=0?t().removeFromCart(r):e(e=>({cartItems:e.cartItems.map(e=>e.id===r?{...e,quantity:s,totalPrice:s*e.costPrice}:e)}))},updateCartItemCostPrice:(t,r)=>{e(e=>({cartItems:e.cartItems.map(e=>e.id===t?{...e,costPrice:r,totalPrice:e.quantity*r}:e)}))},removeFromCart:t=>{e(e=>({cartItems:e.cartItems.filter(e=>e.id!==t)}))},clearCart:()=>{e({cartItems:[],selectedSupplier:null,expectedDelivery:"",notes:""})},setSupplier:t=>{e({selectedSupplier:t})},updateFilters:t=>{e(e=>({filters:{...e.filters,...t}}))},toggleOrderSelection:t=>{e(e=>({selectedOrders:e.selectedOrders.includes(t)?e.selectedOrders.filter(e=>e!==t):[...e.selectedOrders,t]}))},selectAllOrders:()=>{e(e=>({selectedOrders:e.purchaseOrders.map(e=>e.id)}))},deselectAllOrders:()=>{e({selectedOrders:[]})},getFilteredPurchaseOrders:()=>{const{purchaseOrders:e,filters:r}=t();let s=[...e];if(r.searchQuery.trim()){const e=r.searchQuery.toLowerCase();s=s.filter(t=>{var r,s;return t.orderNumber.toLowerCase().includes(e)||(null==(r=t.supplier)?void 0:r.name.toLowerCase().includes(e))||(null==(s=t.notes)?void 0:s.toLowerCase().includes(e))})}return"all"!==r.statusFilter&&(s=s.filter(e=>e.status===r.statusFilter)),r.supplierFilter&&(s=s.filter(e=>e.supplierId===r.supplierFilter)),(r.dateRange.start||r.dateRange.end)&&(s=s.filter(e=>{const t=new Date(e.createdAt),s=r.dateRange.start?new Date(r.dateRange.start):null,a=r.dateRange.end?new Date(r.dateRange.end):null;return!(s&&t<s)&&!(a&&t>a)})),s.sort((e,t)=>{let s,a;switch(r.sortBy){case"orderNumber":s=e.orderNumber,a=t.orderNumber;break;case"totalAmount":s=e.totalAmount,a=t.totalAmount;break;case"expectedDelivery":s=new Date(e.expectedDelivery).getTime(),a=new Date(t.expectedDelivery).getTime();break;default:s=new Date(e.createdAt).getTime(),a=new Date(t.createdAt).getTime()}return"asc"===r.sortOrder?s>a?1:-1:s<a?1:-1}),s},getCartTotal:()=>{const{cartItems:e}=t(),r=e.reduce((e,t)=>e+t.totalPrice,0),s=.18*r;return{subtotal:r,tax:s,total:r+s}},saveDraft:(e,r)=>{const{cartItems:s,selectedSupplier:a,selectedCurrency:i,expectedDelivery:l,paymentTerms:d}=t();try{return N.saveDraft(e,s,a,i,l,d,r||t().notes)}catch(n){return null}},loadDraft:t=>{e({cartItems:t.cartItems||[],selectedSupplier:t.supplier,selectedCurrency:t.currency||{code:"TZS",name:"Tanzanian Shilling",symbol:"TZS",flag:"ðŸ‡¹ðŸ‡¿"},expectedDelivery:t.expectedDelivery||"",paymentTerms:t.paymentTerms||"net_30",notes:t.notes||""})},autoSaveDraft:()=>{const{cartItems:e,selectedSupplier:r,selectedCurrency:s,expectedDelivery:a,paymentTerms:i,notes:l}=t();if(0===e.length)return null;try{return N.autoSave(e,r,s,a,i,l)}catch(d){return null}},clearDrafts:()=>{N.clearAllDrafts()}})),{name:"purchase-order-store"})),S=()=>{var e,t;const r=w(),{currentUser:N}=a(),{purchaseOrderId:S}=I(),{purchaseOrders:O,shippedItems:C,isLoading:D,error:P,loadPurchaseOrders:F,loadShippedItems:L,updateShippedItem:U,markItemAsReceived:T,reportDamage:R}=k(),{products:q,suppliers:A,loadProducts:Q,loadSuppliers:z}=s(),[$,M]=n.useState(""),[_,E]=n.useState("all"),[B,Z]=n.useState(S||""),[K,Y]=n.useState(!1);n.useState([]);const[G,V]=n.useState(10),H=n.useRef(null),[J,W]=n.useState(!1),[X,ee]=n.useState(!1),[te,re]=n.useState(null),[se,ae]=n.useState({quantity:0,notes:""}),[ie,le]=n.useState("");n.useEffect(()=>{(async()=>{try{await Promise.all([F(),Q({page:1,limit:100}),z()]),S&&await L(S)}catch(e){}})()},[F,Q,z,L,S]),n.useEffect(()=>{V(10)},[$,_,B]),n.useEffect(()=>{const e=new IntersectionObserver(e=>{e[0].isIntersecting&&oe&&!D&&V(e=>e+10)},{threshold:.1}),t=H.current;return t&&e.observe(t),()=>{t&&e.unobserve(t)}},[oe,D]);const de=n.useMemo(()=>O.flatMap(e=>{var t;return(null==(t=e.items)?void 0:t.map((t,r)=>{var s,a;return{id:`shipped-${t.id}`,purchaseOrderId:e.id,purchaseOrderItemId:t.id,quantity:t.quantity,shippedDate:new Date(Date.now()-10*Math.random()*24*60*60*1e3).toISOString().split("T")[0],trackingNumber:`TRK${Math.random().toString(36).substr(2,8).toUpperCase()}`,notes:"",status:["shipped","in_transit","delivered"][Math.floor(3*Math.random())],product:q.find(e=>e.id===t.productId),variant:null==(a=null==(s=q.find(e=>e.id===t.productId))?void 0:s.variants)?void 0:a.find(e=>e.id===t.variantId),purchaseOrder:e}}))||[]}),[O,q]),ne=n.useMemo(()=>{let e=de;if($.trim()){const t=$.toLowerCase();e=e.filter(e=>{var r,s,a,i,l,d;return(null==(s=null==(r=e.product)?void 0:r.name)?void 0:s.toLowerCase().includes(t))||(null==(i=null==(a=e.variant)?void 0:a.sku)?void 0:i.toLowerCase().includes(t))||(null==(l=e.trackingNumber)?void 0:l.toLowerCase().includes(t))||(null==(d=e.purchaseOrder)?void 0:d.orderNumber.toLowerCase().includes(t))})}return"all"!==_&&(e=e.filter(e=>e.status===_)),B&&(e=e.filter(e=>e.purchaseOrderId===B)),e},[de,$,_,B]),ce=ne.slice(0,G),oe=G<ne.length;return N?i.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-slate-50 via-purple-50 to-violet-100",children:[i.jsx("div",{className:"bg-white border-b border-gray-200 shadow-sm",children:i.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:i.jsxs("div",{className:"flex items-center justify-between h-16",children:[i.jsxs("div",{className:"flex items-center gap-4",children:[i.jsx(c,{onClick:()=>r("/lats/purchase-orders")}),i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"p-2 bg-purple-50 rounded-lg",children:i.jsx(o,{className:"w-6 h-6 text-purple-600"})}),i.jsxs("div",{children:[i.jsx("h1",{className:"text-xl font-semibold text-gray-900",children:"Shipped Items"}),i.jsx("p",{className:"text-sm text-gray-600",children:"Track and manage purchase order shipments"})]})]})]}),i.jsx("div",{className:"flex items-center gap-3",children:i.jsx(l,{onClick:()=>r("/purchase-orders/create"),icon:i.jsx(m,{size:18}),className:"bg-gradient-to-r from-purple-500 to-violet-600 text-white",children:"New Order"})})]})})}),i.jsxs("div",{className:"max-w-7xl mx-auto p-4 sm:p-6 space-y-6",children:[i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[i.jsx(d,{className:"p-4",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"p-2 bg-blue-50 rounded-lg",children:i.jsx(u,{className:"w-5 h-5 text-blue-600"})}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-600",children:"Total Shipments"}),i.jsx("p",{className:"text-xl font-semibold text-gray-900",children:ne.length})]})]})}),i.jsx(d,{className:"p-4",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"p-2 bg-yellow-50 rounded-lg",children:i.jsx(p,{className:"w-5 h-5 text-yellow-600"})}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-600",children:"In Transit"}),i.jsx("p",{className:"text-xl font-semibold text-gray-900",children:ne.filter(e=>"in_transit"===e.status).length})]})]})}),i.jsx(d,{className:"p-4",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"p-2 bg-green-50 rounded-lg",children:i.jsx(x,{className:"w-5 h-5 text-green-600"})}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-600",children:"Delivered"}),i.jsx("p",{className:"text-xl font-semibold text-gray-900",children:ne.filter(e=>"delivered"===e.status).length})]})]})}),i.jsx(d,{className:"p-4",children:i.jsxs("div",{className:"flex items-center gap-3",children:[i.jsx("div",{className:"p-2 bg-red-50 rounded-lg",children:i.jsx(g,{className:"w-5 h-5 text-red-600"})}),i.jsxs("div",{children:[i.jsx("p",{className:"text-sm text-gray-600",children:"Issues"}),i.jsx("p",{className:"text-xl font-semibold text-gray-900",children:ne.filter(e=>"damaged"===e.status).length})]})]})})]}),i.jsxs(d,{className:"p-6",children:[i.jsxs("div",{className:"flex flex-col sm:flex-row gap-4 items-start sm:items-center justify-between",children:[i.jsx("div",{className:"flex-1 max-w-md",children:i.jsxs("div",{className:"relative",children:[i.jsx(h,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),i.jsx("input",{type:"text",placeholder:"Search shipments...",value:$,onChange:e=>M(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500"})]})}),i.jsx("div",{className:"flex items-center gap-3",children:i.jsxs("button",{onClick:()=>Y(!K),className:"flex items-center gap-2 px-3 py-2 text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-lg transition-colors",children:[i.jsx(v,{className:"w-4 h-4"}),"Filters"]})})]}),K&&i.jsx("div",{className:"mt-4 p-4 bg-gray-50 rounded-lg border border-gray-200",children:i.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),i.jsxs("select",{value:_,onChange:e=>E(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",children:[i.jsx("option",{value:"all",children:"All Status"}),i.jsx("option",{value:"shipped",children:"Shipped"}),i.jsx("option",{value:"in_transit",children:"In Transit"}),i.jsx("option",{value:"delivered",children:"Delivered"}),i.jsx("option",{value:"damaged",children:"Damaged"})]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Purchase Order"}),i.jsxs("select",{value:B,onChange:e=>Z(e.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500",children:[i.jsx("option",{value:"",children:"All Orders"}),O.map(e=>{var t;return i.jsxs("option",{value:e.id,children:[e.orderNumber," - ",null==(t=A.find(t=>t.id===e.supplierId))?void 0:t.name]},e.id)})]})]}),i.jsx("div",{className:"flex items-end",children:i.jsx("button",{onClick:()=>{M(""),E("all"),Z("")},className:"w-full px-4 py-2 text-sm text-gray-600 hover:text-gray-800 hover:bg-gray-100 rounded-lg transition-colors",children:"Clear Filters"})})]})})]}),i.jsx(d,{className:"overflow-hidden",children:D?i.jsxs("div",{className:"flex items-center justify-center py-12",children:[i.jsx(y,{className:"w-8 h-8 animate-spin text-purple-500"}),i.jsx("span",{className:"ml-3 text-gray-600",children:"Loading shipments..."})]}):0===ne.length?i.jsxs("div",{className:"text-center py-12",children:[i.jsx(o,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No shipments found"}),i.jsx("p",{className:"text-gray-600 mb-6",children:$||"all"!==_||B?"No shipments match your current filters":"No shipments have been created yet"}),i.jsx(l,{onClick:()=>r("/purchase-orders/create"),icon:i.jsx(m,{size:20}),className:"bg-gradient-to-r from-purple-500 to-violet-600 text-white",children:"Create Purchase Order"})]}):i.jsxs(i.Fragment,{children:[i.jsx("div",{className:"bg-gray-50 px-6 py-3 border-b border-gray-200",children:i.jsxs("div",{className:"grid grid-cols-8 gap-4",children:[i.jsx("div",{className:"font-medium text-gray-700",children:"Product"}),i.jsx("div",{className:"font-medium text-gray-700",children:"PO Number"}),i.jsx("div",{className:"font-medium text-gray-700",children:"Tracking"}),i.jsx("div",{className:"font-medium text-gray-700",children:"Quantity"}),i.jsx("div",{className:"font-medium text-gray-700",children:"Shipped Date"}),i.jsx("div",{className:"font-medium text-gray-700",children:"Status"}),i.jsx("div",{className:"font-medium text-gray-700",children:"Progress"}),i.jsx("div",{className:"font-medium text-gray-700",children:"Actions"})]})}),i.jsx("div",{className:"divide-y divide-gray-200",children:ce.map(e=>{var t,s,a,l,d;return i.jsx("div",{className:"px-6 py-4 hover:bg-gray-50 transition-colors",children:i.jsxs("div",{className:"grid grid-cols-8 gap-4 items-center",children:[i.jsxs("div",{children:[i.jsx("div",{className:"font-medium text-gray-900",children:(null==(t=e.product)?void 0:t.name)||"Unknown Product"}),i.jsxs("div",{className:"text-sm text-gray-600",children:["SKU: ",(null==(s=e.variant)?void 0:s.sku)||"N/A"]})]}),i.jsxs("div",{children:[i.jsx("div",{className:"font-medium text-gray-900",children:null==(a=e.purchaseOrder)?void 0:a.orderNumber}),i.jsx("div",{className:"text-sm text-gray-600",children:null==(l=A.find(t=>{var r;return t.id===(null==(r=e.purchaseOrder)?void 0:r.supplierId)}))?void 0:l.name})]}),i.jsx("div",{children:i.jsx("div",{className:"font-mono text-sm text-gray-900",children:e.trackingNumber})}),i.jsxs("div",{children:[i.jsx("div",{className:"font-medium text-gray-900",children:e.quantity}),e.receivedQuantity&&i.jsxs("div",{className:"text-sm text-green-600",children:["Received: ",e.receivedQuantity]})]}),i.jsx("div",{children:i.jsx("div",{className:"text-sm text-gray-900",children:b(e.shippedDate)})}),i.jsx("div",{children:i.jsx("span",{className:`inline-flex px-2 py-1 text-xs font-semibold rounded-full ${d=e.status,{shipped:"bg-blue-100 text-blue-800",in_transit:"bg-yellow-100 text-yellow-800",delivered:"bg-green-100 text-green-800",damaged:"bg-red-100 text-red-800",lost:"bg-gray-100 text-gray-800"}[d]||"bg-gray-100 text-gray-800"}`,children:e.status.replace("_"," ").toUpperCase()})}),i.jsx("div",{children:i.jsx("div",{className:"w-full bg-gray-200 rounded-full h-2",children:i.jsx("div",{className:"h-2 rounded-full "+("delivered"===e.status?"bg-green-500":"in_transit"===e.status?"bg-yellow-500":"damaged"===e.status?"bg-red-500":"bg-blue-500"),style:{width:("delivered"===e.status?100:"in_transit"===e.status?60:"damaged"===e.status?100:30)+"%"}})})}),i.jsxs("div",{className:"flex items-center gap-2",children:[i.jsx("button",{onClick:()=>r(`/purchase-orders/${e.purchaseOrderId}`),className:"p-1 text-blue-600 hover:text-blue-800 hover:bg-blue-50 rounded",title:"View purchase order",children:i.jsx(f,{className:"w-4 h-4"})}),"delivered"!==e.status&&"damaged"!==e.status&&i.jsx("button",{onClick:()=>(async e=>{re(e),ae({quantity:e.quantity,notes:""}),W(!0)})(e),className:"p-1 text-green-600 hover:text-green-800 hover:bg-green-50 rounded",title:"Mark as received",children:i.jsx(x,{className:"w-4 h-4"})}),i.jsx("button",{onClick:()=>(async e=>{re(e),le(""),ee(!0)})(e),className:"p-1 text-red-600 hover:text-red-800 hover:bg-red-50 rounded",title:"Report damage",children:i.jsx(g,{className:"w-4 h-4"})})]})]})},e.id)})}),ne.length>0&&i.jsx("div",{className:"px-6 py-4 bg-gray-50 border-t border-gray-200",children:i.jsxs("div",{className:"text-center",children:[i.jsxs("div",{className:"text-sm text-gray-600 mb-2",children:["Showing ",ce.length," of ",ne.length," shipments"]}),i.jsxs("div",{ref:H,className:"py-2",children:[oe&&!D&&i.jsxs("div",{className:"flex items-center justify-center gap-2 text-blue-600",children:[i.jsx(y,{className:"w-4 h-4 animate-spin"}),i.jsx("span",{className:"text-sm",children:"Loading more shipments..."})]}),!oe&&ce.length>0&&i.jsx("div",{className:"text-gray-500 text-sm",children:"âœ“ All shipments loaded"})]})]})})]})})]}),J&&te&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:i.jsx(d,{className:"w-full max-w-md",children:i.jsxs("div",{className:"p-6",children:[i.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Mark Item as Received"}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Product"}),i.jsx("p",{className:"text-gray-900",children:null==(e=te.product)?void 0:e.name})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Quantity Received"}),i.jsx("input",{type:"number",max:te.quantity,min:0,value:se.quantity,onChange:e=>ae(t=>({...t,quantity:parseInt(e.target.value)||0})),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500"}),i.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Expected: ",te.quantity]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes"}),i.jsx("textarea",{value:se.notes,onChange:e=>ae(t=>({...t,notes:e.target.value})),placeholder:"Any notes about the received items...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-purple-500 resize-none",rows:3})]})]}),i.jsxs("div",{className:"flex gap-3 mt-6",children:[i.jsx(l,{onClick:async()=>{if(te)try{await T(te.id,se.quantity,se.notes),j.success("Item marked as received successfully"),W(!1),re(null)}catch(e){j.error("Failed to mark item as received")}},icon:i.jsx(x,{size:18}),className:"flex-1 bg-gradient-to-r from-green-500 to-emerald-600 text-white",children:"Confirm Received"}),i.jsx(l,{onClick:()=>W(!1),className:"flex-1 bg-gray-100 text-gray-700",children:"Cancel"})]})]})})}),X&&te&&i.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:i.jsx(d,{className:"w-full max-w-md",children:i.jsxs("div",{className:"p-6",children:[i.jsxs("h3",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center gap-2",children:[i.jsx(g,{className:"w-5 h-5 text-red-600"}),"Report Damage"]}),i.jsxs("div",{className:"space-y-4",children:[i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Product"}),i.jsx("p",{className:"text-gray-900",children:null==(t=te.product)?void 0:t.name}),i.jsxs("p",{className:"text-sm text-gray-600",children:["Tracking: ",te.trackingNumber]})]}),i.jsxs("div",{children:[i.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Damage Report"}),i.jsx("textarea",{value:ie,onChange:e=>le(e.target.value),placeholder:"Describe the damage or issue with the shipment...",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-red-500 resize-none",rows:4,required:!0})]})]}),i.jsxs("div",{className:"flex gap-3 mt-6",children:[i.jsx(l,{onClick:async()=>{if(te&&ie.trim())try{await R(te.id,ie),j.success("Damage report submitted successfully"),ee(!1),re(null)}catch(e){j.error("Failed to submit damage report")}},icon:i.jsx(g,{size:18}),className:"flex-1 bg-gradient-to-r from-red-500 to-red-600 text-white",disabled:!ie.trim(),children:"Submit Report"}),i.jsx(l,{onClick:()=>ee(!1),className:"flex-1 bg-gray-100 text-gray-700",children:"Cancel"})]})]})})})]}):null};export{S as default};
