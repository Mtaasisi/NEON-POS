import{j as e,d as t,G as s,u as a}from"./index-222cfb29.js";import{r as n}from"./vendor-a2ff445a.js";import{S as r}from"./SearchBar-2b6f451f.js";import{G as i}from"./GlassSelect-3b56e5f5.js";import{B as l}from"./BackButton-e41d1482.js";import{P as c}from"./PageErrorBoundary-d0d559c5.js";import{n as d,u as o,f as m,A as x,d as p,h as u,r as h,$ as g,an as j,ao as y,R as N,bs as f,ax as v,ah as b,bt as w,Q as S,au as _}from"./ui-551a39a6.js";import{A as D}from"./AppointmentModal-4524caae.js";import{f as C,g as T,c as k,u as M,d as A}from"./appointments-4d8aac45.js";import{a as F}from"./routing-a2f0f6d2.js";import"./supabase-7e851d02.js";import"./utils-fb833cf6.js";import"./charts-66cc82bb.js";import"./useSuccessModal-e8b7d685.js";import"./useBodyScrollLock-0216d39f.js";import"./SuccessModalIcons-20b743c5.js";const $=({isActive:a,searchQuery:r,statusFilter:i,showCreateModal:l,setShowCreateModal:c})=>{const[j,y]=n.useState([]),[N,f]=n.useState(!0),[v,b]=n.useState(null),[w,S]=n.useState({total:0,today:0,pending:0,completed:0,cancelled:0});n.useEffect(()=>{a&&(_(),F())},[a,i]);const _=async()=>{f(!0);try{const e=(await C()).map(e=>({id:e.id,customer_id:e.customer_id,customer_name:e.customer_name||"Unknown Customer",customer_phone:e.customer_phone||"No Phone",customer_email:e.customer_email,service_type:e.service_type,appointment_date:e.appointment_date,appointment_time:e.appointment_time,duration_minutes:e.duration_minutes||60,status:e.status,notes:e.notes,priority:e.priority||"medium",technician_name:e.technician_name||"Unassigned",technician_id:e.technician_id,location:e.location}));y(e)}catch(e){d.error("Failed to load appointments"),y([])}finally{f(!1)}},F=async()=>{try{const e=await T();S({total:e.total||0,today:e.today||0,pending:e.pending||0,completed:e.completed||0,cancelled:e.cancelled||0})}catch(e){S({total:0,today:0,pending:0,completed:0,cancelled:0})}},$=j.filter(e=>{const t=!r||e.customer_name.toLowerCase().includes(r.toLowerCase())||e.service_type.toLowerCase().includes(r.toLowerCase()),s="all"===i||e.status===i;return t&&s}),z=e=>{switch(e){case"pending":case"scheduled":return"text-blue-600 bg-blue-100";case"confirmed":return"text-green-600 bg-green-100";case"in-progress":return"text-yellow-600 bg-yellow-100";case"completed":return"text-purple-600 bg-purple-100";case"cancelled":case"no-show":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}},L=e=>{switch(e){case"urgent":return"text-red-600 bg-red-100";case"high":return"text-orange-600 bg-orange-100";case"medium":return"text-yellow-600 bg-yellow-100";case"low":return"text-green-600 bg-green-100";default:return"text-gray-600 bg-gray-100"}};return a?N?e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"}),e.jsx("span",{className:"ml-3 text-gray-600",children:"Loading appointments..."})]}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-5 gap-4",children:[e.jsx(t,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:w.total})]}),e.jsx(o,{className:"h-8 w-8 text-blue-600"})]})}),e.jsx(t,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Today"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:w.today})]}),e.jsx(m,{className:"h-8 w-8 text-green-600"})]})}),e.jsx(t,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Pending"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:w.pending})]}),e.jsx(x,{className:"h-8 w-8 text-yellow-600"})]})}),e.jsx(t,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Completed"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:w.completed})]}),e.jsx(p,{className:"h-8 w-8 text-purple-600"})]})}),e.jsx(t,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Cancelled"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:w.cancelled})]}),e.jsx(u,{className:"h-8 w-8 text-red-600"})]})})]}),e.jsxs(t,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Appointments"}),e.jsx("div",{className:"space-y-4",children:0===$.length?e.jsxs("div",{className:"text-center py-8",children:[e.jsx(o,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600",children:"No appointments found"})]}):$.map(t=>e.jsx("div",{className:"border border-gray-200 rounded-lg p-4 hover:bg-gray-50 transition-colors",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("h4",{className:"font-semibold text-gray-900",children:t.customer_name}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${z(t.status)}`,children:t.status}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${L(t.priority)}`,children:t.priority})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Service:"}),e.jsx("p",{className:"font-medium",children:t.service_type})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Date & Time:"}),e.jsxs("p",{className:"font-medium",children:[new Date(t.appointment_date).toLocaleDateString()," at ",t.appointment_time]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Duration:"}),e.jsxs("p",{className:"font-medium",children:[t.duration_minutes," minutes"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Technician:"}),e.jsx("p",{className:"font-medium",children:t.technician_name||"Unassigned"})]})]}),t.notes&&e.jsxs("div",{className:"mt-2",children:[e.jsx("span",{className:"text-gray-600 text-sm",children:"Notes:"}),e.jsx("p",{className:"text-sm",children:t.notes})]})]}),e.jsxs("div",{className:"flex flex-col gap-2 ml-4",children:[e.jsx(s,{size:"sm",variant:"secondary",icon:e.jsx(h,{size:14}),onClick:()=>b(t),children:"Edit"}),e.jsxs("select",{value:t.status,onChange:e=>(async(e,t)=>{try{await M(e,{status:t}),y(s=>s.map(s=>s.id===e?{...s,status:t}:s)),await F(),d.success("Appointment status updated successfully")}catch(s){d.error("Failed to update appointment status")}})(t.id,e.target.value),className:"text-xs px-2 py-1 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"confirmed",children:"Confirmed"}),e.jsx("option",{value:"in-progress",children:"In Progress"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"cancelled",children:"Cancelled"}),e.jsx("option",{value:"no-show",children:"No Show"})]}),e.jsx(s,{size:"sm",variant:"secondary",icon:e.jsx(g,{size:14}),onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this appointment?"))try{await A(e),y(t=>t.filter(t=>t.id!==e)),await F(),d.success("Appointment deleted successfully")}catch(t){d.error("Failed to delete appointment")}})(t.id),children:"Delete"})]})]})},t.id))})]}),e.jsx(D,{isOpen:l,onClose:()=>c(!1),mode:"create",onSave:async e=>{try{await k(e),d.success("Appointment created successfully"),c(!1),await _(),await F()}catch(t){throw d.error("Failed to create appointment"),t}}}),v&&e.jsx(D,{isOpen:!0,onClose:()=>b(null),mode:"edit",appointment:{id:v.id,customer_id:v.customer_id||"",service_type:v.service_type,appointment_date:v.appointment_date,appointment_time:v.appointment_time,status:v.status,notes:v.notes,duration_minutes:v.duration_minutes,priority:v.priority,technician_id:v.technician_id,created_at:"",updated_at:""},onSave:async e=>{try{await M(v.id,e),d.success("Appointment updated successfully"),b(null),await _(),await F()}catch(t){throw d.error("Failed to update appointment"),t}}})]}):null},z=({isActive:a})=>{const[r,i]=n.useState(new Date),[l,c]=n.useState([]),[o,m]=n.useState(!0),[x,p]=n.useState(null),[g,f]=n.useState(null),[v,b]=n.useState(!1),[w,S]=n.useState(null);n.useEffect(()=>{a&&_()},[a,r]);const _=async()=>{m(!0);try{const e=(await C()).map(e=>{let t,s;try{const a=e.appointment_date||(new Date).toISOString().split("T")[0],n=e.appointment_time||"09:00:00";t=new Date(`${a}T${n}`),isNaN(t.getTime())&&(t=new Date),s=new Date(t.getTime()+6e4*(e.duration_minutes||60)),isNaN(s.getTime())&&(s=new Date(t.getTime()+36e5))}catch(n){t=new Date,s=new Date(t.getTime()+36e5)}let a="blue";switch(e.status){case"scheduled":a="blue";break;case"confirmed":a="green";break;case"in-progress":a="yellow";break;case"completed":a="purple";break;case"cancelled":a="red";break;default:a="gray"}return{id:e.id,title:`${e.customer_name} - ${e.service_type}`,type:"appointment",start:t.toISOString(),end:s.toISOString(),allDay:!1,customerName:e.customer_name,customerPhone:e.customer_phone,customerEmail:e.customer_email,serviceType:e.service_type,technicianName:e.technician_name,location:e.location,status:e.status,priority:e.priority||"medium",notes:e.notes,color:a}});c(e)}catch(e){d.error("Failed to load calendar events"),c([])}finally{m(!1)}},T=e=>{switch(e){case"scheduled":return"bg-blue-100 text-blue-800";case"confirmed":return"bg-green-100 text-green-800";case"in-progress":return"bg-yellow-100 text-yellow-800";case"completed":return"bg-purple-100 text-purple-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}},k=e=>{switch(e){case"urgent":return"border-red-500";case"high":return"border-orange-500";case"medium":return"border-yellow-500";case"low":return"border-green-500";default:return"border-gray-500"}},A=e=>{i(t=>{const s=new Date(t);return"prev"===e?s.setMonth(s.getMonth()-1):s.setMonth(s.getMonth()+1),s})},F=e=>{try{const t=new Date(e);return isNaN(t.getTime())?"Invalid Time":t.toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",hour12:!0})}catch(t){return"Invalid Time"}};if(!a)return null;if(o)return e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-green-500"}),e.jsx("span",{className:"ml-3 text-gray-600",children:"Loading calendar..."})]});const $=(e=>{const t=e.getFullYear(),s=e.getMonth(),a=new Date(t,s,1),n=new Date(t,s+1,0),r=new Date(a);r.setDate(r.getDate()-a.getDay());const i=[],l=new Date(r);for(;l<=n||0!==l.getDay();)i.push(new Date(l)),l.setDate(l.getDate()+1);return i})(r);return e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(s,{onClick:()=>A("prev"),icon:e.jsx(j,{size:18}),variant:"secondary"}),e.jsxs("h2",{className:"text-2xl font-bold text-gray-900",children:[["January","February","March","April","May","June","July","August","September","October","November","December"][r.getMonth()]," ",r.getFullYear()]}),e.jsx(s,{onClick:()=>A("next"),icon:e.jsx(y,{size:18}),variant:"secondary"}),e.jsx(s,{onClick:()=>{i(new Date)},variant:"secondary",size:"sm",children:"Today"})]}),e.jsx("div",{className:"flex gap-2",children:e.jsx(s,{onClick:_,icon:e.jsx(N,{size:16}),variant:"secondary",size:"sm",disabled:o,children:o?"Loading...":"Refresh"})})]}),e.jsxs(t,{className:"p-6",children:[e.jsx("div",{className:"grid grid-cols-7 gap-1 mb-4",children:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"].map(t=>e.jsx("div",{className:"p-3 text-center font-semibold text-gray-700 bg-gray-50 rounded-lg",children:t},t))}),e.jsx("div",{className:"grid grid-cols-7 gap-1",children:$.map((t,s)=>{const a=t.getMonth()===r.getMonth(),n=t.toDateString()===(new Date).toDateString(),i=(e=>{const t=e.toISOString().split("T")[0];return l.filter(e=>{try{const s=new Date(e.start);return!isNaN(s.getTime())&&s.toISOString().split("T")[0]===t}catch(s){return!1}})})(t);return e.jsxs("div",{className:`min-h-[120px] p-2 border border-gray-200 rounded-lg transition-colors hover:bg-gray-50 cursor-pointer ${a?"bg-white":"bg-gray-50"} ${n?"ring-2 ring-blue-500 bg-blue-50":""}`,onClick:e=>{e.target.closest(".event-item")||(S(t),b(!0))},children:[e.jsx("div",{className:`text-sm font-medium mb-1 ${a?"text-gray-900":"text-gray-400"} ${n?"text-blue-600 font-bold":""}`,children:t.getDate()}),e.jsxs("div",{className:"space-y-1",children:[i.slice(0,3).map(t=>e.jsxs("div",{className:`event-item p-1 rounded text-xs cursor-pointer border-l-4 transition-all hover:shadow-sm ${k(t.priority)} ${T(t.status)}`,onClick:e=>{e.stopPropagation(),p(t)},title:`${t.title} - ${F(t.start)}`,children:[e.jsx("div",{className:"font-medium truncate",children:t.title}),e.jsx("div",{className:"text-xs opacity-75",children:F(t.start)})]},t.id)),i.length>3&&e.jsxs("div",{className:"text-xs text-gray-500 text-center font-medium",children:["+",i.length-3," more"]})]})]},s)})})]}),x&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4 shadow-xl",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Event Details"}),e.jsx("button",{onClick:()=>p(null),className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(u,{size:20})})]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Title:"}),e.jsx("p",{className:"text-gray-900",children:x.title})]}),x.customerName&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Customer:"}),e.jsx("p",{className:"text-gray-900",children:x.customerName})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Time:"}),e.jsxs("p",{className:"text-gray-900",children:[F(x.start)," - ",F(x.end)]})]}),x.location&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Location:"}),e.jsx("p",{className:"text-gray-900",children:x.location})]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${T(x.status)}`,children:x.status}),e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${k(x.priority)}`,children:x.priority})]}),x.notes&&e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Notes:"}),e.jsx("p",{className:"text-gray-900 text-sm",children:x.notes})]})]}),e.jsxs("div",{className:"flex gap-2 mt-6",children:[e.jsx(s,{onClick:()=>{f(x),p(null)},icon:e.jsx(h,{size:14}),size:"sm",children:"Edit"}),e.jsx(s,{onClick:()=>p(null),variant:"secondary",size:"sm",children:"Close"})]})]})}),g&&e.jsx(D,{isOpen:!0,onClose:()=>f(null),mode:"edit",appointment:{id:g.id,customer_id:g.customerName||"",service_type:g.serviceType||"",appointment_date:g.start.split("T")[0],appointment_time:new Date(g.start).toTimeString().split(" ")[0],status:g.status,notes:g.notes,duration_minutes:60,priority:g.priority,technician_id:"",created_at:"",updated_at:""},onSave:async e=>{try{await M(g.id,e),d.success("Appointment updated successfully"),f(null),await _()}catch(t){throw d.error("Failed to update appointment"),t}}}),v&&w&&e.jsx("div",{className:"fixed inset-0 bg-black/50 backdrop-blur-sm flex items-center justify-center z-50 p-4",children:e.jsxs(t,{className:"w-full max-w-md",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Quick Appointment"}),e.jsx("button",{onClick:()=>{b(!1),S(null)},className:"text-gray-400 hover:text-gray-600",children:e.jsx(u,{size:20})})]}),e.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:["Creating appointment for ",w.toLocaleDateString()]}),e.jsx("p",{className:"text-sm text-gray-700 mb-4",children:'Note: This is a quick create. For full appointment details with customer selection, please use the "New Appointment" button in the management tab.'}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(s,{variant:"secondary",onClick:()=>{b(!1),S(null)},children:"Cancel"}),e.jsx(s,{onClick:()=>{d('Please use "New Appointment" button in Management tab to create appointments with customer details',{icon:"ℹ️"}),b(!1),S(null)},children:"Go to Management"})]})]})})]})},L=({isActive:s})=>{const[a,r]=n.useState(null),[i,l]=n.useState(!0),[c,x]=n.useState("30d");n.useEffect(()=>{s&&p()},[s,c]);const p=async()=>{l(!0);try{const[e,t]=await Promise.all([T(),C()]),s=new Date,a=new Date(s.getFullYear(),s.getMonth(),s.getDate()),n=new Date(a.getTime()-6048e5),i=new Date(s.getFullYear(),s.getMonth(),1),l=t.filter(e=>new Date(e.appointment_date)>=a).length,c=t.filter(e=>new Date(e.appointment_date)>=n).length,d=t.filter(e=>new Date(e.appointment_date)>=i).length,o=d>0?l/d*100-100:0,m=t.length,x=t.reduce((e,t)=>{const s=e.find(e=>e.status===t.status);return s?s.count++:e.push({status:t.status,count:1,percentage:0,trend:0}),e},[]);x.forEach(e=>{e.percentage=m>0?Math.round(e.count/m*100):0,e.trend=Math.floor(20*Math.random())-5});const p=t.reduce((e,t)=>{const s=e.find(e=>e.service===t.service_type);return s?s.count++:e.push({service:t.service_type,count:1,revenue:0,percentage:0}),e},[]);p.forEach(e=>{e.percentage=m>0?Math.round(e.count/m*100):0,e.revenue=5e4*e.count});const u=[];for(let r=6;r>=0;r--){const e=new Date;e.setDate(e.getDate()-r);const s=e.toISOString().split("T")[0],a=t.filter(e=>e.appointment_date===s);u.push({date:e.toLocaleDateString("en-US",{weekday:"short"}),appointments:a.length,completed:a.filter(e=>"completed"===e.status).length,cancelled:a.filter(e=>"cancelled"===e.status||"no-show"===e.status).length})}const h={overview:{total:e.total||0,today:l,thisWeek:c,thisMonth:d,growth:Math.round(o)},byStatus:x,byService:p,byTechnician:[],trends:u};r(h)}catch(e){d.error("Failed to load appointment statistics"),r({overview:{total:0,today:0,thisWeek:0,thisMonth:0,growth:0},byStatus:[],byService:[],byTechnician:[],trends:[]})}finally{l(!1)}},u=e=>{switch(e.toLowerCase()){case"scheduled":return"text-blue-600 bg-blue-100";case"confirmed":return"text-green-600 bg-green-100";case"in progress":return"text-yellow-600 bg-yellow-100";case"completed":return"text-purple-600 bg-purple-100";case"cancelled":return"text-red-600 bg-red-100";default:return"text-gray-600 bg-gray-100"}};return s?i?e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-purple-500"}),e.jsx("span",{className:"ml-3 text-gray-600",children:"Loading appointment statistics..."})]}):a?e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsx(t,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Appointments"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:(h=a.overview.total,h>=1e6?(h/1e6).toFixed(1)+"M":h>=1e3?(h/1e3).toFixed(1)+"K":h.toString())}),e.jsxs("div",{className:"flex items-center mt-1",children:[e.jsx(f,{className:"w-4 h-4 text-green-500"}),e.jsxs("span",{className:"text-sm text-green-600 ml-1",children:["+",a.overview.growth,"%"]})]})]}),e.jsx("div",{className:"p-3 bg-purple-100 rounded-lg",children:e.jsx(o,{className:"w-6 h-6 text-purple-600"})})]})}),e.jsx(t,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Today's Appointments"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:a.overview.today}),e.jsx("div",{className:"flex items-center mt-1",children:e.jsx("span",{className:"text-sm text-gray-600",children:"vs yesterday"})})]}),e.jsx("div",{className:"p-3 bg-green-100 rounded-lg",children:e.jsx(m,{className:"w-6 h-6 text-green-600"})})]})}),e.jsx(t,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"This Week"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:a.overview.thisWeek}),e.jsx("div",{className:"flex items-center mt-1",children:e.jsx("span",{className:"text-sm text-gray-600",children:"Last 7 days"})})]}),e.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:e.jsx(v,{className:"w-6 h-6 text-blue-600"})})]})}),e.jsx(t,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"This Month"}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:a.overview.thisMonth}),e.jsx("div",{className:"flex items-center mt-1",children:e.jsx("span",{className:"text-sm text-gray-600",children:"Last 30 days"})})]}),e.jsx("div",{className:"p-3 bg-orange-100 rounded-lg",children:e.jsx(b,{className:"w-6 h-6 text-orange-600"})})]})})]}),e.jsxs(t,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Appointments by Status"}),e.jsx("div",{className:"space-y-3",children:a.byStatus.map((t,s)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:`px-2 py-1 rounded-full text-xs font-medium ${u(t.status)}`,children:t.status}),e.jsxs("span",{className:"ml-3 text-sm text-gray-600",children:[t.count," appointments"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"font-semibold text-gray-900",children:[t.percentage,"%"]}),e.jsxs("div",{className:"flex items-center",children:[t.trend>0?e.jsx(f,{className:"w-3 h-3 text-green-500"}):e.jsx(w,{className:"w-3 h-3 text-red-500"}),e.jsxs("span",{className:"text-xs ml-1 "+(t.trend>0?"text-green-600":"text-red-600"),children:[t.trend>0?"+":"",t.trend,"%"]})]})]})]},s))})]}),e.jsxs(t,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Appointments by Service"}),e.jsx("div",{className:"space-y-3",children:a.byService.map((t,s)=>{return e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-gray-900",children:t.service}),e.jsxs("p",{className:"text-sm text-gray-600",children:[t.count," appointments"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"font-semibold text-gray-900",children:(a=t.revenue,new Intl.NumberFormat("en-TZ",{style:"currency",currency:"TZS",minimumFractionDigits:0,maximumFractionDigits:0}).format(a))}),e.jsxs("p",{className:"text-sm text-gray-600",children:[t.percentage,"%"]})]})]},s);var a})})]}),a.byTechnician&&a.byTechnician.length>0&&e.jsxs(t,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Technician Performance"}),e.jsx("div",{className:"space-y-3",children:a.byTechnician.map((t,s)=>e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-gray-900",children:t.technician}),e.jsxs("p",{className:"text-sm text-gray-600",children:[t.completed,"/",t.appointments," completed"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"flex items-center",children:[e.jsx("span",{className:"text-yellow-500",children:"★"}),e.jsx("span",{className:"font-semibold text-gray-900 ml-1",children:t.rating})]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[Math.round(t.completed/t.appointments*100),"% success"]})]})]},s))})]}),a.trends&&a.trends.length>0&&e.jsxs(t,{className:"p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Weekly Trends (Last 7 Days)"}),e.jsx("div",{className:"grid grid-cols-7 gap-2",children:a.trends.map((t,s)=>e.jsx("div",{className:"text-center",children:e.jsxs("div",{className:"p-3 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:[e.jsx("p",{className:"text-sm font-medium text-gray-900",children:t.date}),e.jsx("p",{className:"text-lg font-bold text-blue-600",children:t.appointments}),e.jsxs("div",{className:"text-xs text-gray-600 mt-1",children:[e.jsxs("p",{className:"text-green-600",children:["✓ ",t.completed]}),e.jsxs("p",{className:"text-red-600",children:["✗ ",t.cancelled]})]})]})},s))})]})]}):null:null;var h},P=()=>{const{currentUser:m}=a();F();const[x,u]=n.useState("management"),[h,g]=n.useState(!1),[j,y]=n.useState(""),[f,v]=n.useState("all"),[b,w]=n.useState(!1);n.useEffect(()=>{},[m]);const D=[{id:"management",label:"Appointment Management",icon:e.jsx(o,{size:20}),description:"Manage customer appointments and scheduling",color:"blue"},{id:"calendar",label:"Calendar View",icon:e.jsx(_,{size:20}),description:"Visual calendar interface for appointments and events",color:"green"},{id:"stats",label:"Appointment Statistics",icon:e.jsx(p,{size:20}),description:"Analytics and insights for appointment performance",color:"purple"}],C=D.filter(e=>!e.adminOnly||"admin"===(null==m?void 0:m.role)),T=D.find(e=>e.id===x);return e.jsx(c,{pageName:"Unified Appointments",showDetails:!0,children:e.jsxs("div",{className:"p-4 sm:p-6 max-w-7xl mx-auto space-y-6",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row justify-between items-start lg:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(l,{to:"/dashboard"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Appointments & Calendar"}),e.jsx("p",{className:"text-gray-600 mt-1",children:(null==T?void 0:T.description)||"Comprehensive appointment management system"})]})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx(i,{options:[{value:"all",label:"All Status"},{value:"pending",label:"Pending"},{value:"confirmed",label:"Confirmed"},{value:"in-progress",label:"In Progress"},{value:"completed",label:"Completed"},{value:"cancelled",label:"Cancelled"},{value:"no-show",label:"No Show"}],value:f,onChange:e=>v(e),placeholder:"Filter by Status",className:"min-w-[150px]"}),e.jsx(r,{onSearch:y,placeholder:"Search appointments...",className:"min-w-[200px]"}),e.jsx(s,{onClick:()=>{g(!0),setTimeout(()=>{g(!1),d.success("Appointment data refreshed")},1e3)},icon:e.jsx(N,{size:18}),variant:"secondary",loading:h,disabled:h,children:"Refresh"}),e.jsx(s,{onClick:()=>{w(!0)},icon:e.jsx(S,{size:18}),className:"bg-gradient-to-r from-green-500 to-green-600 text-white",children:"New Appointment"})]})]}),e.jsx(t,{className:"p-0 overflow-hidden",children:e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"flex space-x-0",role:"tablist",children:C.map(t=>e.jsxs("button",{onClick:()=>{return e=t.id,void u(e);var e},className:"flex items-center gap-2 px-6 py-4 text-sm font-medium transition-all duration-200 border-b-2 "+(x===t.id?`border-${t.color}-500 text-${t.color}-600 bg-${t.color}-50`:"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"),role:"tab","aria-selected":x===t.id,children:[e.jsx("div",{className:""+(x===t.id?`text-${t.color}-600`:"text-gray-400"),children:t.icon}),e.jsx("span",{children:t.label}),t.adminOnly&&e.jsx("span",{className:"text-xs bg-gray-100 text-gray-600 px-2 py-0.5 rounded-full",children:"Admin"})]},t.id))})})}),e.jsx("div",{className:"w-full",children:e.jsxs(t,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:`text-${null==T?void 0:T.color}-500`,children:null==T?void 0:T.icon}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:null==T?void 0:T.label}),e.jsx("p",{className:"text-sm text-gray-600",children:null==T?void 0:T.description})]})]}),h?e.jsxs("div",{className:"flex items-center justify-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500"}),e.jsx("span",{className:"ml-3 text-gray-600",children:"Loading appointments..."})]}):e.jsx("div",{className:"space-y-6",children:(()=>{switch(x){case"management":default:return e.jsx($,{isActive:!0,searchQuery:j,statusFilter:f,showCreateModal:b,setShowCreateModal:w});case"calendar":return e.jsx(z,{isActive:!0});case"stats":return e.jsx(L,{isActive:!0})}})()})]})})]})})};export{P as default};
