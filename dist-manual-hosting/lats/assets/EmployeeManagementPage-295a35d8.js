import{s as e,j as s,u as t,v as a,d as l}from"./index-222cfb29.js";import{r}from"./vendor-a2ff445a.js";import{a as n,c as i}from"./routing-a2f0f6d2.js";import{B as o}from"./BackButton-e41d1482.js";import{G as c}from"./GlassSelect-3b56e5f5.js";import{v as d,n as m,r as x,o as u,X as p,U as h,a4 as g,K as b,u as f,y,t as j,az as N,e as v,Q as w,f as k,aj as S,d as C,p as E,ab as I,$ as D,j as $,P as A,bh as O,ay as P,A as L,a5 as R,ax as _}from"./ui-551a39a6.js";import{e as F}from"./employeeService-806781a0.js";import{u as z,S as T}from"./useSuccessModal-e8b7d685.js";import"./supabase-7e851d02.js";import"./utils-fb833cf6.js";import"./charts-66cc82bb.js";import"./useBodyScrollLock-0216d39f.js";const M=({value:t,onChange:a,label:l="Branch/Store",placeholder:n="Select branch",required:i=!1,error:o,allowMultiple:m=!1,className:x="",showMainBadge:u=!0})=>{const[p,h]=r.useState([]),[g,b]=r.useState(!0);r.useEffect(()=>{f()},[]);const f=async()=>{try{b(!0);const{data:s,error:t}=await e.from("store_locations").select("id, name, code, is_main, is_active").eq("is_active",!0).order("is_main",{ascending:!1}).order("name",{ascending:!0});if(t)throw t;h(s||[])}catch(s){h([])}finally{b(!1)}},y=p.map(e=>({value:e.id,label:`${e.name}${e.code?` (${e.code})`:""}${u&&e.is_main?" ðŸ¢ Main":""}`}));return g?s.jsxs("div",{className:x,children:[l&&s.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:[l," ",i&&s.jsx("span",{className:"text-red-500",children:"*"})]}),s.jsx("div",{className:"w-full px-3 py-2 border border-gray-300 rounded-lg bg-gray-50",children:s.jsx("span",{className:"text-gray-500 text-sm",children:"Loading branches..."})})]}):s.jsxs("div",{className:x,children:[s.jsx(c,{label:l,placeholder:n,value:t||"",onChange:a,options:y,error:o,required:i,icon:s.jsx(d,{size:16})}),0===p.length&&s.jsx("p",{className:"mt-1 text-xs text-orange-600",children:"âš ï¸ No active branches found. Please create a branch first in Settings â†’ Store Management."})]})},q=({employee:t,isOpen:a,onClose:l,onSave:n})=>{const i=new Date,o=`${i.getFullYear()}-${String(i.getMonth()+1).padStart(2,"0")}-${String(i.getDate()).padStart(2,"0")}`,[d,f]=r.useState({firstName:"",lastName:"",email:"",phone:"",position:"",department:"",hireDate:o,salary:0,status:"active",performance:3,attendance:100,skills:[],manager:"",location:"",branchId:"",userId:"",userRole:""}),[y,j]=r.useState({}),[N,v]=r.useState(""),[w,k]=r.useState([]),[S,C]=r.useState(!1);r.useEffect(()=>{if(t)f(t);else{const e=new Date,s=`${e.getFullYear()}-${String(e.getMonth()+1).padStart(2,"0")}-${String(e.getDate()).padStart(2,"0")}`;f({firstName:"",lastName:"",email:"",phone:"",position:"",department:"",hireDate:s,salary:0,status:"active",performance:3,attendance:100,skills:[],manager:"",location:"",branchId:"",userId:"",userRole:""})}j({})},[t,a]),r.useEffect(()=>{a&&E()},[a]);const E=async()=>{C(!0);try{const{data:s,error:t}=await e.from("users").select("id, email, full_name, role").order("full_name",{ascending:!0});if(t)throw t;k(s||[])}catch(s){m.error("Failed to load users")}finally{C(!1)}},I=()=>{const e=d.skills||[];N.trim()&&!e.includes(N.trim())&&(f(e=>({...e,skills:[...e.skills||[],N.trim()]})),v(""))};return a?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed bg-black/50",onClick:l,style:{left:"var(--sidebar-width, 0px)",top:"var(--topbar-height, 64px)",right:0,bottom:0,zIndex:35}}),s.jsx("div",{className:"fixed flex items-center justify-center p-4",style:{left:"var(--sidebar-width, 0px)",top:"var(--topbar-height, 64px)",right:0,bottom:0,zIndex:50,pointerEvents:"none"},children:s.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto",children:s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center "+(t?"bg-blue-100":"bg-green-100"),children:t?s.jsx(x,{className:"w-5 h-5 text-blue-600"}):s.jsx(u,{className:"w-5 h-5 text-green-600"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-xl font-bold text-gray-900",children:t?"Edit Employee":"Add New Employee"}),s.jsx("p",{className:"text-xs text-gray-500",children:t?"Update employee information":"Create a new employee record"})]})]}),s.jsx("button",{onClick:l,className:"text-gray-400 hover:text-gray-600 transition-colors",children:s.jsx(p,{className:"w-6 h-6"})})]}),s.jsxs("form",{onSubmit:e=>{if(e.preventDefault(),!(()=>{var e;const s={};return d.firstName.trim()||(s.firstName="First name is required"),d.lastName.trim()||(s.lastName="Last name is required"),d.email.trim()?/\S+@\S+\.\S+/.test(d.email)||(s.email="Email is invalid"):s.email="Email is required",d.phone.trim()||(s.phone="Phone number is required"),d.position.trim()||(s.position="Position is required"),d.department.trim()||(s.department="Department is required"),d.hireDate||(s.hireDate="Hire date is required"),d.salary<=0&&(s.salary="Salary must be greater than 0"),(null==(e=d.branchId)?void 0:e.trim())||(s.branchId="Branch/Store is required"),j(s),0===Object.keys(s).length})())return void m.error("Please fix the errors in the form");const s={...d,id:(null==t?void 0:t.id)||Date.now().toString()};n(s),l(),m.success(t?"Employee updated successfully":"Employee added successfully")},className:"space-y-6",children:[s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"First Name *"}),s.jsx("input",{type:"text",value:d.firstName,onChange:e=>f(s=>({...s,firstName:e.target.value})),className:"w-full px-4 py-3 border-2 rounded-lg focus:outline-none transition-colors "+(y.firstName?"border-red-500 focus:border-red-600":"border-gray-200 focus:border-blue-500"),placeholder:"Enter first name"}),y.firstName&&s.jsx("p",{className:"text-red-500 text-sm mt-1",children:y.firstName})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Last Name *"}),s.jsx("input",{type:"text",value:d.lastName,onChange:e=>f(s=>({...s,lastName:e.target.value})),className:"w-full px-4 py-3 border-2 rounded-lg focus:outline-none transition-colors "+(y.lastName?"border-red-500 focus:border-red-600":"border-gray-200 focus:border-blue-500"),placeholder:"Enter last name"}),y.lastName&&s.jsx("p",{className:"text-red-500 text-sm mt-1",children:y.lastName})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email *"}),s.jsx("input",{type:"email",value:d.email,onChange:e=>f(s=>({...s,email:e.target.value})),className:"w-full px-4 py-3 border-2 rounded-lg focus:outline-none transition-colors "+(y.email?"border-red-500 focus:border-red-600":"border-gray-200 focus:border-blue-500"),placeholder:"Enter email address"}),y.email&&s.jsx("p",{className:"text-red-500 text-sm mt-1",children:y.email})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone Number *"}),s.jsx("input",{type:"tel",value:d.phone,onChange:e=>f(s=>({...s,phone:e.target.value})),className:"w-full px-4 py-3 border-2 rounded-lg focus:outline-none transition-colors "+(y.phone?"border-red-500 focus:border-red-600":"border-gray-200 focus:border-blue-500"),placeholder:"Enter phone number"}),y.phone&&s.jsx("p",{className:"text-red-500 text-sm mt-1",children:y.phone})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Position *"}),s.jsx("input",{type:"text",value:d.position,onChange:e=>f(s=>({...s,position:e.target.value})),className:"w-full px-4 py-3 border-2 rounded-lg focus:outline-none transition-colors "+(y.position?"border-red-500 focus:border-red-600":"border-gray-200 focus:border-blue-500"),placeholder:"Enter job position"}),y.position&&s.jsx("p",{className:"text-red-500 text-sm mt-1",children:y.position})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Department *"}),s.jsx(c,{options:[{value:"IT",label:"IT Department"},{value:"Service",label:"Service Department"},{value:"Support",label:"Support Department"},{value:"Sales",label:"Sales Department"},{value:"Marketing",label:"Marketing Department"},{value:"Finance",label:"Finance Department"},{value:"HR",label:"Human Resources"}],value:d.department,onChange:e=>f(s=>({...s,department:e})),placeholder:"Select department"}),y.department&&s.jsx("p",{className:"text-red-500 text-sm mt-1",children:y.department})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Hire Date *"}),s.jsx("input",{type:"date",value:d.hireDate,onChange:e=>f(s=>({...s,hireDate:e.target.value})),className:"w-full px-4 py-3 border-2 rounded-lg focus:outline-none transition-colors "+(y.hireDate?"border-red-500 focus:border-red-600":"border-gray-200 focus:border-blue-500")}),y.hireDate&&s.jsx("p",{className:"text-red-500 text-sm mt-1",children:y.hireDate})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Salary (TZS) *"}),s.jsx("input",{type:"number",value:d.salary,onChange:e=>f(s=>({...s,salary:Number(e.target.value)})),className:"w-full px-4 py-3 border-2 rounded-lg focus:outline-none transition-colors "+(y.salary?"border-red-500 focus:border-red-600":"border-gray-200 focus:border-blue-500"),placeholder:"Enter salary",min:"0"}),y.salary&&s.jsx("p",{className:"text-red-500 text-sm mt-1",children:y.salary})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),s.jsx(c,{options:[{value:"active",label:"Active"},{value:"inactive",label:"Inactive"},{value:"on-leave",label:"On Leave"},{value:"terminated",label:"Terminated"}],value:d.status,onChange:e=>f(s=>({...s,status:e})),placeholder:"Select status"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Performance Rating (1-5)"}),s.jsx("input",{type:"number",value:d.performance,onChange:e=>f(s=>({...s,performance:Number(e.target.value)})),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:border-blue-500 transition-colors",min:"1",max:"5",step:"0.1"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Attendance % (0-100)"}),s.jsx("input",{type:"number",value:d.attendance,onChange:e=>f(s=>({...s,attendance:Number(e.target.value)})),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:border-blue-500 transition-colors",min:"0",max:"100"})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Manager"}),s.jsx("input",{type:"text",value:d.manager,onChange:e=>f(s=>({...s,manager:e.target.value})),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:border-blue-500 transition-colors",placeholder:"Enter manager name"})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Work Location (Optional)"}),s.jsx("input",{type:"text",value:d.location,onChange:e=>f(s=>({...s,location:e.target.value})),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:border-blue-500 transition-colors",placeholder:"City or specific location"})]})]}),s.jsx("div",{children:s.jsx(M,{label:"Assigned Branch/Store",value:d.branchId,onChange:e=>f(s=>({...s,branchId:e})),placeholder:"Select employee's branch",required:!0,error:y.branchId})}),s.jsxs("div",{className:"border-t border-gray-200 pt-6",children:[s.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[s.jsx(h,{className:"w-5 h-5 text-purple-600"}),s.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"User Account Access"})]}),s.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Link this employee to a user account to give them system access. This allows them to log in and use the POS system."}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(g,{className:"w-4 h-4 text-gray-500"}),"Link to User Account (Optional)"]})}),s.jsx(c,{options:[{value:"",label:"No user account linked"},...w.map(e=>({value:e.id,label:`${e.full_name||e.email} (${e.role})`}))],value:d.userId||"",onChange:e=>{const s=w.find(s=>s.id===e);f(t=>({...t,userId:e,userRole:(null==s?void 0:s.role)||""}))},placeholder:S?"Loading users...":"Select user account"}),d.userId&&d.userRole&&s.jsxs("div",{className:"mt-2 flex items-center gap-2 px-3 py-2 bg-purple-50 rounded-lg",children:[s.jsx(b,{className:"w-4 h-4 text-purple-600"}),s.jsxs("span",{className:"text-sm text-purple-700",children:["Role: ",s.jsx("span",{className:"font-semibold capitalize",children:d.userRole})]})]})]}),s.jsxs("div",{className:"bg-blue-50 p-4 rounded-lg",children:[s.jsx("h4",{className:"text-sm font-semibold text-blue-900 mb-2",children:"ðŸ’¡ User Account Benefits"}),s.jsxs("ul",{className:"text-xs text-blue-800 space-y-1",children:[s.jsx("li",{children:"â€¢ System access with username/password"}),s.jsx("li",{children:"â€¢ Role-based permissions"}),s.jsx("li",{children:"â€¢ Track activities and actions"}),s.jsx("li",{children:"â€¢ Attendance self-service"}),s.jsx("li",{children:"â€¢ Personal dashboard access"})]})]})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Skills"}),s.jsxs("div",{className:"flex gap-2 mb-3",children:[s.jsx("input",{type:"text",value:N,onChange:e=>v(e.target.value),className:"flex-1 px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:border-blue-500 transition-colors",placeholder:"Add a skill",onKeyPress:e=>"Enter"===e.key&&(e.preventDefault(),I())}),s.jsx("button",{type:"button",onClick:I,className:"px-4 py-3 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-colors",children:"Add"})]}),s.jsx("div",{className:"flex flex-wrap gap-2",children:(d.skills||[]).map((e,t)=>s.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm",children:[e,s.jsx("button",{type:"button",onClick:()=>{return s=e,void f(e=>({...e,skills:(e.skills||[]).filter(e=>e!==s)}));var s},className:"text-blue-600 hover:text-blue-800",children:s.jsx(p,{size:14})})]},t))})]}),s.jsxs("div",{className:"flex gap-3 mt-6",children:[s.jsx("button",{type:"button",onClick:l,className:"flex-1 px-4 py-3 border-2 border-gray-200 rounded-lg text-gray-700 font-medium hover:bg-gray-50 transition-colors",children:"Cancel"}),s.jsx("button",{type:"submit",className:"flex-1 px-4 py-3 bg-green-600 text-white rounded-lg font-medium hover:bg-green-700 transition-colors",children:t?"Update Employee":"Add Employee"})]})]})]})})})]}):null},U=({employees:e,isOpen:t,onClose:a,onSave:l})=>{var n,i,o,d;const[x,u]=r.useState({employeeId:"",date:(new Date).toISOString().split("T")[0],checkIn:"",checkOut:"",status:"present",hours:0,notes:""}),[h,g]=r.useState({});r.useEffect(()=>{t&&(u({employeeId:"",date:(new Date).toISOString().split("T")[0],checkIn:"",checkOut:"",status:"present",hours:0,notes:""}),g({}))},[t]);const b=()=>e.find(e=>e.id===x.employeeId);return t?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"fixed bg-black/50",onClick:a,style:{left:"var(--sidebar-width, 0px)",top:"var(--topbar-height, 64px)",right:0,bottom:0,zIndex:35}}),s.jsx("div",{className:"fixed flex items-center justify-center p-4",style:{left:"var(--sidebar-width, 0px)",top:"var(--topbar-height, 64px)",right:0,bottom:0,zIndex:50,pointerEvents:"none"},children:s.jsx("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",onClick:e=>e.stopPropagation(),style:{pointerEvents:"auto"},children:s.jsxs("div",{className:"p-6",children:[s.jsxs("div",{className:"flex items-center justify-between mb-6",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:s.jsx(f,{className:"w-5 h-5 text-blue-600"})}),s.jsxs("div",{children:[s.jsx("h3",{className:"text-xl font-bold text-gray-900",children:"Mark Attendance"}),s.jsx("p",{className:"text-xs text-gray-500",children:"Record employee attendance for today"})]})]}),s.jsx("button",{onClick:a,className:"text-gray-400 hover:text-gray-600 transition-colors",children:s.jsx(p,{className:"w-6 h-6"})})]}),s.jsxs("form",{onSubmit:s=>{if(s.preventDefault(),!(()=>{const e={};return x.employeeId||(e.employeeId="Please select an employee"),x.date||(e.date="Date is required"),x.checkIn||(e.checkIn="Check-in time is required"),"present"!==x.status||x.checkOut||(e.checkOut="Check-out time is required for present status"),g(e),0===Object.keys(e).length})())return void m.error("Please fix the errors in the form");const t=e.find(e=>e.id===x.employeeId);if(!t)return void m.error("Selected employee not found");const r={id:Date.now().toString(),employeeId:x.employeeId,employeeName:`${t.firstName} ${t.lastName}`,date:x.date,checkIn:x.checkIn,checkOut:x.checkOut,status:x.status,hours:x.hours||0,notes:x.notes};l(r),a(),m.success("Attendance marked successfully")},className:"space-y-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Employee *"}),s.jsx(c,{options:e.map(e=>({value:e.id,label:`${e.firstName} ${e.lastName} - ${e.position} (${e.department})`})),value:x.employeeId,onChange:e=>u(s=>({...s,employeeId:e})),placeholder:"Select employee"}),h.employeeId&&s.jsx("p",{className:"text-red-500 text-sm mt-1",children:h.employeeId})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Date *"}),s.jsx("input",{type:"date",value:x.date,onChange:e=>u(s=>({...s,date:e.target.value})),className:"w-full px-4 py-3 border-2 rounded-lg focus:outline-none transition-colors "+(h.date?"border-red-500 focus:border-red-600":"border-gray-200 focus:border-blue-500")}),h.date&&s.jsx("p",{className:"text-red-500 text-sm mt-1",children:h.date})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),s.jsx(c,{options:[{value:"present",label:"Present"},{value:"absent",label:"Absent"},{value:"late",label:"Late"},{value:"half-day",label:"Half Day"}],value:x.status,onChange:e=>u(s=>({...s,status:e})),placeholder:"Select status"})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Check In Time *"}),s.jsx("input",{type:"time",value:x.checkIn,onChange:e=>u(s=>({...s,checkIn:e.target.value})),className:"w-full px-4 py-3 border-2 rounded-lg focus:outline-none transition-colors "+(h.checkIn?"border-red-500 focus:border-red-600":"border-gray-200 focus:border-blue-500")}),h.checkIn&&s.jsx("p",{className:"text-red-500 text-sm mt-1",children:h.checkIn})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Check Out Time"}),s.jsx("input",{type:"time",value:x.checkOut,onChange:e=>u(s=>({...s,checkOut:e.target.value})),className:"w-full px-4 py-3 border-2 rounded-lg focus:outline-none transition-colors "+(h.checkOut?"border-red-500 focus:border-red-600":"border-gray-200 focus:border-blue-500")}),h.checkOut&&s.jsx("p",{className:"text-red-500 text-sm mt-1",children:h.checkOut})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Hours Worked"}),s.jsxs("div",{className:"flex gap-2",children:[s.jsx("input",{type:"number",value:x.hours,onChange:e=>u(s=>({...s,hours:Number(e.target.value)})),className:"flex-1 px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:border-blue-500 transition-colors",placeholder:"0",min:"0",step:"0.5"}),s.jsx("button",{type:"button",onClick:()=>{if(x.checkIn&&x.checkOut){const e=new Date(`2000-01-01T${x.checkIn}`),s=(new Date(`2000-01-01T${x.checkOut}`).getTime()-e.getTime())/36e5;u(e=>({...e,hours:Math.max(0,s)}))}},className:"px-4 py-3 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-colors",children:"Calculate"})]})]}),s.jsxs("div",{children:[s.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes"}),s.jsx("textarea",{value:x.notes,onChange:e=>u(s=>({...s,notes:e.target.value})),className:"w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:border-blue-500 transition-colors",rows:3,placeholder:"Add any additional notes..."})]}),b()&&s.jsxs("div",{className:"bg-gray-50 p-4 rounded-lg",children:[s.jsx("h3",{className:"font-medium text-gray-900 mb-2",children:"Employee Information"}),s.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-600",children:"Name:"}),s.jsxs("span",{className:"ml-2 font-medium",children:[null==(n=b())?void 0:n.firstName," ",null==(i=b())?void 0:i.lastName]})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-600",children:"Position:"}),s.jsx("span",{className:"ml-2 font-medium",children:null==(o=b())?void 0:o.position})]}),s.jsxs("div",{children:[s.jsx("span",{className:"text-gray-600",children:"Department:"}),s.jsx("span",{className:"ml-2 font-medium",children:null==(d=b())?void 0:d.department})]})]})]}),s.jsxs("div",{className:"flex gap-3 mt-6",children:[s.jsx("button",{type:"button",onClick:a,className:"flex-1 px-4 py-3 border-2 border-gray-200 rounded-lg text-gray-700 font-medium hover:bg-gray-50 transition-colors",children:"Cancel"}),s.jsx("button",{type:"submit",className:"flex-1 px-4 py-3 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-colors",children:"Mark Attendance"})]})]})]})})})]}):null},B=({isOpen:t,onClose:a,onImportComplete:l})=>{const[n,i]=r.useState([]),[o,c]=r.useState(new Set),[d,x]=r.useState(!1),[h,g]=r.useState(!1),[b,f]=r.useState(""),[w,k]=r.useState("without");r.useEffect(()=>{t&&S()},[t]);const S=async()=>{x(!0);try{const{data:s,error:t}=await e.from("users").select("id, email, full_name, phone, role, department, is_active").eq("is_active",!0).order("full_name",{ascending:!0});if(t)throw t;const{data:a,error:l}=await e.from("employees").select("user_id").neq("user_id",null);if(l)throw l;const r=new Set((null==a?void 0:a.map(e=>e.user_id).filter(Boolean))||[]),n=(s||[]).map(e=>({...e,hasEmployeeRecord:r.has(e.id)}));i(n)}catch(s){m.error("Failed to load users")}finally{x(!1)}},C=e=>{const s=new Set(o);s.has(e)?s.delete(e):s.add(e),c(s)},E=()=>n.filter(e=>{const s=""===b||e.full_name.toLowerCase().includes(b.toLowerCase())||e.email.toLowerCase().includes(b.toLowerCase())||e.role.toLowerCase().includes(b.toLowerCase()),t="all"===w||"without"===w&&!e.hasEmployeeRecord||"with"===w&&e.hasEmployeeRecord;return s&&t}),I=E(),D=n.filter(e=>!e.hasEmployeeRecord).length;return t?s.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center p-4 bg-black bg-opacity-50 backdrop-blur-sm",children:s.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl w-full max-w-4xl max-h-[90vh] flex flex-col",children:[s.jsxs("div",{className:"flex items-center justify-between p-6 border-b border-gray-200",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"p-2 bg-blue-100 rounded-lg",children:s.jsx(u,{className:"w-6 h-6 text-blue-600"})}),s.jsxs("div",{children:[s.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Import Employees from Users"}),s.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:[D," user",1!==D?"s":""," without employee records"]})]})]}),s.jsx("button",{onClick:a,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",disabled:h,children:s.jsx(p,{className:"w-5 h-5 text-gray-500"})})]}),s.jsxs("div",{className:"p-4 border-b border-gray-200 space-y-3",children:[s.jsxs("div",{className:"flex gap-3",children:[s.jsxs("div",{className:"flex-1 relative",children:[s.jsx(y,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),s.jsx("input",{type:"text",placeholder:"Search by name, email, or role...",value:b,onChange:e=>f(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),s.jsxs("select",{value:w,onChange:e=>k(e.target.value),className:"px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",children:[s.jsx("option",{value:"all",children:"All Users"}),s.jsx("option",{value:"without",children:"Without Employee Record"}),s.jsx("option",{value:"with",children:"With Employee Record"})]})]}),s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("input",{type:"checkbox",checked:I.length>0&&o.size===I.length,onChange:()=>{const e=E();o.size===e.length?c(new Set):c(new Set(e.map(e=>e.id)))},className:"w-4 h-4 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"}),s.jsx("span",{className:"text-sm text-gray-600",children:o.size>0?s.jsxs("span",{className:"font-medium text-blue-600",children:[o.size," user",1!==o.size?"s":""," selected"]}):"Select users to import"})]}),s.jsxs("span",{className:"text-sm text-gray-500",children:[I.length," user",1!==I.length?"s":""," shown"]})]})]}),s.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:d?s.jsxs("div",{className:"flex items-center justify-center h-64",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),s.jsx("span",{className:"ml-3 text-gray-600",children:"Loading users..."})]}):0===I.length?s.jsxs("div",{className:"flex flex-col items-center justify-center h-64 text-gray-500",children:[s.jsx(j,{className:"w-16 h-16 mb-4 opacity-50"}),s.jsx("p",{className:"text-lg font-medium",children:"No users found"}),s.jsx("p",{className:"text-sm mt-1",children:"Try adjusting your filters"})]}):s.jsx("div",{className:"space-y-2",children:I.map(e=>s.jsx("div",{className:"p-4 border rounded-lg transition-all cursor-pointer "+(o.has(e.id)?"border-blue-500 bg-blue-50":e.hasEmployeeRecord?"border-gray-200 bg-gray-50 opacity-60":"border-gray-200 hover:border-blue-300 hover:bg-gray-50"),onClick:()=>!e.hasEmployeeRecord&&C(e.id),children:s.jsxs("div",{className:"flex items-start gap-3",children:[s.jsx("input",{type:"checkbox",checked:o.has(e.id),onChange:()=>C(e.id),disabled:e.hasEmployeeRecord,className:"mt-1 w-4 h-4 text-blue-600 rounded focus:ring-2 focus:ring-blue-500 disabled:opacity-50",onClick:e=>e.stopPropagation()}),s.jsxs("div",{className:"flex-1 min-w-0",children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("h3",{className:"font-medium text-gray-900",children:e.full_name}),e.hasEmployeeRecord&&s.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-green-100 text-green-700 text-xs rounded-full",children:[s.jsx(N,{className:"w-3 h-3"}),"Has Employee Record"]})]}),s.jsxs("div",{className:"flex items-center gap-4 mt-1 text-sm text-gray-600",children:[s.jsx("span",{children:e.email}),e.phone&&s.jsx("span",{children:e.phone})]}),s.jsxs("div",{className:"flex items-center gap-2 mt-2",children:[s.jsx("span",{className:"px-2 py-0.5 bg-purple-100 text-purple-700 text-xs rounded-full",children:e.role}),e.department&&s.jsx("span",{className:"px-2 py-0.5 bg-gray-200 text-gray-700 text-xs rounded-full",children:e.department})]})]})]})},e.id))})}),s.jsxs("div",{className:"flex items-center justify-between p-6 border-t border-gray-200 bg-gray-50",children:[s.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600",children:[s.jsx(v,{className:"w-4 h-4"}),s.jsx("span",{children:"Employee records will be created with basic info. You can edit them later."})]}),s.jsxs("div",{className:"flex gap-3",children:[s.jsx("button",{onClick:a,disabled:h,className:"px-4 py-2 text-gray-700 bg-white border border-gray-300 rounded-lg hover:bg-gray-50 transition-colors disabled:opacity-50",children:"Cancel"}),s.jsx("button",{onClick:async()=>{if(0===o.size)return void m.error("Please select at least one user to import");g(!0);let e=0,s=0;const t=[];try{for(const a of o){const l=n.find(e=>e.id===a);if(l)try{if(l.hasEmployeeRecord){t.push(`${l.full_name}: Already has employee record`),s++;continue}const a=l.full_name.split(" "),r=a[0]||"Unknown",n=a.slice(1).join(" ")||"User";await F.createEmployee({userId:l.id,firstName:r,lastName:n,email:l.email,phone:l.phone||"",position:l.role||"Staff",department:l.department||"General",hireDate:(new Date).toISOString().split("T")[0],salary:0,currency:"TZS",status:"active",employmentType:"full-time",performanceRating:3,skills:null}),e++}catch(r){t.push(`${l.full_name}: ${r.message||"Failed to import"}`),s++}}e>0&&m.success(`Successfully imported ${e} employee${1!==e?"s":""}`,{duration:4e3}),s>0&&m.error(`Failed to import ${s} user${1!==s?"s":""}. Check console for details.`,{duration:5e3}),e>0?(l(),a()):await S()}catch(r){m.error("An error occurred during import")}finally{g(!1),c(new Set)}},disabled:0===o.size||h,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:h?s.jsxs(s.Fragment,{children:[s.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-b-2 border-white"}),s.jsx("span",{children:"Importing..."})]}):s.jsxs(s.Fragment,{children:[s.jsx(u,{className:"w-4 h-4"}),s.jsxs("span",{children:["Import ",o.size>0?`(${o.size})`:""]})]})})]})]})]})}):null},H=()=>{t();const{currentBranch:c}=a();n(),i();const d=z(),[g,b]=r.useState([]),[f,N]=r.useState([]),[v,M]=r.useState([]),[H,G]=r.useState(!0),[W,Y]=r.useState("list"),[K,V]=r.useState(""),[Q,Z]=r.useState("all"),[J,X]=r.useState("all"),[ee,se]=r.useState("all"),[te,ae]=r.useState([]),[le,re]=r.useState(!1),[ne,ie]=r.useState(!1),[oe,ce]=r.useState(!1),[de,me]=r.useState(void 0),[xe,ue]=r.useState(!1);r.useEffect(()=>{he(),pe()},[c]);const pe=async()=>{try{const{data:s,error:t}=await e.from("store_locations").select("id, name, code, is_main").eq("is_active",!0).order("is_main",{ascending:!1}).order("name",{ascending:!0});if(t)throw t;M(s||[])}catch(s){}},he=async()=>{G(!0);try{const e=await F.getAllEmployees();b(e);const s=await F.getAllAttendanceRecords();N(s)}catch(e){m.error("Failed to load employee data")}finally{G(!1)}},ge=r.useMemo(()=>{const e=g.length,s=g.filter(e=>"active"===e.status).length,t=g.filter(e=>"inactive"===e.status).length,a=g.filter(e=>"on-leave"===e.status).length,l=(new Date).toISOString().split("T")[0];return{total:e,active:s,inactive:t,onLeave:a,todayPresent:f.filter(e=>e.attendanceDate===l&&"present"===e.status).length,avgAttendance:e>0?g.reduce((e,s)=>e+(s.attendance||0),0)/e:0,avgPerformance:e>0?g.reduce((e,s)=>e+(s.performance||0),0)/e:0,totalSalary:g.reduce((e,s)=>e+(s.salary||0),0),departments:[...new Set(g.map(e=>e.department))].length,withUserAccounts:g.filter(e=>e.userId).length}},[g,f]),be=r.useMemo(()=>g.filter(e=>{const s=!K||`${e.firstName} ${e.lastName}`.toLowerCase().includes(K.toLowerCase())||e.position.toLowerCase().includes(K.toLowerCase())||e.department.toLowerCase().includes(K.toLowerCase())||e.email.toLowerCase().includes(K.toLowerCase()),t="all"===Q||e.department===Q,a="all"===J||e.status===J,l="all"===ee||e.branchId===ee;return s&&t&&a&&l}),[g,K,Q,J,ee]),fe=r.useMemo(()=>[...new Set(g.map(e=>e.department))].sort(),[g]),ye=async e=>{if(0!==te.length){switch(e){case"export":je();break;case"archive":window.confirm(`Archive ${te.length} employees?`)&&m.success("Employees archived");break;case"delete":if(window.confirm(`Delete ${te.length} employees?`))try{await Promise.all(te.map(e=>F.deleteEmployee(e))),m.success("Employees deleted"),await he(),ae([])}catch(s){m.error("Failed to delete employees")}}ue(!1)}else m.error("Please select employees first")},je=()=>{const e=[["Name","Email","Phone","Position","Department","Status","Salary","Attendance","Performance"],...g.filter(e=>te.includes(e.id)).map(e=>[`${e.firstName} ${e.lastName}`,e.email,e.phone,e.position,e.department,e.status,e.salary,`${e.attendance}%`,e.performance])].map(e=>e.join(",")).join("\n"),s=new Blob([e],{type:"text/csv"}),t=window.URL.createObjectURL(s),a=document.createElement("a");a.href=t,a.download=`employees_${(new Date).toISOString().split("T")[0]}.csv`,a.click(),m.success("Employees exported")},Ne=e=>{switch(e){case"active":return"bg-green-100 text-green-700";case"inactive":default:return"bg-gray-100 text-gray-700";case"on-leave":return"bg-yellow-100 text-yellow-700";case"terminated":return"bg-red-100 text-red-700"}},ve=e=>e>=4.5?"text-green-600":e>=3.5?"text-blue-600":e>=2.5?"text-yellow-600":"text-red-600";return H?s.jsx("div",{className:"p-4 sm:p-6 max-w-7xl mx-auto space-y-6",children:s.jsxs("div",{className:"flex items-center justify-center h-64",children:[s.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),s.jsx("span",{className:"ml-3 text-gray-600 font-medium",children:"Loading employees..."})]})}):s.jsxs("div",{className:"p-4 sm:p-6 max-w-7xl mx-auto space-y-6",children:[s.jsxs("div",{className:"flex flex-col lg:flex-row justify-between items-start lg:items-center gap-4",children:[s.jsxs("div",{className:"flex items-center gap-4",children:[s.jsx(o,{to:"/dashboard"}),s.jsxs("div",{children:[s.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Employee Management"}),s.jsx("p",{className:"text-gray-600 mt-1",children:"Manage your team, track attendance, and monitor performance"})]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("button",{onClick:()=>{me(void 0),re(!0)},className:"flex items-center gap-2 px-5 py-2.5 rounded-lg font-medium bg-blue-600 text-white hover:bg-blue-700 transition-colors text-sm",children:[s.jsx(w,{size:18}),"New Employee",s.jsx("span",{className:"hidden sm:inline text-xs opacity-75 ml-2",children:"âŒ˜N"})]}),s.jsxs("button",{onClick:()=>ce(!0),className:"flex items-center gap-2 px-4 py-2.5 rounded-lg font-medium bg-purple-600 text-white hover:bg-purple-700 transition-colors text-sm",title:"Import employees from existing users",children:[s.jsx(u,{size:18}),s.jsx("span",{className:"hidden sm:inline",children:"Import from Users"})]}),s.jsxs("button",{onClick:()=>ie(!0),className:"flex items-center gap-2 px-4 py-2.5 rounded-lg font-medium bg-green-600 text-white hover:bg-green-700 transition-colors text-sm",children:[s.jsx(k,{size:18}),s.jsx("span",{className:"hidden sm:inline",children:"Attendance"})]}),s.jsxs("button",{onClick:()=>je(),className:"flex items-center gap-2 px-4 py-2.5 rounded-lg font-medium bg-gray-100 text-gray-700 hover:bg-gray-200 transition-colors text-sm",children:[s.jsx(S,{size:18}),s.jsx("span",{className:"hidden sm:inline",children:"Export"})]})]})]}),s.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-3",children:[s.jsx("div",{className:"bg-blue-50 rounded-lg p-5 hover:bg-blue-100 transition-colors",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(j,{className:"w-7 h-7 text-blue-600 flex-shrink-0"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"Total Employees"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:ge.total}),s.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[ge.active," active"]})]})]})}),s.jsx("div",{className:"bg-green-50 rounded-lg p-5 hover:bg-green-100 transition-colors",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(C,{className:"w-7 h-7 text-green-600 flex-shrink-0"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"Present Today"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:ge.todayPresent}),s.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[ge.avgAttendance.toFixed(1),"% avg"]})]})]})}),s.jsx("div",{className:"bg-purple-50 rounded-lg p-5 hover:bg-purple-100 transition-colors",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(E,{className:"w-7 h-7 text-purple-600 flex-shrink-0"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"Avg Performance"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:ge.avgPerformance.toFixed(1)}),s.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"out of 5.0"})]})]})}),s.jsx("div",{className:"bg-orange-50 rounded-lg p-5 hover:bg-orange-100 transition-colors",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(h,{className:"w-7 h-7 text-orange-600 flex-shrink-0"}),s.jsxs("div",{children:[s.jsx("p",{className:"text-xs text-gray-600 mb-1",children:"System Access"}),s.jsx("p",{className:"text-2xl font-bold text-gray-900",children:ge.withUserAccounts}),s.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[ge.departments," depts, ",v.length," branches"]})]})]})})]}),s.jsxs(l,{className:"p-4",children:[s.jsxs("div",{className:"flex flex-col lg:flex-row items-start lg:items-center gap-4",children:[s.jsxs("div",{className:"relative flex-1 w-full lg:w-auto lg:min-w-[350px]",children:[s.jsx(y,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),s.jsx("input",{type:"text",placeholder:"Search by name, position, department, email...",value:K,onChange:e=>V(e.target.value),className:"w-full pl-10 pr-4 py-2.5 border border-gray-300 rounded-full focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-transparent transition-all"}),K&&s.jsx("button",{onClick:()=>V(""),className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-gray-400 hover:text-gray-600",children:s.jsx(p,{className:"w-4 h-4"})})]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(I,{className:"w-5 h-5 text-gray-500"}),s.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Status:"}),s.jsx("div",{className:"flex rounded-full bg-gray-100 p-1 gap-1",children:[{value:"all",label:"All",color:"blue"},{value:"active",label:"Active",color:"green"},{value:"on-leave",label:"Leave",color:"yellow"},{value:"inactive",label:"Inactive",color:"gray"}].map(({value:e,label:t,color:a})=>s.jsx("button",{onClick:()=>X(e),className:"px-3 py-1.5 text-sm font-medium rounded-full transition-colors "+(J===e?`bg-${a}-500 text-white`:"text-gray-600 hover:text-gray-900"),style:J===e?{backgroundColor:"blue"===a?"#3b82f6":"green"===a?"#10b981":"yellow"===a?"#f59e0b":"#6b7280"}:{},children:t},e))})]}),fe.length>0&&s.jsxs("select",{value:Q,onChange:e=>Z(e.target.value),className:"px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm",children:[s.jsx("option",{value:"all",children:"All Departments"}),fe.map(e=>s.jsx("option",{value:e,children:e},e))]}),v.length>0&&s.jsxs("select",{value:ee,onChange:e=>se(e.target.value),className:"px-4 py-2.5 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-sm",children:[s.jsx("option",{value:"all",children:"All Branches"}),v.map(e=>s.jsxs("option",{value:e.id,children:[e.name," ",e.is_main?"(Main)":""]},e.id))]})]}),te.length>0&&s.jsxs("div",{className:"mt-4 flex items-center justify-between p-3 bg-blue-50 rounded-lg",children:[s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx(C,{className:"w-5 h-5 text-blue-600"}),s.jsxs("span",{className:"text-sm font-medium text-gray-900",children:[te.length," employee",1!==te.length?"s":""," selected"]})]}),s.jsxs("div",{className:"flex gap-2",children:[s.jsxs("button",{onClick:()=>ye("export"),className:"px-3 py-1.5 text-sm font-medium text-blue-600 hover:bg-blue-100 rounded-lg transition-colors",children:[s.jsx(S,{className:"w-4 h-4 inline mr-1"}),"Export"]}),s.jsxs("button",{onClick:()=>ye("delete"),className:"px-3 py-1.5 text-sm font-medium text-red-600 hover:bg-red-100 rounded-lg transition-colors",children:[s.jsx(D,{className:"w-4 h-4 inline mr-1"}),"Delete"]}),s.jsx("button",{onClick:()=>ae([]),className:"px-3 py-1.5 text-sm font-medium text-gray-600 hover:bg-gray-100 rounded-lg transition-colors",children:"Clear"})]})]})]}),s.jsxs(l,{className:"overflow-hidden",children:[0===be.length?s.jsxs("div",{className:"text-center py-12",children:[s.jsx(j,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),s.jsx("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No employees found"}),s.jsx("p",{className:"text-gray-500 mb-6",children:K||"all"!==Q||"all"!==J||"all"!==ee?"Try adjusting your search or filters":"Get started by adding your first employee"}),!K&&"all"===Q&&"all"===J&&"all"===ee&&s.jsxs("button",{onClick:()=>re(!0),className:"inline-flex items-center gap-2 px-5 py-2.5 rounded-lg font-medium bg-blue-600 text-white hover:bg-blue-700 transition-colors",children:[s.jsx(w,{size:18}),"Add First Employee"]})]}):s.jsx("div",{className:"overflow-x-auto",children:s.jsxs("table",{className:"w-full",children:[s.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:s.jsxs("tr",{children:[s.jsx("th",{className:"py-3 px-4 text-left",children:s.jsx("input",{type:"checkbox",checked:te.length===be.length&&be.length>0,onChange:()=>{te.length===be.length?ae([]):ae(be.map(e=>e.id))},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"})}),s.jsx("th",{className:"py-3 px-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Employee"}),s.jsx("th",{className:"py-3 px-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Position"}),s.jsx("th",{className:"py-3 px-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Department"}),s.jsx("th",{className:"py-3 px-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Branch"}),s.jsx("th",{className:"py-3 px-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Status"}),s.jsx("th",{className:"py-3 px-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Performance"}),s.jsx("th",{className:"py-3 px-4 text-left text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Attendance"}),s.jsx("th",{className:"py-3 px-4 text-right text-xs font-semibold text-gray-600 uppercase tracking-wider",children:"Actions"})]})}),s.jsx("tbody",{className:"divide-y divide-gray-100",children:be.map(e=>s.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[s.jsx("td",{className:"py-4 px-4",children:s.jsx("input",{type:"checkbox",checked:te.includes(e.id),onChange:()=>{return s=e.id,void ae(e=>e.includes(s)?e.filter(e=>e!==s):[...e,s]);var s},className:"rounded border-gray-300 text-blue-600 focus:ring-blue-500"})}),s.jsx("td",{className:"py-4 px-4",children:s.jsxs("div",{className:"flex items-center gap-3",children:[s.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-blue-500 to-purple-500 rounded-full flex items-center justify-center flex-shrink-0",children:s.jsxs("span",{className:"text-sm font-bold text-white",children:[e.firstName[0],e.lastName[0]]})}),s.jsxs("div",{children:[s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsxs("p",{className:"font-medium text-gray-900",children:[e.firstName," ",e.lastName]}),e.userId&&s.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 bg-purple-100 text-purple-700 rounded-full text-xs font-medium",title:"Has user account"+(e.userRole?` (${e.userRole})`:""),children:[s.jsx(h,{className:"w-3 h-3"}),e.userRole||"User"]})]}),s.jsxs("div",{className:"flex items-center gap-2 mt-0.5",children:[s.jsx($,{className:"w-3 h-3 text-gray-400"}),s.jsx("p",{className:"text-xs text-gray-500",children:e.email})]})]})]})}),s.jsxs("td",{className:"py-4 px-4",children:[s.jsx("p",{className:"font-medium text-gray-900",children:e.position}),s.jsxs("div",{className:"flex items-center gap-1 mt-0.5",children:[s.jsx(A,{className:"w-3 h-3 text-gray-400"}),s.jsx("p",{className:"text-xs text-gray-500",children:e.phone})]})]}),s.jsx("td",{className:"py-4 px-4",children:s.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 bg-gray-100 text-gray-700 rounded-full text-xs font-medium",children:[s.jsx(O,{className:"w-3 h-3"}),e.department]})}),s.jsx("td",{className:"py-4 px-4",children:e.branch?s.jsxs("span",{className:"inline-flex items-center gap-1 px-2.5 py-1 bg-blue-50 text-blue-700 rounded-full text-xs font-medium",children:[s.jsx(P,{className:"w-3 h-3"}),e.branch.name]}):s.jsx("span",{className:"text-xs text-gray-400",children:"No branch"})}),s.jsx("td",{className:"py-4 px-4",children:s.jsxs("span",{className:`inline-flex items-center px-2.5 py-1 rounded-full text-xs font-medium ${Ne(e.status)}`,children:["active"===e.status&&s.jsx(C,{className:"w-3 h-3 mr-1"}),"on-leave"===e.status&&s.jsx(k,{className:"w-3 h-3 mr-1"}),"inactive"===e.status&&s.jsx(L,{className:"w-3 h-3 mr-1"}),e.status.replace("-"," ")]})}),s.jsx("td",{className:"py-4 px-4",children:s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx(E,{className:`w-4 h-4 ${ve(e.performance||0)}`,fill:"currentColor"}),s.jsx("span",{className:`text-sm font-semibold ${ve(e.performance||0)}`,children:(e.performance||0).toFixed(1)}),s.jsx("span",{className:"text-xs text-gray-400",children:"/5.0"})]})}),s.jsx("td",{className:"py-4 px-4",children:s.jsx("div",{className:"flex items-center gap-2",children:s.jsxs("div",{className:"flex-1 min-w-[60px]",children:[s.jsx("div",{className:"flex items-center justify-between mb-1",children:s.jsxs("span",{className:"text-xs font-medium text-gray-900",children:[e.attendance||0,"%"]})}),s.jsx("div",{className:"w-full bg-gray-200 rounded-full h-1.5",children:s.jsx("div",{className:"h-1.5 rounded-full "+((e.attendance||0)>=90?"bg-green-500":(e.attendance||0)>=75?"bg-blue-500":(e.attendance||0)>=60?"bg-yellow-500":"bg-red-500"),style:{width:`${e.attendance||0}%`}})})]})})}),s.jsx("td",{className:"py-4 px-4",children:s.jsxs("div",{className:"flex items-center justify-end gap-1",children:[s.jsx("button",{onClick:()=>(e=>{me(e),re(!0)})(e),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Edit",children:s.jsx(x,{className:"w-4 h-4"})}),s.jsx("button",{onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this employee?"))try{const s=g.find(s=>s.id===e);await F.deleteEmployee(e),await he(),d.show(`Employee "${null==s?void 0:s.firstName} ${null==s?void 0:s.lastName}" has been deleted successfully!`,{title:"Employee Deleted",autoCloseDelay:2e3})}catch(s){m.error("Failed to delete employee")}})(e.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Delete",children:s.jsx(D,{className:"w-4 h-4"})})]})})]},e.id))})]})}),be.length>0&&s.jsx("div",{className:"px-6 py-4 bg-gray-50 border-t border-gray-200",children:s.jsxs("div",{className:"flex items-center justify-between",children:[s.jsxs("p",{className:"text-sm text-gray-600",children:["Showing ",s.jsx("span",{className:"font-medium",children:be.length})," of"," ",s.jsx("span",{className:"font-medium",children:g.length})," employees"]}),s.jsxs("div",{className:"flex items-center gap-2",children:[s.jsx("span",{className:"text-xs text-gray-500",children:"View:"}),s.jsx("button",{onClick:()=>Y("list"),className:"p-2 rounded-lg transition-colors "+("list"===W?"bg-blue-100 text-blue-600":"text-gray-400 hover:text-gray-600"),children:s.jsx(R,{className:"w-4 h-4"})}),s.jsx("button",{onClick:()=>Y("grid"),className:"p-2 rounded-lg transition-colors "+("grid"===W?"bg-blue-100 text-blue-600":"text-gray-400 hover:text-gray-600"),children:s.jsx(_,{className:"w-4 h-4"})})]})]})})]}),be.length>0&&s.jsxs(l,{className:"p-6",children:[s.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Department Overview"}),s.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:fe.map(e=>{const t=be.filter(s=>s.department===e),a=t.reduce((e,s)=>e+(s.performance||0),0)/t.length,l=t.reduce((e,s)=>e+(s.attendance||0),0)/t.length;return s.jsxs("div",{className:"p-4 bg-gray-50 rounded-lg hover:bg-gray-100 transition-colors",children:[s.jsxs("div",{className:"flex items-center justify-between mb-3",children:[s.jsx("h4",{className:"font-semibold text-gray-900",children:e}),s.jsx("span",{className:"text-sm font-medium text-gray-500",children:t.length})]}),s.jsxs("div",{className:"space-y-2",children:[s.jsxs("div",{className:"flex items-center justify-between text-sm",children:[s.jsx("span",{className:"text-gray-600",children:"Performance:"}),s.jsxs("span",{className:`font-semibold ${ve(a)}`,children:[(a||0).toFixed(1),"/5.0"]})]}),s.jsxs("div",{className:"flex items-center justify-between text-sm",children:[s.jsx("span",{className:"text-gray-600",children:"Attendance:"}),s.jsxs("span",{className:"font-semibold text-gray-900",children:[(l||0).toFixed(1),"%"]})]})]})]},e)})})]}),s.jsx(q,{employee:de,isOpen:le,onClose:()=>{re(!1),me(void 0)},onSave:async e=>{try{const s=!!de;s?await F.updateEmployee(de.id,e):await F.createEmployee(e),await he(),re(!1),me(void 0);const t=`${e.firstName} ${e.lastName}`;d.show(`Employee "${t}" has been ${s?"updated":"added"} successfully!`,{title:"Employee "+(s?"Updated":"Added"),actionButtons:[{label:"View Employees",onClick:()=>{},variant:"primary"},{label:"Add Another",onClick:()=>re(!0),variant:"secondary"}]})}catch(s){m.error("Failed to save employee")}}}),s.jsx(B,{isOpen:oe,onClose:()=>ce(!1),onImportComplete:()=>{he(),d.show("Employees imported successfully! You can now edit them to add more details.",{title:"Import Complete",autoCloseDelay:3e3})}}),s.jsx(U,{employees:g,isOpen:ne,onClose:()=>ie(!1),onSave:async e=>{try{await F.markAttendance(e),m.success("Attendance marked successfully"),await he(),ie(!1)}catch(s){m.error("Failed to save attendance")}}}),s.jsx(T,{...d.props})]})};export{H as default};
