import{j as e}from"./index-222cfb29.js";import{r as s}from"./vendor-a2ff445a.js";import{c as t,M as r}from"./customerPortalService-ebbdd244.js";import{z as a,ar as i,p as l,ag as o,f as n,ah as c,Z as d,aq as m}from"./ui-551a39a6.js";import{a as x}from"./routing-a2f0f6d2.js";import"./supabase-7e851d02.js";const p=()=>{x();const[p,u]=s.useState(0),[h,f]=s.useState("interested"),[g,b]=s.useState([]),[y,j]=s.useState(!0),[N,v]=s.useState("rewards");s.useEffect(()=>{w()},[]);const w=async()=>{try{j(!0);const e=localStorage.getItem("customer_id");if(e){const s=await t.getCustomerById(e);s&&(u(s.points||0),f(s.loyalty_tier||s.loyalty_level||"interested"))}b([{id:"1",title:"10% Off Next Purchase",description:"Get 10% discount on your next purchase of any product",pointsRequired:1e3,category:"discount",imageUrl:""},{id:"2",title:"Free Phone Case",description:"Redeem for a free phone case of your choice",pointsRequired:2e3,category:"product",imageUrl:""},{id:"3",title:"Free Screen Protector",description:"Get a premium screen protector installed for free",pointsRequired:1500,category:"service",imageUrl:""},{id:"4",title:"Tsh 50,000 Voucher",description:"Shopping voucher worth Tsh 50,000",pointsRequired:5e3,category:"voucher",imageUrl:""}])}catch(e){a.error("Failed to load loyalty data")}finally{j(!1)}},R=(e=>{switch(e){case"vip":return{name:"VIP",color:"from-purple-500 to-pink-500",icon:m,benefits:["20% off all purchases","Free delivery","Priority support","Exclusive deals"]};case"premium":return{name:"Premium",color:"from-yellow-400 to-orange-500",icon:i,benefits:["15% off all purchases","Free delivery on orders over Tsh 50,000","Priority support"]};case"regular":return{name:"Regular",color:"from-blue-400 to-blue-600",icon:l,benefits:["10% off all purchases","Free delivery on orders over Tsh 100,000"]};case"active":return{name:"Active",color:"from-green-400 to-green-600",icon:d,benefits:["7% off all purchases","Regular customer perks"]};case"payment_customer":return{name:"Payment Customer",color:"from-teal-400 to-teal-600",icon:l,benefits:["5% off all purchases","Earn bonus points"]};case"engaged":return{name:"Engaged",color:"from-indigo-400 to-indigo-600",icon:d,benefits:["3% off all purchases","Earn points on every purchase"]};default:return{name:"Interested",color:"from-gray-400 to-gray-600",icon:l,benefits:["Earn points on every purchase","Join our loyalty program"]}}})(h),P=R.icon;return y?e.jsx(r,{title:"Loyalty Rewards",children:e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})})}):e.jsxs(r,{title:"Loyalty Rewards",children:[e.jsxs("div",{className:`bg-gradient-to-br ${R.color} p-6 text-white`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm opacity-90",children:"Your Points"}),e.jsx("div",{className:"text-4xl font-bold",children:p.toLocaleString()})]}),e.jsx("div",{className:"w-16 h-16 bg-white bg-opacity-20 rounded-full flex items-center justify-center",children:e.jsx(P,{size:32})})]}),e.jsx("div",{className:"flex items-center gap-2 mb-2",children:e.jsxs("div",{className:"px-3 py-1 bg-white bg-opacity-20 rounded-full text-sm font-bold",children:[R.name," Member"]})}),e.jsx("div",{className:"text-sm opacity-90",children:"Keep shopping to reach the next tier!"})]}),e.jsx("div",{className:"p-4",children:e.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm",children:[e.jsxs("h3",{className:"font-bold text-gray-900 mb-3 flex items-center gap-2",children:[e.jsx(i,{size:20,className:"text-blue-600"}),"Your Benefits"]}),e.jsx("ul",{className:"space-y-2",children:R.benefits.map((s,t)=>e.jsxs("li",{className:"flex items-start gap-2 text-sm text-gray-700",children:[e.jsx(l,{size:16,className:"text-yellow-500 mt-0.5 flex-shrink-0"}),e.jsx("span",{children:s})]},t))})]})}),e.jsx("div",{className:"px-4",children:e.jsxs("div",{className:"flex gap-2 mb-4",children:[e.jsx("button",{onClick:()=>v("rewards"),className:"flex-1 py-3 rounded-lg font-medium transition-colors "+("rewards"===N?"bg-blue-600 text-white":"bg-gray-100 text-gray-700"),children:"Available Rewards"}),e.jsx("button",{onClick:()=>v("history"),className:"flex-1 py-3 rounded-lg font-medium transition-colors "+("history"===N?"bg-blue-600 text-white":"bg-gray-100 text-gray-700"),children:"Points History"})]})}),"rewards"===N?e.jsx("div",{className:"px-4 pb-4 space-y-3",children:g.map(s=>{const t=p>=s.pointsRequired;return e.jsx("div",{className:"bg-white rounded-xl p-4 shadow-sm",children:e.jsxs("div",{className:"flex gap-4",children:[e.jsx("div",{className:"w-16 h-16 rounded-lg flex items-center justify-center flex-shrink-0 "+(t?"bg-blue-100":"bg-gray-100"),children:e.jsx(o,{size:28,className:t?"text-blue-600":"text-gray-400"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h4",{className:"font-bold text-gray-900 mb-1",children:s.title}),e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:s.description}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(l,{size:16,className:"text-yellow-500"}),e.jsxs("span",{className:"text-sm font-bold text-gray-900",children:[s.pointsRequired.toLocaleString()," points"]})]}),e.jsx("button",{onClick:()=>(e=>{p<e.pointsRequired?a.error("Not enough points to redeem this reward"):confirm(`Redeem ${e.title} for ${e.pointsRequired} points?`)&&a.success("Reward redeemed! Check your account for details")})(s),disabled:!t,className:"px-4 py-2 rounded-lg font-medium text-sm transition-all "+(t?"bg-blue-600 text-white hover:bg-blue-700 active:scale-95":"bg-gray-200 text-gray-500 cursor-not-allowed"),children:t?"Redeem":"Not Enough Points"})]})]})]})},s.id)})}):e.jsx("div",{className:"px-4 pb-4",children:e.jsxs("div",{className:"bg-white rounded-xl p-6 text-center",children:[e.jsx(n,{size:48,className:"text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"font-bold text-gray-900 mb-2",children:"Points History"}),e.jsx("p",{className:"text-gray-600 text-sm",children:"Your points earning and redemption history will appear here"})]})}),e.jsx("div",{className:"px-4 pb-4",children:e.jsxs("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 rounded-xl p-4",children:[e.jsxs("h3",{className:"font-bold text-gray-900 mb-3 flex items-center gap-2",children:[e.jsx(c,{size:20,className:"text-blue-600"}),"How to Earn Points"]}),e.jsxs("ul",{className:"space-y-2 text-sm text-gray-700",children:[e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-blue-600 font-bold",children:"•"}),e.jsx("span",{children:"Earn 1 point for every Tsh 1,000 spent"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-blue-600 font-bold",children:"•"}),e.jsx("span",{children:"Refer a friend and get 500 bonus points"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-blue-600 font-bold",children:"•"}),e.jsx("span",{children:"Complete your profile for 200 points"})]}),e.jsxs("li",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-blue-600 font-bold",children:"•"}),e.jsx("span",{children:"Write a review and earn 100 points"})]})]})]})})]})};export{p as default};
