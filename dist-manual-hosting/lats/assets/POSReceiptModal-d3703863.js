import{j as e,d as s}from"./index-222cfb29.js";import{r as t}from"./vendor-a2ff445a.js";import{u as a}from"./useBluetoothPrinter-08dc31b9.js";import{u as r}from"./useBusinessInfo-13b9c3ff.js";import{u as i}from"./useBodyScrollLock-0216d39f.js";import{X as n,d as l,h as c,cc as o,aa as d,a8 as m,m as x,a1 as h}from"./ui-551a39a6.js";import"./supabase-7e851d02.js";import"./routing-a2f0f6d2.js";const p=({isOpen:p,onClose:u,receipt:g,formatMoney:j,onPrint:b,onSendWhatsApp:y,onSendSMS:N,isTaxEnabled:f=!0})=>{const{isConnected:v,isPrinting:w,printReceipt:C,connectedDevice:P}=a(),{businessInfo:k}=r();i(p);const[S,B]=t.useState(!1);return p&&g?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"fixed bg-black bg-opacity-50",onClick:u,style:{left:"var(--sidebar-width, 0px)",top:"var(--topbar-height, 64px)",right:0,bottom:0,zIndex:35}}),e.jsx("div",{className:"fixed flex items-center justify-center p-4",style:{left:"var(--sidebar-width, 0px)",top:"var(--topbar-height, 64px)",right:0,bottom:0,zIndex:50,pointerEvents:"none"},children:e.jsxs(s,{className:"max-w-2xl w-full p-8 max-h-[90vh] overflow-y-auto",onClick:e=>e.stopPropagation(),style:{pointerEvents:"auto"},children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"Receipt"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Transaction completed successfully"})]}),e.jsx("button",{onClick:u,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(n,{className:"w-6 h-6 text-gray-500"})})]}),e.jsxs("div",{className:"bg-white rounded-lg border-2 border-gray-200 p-6 mb-6",children:[e.jsxs("div",{className:"text-center mb-6",children:[k.logo&&e.jsx("div",{className:"mb-3",children:e.jsx("img",{src:k.logo,alt:`${k.name} Logo`,className:"h-16 w-auto mx-auto object-contain"})}),e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:k.name}),k.address&&e.jsx("p",{className:"text-xs text-gray-600",children:k.address}),k.phone&&e.jsx("p",{className:"text-xs text-gray-600",children:k.phone}),k.email&&e.jsx("p",{className:"text-xs text-gray-600",children:k.email}),e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200",children:[e.jsxs("p",{className:"text-sm font-semibold text-gray-600",children:["Receipt #",(null==g?void 0:g.receiptNumber)||"N/A"]}),e.jsxs("p",{className:"text-sm text-gray-600",children:[g.date," at ",g.time]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Cashier: ",g.cashier]})]})]}),g.customer&&e.jsxs("div",{className:"border-b border-gray-200 pb-4 mb-4",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Customer Information"}),e.jsxs("p",{className:"text-sm text-gray-700",children:["Name: ",g.customer.name]}),e.jsxs("p",{className:"text-sm text-gray-700",children:["Phone: ",g.customer.phone]}),g.customer.email&&e.jsxs("p",{className:"text-sm text-gray-700",children:["Email: ",g.customer.email]})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("h4",{className:"font-semibold text-gray-900 mb-2",children:"Items"}),e.jsx("div",{className:"space-y-2",children:g.items.map((s,t)=>e.jsxs("div",{className:"flex justify-between items-center text-sm",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-gray-900",children:s.productName}),e.jsxs("p",{className:"text-gray-600",children:["Qty: ",s.quantity," Ã— ",j(s.unitPrice)]})]}),e.jsx("p",{className:"font-semibold text-gray-900",children:j(s.quantity*s.unitPrice)})]},t))})]}),e.jsxs("div",{className:"border-t border-gray-200 pt-4 space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Subtotal:"}),e.jsx("span",{className:"font-medium",children:j(g.subtotal)})]}),f&&g.tax>0&&e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Tax:"}),e.jsx("span",{className:"font-medium",children:j(g.tax)})]}),g.discount>0&&e.jsxs("div",{className:"flex justify-between text-sm",children:[e.jsx("span",{className:"text-gray-600",children:"Discount:"}),e.jsxs("span",{className:"font-medium text-red-600",children:["-",j(g.discount)]})]}),e.jsxs("div",{className:"flex justify-between text-lg font-bold border-t border-gray-200 pt-2",children:[e.jsx("span",{children:"Total:"}),e.jsx("span",{className:"text-green-600",children:j(g.total)})]})]}),e.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-2xl",children:g.paymentMethod.icon}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-900",children:g.paymentMethod.name}),e.jsx("p",{className:"text-sm text-gray-600",children:g.paymentMethod.description})]})]})}),e.jsxs("div",{className:"text-center mt-6 pt-4 border-t border-gray-200",children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Thank you for your purchase!"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Please keep this receipt for your records"})]})]}),e.jsxs("div",{className:"mt-4 space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"p-2 rounded-full "+(v?"bg-green-100":"bg-gray-100"),children:v?e.jsx(l,{className:"w-4 h-4 text-green-600"}):e.jsx(c,{className:"w-4 h-4 text-gray-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-sm",children:v?"Bluetooth Printer Connected":"Bluetooth Printer Not Connected"}),e.jsx("p",{className:"text-xs text-gray-600",children:v?null==P?void 0:P.name:"Connect a Bluetooth printer to print receipts"})]})]}),e.jsx("button",{onClick:()=>B(!S),className:"text-blue-600 hover:text-blue-700 text-sm font-medium",children:S?"Hide":"Options"})]}),S&&e.jsxs("div",{className:"p-4 bg-blue-50 rounded-lg border border-blue-200",children:[e.jsx("h4",{className:"font-semibold text-blue-900 mb-3",children:"Bluetooth Printer Options"}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{onClick:async()=>{try{await C({header:k.name,items:g.items.map(e=>({name:e.productName,quantity:e.quantity,price:e.unitPrice,total:e.quantity*e.unitPrice})),subtotal:g.subtotal,tax:g.tax,discount:g.discount,total:g.total,paymentMethod:g.paymentMethod.name,cashier:g.cashier,footer:"Thank you for your purchase!"})}catch(e){alert("Failed to print via Bluetooth printer")}},disabled:!v||w,className:"p-3 bg-blue-500 hover:bg-blue-600 disabled:bg-gray-300 text-white rounded-lg transition-colors duration-200 flex items-center justify-center gap-2",children:[e.jsx(o,{className:"w-4 h-4"}),w?"Printing...":"Bluetooth Print"]}),e.jsxs("button",{onClick:()=>{window.open("/bluetooth-printer","_blank")},className:"p-3 bg-gray-500 hover:bg-gray-600 text-white rounded-lg transition-colors duration-200 flex items-center justify-center gap-2",children:[e.jsx(d,{className:"w-4 h-4"}),"Manage Printer"]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("button",{onClick:b,className:"p-3 bg-blue-500 hover:bg-blue-600 text-white rounded-lg transition-colors duration-200 flex items-center justify-center gap-2",children:[e.jsx(m,{className:"w-4 h-4"}),"Print"]}),e.jsxs("button",{onClick:y,className:"p-3 bg-green-500 hover:bg-green-600 text-white rounded-lg transition-colors duration-200 flex items-center justify-center gap-2",children:[e.jsx(x,{className:"w-4 h-4"}),"WhatsApp"]}),e.jsxs("button",{onClick:N,className:"p-3 bg-purple-500 hover:bg-purple-600 text-white rounded-lg transition-colors duration-200 flex items-center justify-center gap-2",children:[e.jsx(h,{className:"w-4 h-4"}),"SMS"]})]})]}),e.jsx("div",{className:"mt-6",children:e.jsx("button",{onClick:u,className:"w-full py-3 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg font-semibold transition-colors duration-200",children:"Close"})})]})})]}):null};export{p as default};
