import{j as e}from"./index-222cfb29.js";import{r as s}from"./vendor-a2ff445a.js";import{TradeInCalculator as t}from"./TradeInCalculator-fb3e1cc9.js";import{T as a}from"./TradeInContractModal-dd90079f.js";import{f as r,t as i}from"./tradeInApi-966791f7.js";import{a as d}from"./routing-a2f0f6d2.js";import{i as n,m as l,V as c}from"./ui-551a39a6.js";import"./supabase-7e851d02.js";import"./format-0f0b2647.js";import"./charts-66cc82bb.js";import"./toPropertyKey-7f87613e.js";import"./pdf-33d2fdad.js";import"./useBodyScrollLock-0216d39f.js";const o=()=>{var o;const m=d(),[x,h]=s.useState(!1),[g,u]=s.useState(!1),[j,b]=s.useState(null),[p,v]=s.useState(null),[_]=s.useState(12e5),[N]=s.useState("iPhone 14 Pro Max 256GB");return e.jsxs("div",{className:"min-h-screen bg-gray-50 p-6",children:[e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("button",{onClick:()=>m("/lats/trade-in/management"),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 mb-4",children:[e.jsx(n,{className:"w-5 h-5"}),"Back to Trade-In Management"]}),e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[e.jsx(l,{className:"w-8 h-8 text-blue-600"}),"Create Trade-In Transaction"]}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Test the complete trade-in workflow"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Sale Scenario"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-blue-50 rounded-lg border border-blue-200",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(c,{className:"w-6 h-6 text-blue-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-gray-900",children:N}),e.jsx("div",{className:"text-sm text-gray-600",children:"New device customer is buying"})]})]}),e.jsx("div",{className:"text-right",children:e.jsxs("div",{className:"text-lg font-bold text-blue-600",children:["TSh ",_.toLocaleString()]})})]}),j?e.jsxs("div",{className:"p-4 bg-green-50 rounded-lg border border-green-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-gray-900",children:["Trade-In: ",j.trade_in_details.device_name]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[j.trade_in_details.device_model," - ",j.trade_in_details.condition_rating]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-lg font-bold text-green-600",children:["-TSh ",j.final_trade_in_value.toLocaleString()]}),e.jsx("div",{className:"text-xs text-gray-600",children:"Trade-in credit"})]})]}),(null==(o=j.trade_in_details.damage_items)?void 0:o.length)>0&&e.jsxs("div",{className:"text-xs text-gray-600 space-y-1 mt-2 pt-2 border-t border-green-200",children:[e.jsx("div",{className:"font-medium",children:"Deductions:"}),j.trade_in_details.damage_items.map((s,t)=>e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{children:["- ",s.spare_part_name]}),e.jsxs("span",{children:["TSh ",s.price.toLocaleString()]})]},t))]})]}):e.jsx("button",{onClick:()=>h(!0),className:"w-full p-4 border-2 border-dashed border-gray-300 rounded-lg hover:border-blue-500 hover:bg-blue-50 transition-colors",children:e.jsxs("div",{className:"text-center",children:[e.jsx(l,{className:"w-8 h-8 text-gray-400 mx-auto mb-2"}),e.jsx("div",{className:"font-medium text-gray-700",children:"Add Trade-In Device"}),e.jsx("div",{className:"text-sm text-gray-500",children:"Customer trading in old device"})]})}),e.jsxs("div",{className:"p-4 bg-gray-100 rounded-lg",children:[e.jsxs("div",{className:"flex justify-between items-center text-lg font-bold",children:[e.jsx("span",{className:"text-gray-900",children:"Customer Pays:"}),e.jsxs("span",{className:"text-2xl text-blue-600",children:["TSh ",(j?j.customer_payment_amount:_).toLocaleString()]})]}),j&&e.jsxs("div",{className:"text-sm text-gray-600 mt-1 text-right",children:["(TSh ",_.toLocaleString()," - TSh ",j.final_trade_in_value.toLocaleString(),")"]})]})]}),j&&!p&&e.jsx("div",{className:"mt-6 flex gap-3",children:e.jsx("button",{onClick:()=>{b(null),h(!0)},className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Change Trade-In"})}),p&&e.jsxs("div",{className:"mt-6",children:[e.jsx("div",{className:"p-4 bg-green-100 border border-green-300 rounded-lg mb-4",children:e.jsxs("div",{className:"flex items-center gap-2 text-green-800",children:[e.jsx("div",{className:"w-2 h-2 bg-green-600 rounded-full"}),e.jsxs("span",{className:"font-medium",children:["Transaction Created: ",p.transaction_number]})]})}),e.jsx("button",{onClick:()=>u(!0),className:"w-full px-6 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700 font-semibold",children:"View/Sign Contract"})]})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6",children:[e.jsx("h3",{className:"font-semibold text-blue-900 mb-3",children:"How to Use This Page:"}),e.jsxs("ol",{className:"space-y-2 text-sm text-blue-800",children:[e.jsx("li",{children:'1. Click "Add Trade-In Device" to open the calculator'}),e.jsx("li",{children:"2. Select the device model being traded in"}),e.jsx("li",{children:"3. Enter IMEI and assess condition"}),e.jsx("li",{children:"4. Add any damage/issues (optional)"}),e.jsx("li",{children:"5. Review final value and customer payment"}),e.jsx("li",{children:"6. Complete to create transaction"}),e.jsx("li",{children:"7. Generate and sign contract"})]}),e.jsxs("div",{className:"mt-4 p-3 bg-white rounded border border-blue-200",children:[e.jsx("div",{className:"text-xs font-medium text-blue-900 mb-1",children:"ðŸ’¡ Note:"}),e.jsx("div",{className:"text-xs text-blue-700",children:"In production, this would be integrated into your POS system. This page is for testing the trade-in flow independently."})]})]})]}),e.jsx(t,{isOpen:x,onClose:()=>h(!1),newDevicePrice:_,onTradeInComplete:async e=>{b(e);try{const s=await r({customer_id:"dbd45d11-2f0a-43f8-9da7-06c207eef6ce",device_name:e.trade_in_details.device_name,device_model:e.trade_in_details.device_model,device_imei:e.trade_in_details.device_imei,base_trade_in_price:e.trade_in_details.base_price,condition_rating:e.trade_in_details.condition_rating,condition_description:e.trade_in_details.condition_description,damage_items:e.trade_in_details.damage_items,new_device_price:_,customer_payment_amount:e.customer_payment_amount});s.success&&s.data?(i.success("Trade-in transaction created!"),v(s.data),h(!1),u(!0)):i.error(s.error||"Failed to create transaction")}catch(s){i.error("Failed to create transaction")}}}),p&&e.jsx(a,{isOpen:g,transaction:p,onClose:()=>u(!1),onContractSigned:()=>{i.success("Contract signed successfully!"),u(!1),i.success("Sale completed! Device added to inventory.")}})]})};export{o as TradeInTestPage,o as default};
