import{s as e}from"./index-222cfb29.js";const t={enabled:!0,allowEmployeeChoice:!0,availableSecurityModes:["auto-location","manual-location","wifi-only"],defaultSecurityMode:"auto-location",requireLocation:!0,requireWifi:!0,requirePhoto:!1,allowMobileData:!0,gpsAccuracy:50,checkInRadius:100,checkInTime:"08:00",checkOutTime:"17:00",gracePeriod:15,offices:[{name:"Arusha Main Office",lat:-3.359178,lng:36.661366,radius:100,address:"Main Office, Arusha, Tanzania",networks:[{ssid:"Office_WiFi",bssid:"00:11:22:33:44:55",description:"Main office WiFi network"},{ssid:"Office_Guest",description:"Guest WiFi network"},{ssid:"4G_Mobile",description:"Mobile data connection"}]}]},i=async()=>{try{const{data:i,error:a}=await e.from("settings").select("value").eq("key","attendance").single();return a?t:i?JSON.parse(i.value):t}catch(i){return t}},a=async t=>{try{const{error:i}=await e.from("settings").upsert({key:"attendance",value:JSON.stringify(t),updated_at:(new Date).toISOString()});if(i)throw i}catch(i){throw i}},n=(e,t,i,a)=>{const n=e*Math.PI/180,o=i*Math.PI/180,s=(i-e)*Math.PI/180,c=(a-t)*Math.PI/180,r=Math.sin(s/2)*Math.sin(s/2)+Math.cos(n)*Math.cos(o)*Math.sin(c/2)*Math.sin(c/2);return 6371e3*(2*Math.atan2(Math.sqrt(r),Math.sqrt(1-r)))},o=async(e,t)=>{try{const a=await i();if(0===a.offices.length)return{office:null,distance:1/0,isWithinRange:!1};let o=null,s=1/0;for(const i of a.offices){const a=n(e,t,i.lat,i.lng);a<s&&(s=a,o=i)}if(!o)return{office:null,distance:1/0,isWithinRange:!1};return{office:o,distance:s,isWithinRange:s<=o.radius}}catch(a){return{office:null,distance:1/0,isWithinRange:!1}}},s=async(e,t,a)=>{try{const n=await i();if(e){const t=n.offices.find(t=>t.name.toLowerCase().includes(e.toLowerCase()));if(t)return{office:t,detectionMethod:"name"}}if(void 0!==t&&void 0!==a){const e=await o(t,a);return{office:e.office,distance:e.distance,isWithinRange:e.isWithinRange,detectionMethod:"nearest"}}return{office:n.offices[0]||null,detectionMethod:"default"}}catch(n){return{office:null,detectionMethod:"default"}}};export{o as a,s as b,t as d,i as g,a as s};
