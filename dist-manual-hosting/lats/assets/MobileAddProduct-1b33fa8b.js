import{j as e,a5 as t,s as a}from"./index-222cfb29.js";import{r as s}from"./vendor-a2ff445a.js";import"./supabase-460661f2.js";import{i as r,O as l,Q as n,z as i}from"./ui-551a39a6.js";import{a as c}from"./routing-a2f0f6d2.js";import"./supabase-7e851d02.js";const x=()=>{const x=c(),[d,o]=s.useState(""),[p,m]=s.useState(""),[b,u]=s.useState(""),[g,h]=s.useState(""),[y,j]=s.useState(""),[N,f]=s.useState(""),[v,w]=s.useState("1"),[k,S]=s.useState("5"),[C,A]=s.useState(""),[F,P]=s.useState([]),[W,_]=s.useState(!1),[z,I]=s.useState(!1);s.useEffect(()=>{(async()=>{try{const e=await t();P(e),e.length>0&&m(e[0].id)}catch(e){i.error("Failed to load categories")}})()},[]),s.useEffect(()=>{if(d&&!g){const e=d.toUpperCase().replace(/[^A-Z0-9]/g,"").substring(0,8)+"-"+Date.now().toString().substring(-4);h(e)}},[d]);const q=e=>{const t=parseInt(v)||0,a=Math.max(0,t+e);w(String(a))},D=y&&N?((parseFloat(N)-parseFloat(y))/parseFloat(N)*100).toFixed(1):"0";return e.jsxs("div",{className:"flex flex-col h-full bg-white",children:[e.jsx("div",{className:"bg-white border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between px-4 py-3",children:[e.jsxs("button",{onClick:()=>x("/mobile/inventory"),className:"flex items-center gap-1 text-blue-500",children:[e.jsx(r,{size:20,strokeWidth:2}),e.jsx("span",{className:"text-[17px]",children:"Cancel"})]}),e.jsx("h1",{className:"text-[17px] font-semibold text-gray-900 absolute left-1/2 transform -translate-x-1/2",children:"Add Product"}),e.jsx("button",{onClick:async()=>{if(d.trim()?p?N&&!(parseFloat(N)<=0)||(i.error("Selling price must be greater than 0"),0):(i.error("Category is required"),0):(i.error("Product name is required"),0))try{_(!0);const{data:e,error:t}=await a.from("lats_products").insert({name:d.trim(),category_id:p,description:C.trim()||null,is_active:!0}).select().single();if(t)throw t;const{error:s}=await a.from("lats_product_variants").insert({product_id:e.id,variant_name:b.trim()||d.trim(),sku:g.trim()||`SKU-${Date.now()}`,cost_price:y?parseFloat(y):0,selling_price:parseFloat(N),quantity:parseInt(v)||0,min_quantity:parseInt(k)||5,is_active:!0});if(s)throw s;i.success(`${d} added successfully!`),x(`/mobile/inventory/${e.id}`)}catch(e){i.error(e.message||"Failed to add product")}finally{_(!1)}},disabled:W||!d.trim()||!N,className:"text-blue-500 text-[17px] font-semibold disabled:text-gray-400 disabled:cursor-not-allowed",children:W?"Adding...":"Add"})]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto pb-20",children:[e.jsxs("div",{className:"px-4 py-4 border-b border-gray-200",children:[e.jsx("label",{className:"block text-[13px] text-gray-500 mb-2 uppercase tracking-wide",children:"Product Information"}),e.jsx("input",{type:"text",placeholder:"Product name",value:d,onChange:e=>o(e.target.value),autoFocus:!0,className:"w-full bg-transparent border-0 outline-none text-[17px] text-gray-900 placeholder-gray-400 p-0",style:{WebkitAppearance:"none"}})]}),e.jsx("div",{className:"px-4 py-4 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-900 text-[17px]",children:"Category"}),e.jsx("select",{value:p,onChange:e=>m(e.target.value),className:"bg-transparent border-0 outline-none text-[17px] text-gray-900 text-right",style:{WebkitAppearance:"none"},children:F.map(t=>e.jsx("option",{value:t.id,children:t.name},t.id))})]})}),e.jsxs("div",{className:"mt-6",children:[e.jsx("div",{className:"px-4 pb-2",children:e.jsx("label",{className:"block text-[13px] text-gray-500 uppercase tracking-wide",children:"Pricing"})}),e.jsxs("div",{className:"border-t border-b border-gray-200",children:[e.jsx("div",{className:"px-4 py-4 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-900 text-[17px]",children:"Selling Price"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-gray-500 text-[17px]",children:"TSh"}),e.jsx("input",{type:"number",placeholder:"0",value:N,onChange:e=>f(e.target.value),className:"w-32 bg-transparent border-0 outline-none text-[17px] text-gray-900 text-right placeholder-gray-400",style:{WebkitAppearance:"none"}})]})]})}),e.jsx("div",{className:"px-4 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-900 text-[17px]",children:"Cost Price"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-gray-500 text-[17px]",children:"TSh"}),e.jsx("input",{type:"number",placeholder:"0",value:y,onChange:e=>j(e.target.value),className:"w-32 bg-transparent border-0 outline-none text-[17px] text-gray-900 text-right placeholder-gray-400",style:{WebkitAppearance:"none"}})]})]})})]}),y&&N&&parseFloat(N)>0&&e.jsx("div",{className:"px-4 py-3 bg-green-50",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-green-700 text-[15px] font-medium",children:"Profit Margin"}),e.jsxs("span",{className:"text-green-700 text-[15px] font-semibold",children:[D,"%"]})]})})]}),e.jsxs("div",{className:"mt-6",children:[e.jsx("div",{className:"px-4 pb-2",children:e.jsx("label",{className:"block text-[13px] text-gray-500 uppercase tracking-wide",children:"Stock"})}),e.jsxs("div",{className:"border-t border-b border-gray-200",children:[e.jsx("div",{className:"px-4 py-4 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-900 text-[17px]",children:"Initial Quantity"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>q(-1),className:"w-8 h-8 rounded-full bg-gray-200 hover:bg-gray-300 flex items-center justify-center active:scale-95 transition-all",children:e.jsx(l,{size:16,strokeWidth:3})}),e.jsx("input",{type:"number",value:v,onChange:e=>w(e.target.value),className:"w-16 bg-transparent border-0 outline-none text-[17px] text-gray-900 text-center font-semibold",style:{WebkitAppearance:"none"}}),e.jsx("button",{onClick:()=>q(1),className:"w-8 h-8 rounded-full bg-blue-500 text-white hover:bg-blue-600 flex items-center justify-center active:scale-95 transition-all",children:e.jsx(n,{size:16,strokeWidth:3})})]})]})}),e.jsx("div",{className:"px-4 py-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-900 text-[17px]",children:"Low Stock Alert"}),e.jsx("input",{type:"number",placeholder:"5",value:k,onChange:e=>S(e.target.value),className:"w-20 bg-transparent border-0 outline-none text-[17px] text-gray-900 text-right",style:{WebkitAppearance:"none"}})]})})]})]}),e.jsxs("div",{className:"mt-6",children:[e.jsxs("button",{onClick:()=>I(!z),className:"w-full px-4 py-3 border-t border-b border-gray-200 flex items-center justify-between hover:bg-gray-50 active:bg-gray-100 transition-colors",children:[e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"text-blue-500 text-[17px] font-medium",children:"Advanced Options"}),e.jsx("div",{className:"text-gray-500 text-[13px] mt-0.5",children:"SKU, variant name, description"})]}),e.jsx("span",{className:"text-gray-400 text-[17px] transition-transform "+(z?"rotate-180":""),children:"â–¼"})]}),z&&e.jsxs("div",{className:"border-b border-gray-200",children:[e.jsxs("div",{className:"px-4 py-4 border-b border-gray-200",children:[e.jsx("label",{className:"block text-[13px] text-gray-500 mb-2",children:"Variant Name (Optional)"}),e.jsx("input",{type:"text",placeholder:"e.g., Default, Standard",value:b,onChange:e=>u(e.target.value),className:"w-full bg-transparent border-0 outline-none text-[17px] text-gray-900 placeholder-gray-400 p-0",style:{WebkitAppearance:"none"}})]}),e.jsxs("div",{className:"px-4 py-4 border-b border-gray-200",children:[e.jsx("label",{className:"block text-[13px] text-gray-500 mb-2",children:"SKU"}),e.jsx("input",{type:"text",placeholder:"Auto-generated",value:g,onChange:e=>h(e.target.value),className:"w-full bg-transparent border-0 outline-none text-[17px] text-gray-900 font-mono placeholder-gray-400 p-0",style:{WebkitAppearance:"none"}})]}),e.jsxs("div",{className:"px-4 py-4",children:[e.jsx("label",{className:"block text-[13px] text-gray-500 mb-2",children:"Description (Optional)"}),e.jsx("textarea",{placeholder:"Product description",value:C,onChange:e=>A(e.target.value),rows:4,className:"w-full bg-transparent border-0 outline-none text-[17px] text-gray-900 placeholder-gray-400 resize-none p-0",style:{WebkitAppearance:"none"}})]})]})]}),d&&N&&e.jsxs("div",{className:"mx-4 my-6 p-4 bg-blue-50 rounded-xl",children:[e.jsx("div",{className:"text-[15px] text-gray-900 font-semibold mb-3",children:"Summary"}),e.jsxs("div",{className:"space-y-2 text-[15px]",children:[e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Product:"}),e.jsx("span",{className:"text-gray-900 font-medium",children:d})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Price:"}),e.jsxs("span",{className:"text-green-600 font-semibold",children:["TSh ",parseFloat(N).toLocaleString()]})]}),e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Stock:"}),e.jsxs("span",{className:"text-gray-900 font-medium",children:[v," units"]})]}),y&&e.jsxs("div",{className:"flex justify-between",children:[e.jsx("span",{className:"text-gray-600",children:"Profit Margin:"}),e.jsxs("span",{className:"text-purple-600 font-semibold",children:[D,"%"]})]})]})]})]})]})};export{x as default};
