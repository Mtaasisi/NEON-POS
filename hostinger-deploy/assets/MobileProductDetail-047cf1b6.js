import{a as ue,j as e,s as b}from"./index-61458a34.js";import{r as x,R as pe,b as $}from"./vendor-36d2c7c1.js";import{u as B,h as he,N as O,J as ge,i as fe,z as n,X as K,m as be,O as ye,bM as je,c as ve,b1 as Ne,a6 as we,b8 as ke,Y as Pe}from"./ui-28e30067.js";import{R as I}from"./robustImageService-f15af7ef.js";import{format as p}from"./format-aff4c6a2.js";import{g as Ce,f as Se,a as G}from"./variantUtils-827870e5.js";import{p as _e,f as $e}from"./specificationUtils-0c00478d.js";import{u as Ie}from"./useMobileBranch-d96f1509.js";import{u as qe}from"./useDialog-6eb5c329.js";import{d as ze,a as De}from"./routing-eb8c310c.js";import"./supabase-cf010ec4.js";const Ke=()=>{var L,F,T;const{productId:d}=ze(),f=De(),{confirm:w}=qe(),{currentBranch:y}=Ie(),{startLoading:J,completeLoading:Y,failLoading:H}=ue(),[s,q]=x.useState(null),[X,z]=x.useState(!0),[j,k]=x.useState("overview"),[h,P]=x.useState([]),[C,D]=x.useState(0),[Z,U]=x.useState(!1),[E,A]=x.useState(!1),[V,v]=x.useState(!1),N=x.useRef(null),[ee,S]=x.useState(!1),[Q,te]=x.useState(""),[se,ae]=x.useState(null),[_,u]=x.useState(!1);x.useEffect(()=>(_?document.body.style.overflow="hidden":document.body.style.overflow="",()=>{document.body.style.overflow=""}),[_]);const re=()=>{if(!s||!a)return;const t=`${window.location.origin}/mobile/inventory/${s.id}`,i=`SKU: ${a.sku}
Product: ${s.name}
Price: ${p.money(a.sellingPrice||0)}
${t}`,r=`https://api.qrserver.com/v1/create-qr-code/?size=300x300&data=${encodeURIComponent(i)}`,o=window.open("","_blank");o?(o.document.write(`
        <!DOCTYPE html>
        <html>
          <head>
            <title>Print QR Code - ${s.name}</title>
            <style>
              * { margin: 0; padding: 0; box-sizing: border-box; }
              body {
                font-family: Arial, sans-serif;
                display: flex;
                justify-content: center;
                align-items: center;
                min-height: 100vh;
                padding: 20px;
                background: white;
              }
              .label {
                text-align: center;
                max-width: 400px;
                padding: 30px;
                border: 2px solid #000;
                background: white;
              }
              .product-name {
                font-size: 24px;
                font-weight: bold;
                margin-bottom: 10px;
                word-wrap: break-word;
              }
              .sku {
                font-size: 18px;
                font-family: monospace;
                margin-bottom: 15px;
                color: #333;
              }
              .qr-code {
                margin: 20px 0;
              }
              .qr-code img {
                width: 250px;
                height: 250px;
                border: 3px solid #000;
              }
              .price {
                font-size: 28px;
                font-weight: bold;
                color: #000;
                margin: 15px 0;
              }
              .category {
                font-size: 14px;
                color: #666;
                margin-top: 10px;
              }
              @media print {
                body { background: white; }
                .label { border: 2px solid #000; page-break-after: always; }
              }
            </style>
          </head>
          <body>
            <div class="label">
              <div class="product-name">${s.name}</div>
              <div class="sku">SKU: ${a.sku||"N/A"}</div>
              <div class="qr-code">
                <img src="${r}" alt="QR Code" />
              </div>
              <div class="price">${p.money(a.sellingPrice||0)}</div>
              <div class="category">${s.category||""}</div>
            </div>
            <script>
              window.onload = function() {
                setTimeout(function() {
                  window.print();
                }, 500);
              };
              window.onafterprint = function() {
                window.close();
              };
            <\/script>
          </body>
        </html>
      `),o.document.close(),n.success("Preparing QR code label...")):n.error("Please allow pop-ups to print")};x.useEffect(()=>{const t=async()=>{var o;if(!d)return;const r=J("Loading product...");z(!0);try{console.log("ðŸ” [MobileProductDetail] Loading product for branch:",y==null?void 0:y.name);const{data:l,error:g}=await b.from("lats_products").select(`
            *,
            category:lats_categories(id, name),
            variants:lats_product_variants(id, variant_name, sku, cost_price, selling_price, quantity, min_quantity, is_active, variant_attributes)
          `).eq("id",d).single();if(g)throw g;if(!l)throw new Error("Product not found");if(y&&l.branch_id&&l.branch_id!==y.id&&!l.is_shared){console.warn("âš ï¸ [MobileProductDetail] Product does not belong to current branch"),n.error("Product not found in current branch"),f("/mobile/inventory");return}const m={...l,price:l.selling_price||0,cost_price:l.cost_price,stock_quantity:l.quantity||0,low_stock_threshold:l.min_stock_level,status:l.is_active?"active":"inactive",category:((o=l.category)==null?void 0:o.name)||"Uncategorized",variants:Array.isArray(l.variants)?l.variants.map(c=>({id:c.id,name:c.variant_name,sku:c.sku,costPrice:c.cost_price||0,sellingPrice:c.selling_price||0,quantity:c.quantity||0,minQuantity:c.min_quantity||0,isActive:c.is_active,attributes:c.variant_attributes||{}})):[],totalQuantity:Array.isArray(l.variants)?l.variants.reduce((c,me)=>c+(me.quantity||0),0):0};q(m),Y(r)}catch(l){console.error("Error loading product:",l),H(r,"Failed to load product"),n.error("Failed to load product")}finally{z(!1)}};t();const i=()=>{console.log("ðŸ”„ [MobileProductDetail] Branch changed, reloading product..."),t()};return window.addEventListener("branchChanged",i),()=>{window.removeEventListener("branchChanged",i)}},[d,y,f]),x.useEffect(()=>{d&&(async()=>{if(d)try{U(!0);const i=await I.getProductImages(d);P(i)}catch(i){console.error("Error loading images:",i)}finally{U(!1)}})()},[d]);const R=pe.useMemo(()=>{var i,r;const t=(i=s==null?void 0:s.variants)==null?void 0:i[0];return(r=t==null?void 0:t.attributes)!=null&&r.specification?_e(t.attributes.specification):{}},[s==null?void 0:s.variants]),a=(()=>{if(!(s!=null&&s.variants)||s.variants.length===0)return null;const t=s.variants.find(r=>(r.quantity||0)>0);if(t)return t;const i=[...s.variants].sort((r,o)=>(o.sellingPrice||0)-(r.sellingPrice||0))[0];return i&&i.sellingPrice>0?i:s.variants[0]})(),M=a!=null&&a.costPrice?((a.sellingPrice-a.costPrice)/a.sellingPrice*100).toFixed(1):"N/A",ie=async()=>{if(s&&await w(`Are you sure you want to delete "${s.name}"?`))try{const{error:t}=await b.from("lats_products").delete().eq("id",s.id);if(t)throw t;n.success("Product deleted successfully"),f("/mobile/inventory")}catch(t){console.error("Error deleting product:",t),n.error("Failed to delete product")}},W=async(t,i)=>{var l,g;if(!s)return;const r=(l=s.variants)==null?void 0:l.find(m=>m.id===t);if(!r)return;const o=Math.max(0,r.quantity+i);try{const{error:m}=await b.from("lats_product_variants").update({quantity:o}).eq("id",t);if(m)throw m;q({...s,variants:(g=s.variants)==null?void 0:g.map(c=>c.id===t?{...c,quantity:o}:c),totalQuantity:(s.totalQuantity||0)+i}),n.success(`Stock ${i>0?"increased":"decreased"}`)}catch(m){console.error("Error updating stock:",m),n.error("Failed to update stock")}},le=async t=>{const i=t.target.files;if(!(!i||i.length===0||!d)){A(!0);try{const r=i[0];if(!r.type.startsWith("image/")){n.error("Please select an image file");return}if(r.size>10*1024*1024){n.error("Image size must be less than 10MB");return}n.loading("Uploading image...",{id:"image-upload"});let o=null;try{const m=localStorage.getItem("user");if(m){const c=JSON.parse(m);o=c.id&&c.id!=="system"?c.id:null}}catch(m){console.warn("Could not get user ID:",m)}const l=await I.uploadImage(r,d,o,h.length===0);if(!l.success)throw new Error(l.error||"Upload failed");const g=await I.getProductImages(d);P(g),n.success("Image uploaded successfully!",{id:"image-upload"}),N.current&&(N.current.value="")}catch(r){console.error("Error uploading image:",r);const o=r instanceof Error?r.message:"Failed to upload image";n.error(o,{id:"image-upload"})}finally{A(!1)}}},ne=async t=>{if(w("Are you sure you want to delete this image?"))try{n.loading("Deleting image...",{id:"delete-image"});const{error:i}=await b.from("product_images").delete().eq("id",t);if(i)throw i;const r=h.find(l=>l.id===t);if(r!=null&&r.url){const l=r.url.split("/").pop();l&&await b.storage.from("product-images").remove([l])}const o=h.filter(l=>l.id!==t);P(o),C>=o.length&&D(Math.max(0,o.length-1)),n.success("Image deleted successfully!",{id:"delete-image"})}catch(i){console.error("Error deleting image:",i),n.error("Failed to delete image",{id:"delete-image"})}},oe=()=>{if(!(!s||!a))try{const t=`${window.location.origin}/mobile/inventory/${s.id}`,i=`Product: ${s.name}
SKU: ${a.sku||"N/A"}
Price: ${p.money(a.sellingPrice||0)}
Details: ${t}`,r=`https://api.qrserver.com/v1/create-qr-code/?size=300x300&data=${encodeURIComponent(i)}`;te(r),S(!0),n.success("QR Code generated!")}catch{n.error("Failed to generate QR code")}},ce=()=>{if(!s||!a)return;const t=`Product: ${s.name}
SKU: ${a.sku||"N/A"}
Price: ${p.money(a.sellingPrice||0)}
Stock: ${s.totalQuantity||0} units
Category: ${s.category}
Status: ${s.status}`.trim();navigator.clipboard.writeText(t),n.success("Product info copied to clipboard!")},de=()=>{if(!(!s||!a))try{localStorage.setItem("pos_quick_add",JSON.stringify({productId:s.id,variantId:a.id,timestamp:Date.now()})),n.success("Redirecting to POS..."),setTimeout(()=>f("/mobile/pos"),500)}catch{n.error("Failed to add to cart")}},xe=async(t,i)=>{if(w(`Delete variant "${i}"?`))try{const{data:r,error:o}=await b.from("lats_stock_movements").select("id").eq("variant_id",t).limit(1);if(o){console.error("Failed to check stock movements:",o),n.error("Failed to verify variant status");return}if(r&&r.length>0){n.error("Cannot delete variant: has stock movement history");return}const{error:l}=await b.from("lats_product_variants").delete().eq("id",t);if(l){if(l.code==="23503")n.error("Cannot delete: variant is referenced by other records");else throw l;return}n.success("Variant deleted!"),window.location.reload()}catch(r){console.error("Error deleting variant:",r),n.error(`Failed: ${r.message}`)}};return X?e.jsx("div",{className:"flex flex-col h-full bg-white",children:e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500",children:"Loading product..."})]})})}):s?e.jsxs("div",{className:"flex flex-col h-full bg-white",children:[e.jsx("div",{className:"bg-white border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between px-4 py-3",children:[e.jsxs("button",{onClick:()=>f("/mobile/inventory"),className:"flex items-center gap-1 text-blue-500",children:[e.jsx(he,{size:20,strokeWidth:2}),e.jsx("span",{className:"text-[17px]",children:"Back"})]}),e.jsxs("h1",{className:"text-[17px] font-semibold text-gray-900 absolute left-1/2 transform -translate-x-1/2",children:[s.name.slice(0,20),s.name.length>20?"...":""]}),e.jsx("button",{onClick:()=>u(!0),className:"text-blue-500 text-[17px]",children:"More"})]})}),e.jsx("div",{className:"bg-white px-4 py-3",children:e.jsxs("div",{className:"bg-gray-100 rounded-lg p-0.5 flex",children:[e.jsx("button",{onClick:()=>k("overview"),className:`flex-1 py-2 text-center text-[12px] font-medium rounded-md transition-all ${j==="overview"?"bg-white text-gray-900 font-semibold shadow-sm":"text-gray-600"}`,children:"Overview"}),e.jsx("button",{onClick:()=>k("variants"),className:`flex-1 py-2 text-center text-[12px] font-medium rounded-md transition-all ${j==="variants"?"bg-white text-gray-900 font-semibold shadow-sm":"text-gray-600"}`,children:"Variants"}),e.jsx("button",{onClick:()=>k("details"),className:`flex-1 py-2 text-center text-[12px] font-medium rounded-md transition-all ${j==="details"?"bg-white text-gray-900 font-semibold shadow-sm":"text-gray-600"}`,children:"Details"})]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto pb-20",children:[j==="overview"&&e.jsxs("div",{className:"bg-white",children:[e.jsxs("div",{className:"w-full aspect-square bg-gray-100 flex items-center justify-center relative overflow-hidden border-b border-gray-200",children:[Z&&h.length===0?e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500"}):h.length>0?e.jsx("img",{src:((L=h[C])==null?void 0:L.url)||((F=h[C])==null?void 0:F.thumbnailUrl),alt:s.name,className:"w-full h-full object-cover cursor-pointer",onClick:()=>v(!0)}):e.jsx(B,{size:64,className:"text-gray-300",strokeWidth:1.5}),e.jsx("input",{ref:N,type:"file",accept:"image/*",onChange:le,className:"hidden"}),e.jsx("button",{onClick:()=>{var t;return(t=N.current)==null?void 0:t.click()},disabled:E,className:"absolute bottom-4 right-4 p-4 bg-gradient-to-br from-blue-500 to-blue-600 text-white rounded-full shadow-2xl hover:from-blue-600 hover:to-blue-700 active:scale-95 disabled:opacity-50 transition-all",style:{boxShadow:"0 10px 25px rgba(59, 130, 246, 0.4)"},children:E?e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-2 border-white border-t-transparent"}):e.jsx(O,{size:22,strokeWidth:3})})]}),e.jsx("div",{className:"px-4 py-4 border-b border-gray-200",children:e.jsxs("div",{className:"grid grid-cols-4 gap-2",children:[e.jsxs("div",{className:"bg-green-50 rounded-xl p-3 text-center border border-green-100",children:[e.jsx("div",{className:"text-[18px] font-bold text-green-600",children:p.money((a==null?void 0:a.sellingPrice)||0).replace("TSh ","")}),e.jsx("div",{className:"text-[10px] text-gray-500 mt-1 uppercase tracking-wide",children:"Price"})]}),e.jsxs("div",{className:"bg-blue-50 rounded-xl p-3 text-center border border-blue-100",children:[e.jsx("div",{className:"text-[18px] font-bold text-blue-600",children:s.totalQuantity||0}),e.jsx("div",{className:"text-[10px] text-gray-500 mt-1 uppercase tracking-wide",children:"Stock"})]}),e.jsxs("div",{className:"bg-gray-50 rounded-xl p-3 text-center border border-gray-200",children:[e.jsx("div",{className:"text-[18px] font-bold text-gray-900",children:((T=s.variants)==null?void 0:T.length)||0}),e.jsx("div",{className:"text-[10px] text-gray-500 mt-1 uppercase tracking-wide",children:"Variants"})]}),e.jsxs("div",{className:"bg-purple-50 rounded-xl p-3 text-center border border-purple-100",children:[e.jsxs("div",{className:"text-[18px] font-bold text-purple-600",children:[M,"%"]}),e.jsx("div",{className:"text-[10px] text-gray-500 mt-1 uppercase tracking-wide",children:"Margin"})]})]})}),e.jsxs("div",{className:"px-5 py-4 flex justify-between items-center border-b border-gray-200",children:[e.jsx("span",{className:"text-gray-900 text-[15px]",children:"Name"}),e.jsx("span",{className:"text-gray-900 text-[15px] text-right font-medium max-w-[60%]",children:s.name})]}),e.jsxs("div",{className:"px-5 py-4 flex justify-between items-center border-b border-gray-200",children:[e.jsx("span",{className:"text-gray-900 text-[15px]",children:"SKU"}),e.jsx("span",{className:"text-gray-900 text-[15px] font-mono",children:(a==null?void 0:a.sku)||"N/A"})]}),e.jsxs("div",{className:"px-5 py-4 flex justify-between items-center border-b border-gray-200",children:[e.jsx("span",{className:"text-gray-900 text-[15px]",children:"Category"}),e.jsx("span",{className:"text-gray-900 text-[15px]",children:s.category})]}),e.jsxs("div",{className:"px-5 py-4 flex justify-between items-center border-b border-gray-200",children:[e.jsx("span",{className:"text-gray-900 text-[15px]",children:"Selling Price"}),e.jsx("span",{className:"text-green-600 text-[15px] font-semibold",children:p.money((a==null?void 0:a.sellingPrice)||0)})]}),e.jsxs("div",{className:"px-5 py-4 flex justify-between items-center border-b border-gray-200",children:[e.jsx("span",{className:"text-gray-900 text-[15px]",children:"Cost Price"}),e.jsx("span",{className:"text-red-600 text-[15px] font-semibold",children:p.money((a==null?void 0:a.costPrice)||0)})]}),e.jsxs("div",{className:"px-5 py-4 flex justify-between items-center border-b border-gray-200",children:[e.jsx("span",{className:"text-gray-900 text-[15px]",children:"Profit per Unit"}),e.jsx("span",{className:"text-blue-600 text-[15px] font-semibold",children:p.money(((a==null?void 0:a.sellingPrice)||0)-((a==null?void 0:a.costPrice)||0))})]}),e.jsxs("div",{className:"px-5 py-4 flex justify-between items-center border-b border-gray-200",children:[e.jsx("span",{className:"text-gray-900 text-[15px]",children:"Profit Margin"}),e.jsxs("span",{className:"text-purple-600 text-[15px] font-semibold",children:[M,"%"]})]}),e.jsxs("div",{className:"px-5 py-4 flex justify-between items-center border-b border-gray-200",children:[e.jsx("span",{className:"text-gray-900 text-[15px]",children:"Total Stock"}),e.jsxs("span",{className:`text-[15px] font-semibold ${(s.totalQuantity||0)===0?"text-red-600":(s.totalQuantity||0)<=(s.low_stock_threshold||5)?"text-yellow-600":"text-green-600"}`,children:[s.totalQuantity||0," units"]})]}),e.jsxs("div",{className:"px-5 py-4 flex justify-between items-center border-b border-gray-200",children:[e.jsx("span",{className:"text-gray-900 text-[15px]",children:"Status"}),e.jsx("span",{className:`text-[15px] font-medium capitalize ${s.status==="active"?"text-green-600":"text-gray-600"}`,children:s.status})]}),Object.keys(R).length>0&&Object.entries(R).slice(0,6).map(([t,i])=>{const r=$e(t,i);return e.jsxs("div",{className:"px-5 py-4 flex justify-between items-center border-b border-gray-200",children:[e.jsx("span",{className:"text-gray-900 text-[15px] capitalize",children:t.replace(/_/g," ")}),e.jsx("span",{className:"text-gray-900 text-[15px] font-medium",children:r})]},t)}),s.description&&e.jsxs("div",{className:"px-5 py-4 border-b border-gray-200",children:[e.jsx("div",{className:"text-gray-900 text-[15px] mb-2",children:"Description"}),e.jsx("div",{className:"text-gray-600 text-[15px] leading-relaxed",children:s.description})]})]}),j==="variants"&&e.jsx("div",{className:"bg-[#f2f2f7] p-4 space-y-3",children:s.variants&&s.variants.length>0?s.variants.map((t,i)=>{const r=Ce(t),o=Se(t),l=se===t.id;return e.jsxs("div",{className:"bg-white rounded-2xl border border-gray-200 overflow-hidden shadow-sm",children:[e.jsxs("div",{className:"px-4 py-3 bg-gradient-to-r from-gray-50 to-white border-b border-gray-100",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("span",{className:"text-[17px] font-bold text-gray-900",children:G(t,`Variant ${i+1}`)}),r&&e.jsx("span",{className:`inline-flex items-center px-2 py-0.5 rounded-full text-[10px] font-bold uppercase ${r.className}`,children:r.text})]}),e.jsx("p",{className:"text-[13px] text-gray-500 font-mono",children:t.sku})]}),e.jsx("button",{onClick:()=>xe(t.id,G(t)),disabled:s.variants&&s.variants.length===1,className:`text-[15px] font-semibold ${s.variants&&s.variants.length===1?"text-gray-300 cursor-not-allowed":"text-red-500"}`,title:s.variants&&s.variants.length===1?"Cannot delete the last variant":"Delete variant",children:"Delete"})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-2 mt-3",children:[e.jsxs("div",{className:"bg-white rounded-xl p-2 text-center shadow-sm",children:[e.jsx("div",{className:"text-[16px] font-bold text-green-600",children:p.money(t.sellingPrice||0).replace("TSh ","")}),e.jsx("div",{className:"text-[10px] text-gray-500 mt-0.5 uppercase tracking-wide",children:"Price"})]}),e.jsxs("div",{className:"bg-white rounded-xl p-2 text-center shadow-sm",children:[e.jsx("div",{className:`text-[16px] font-bold ${(t.quantity||0)===0?"text-red-600":(t.quantity||0)<=(t.minQuantity||0)?"text-yellow-600":"text-green-600"}`,children:t.quantity||0}),e.jsx("div",{className:"text-[10px] text-gray-500 mt-0.5 uppercase tracking-wide",children:"Stock"})]}),e.jsxs("div",{className:"bg-white rounded-xl p-2 text-center shadow-sm",children:[e.jsx("div",{className:"text-[16px] font-bold text-blue-600",children:p.money((t.sellingPrice||0)-(t.costPrice||0)).replace("TSh ","")}),e.jsx("div",{className:"text-[10px] text-gray-500 mt-0.5 uppercase tracking-wide",children:"Profit"})]})]})]}),e.jsx("div",{className:"px-4 py-3 bg-white",children:e.jsxs("div",{className:"flex items-center justify-between bg-gray-50 rounded-xl p-3",children:[e.jsx("span",{className:"text-[15px] text-gray-700 font-medium",children:"Adjust Stock"}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{onClick:()=>W(t.id,-1),className:"w-9 h-9 rounded-full bg-gray-200 hover:bg-gray-300 flex items-center justify-center active:scale-95 transition-all shadow-sm",children:e.jsx(ge,{size:16,strokeWidth:3})}),e.jsx("span",{className:"text-[18px] font-bold text-gray-900 w-12 text-center",children:t.quantity||0}),e.jsx("button",{onClick:()=>W(t.id,1),className:"w-9 h-9 rounded-full bg-blue-500 text-white hover:bg-blue-600 flex items-center justify-center active:scale-95 transition-all shadow-sm",children:e.jsx(O,{size:16,strokeWidth:3})})]})]})}),o.length>0&&e.jsxs("div",{className:"px-4 pb-3",children:[e.jsx("button",{onClick:()=>ae(l?null:t.id),className:"w-full py-2.5 text-blue-500 text-[15px] font-semibold hover:bg-gray-50 active:bg-gray-100 rounded-lg transition-colors",children:l?"â–² Hide Details":"â–¼ Show Details"}),l&&e.jsx("div",{className:"mt-3 pt-3 border-t border-gray-100 space-y-2.5",children:o.map((g,m)=>e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-[14px] text-gray-600 capitalize",children:g.label}),e.jsx("span",{className:"text-[15px] font-semibold text-gray-900",children:g.value})]},m))})]})]},t.id)}):e.jsxs("div",{className:"px-5 py-12 text-center bg-white rounded-2xl",children:[e.jsx(fe,{className:"w-16 h-16 text-gray-300 mx-auto mb-3",strokeWidth:1.5}),e.jsx("p",{className:"text-[16px] text-gray-500 font-medium",children:"No variants found"}),e.jsx("p",{className:"text-[14px] text-gray-400 mt-1",children:"Add variants to manage different options"})]})}),j==="details"&&e.jsxs("div",{className:"bg-white",children:[e.jsxs("div",{className:"px-5 py-4 flex justify-between items-center border-b border-gray-200",children:[e.jsx("span",{className:"text-gray-900 text-[15px]",children:"Product ID"}),e.jsx("span",{className:"text-gray-900 text-[15px] font-mono text-right max-w-[60%] truncate",children:s.id})]}),e.jsxs("div",{className:"px-5 py-4 flex justify-between items-center border-b border-gray-200",children:[e.jsx("span",{className:"text-gray-900 text-[15px]",children:"SKU"}),e.jsx("span",{className:"text-gray-900 text-[15px] font-mono",children:(a==null?void 0:a.sku)||"N/A"})]}),s.barcode&&e.jsxs("div",{className:"px-5 py-4 flex justify-between items-center border-b border-gray-200",children:[e.jsx("span",{className:"text-gray-900 text-[15px]",children:"Barcode"}),e.jsx("span",{className:"text-gray-900 text-[15px] font-mono",children:s.barcode})]}),s.brand&&e.jsxs("div",{className:"px-5 py-4 flex justify-between items-center border-b border-gray-200",children:[e.jsx("span",{className:"text-gray-900 text-[15px]",children:"Brand"}),e.jsx("span",{className:"text-gray-900 text-[15px]",children:s.brand})]}),e.jsxs("div",{className:"px-5 py-4 flex justify-between items-center border-b border-gray-200",children:[e.jsx("span",{className:"text-gray-900 text-[15px]",children:"Created"}),e.jsx("span",{className:"text-gray-900 text-[15px]",children:new Date(s.created_at).toLocaleDateString()})]}),e.jsxs("div",{className:"px-5 py-4 flex justify-between items-center border-b border-gray-200",children:[e.jsx("span",{className:"text-gray-900 text-[15px]",children:"Last Updated"}),e.jsx("span",{className:"text-gray-900 text-[15px]",children:new Date(s.updated_at).toLocaleDateString()})]}),s.low_stock_threshold&&e.jsxs("div",{className:"px-5 py-4 flex justify-between items-center border-b border-gray-200",children:[e.jsx("span",{className:"text-gray-900 text-[15px]",children:"Low Stock Alert"}),e.jsxs("span",{className:"text-gray-900 text-[15px]",children:[s.low_stock_threshold," units"]})]})]})]}),ee&&$.createPortal(e.jsx("div",{className:"fixed inset-0 flex items-center justify-center z-50",style:{backgroundColor:"rgba(0, 0, 0, 0.4)"},onClick:()=>S(!1),children:e.jsxs("div",{className:"w-[90%] max-w-sm bg-white rounded-3xl overflow-hidden shadow-2xl animate-scale-up",onClick:t=>t.stopPropagation(),children:[e.jsx("div",{className:"px-6 pt-6 pb-4 border-b border-gray-100",children:e.jsx("h3",{className:"text-[22px] font-bold text-gray-900 text-center",children:"QR Code"})}),e.jsxs("div",{className:"p-6 text-center space-y-4",children:[e.jsx("div",{className:"bg-white p-4 rounded-2xl border border-gray-200 inline-block shadow-sm",children:e.jsx("img",{src:Q,alt:"QR Code",className:"w-56 h-56 object-contain"})}),e.jsxs("div",{className:"bg-gray-50 rounded-xl p-4",children:[e.jsx("p",{className:"text-[16px] font-semibold text-gray-900 mb-2",children:s.name}),e.jsxs("p",{className:"font-mono text-[14px] text-gray-600",children:["SKU: ",a==null?void 0:a.sku]}),e.jsx("p",{className:"text-[15px] text-gray-600 mt-2",children:p.money((a==null?void 0:a.sellingPrice)||0)})]})]}),e.jsxs("div",{className:"px-6 pb-6 space-y-2",children:[e.jsx("button",{onClick:()=>{const t=document.createElement("a");t.href=Q,t.download=`${s.name.replace(/[^a-zA-Z0-9]/g,"_")}_QR.png`,t.click(),n.success("Downloaded!")},className:"w-full py-4 bg-blue-500 text-white rounded-xl font-semibold text-[17px] hover:bg-blue-600 active:bg-blue-700 transition-all shadow-sm",children:"Download QR Code"}),e.jsx("button",{onClick:()=>S(!1),className:"w-full py-3 text-gray-700 rounded-xl font-medium text-[16px] hover:bg-gray-50 active:bg-gray-100 transition-colors",children:"Close"})]})]})}),document.body),_&&$.createPortal(e.jsx("div",{className:"fixed inset-0 z-[9999] flex items-end",style:{backgroundColor:"rgba(0, 0, 0, 0.6)",backdropFilter:"blur(4px)",WebkitBackdropFilter:"blur(4px)"},onClick:()=>u(!1),children:e.jsxs("div",{className:"w-full bg-white rounded-t-[32px] max-h-[80vh] flex flex-col animate-slide-up shadow-[0_-10px_50px_rgba(0,0,0,0.3)]",onClick:t=>t.stopPropagation(),style:{isolation:"isolate"},children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-4 border-b border-gray-200 bg-white",children:[e.jsx("h3",{className:"text-[20px] font-semibold text-gray-900",children:"Actions"}),e.jsx("button",{onClick:()=>u(!1),className:"text-gray-500 hover:text-gray-700",children:e.jsx(K,{size:24,strokeWidth:2})})]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4 bg-white",style:{isolation:"isolate"},children:e.jsxs("div",{className:"grid grid-cols-3 min-[480px]:grid-cols-4 sm:grid-cols-4 md:grid-cols-5 lg:grid-cols-6 gap-2.5 relative z-10",children:[e.jsxs("button",{onClick:()=>{u(!1),f(`/mobile/inventory/${d}/edit`)},className:"flex flex-col items-center gap-1.5 p-2 active:scale-95 transition-all",children:[e.jsx("div",{className:"w-12 h-12 bg-indigo-500 rounded-xl flex items-center justify-center shadow-sm",children:e.jsx(be,{size:20,className:"text-white",strokeWidth:2})}),e.jsx("div",{className:"text-center",children:e.jsx("div",{className:"text-[12px] font-medium text-gray-900",children:"Edit"})})]}),e.jsxs("button",{onClick:()=>{u(!1),de()},className:"flex flex-col items-center gap-1.5 p-2 active:scale-95 transition-all",children:[e.jsx("div",{className:"w-12 h-12 bg-blue-500 rounded-xl flex items-center justify-center shadow-sm",children:e.jsx(ye,{size:20,className:"text-white",strokeWidth:2})}),e.jsx("div",{className:"text-center",children:e.jsx("div",{className:"text-[12px] font-medium text-gray-900",children:"Add to POS"})})]}),e.jsxs("button",{onClick:()=>{u(!1),oe()},className:"flex flex-col items-center gap-1.5 p-2 active:scale-95 transition-all",children:[e.jsx("div",{className:"w-12 h-12 bg-purple-500 rounded-xl flex items-center justify-center shadow-sm",children:e.jsx(je,{size:20,className:"text-white",strokeWidth:2})}),e.jsx("div",{className:"text-center",children:e.jsx("div",{className:"text-[12px] font-medium text-gray-900",children:"QR Code"})})]}),e.jsxs("button",{onClick:()=>{u(!1),ce()},className:"flex flex-col items-center gap-1.5 p-2 active:scale-95 transition-all",children:[e.jsx("div",{className:"w-12 h-12 bg-green-500 rounded-xl flex items-center justify-center shadow-sm",children:e.jsx(ve,{size:20,className:"text-white",strokeWidth:2})}),e.jsx("div",{className:"text-center",children:e.jsx("div",{className:"text-[12px] font-medium text-gray-900",children:"Copy Info"})})]}),e.jsxs("button",{onClick:()=>{u(!1);const t=`${window.location.origin}/mobile/inventory/${d}`,i=`${s.name}
${p.money((a==null?void 0:a.sellingPrice)||0)}
SKU: ${(a==null?void 0:a.sku)||"N/A"}

${t}`;navigator.share?navigator.share({title:s.name,text:i,url:t}).then(()=>{n.success("Shared successfully!")}).catch(r=>{r.name!=="AbortError"&&n.error("Failed to share")}):navigator.clipboard.writeText(i).then(()=>{n.success("Product link copied to clipboard!")}).catch(()=>{n.error("Failed to copy link")})},className:"flex flex-col items-center gap-1.5 p-2 active:scale-95 transition-all",children:[e.jsx("div",{className:"w-12 h-12 bg-cyan-500 rounded-xl flex items-center justify-center shadow-sm",children:e.jsx(Ne,{size:20,className:"text-white",strokeWidth:2})}),e.jsx("div",{className:"text-center",children:e.jsx("div",{className:"text-[12px] font-medium text-gray-900",children:"Share"})})]}),e.jsxs("button",{onClick:()=>{u(!1),re()},className:"flex flex-col items-center gap-1.5 p-2 active:scale-95 transition-all",children:[e.jsx("div",{className:"w-12 h-12 bg-gray-600 rounded-xl flex items-center justify-center shadow-sm",children:e.jsx(we,{size:20,className:"text-white",strokeWidth:2})}),e.jsx("div",{className:"text-center",children:e.jsx("div",{className:"text-[12px] font-medium text-gray-900",children:"Print"})})]}),e.jsxs("button",{onClick:()=>{u(!1),n("Transfer stock feature - Coming soon!")},className:"flex flex-col items-center gap-1.5 p-2 active:scale-95 transition-all",children:[e.jsx("div",{className:"w-12 h-12 bg-orange-500 rounded-xl flex items-center justify-center shadow-sm",children:e.jsx(ke,{size:20,className:"text-white",strokeWidth:2})}),e.jsx("div",{className:"text-center",children:e.jsx("div",{className:"text-[12px] font-medium text-gray-900",children:"Transfer"})})]}),e.jsxs("button",{onClick:()=>{u(!1),ie()},className:"flex flex-col items-center gap-1.5 p-2 active:scale-95 transition-all",children:[e.jsx("div",{className:"w-12 h-12 bg-red-500 rounded-xl flex items-center justify-center shadow-sm",children:e.jsx(Pe,{size:20,className:"text-white",strokeWidth:2})}),e.jsx("div",{className:"text-center",children:e.jsx("div",{className:"text-[12px] font-medium text-gray-900",children:"Delete"})})]})]})}),e.jsx("div",{className:"p-4 border-t border-gray-200 bg-white",children:e.jsx("button",{onClick:()=>u(!1),className:"w-full py-4 bg-gray-100 hover:bg-gray-200 active:bg-gray-300 text-gray-900 rounded-xl font-semibold text-[17px] transition-all",children:"Cancel"})})]})}),document.body),V&&h.length>0&&$.createPortal(e.jsx("div",{className:"fixed inset-0 z-50 flex items-end",style:{backgroundColor:"rgba(0, 0, 0, 0.5)"},onClick:()=>v(!1),children:e.jsxs("div",{className:"w-full bg-white rounded-t-[20px] max-h-[95vh] flex flex-col animate-slide-up",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-gray-200 sticky top-0 bg-white z-10",children:[e.jsx("button",{onClick:()=>v(!1),className:"text-blue-500 text-[17px]",children:"Done"}),e.jsxs("h3",{className:"text-[17px] font-semibold text-gray-900",children:["Gallery (",h.length,")"]}),e.jsx("div",{className:"w-12"})," "]}),e.jsx("div",{className:"flex-1 overflow-y-auto p-4",children:e.jsx("div",{className:"grid grid-cols-2 gap-3",children:h.map((t,i)=>e.jsxs("div",{className:"relative group",children:[e.jsxs("div",{className:"aspect-square relative rounded-2xl overflow-hidden bg-gray-100 border border-gray-200 shadow-sm",children:[e.jsx("img",{src:t.url,alt:`${s.name} ${i+1}`,className:"w-full h-full object-cover cursor-pointer hover:opacity-90 transition-opacity active:scale-95",onClick:()=>{D(i),v(!1)}}),t.isPrimary&&e.jsx("div",{className:"absolute top-2 left-2 bg-gradient-to-r from-blue-500 to-blue-600 text-white text-[10px] px-2.5 py-1 rounded-full font-bold shadow-md uppercase tracking-wide",children:"Primary"}),e.jsx("button",{onClick:r=>{r.stopPropagation(),ne(t.id)},className:"absolute top-2 right-2 p-2 bg-red-500 text-white rounded-full shadow-lg hover:bg-red-600 active:bg-red-700 active:scale-95 transition-all",children:e.jsx(K,{size:14,strokeWidth:3})})]}),e.jsxs("div",{className:"text-center mt-2 text-[12px] text-gray-500",children:["Image ",i+1]})]},t.id))})})]})}),document.body)]}):e.jsx("div",{className:"flex flex-col h-full bg-white",children:e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx(B,{size:48,className:"mx-auto text-gray-400 mb-3"}),e.jsx("p",{className:"text-gray-500",children:"Product not found"}),e.jsx("button",{onClick:()=>f("/mobile/inventory"),className:"mt-4 px-4 py-2 bg-blue-500 text-white rounded-lg",children:"Back to Inventory"})]})})})},Ue=`
  @keyframes slideUp {
    from {
      transform: translateY(100%);
    }
    to {
      transform: translateY(0);
    }
  }
  @keyframes scaleUp {
    from {
      transform: scale(0.95);
      opacity: 0;
    }
    to {
      transform: scale(1);
      opacity: 1;
    }
  }
  .animate-slide-up {
    animation: slideUp 0.3s ease-out;
  }
  .animate-scale-up {
    animation: scaleUp 0.25s ease-out;
  }
`;if(typeof document<"u"&&!document.getElementById("mobile-product-detail-styles")){const d=document.createElement("style");d.id="mobile-product-detail-styles",d.textContent=Ue,document.head.appendChild(d)}export{Ke as default};
