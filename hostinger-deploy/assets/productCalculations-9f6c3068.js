const a=t=>!(!isFinite(t)||isNaN(t)||Math.abs(t)>1e12),s=t=>{const e=Number(t)||0,r=a(e);return{price:r?e:0,wasCorrupt:!r&&e!==0}},o=t=>{const e=Number(t)||0;return!isFinite(e)||isNaN(e)||e<0||e>1e7?0:e},l=t=>!!(t.parent_variant_id||t.parentVariantId||t.variantType==="imei_child"||t.variant_type==="imei_child"||t.name&&t.name.toLowerCase().includes("imei:")),f=t=>t.filter(r=>!l(r)).reduce((r,c)=>r+o(c.quantity),0),p=t=>t.reduce((e,r)=>{const{price:c,wasCorrupt:n}=s(r.costPrice),i=o(r.quantity);return n?(console.warn(`⚠️ Corrupt costPrice detected for variant ${r.id||r.sku}: ${r.costPrice}. Skipping from calculation.`),e):e+c*i},0),u=t=>t.reduce((e,r)=>{const{price:c,wasCorrupt:n}=s(r.sellingPrice||r.price),i=o(r.quantity);return n?(console.warn(`⚠️ Corrupt sellingPrice detected for variant ${r.id||r.sku}: ${r.sellingPrice||r.price}. Skipping from calculation.`),e):e+c*i},0),m=t=>{const e=u(t),r=p(t);return e-r},d=t=>{const e=u(t),r=m(t);return e>0?r/e*100:0},y=t=>{const e=f(t);return e<=0?"out-of-stock":t.some(c=>(c.quantity??0)>0&&(c.quantity??0)<=(c.minQuantity??0))||e<=10?"low":"normal"},P=(t,e="USD")=>new Intl.NumberFormat("en-US",{style:"currency",currency:e,minimumFractionDigits:2,maximumFractionDigits:2}).format(t);export{p as a,u as b,f as c,m as d,d as e,P as f,y as g};
