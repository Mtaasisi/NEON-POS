import{a as I,j as e}from"./index-61458a34.js";import{r as c}from"./vendor-36d2c7c1.js";import{c as b,M as m}from"./customerPortalService-0d37743c.js";import{z as i,U as j,m as S,P as E,M as L,s as z,an as k,aK as F,aq as M,al as R,bz as _,bs as A,a3 as q,a2 as B}from"./ui-28e30067.js";import{a as H}from"./routing-eb8c310c.js";import"./supabase-cf010ec4.js";const O=()=>{const o=H(),{startLoading:u,completeLoading:x,failLoading:g}=I(),[t,f]=c.useState(null),[y,h]=c.useState(!0),[v,d]=c.useState(!1),[l,n]=c.useState(null);c.useEffect(()=>{N()},[]);const N=async()=>{const a=u("Loading profile...");try{h(!0);const s=localStorage.getItem("customer_id");if(!s){o("/customer-portal/login");return}const r=await b.getCustomerById(s);if(!r)throw new Error("Customer not found");const p={name:r.name,phone:r.phone,email:r.email,address:r.address,profileImage:r.profile_image};f(p),n(p),x(a)}catch(s){console.error("Error loading profile:",s),i.error("Failed to load profile"),g(a,"Failed to load profile")}finally{h(!1)}},w=async()=>{if(!l)return;const a=u("Saving profile...");try{const s=localStorage.getItem("customer_id");if(!s)return;const r=await b.updateCustomerProfile(s,{name:l.name,email:l.email,address:l.address});if(!r.success)throw new Error(r.error);f(l),d(!1),i.success("Profile updated successfully"),x(a)}catch(s){console.error("Error updating profile:",s),i.error("Failed to update profile"),g(a,"Failed to save profile")}},P=()=>{localStorage.removeItem("customer_id"),i.success("Logged out successfully"),o("/customer-portal/login")},C=[{icon:M,label:"Loyalty & Rewards",value:"View points and redeem rewards",action:()=>o("/customer-portal/loyalty")},{icon:R,label:"Notifications",value:"Manage your notifications",action:()=>o("/customer-portal/notifications")},{icon:_,label:"Privacy & Security",value:"Password and security settings",action:()=>i("Feature coming soon")},{icon:A,label:"Help & Support",value:"Get help with your account",action:()=>i("Contact us at +255 712 345 678")},{icon:q,label:"Terms & Conditions",value:"Read our terms",action:()=>i("Feature coming soon")},{icon:B,label:"Privacy Policy",value:"Read our privacy policy",action:()=>i("Feature coming soon")}];return y?e.jsx(m,{title:"Profile",children:e.jsx("div",{className:"flex items-center justify-center py-20",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600"})})}):t?e.jsxs(m,{title:"Profile",children:[e.jsx("div",{className:"bg-gradient-to-br from-blue-600 to-blue-700 p-6 pb-8",children:e.jsxs("div",{className:"flex flex-col items-center",children:[e.jsx("div",{className:"w-24 h-24 bg-white rounded-full flex items-center justify-center mb-4 shadow-lg",children:t.profileImage?e.jsx("img",{src:t.profileImage,alt:t.name,className:"w-full h-full rounded-full object-cover"}):e.jsx(j,{size:48,className:"text-blue-600"})}),e.jsx("h2",{className:"text-2xl font-bold text-white mb-1",children:t.name}),e.jsx("p",{className:"text-blue-100",children:t.phone})]})}),v?e.jsx("div",{className:"px-4 py-6",children:e.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900 mb-4",children:"Edit Profile"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Full Name"}),e.jsx("input",{type:"text",value:(l==null?void 0:l.name)||"",onChange:a=>n(s=>s?{...s,name:a.target.value}:null),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),e.jsx("input",{type:"email",value:(l==null?void 0:l.email)||"",onChange:a=>n(s=>s?{...s,email:a.target.value}:null),className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Address"}),e.jsx("textarea",{value:(l==null?void 0:l.address)||"",onChange:a=>n(s=>s?{...s,address:a.target.value}:null),rows:3,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{className:"flex gap-3 pt-4",children:[e.jsx("button",{onClick:()=>{n(t),d(!1)},className:"flex-1 py-3 border-2 border-gray-300 text-gray-700 rounded-lg font-medium hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{onClick:w,className:"flex-1 py-3 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700",children:"Save Changes"})]})]})]})}):e.jsx("div",{className:"px-4 py-6 space-y-4",children:e.jsxs("div",{className:"bg-white rounded-xl p-4 shadow-sm",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Personal Information"}),e.jsxs("button",{onClick:()=>d(!0),className:"text-blue-600 font-medium flex items-center gap-1",children:[e.jsx(S,{size:18}),"Edit"]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(j,{size:20,className:"text-gray-400 mt-1"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Full Name"}),e.jsx("div",{className:"font-medium text-gray-900",children:t.name})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(E,{size:20,className:"text-gray-400 mt-1"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Phone Number"}),e.jsx("div",{className:"font-medium text-gray-900",children:t.phone})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(L,{size:20,className:"text-gray-400 mt-1"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Email"}),e.jsx("div",{className:"font-medium text-gray-900",children:t.email||"Not provided"})]})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(z,{size:20,className:"text-gray-400 mt-1"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-sm text-gray-600",children:"Address"}),e.jsx("div",{className:"font-medium text-gray-900",children:t.address||"Not provided"})]})]})]})]})}),e.jsx("div",{className:"px-4 pb-4",children:e.jsx("div",{className:"bg-white rounded-xl shadow-sm overflow-hidden",children:C.map((a,s)=>{const r=a.icon;return e.jsxs("button",{onClick:a.action,className:"w-full p-4 flex items-center justify-between hover:bg-gray-50 active:bg-gray-100 transition-colors border-b border-gray-100 last:border-b-0",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-100 rounded-lg flex items-center justify-center",children:e.jsx(r,{size:20,className:"text-gray-600"})}),e.jsxs("div",{className:"text-left",children:[e.jsx("div",{className:"font-medium text-gray-900",children:a.label}),e.jsx("div",{className:"text-xs text-gray-600",children:a.value})]})]}),e.jsx(k,{size:20,className:"text-gray-400"})]},s)})})}),e.jsx("div",{className:"px-4 pb-8",children:e.jsxs("button",{onClick:P,className:"w-full py-4 bg-red-50 text-red-600 rounded-xl font-bold flex items-center justify-center gap-2 hover:bg-red-100 active:scale-95 transition-all",children:[e.jsx(F,{size:20}),"Logout"]})})]}):e.jsx(m,{title:"Profile",children:e.jsxs("div",{className:"flex flex-col items-center justify-center py-20 px-4",children:[e.jsx("p",{className:"text-gray-600 mb-4",children:"Please login to view your profile"}),e.jsx("button",{onClick:()=>o("/customer-portal/login"),className:"px-6 py-3 bg-blue-600 text-white rounded-lg font-medium",children:"Login"})]})})};export{O as default};
