import{j as e}from"./index-61458a34.js";import{r}from"./vendor-36d2c7c1.js";import{TradeInCalculator as _}from"./TradeInCalculator-868648b1.js";import{T as f}from"./TradeInContractModal-15d48929.js";import{j as N,t as d}from"./tradeInApi-5d12dbe0.js";import{a as y}from"./routing-eb8c310c.js";import{h as w,S as x,O as S}from"./ui-28e30067.js";import"./supabase-cf010ec4.js";import"./format-aff4c6a2.js";import"./charts-d592fbd1.js";import"./toPropertyKey-7cc7522c.js";import"./pdf-e6e38bab.js";import"./useBodyScrollLock-341c8b9f.js";const G=()=>{var m;const h=y(),[g,l]=r.useState(!1),[u,c]=r.useState(!1),[s,o]=r.useState(null),[n,b]=r.useState(null),[i]=r.useState(12e5),[p]=r.useState("iPhone 14 Pro Max 256GB"),j=async t=>{console.log("Trade-in completed:",t),o(t);try{const a=await N({customer_id:"dbd45d11-2f0a-43f8-9da7-06c207eef6ce",device_name:t.trade_in_details.device_name,device_model:t.trade_in_details.device_model,device_imei:t.trade_in_details.device_imei,base_trade_in_price:t.trade_in_details.base_price,condition_rating:t.trade_in_details.condition_rating,condition_description:t.trade_in_details.condition_description,damage_items:t.trade_in_details.damage_items,new_device_price:i,customer_payment_amount:t.customer_payment_amount});a.success&&a.data?(d.success("Trade-in transaction created!"),b(a.data),l(!1),c(!0)):d.error(a.error||"Failed to create transaction")}catch(a){console.error("Error creating transaction:",a),d.error("Failed to create transaction")}},v=()=>{d.success("Contract signed successfully!"),c(!1),d.success("Sale completed! Device added to inventory.")};return e.jsxs("div",{className:"min-h-screen bg-gray-50 p-6",children:[e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs("button",{onClick:()=>h("/lats/trade-in/management"),className:"flex items-center gap-2 text-gray-600 hover:text-gray-900 mb-4",children:[e.jsx(w,{className:"w-5 h-5"}),"Back to Trade-In Management"]}),e.jsxs("h1",{className:"text-3xl font-bold text-gray-900 flex items-center gap-3",children:[e.jsx(x,{className:"w-8 h-8 text-blue-600"}),"Create Trade-In Transaction"]}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Test the complete trade-in workflow"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-6 mb-6",children:[e.jsx("h2",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Sale Scenario"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center justify-between p-4 bg-blue-50 rounded-lg border border-blue-200",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(S,{className:"w-6 h-6 text-blue-600"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-gray-900",children:p}),e.jsx("div",{className:"text-sm text-gray-600",children:"New device customer is buying"})]})]}),e.jsx("div",{className:"text-right",children:e.jsxs("div",{className:"text-lg font-bold text-blue-600",children:["TSh ",i.toLocaleString()]})})]}),s?e.jsxs("div",{className:"p-4 bg-green-50 rounded-lg border border-green-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{children:[e.jsxs("div",{className:"font-semibold text-gray-900",children:["Trade-In: ",s.trade_in_details.device_name]}),e.jsxs("div",{className:"text-sm text-gray-600",children:[s.trade_in_details.device_model," - ",s.trade_in_details.condition_rating]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-lg font-bold text-green-600",children:["-TSh ",s.final_trade_in_value.toLocaleString()]}),e.jsx("div",{className:"text-xs text-gray-600",children:"Trade-in credit"})]})]}),((m=s.trade_in_details.damage_items)==null?void 0:m.length)>0&&e.jsxs("div",{className:"text-xs text-gray-600 space-y-1 mt-2 pt-2 border-t border-green-200",children:[e.jsx("div",{className:"font-medium",children:"Deductions:"}),s.trade_in_details.damage_items.map((t,a)=>e.jsxs("div",{className:"flex justify-between",children:[e.jsxs("span",{children:["- ",t.spare_part_name]}),e.jsxs("span",{children:["TSh ",t.price.toLocaleString()]})]},a))]})]}):e.jsx("button",{onClick:()=>l(!0),className:"w-full p-4 border-2 border-dashed border-gray-300 rounded-lg hover:border-blue-500 hover:bg-blue-50 transition-colors",children:e.jsxs("div",{className:"text-center",children:[e.jsx(x,{className:"w-8 h-8 text-gray-400 mx-auto mb-2"}),e.jsx("div",{className:"font-medium text-gray-700",children:"Add Trade-In Device"}),e.jsx("div",{className:"text-sm text-gray-500",children:"Customer trading in old device"})]})}),e.jsxs("div",{className:"p-4 bg-gray-100 rounded-lg",children:[e.jsxs("div",{className:"flex justify-between items-center text-lg font-bold",children:[e.jsx("span",{className:"text-gray-900",children:"Customer Pays:"}),e.jsxs("span",{className:"text-2xl text-blue-600",children:["TSh ",(s?s.customer_payment_amount:i).toLocaleString()]})]}),s&&e.jsxs("div",{className:"text-sm text-gray-600 mt-1 text-right",children:["(TSh ",i.toLocaleString()," - TSh ",s.final_trade_in_value.toLocaleString(),")"]})]})]}),s&&!n&&e.jsx("div",{className:"mt-6 flex gap-3",children:e.jsx("button",{onClick:()=>{o(null),l(!0)},className:"flex-1 px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Change Trade-In"})}),n&&e.jsxs("div",{className:"mt-6",children:[e.jsx("div",{className:"p-4 bg-green-100 border border-green-300 rounded-lg mb-4",children:e.jsxs("div",{className:"flex items-center gap-2 text-green-800",children:[e.jsx("div",{className:"w-2 h-2 bg-green-600 rounded-full"}),e.jsxs("span",{className:"font-medium",children:["Transaction Created: ",n.transaction_number]})]})}),e.jsx("button",{onClick:()=>c(!0),className:"w-full px-6 py-3 bg-purple-600 text-white rounded-lg hover:bg-purple-700 font-semibold",children:"View/Sign Contract"})]})]}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-6",children:[e.jsx("h3",{className:"font-semibold text-blue-900 mb-3",children:"How to Use This Page:"}),e.jsxs("ol",{className:"space-y-2 text-sm text-blue-800",children:[e.jsx("li",{children:'1. Click "Add Trade-In Device" to open the calculator'}),e.jsx("li",{children:"2. Select the device model being traded in"}),e.jsx("li",{children:"3. Enter IMEI and assess condition"}),e.jsx("li",{children:"4. Add any damage/issues (optional)"}),e.jsx("li",{children:"5. Review final value and customer payment"}),e.jsx("li",{children:"6. Complete to create transaction"}),e.jsx("li",{children:"7. Generate and sign contract"})]}),e.jsxs("div",{className:"mt-4 p-3 bg-white rounded border border-blue-200",children:[e.jsx("div",{className:"text-xs font-medium text-blue-900 mb-1",children:"ðŸ’¡ Note:"}),e.jsx("div",{className:"text-xs text-blue-700",children:"In production, this would be integrated into your POS system. This page is for testing the trade-in flow independently."})]})]})]}),e.jsx(_,{isOpen:g,onClose:()=>l(!1),newDevicePrice:i,onTradeInComplete:j}),n&&e.jsx(f,{isOpen:u,transaction:n,onClose:()=>c(!1),onContractSigned:v})]})};export{G as TradeInTestPage,G as default};
