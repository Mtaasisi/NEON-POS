import{j as e,e as j,G as m,u as V,s as i}from"./index-61458a34.js";import{r as g}from"./vendor-36d2c7c1.js";import{B as K}from"./BackButton-02a80e74.js";import{a as O}from"./routing-eb8c310c.js";import{O as v,u as J,az as W,p as X,a3 as I,ap as ee,v as te,D as ae,ag as re,af as se,a8 as oe,av as R,aE as ne,Q as le,N as ie,at as E}from"./ui-28e30067.js";import{D as ce}from"./SkeletonLoaders-da70324a.js";import{P as de}from"./PageErrorBoundary-3d3e48b8.js";import{u as me}from"./useErrorHandler-ecda4689.js";import{E as pe}from"./ErrorState-8ed6c2f9.js";import{A as ue}from"./AddProductModal-144ca68a.js";import"./supabase-cf010ec4.js";import"./skuUtils-60e0a165.js";import"./CategoryInput-e47eba98.js";import"./specificationUtils-0c00478d.js";import"./useBodyScrollLock-341c8b9f.js";import"./forms-ebbdb905.js";const he=[{id:"pos-system",name:"POS System",description:"Point of Sale transactions",icon:v,path:"/pos",color:"from-blue-500 to-blue-600",category:"sales"},{id:"new-sale",name:"New Sale",description:"Start a new POS transaction",icon:v,path:"/pos",color:"from-blue-500 to-blue-600",category:"sales"},{id:"unified-inventory",name:"Unified Inventory",description:"Complete inventory and catalog management",icon:J,path:"/lats/unified-inventory",color:"from-purple-500 to-purple-600",category:"inventory"},{id:"create-purchase-order",name:"Create Purchase Order",description:"Create new purchase order",icon:v,path:"/lats/purchase-order/create",color:"from-orange-500 to-orange-600",category:"inventory"},{id:"stock-transfers",name:"Stock Transfers",description:"Transfer inventory between branches",icon:W,path:"/lats/stock-transfers",color:"from-blue-500 to-blue-600",category:"inventory"},{id:"add-customer",name:"Add Customer",description:"Create new customer profile",icon:X,path:"/lats/customers",color:"from-indigo-500 to-indigo-600",category:"customers"},{id:"sales-report",name:"Sales Report",description:"Generate sales reports",icon:I,path:"/lats/sales-reports",color:"from-teal-500 to-teal-600",category:"reports"},{id:"loyalty-program",name:"Loyalty Program",description:"Manage customer loyalty",icon:ee,path:"/lats/loyalty",color:"from-yellow-500 to-yellow-600",category:"customers"},{id:"search-products",name:"Search Products",description:"Find products quickly",icon:te,path:"/lats/unified-inventory",color:"from-emerald-500 to-emerald-600",category:"inventory"},{id:"export-data",name:"Export Data",description:"Export reports and data",icon:ae,path:"/lats/sales-reports",color:"from-cyan-500 to-cyan-600",category:"reports"},{id:"import-data",name:"Import Data",description:"Import products and customers",icon:re,path:"/lats/customers",color:"from-violet-500 to-violet-600",category:"inventory"},{id:"sales-analytics",name:"Sales Analytics",description:"Sales performance metrics",icon:se,path:"/lats/sales-analytics",color:"from-red-500 to-red-600",category:"analytics"},{id:"payment-settings",name:"Payment Settings",description:"Select provider and credentials",icon:oe,path:"/lats/payment-settings",color:"from-slate-500 to-slate-700",category:"sales"},{id:"payment-history",name:"Payment History",description:"View all payment transactions",icon:I,path:"/lats/payment-history",color:"from-indigo-500 to-indigo-600",category:"analytics"},{id:"payment-analytics",name:"Payment Analytics",description:"Payment performance insights",icon:R,path:"/lats/payment-analytics",color:"from-purple-500 to-purple-600",category:"analytics"},{id:"beem-test",name:"Beem Test",description:"Test Beem Africa payment integration",icon:ne,path:"/lats/beem-test",color:"from-blue-500 to-blue-600",category:"sales"}],ge=({className:l="",variant:w="grid",category:c="all",maxItems:p})=>{const d=O(),u=he.filter(a=>c==="all"||a.category===c).slice(0,p),x=()=>e.jsx("div",{className:`grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-4 ${l}`,children:u.map(a=>{const n=a.icon;return e.jsx(j,{className:"cursor-pointer hover:scale-105 transition-transform duration-200",onClick:()=>d(a.path),children:e.jsxs("div",{className:"p-4 text-center",children:[e.jsx("div",{className:`w-12 h-12 mx-auto mb-3 rounded-lg bg-gradient-to-br ${a.color} flex items-center justify-center`,children:e.jsx(n,{size:24,className:"text-white"})}),e.jsx("h3",{className:"font-semibold text-gray-900 mb-1",children:a.name}),e.jsx("p",{className:"text-sm text-gray-600",children:a.description})]})},a.id)})}),b=()=>e.jsx("div",{className:`space-y-2 ${l}`,children:u.map(a=>{const n=a.icon;return e.jsx(m,{onClick:()=>d(a.path),icon:e.jsx(n,{size:18}),className:`w-full justify-start text-left p-4 ${l}`,variant:"secondary",children:e.jsxs("div",{className:"flex flex-col items-start",children:[e.jsx("span",{className:"font-medium text-gray-900",children:a.name}),e.jsx("span",{className:"text-sm text-gray-600",children:a.description})]})},a.id)})}),y=()=>e.jsx("div",{className:`flex flex-wrap gap-2 ${l}`,children:u.map(a=>{const n=a.icon;return e.jsx(m,{onClick:()=>d(a.path),icon:e.jsx(n,{size:16}),className:`bg-gradient-to-r ${a.color} text-white hover:scale-105 transition-transform duration-200`,variant:"primary",children:a.name},a.id)})});switch(w){case"list":return b();case"compact":return y();default:return x()}},Ie=()=>{V();const l=O();g.useState("all");const[w,c]=g.useState(!1),{errorState:p,handleError:d,clearError:u,withErrorHandling:x}=me({maxRetries:3,showToast:!0,logToConsole:!0}),[b,y]=g.useState(!0),[a,n]=g.useState({metrics:{todaySales:0,todayOrders:0,totalProducts:0,activeCustomers:0,lowStockItems:0,pendingPayments:0,monthlyRevenue:0,monthlyGrowth:0},recentActivities:[],quickStats:[]});g.useEffect(()=>{(async()=>{await x(async()=>{var o,f,D,_,k,P;y(!0);try{const[S,q,L,G,M,$]=await Promise.allSettled([i.from("lats_sales").select("total_amount").gte("created_at",new Date().toISOString().split("T")[0]).eq("status","completed").then(t=>t).catch(t=>(console.error("❌ Failed to load today's sales:",t),{data:[],error:null})),i.from("lats_sales").select("id").gte("created_at",new Date().toISOString().split("T")[0]).then(t=>t).catch(t=>(console.error("❌ Failed to load today's orders:",t),{data:[],error:null})),i.from("lats_products").select("id, is_active").eq("is_active",!0).then(t=>t).catch(t=>(console.error("❌ Failed to load products:",t),{data:[],error:null})),i.from("customers").select("id").eq("is_active",!0).then(t=>t).catch(t=>(console.error("❌ Failed to load customers:",t),{data:[],error:null})),i.from("lats_product_variants").select("id, quantity, min_quantity").lte("quantity",10).then(t=>t).catch(t=>(console.error("❌ Failed to load low stock items:",t),{data:[],error:null})),i.from("lats_sales").select("total_amount").gte("created_at",new Date(new Date().getFullYear(),new Date().getMonth(),1).toISOString()).eq("status","completed")]),B=((o=S.data)==null?void 0:o.reduce((t,s)=>{const h=typeof s.total_amount=="number"?s.total_amount:parseFloat(s.total_amount)||0;return t+h},0))||0,z=((f=q.data)==null?void 0:f.length)||0,U=((D=L.data)==null?void 0:D.length)||0,H=((_=G.data)==null?void 0:_.length)||0,Q=((k=M.data)==null?void 0:k.length)||0,T=((P=$.data)==null?void 0:P.reduce((t,s)=>{const h=typeof s.total_amount=="number"?s.total_amount:parseFloat(s.total_amount)||0;return t+h},0))||0,Y=new Date(new Date().getFullYear(),new Date().getMonth()-1,1),{data:C}=await i.from("lats_sales").select("total_amount").gte("created_at",Y.toISOString()).lt("created_at",new Date(new Date().getFullYear(),new Date().getMonth(),1).toISOString()).eq("status","completed"),A=(C==null?void 0:C.reduce((t,s)=>{const h=typeof s.total_amount=="number"?s.total_amount:parseFloat(s.total_amount)||0;return t+h},0))||0,Z=A>0?(T-A)/A*100:0;n({metrics:{todaySales:B,todayOrders:z,totalProducts:U,activeCustomers:H,lowStockItems:Q,pendingPayments:0,monthlyRevenue:T,monthlyGrowth:Math.round(Z*100)/100},recentActivities:[],quickStats:[]})}catch(S){console.error("Error loading dashboard data:",S),n({metrics:{todaySales:0,todayOrders:0,totalProducts:0,activeCustomers:0,lowStockItems:0,pendingPayments:0,monthlyRevenue:0,monthlyGrowth:0},recentActivities:[],quickStats:[]})}y(!1)},"Loading dashboard data")})()},[x]);const N=r=>{try{l(r)}catch(o){d(o,"Navigation")}},F=r=>{try{return new Intl.NumberFormat("en-TZ",{style:"currency",currency:"TZS"}).format(r)}catch(o){return d(o,"Currency formatting"),`TZS ${r}`}};return p.hasError?e.jsx(pe,{title:"Dashboard Error",message:p.errorMessage||void 0,error:p.error||void 0,action:{label:"Try Again",onClick:()=>{u(),window.location.reload()}},secondaryAction:{label:"Go Back",onClick:()=>l(-1)},showDetails:!0}):b?e.jsx(ce,{}):e.jsxs(de,{pageName:"LATS Dashboard",showDetails:!0,children:[e.jsxs("div",{className:"p-4 sm:p-6 max-w-7xl mx-auto space-y-6",children:[e.jsxs("div",{className:"flex flex-col lg:flex-row justify-between items-start lg:items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(K,{to:"/dashboard"}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"LATS System Dashboard"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Complete business management system"})]})]}),e.jsxs("div",{className:"flex flex-wrap gap-3",children:[e.jsx(m,{onClick:()=>N("/pos"),icon:e.jsx(v,{size:18}),className:"bg-gradient-to-r from-blue-500 to-blue-600 text-white",children:"Start New Sale"}),e.jsx(m,{onClick:()=>N("/lats/purchase-order/create"),icon:e.jsx(le,{size:18}),className:"bg-gradient-to-r from-orange-500 to-amber-600 text-white",children:"Create Purchase Order"}),e.jsx(m,{onClick:()=>c(!0),icon:e.jsx(ie,{size:18}),className:"bg-gradient-to-r from-green-500 to-green-600 text-white",children:"Add Product"}),e.jsx(m,{onClick:()=>N("/lats/analytics"),icon:e.jsx(R,{size:18}),className:"bg-gradient-to-r from-purple-500 to-purple-600 text-white",children:"View Analytics"})]})]}),e.jsx("div",{style:{display:"grid",gridTemplateColumns:"repeat(auto-fit, minmax(min(240px, 100%), 1fr))",gap:"clamp(1rem, 2vw, 1.5rem)",gridAutoRows:"1fr"},children:a.quickStats.map((r,o)=>{const f=r.icon;return e.jsx(j,{className:"bg-gradient-to-br from-white/80 to-white/60",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:r.title}),e.jsx("p",{className:"text-2xl font-bold text-gray-900",children:r.value}),e.jsxs("div",{className:"flex items-center gap-1 mt-1",children:[e.jsx("span",{className:`text-sm font-medium ${r.changeType==="positive"?"text-green-600":"text-red-600"}`,children:r.change}),e.jsx("span",{className:"text-xs text-gray-500",children:"from yesterday"})]})]}),e.jsx("div",{className:`p-3 rounded-full bg-gradient-to-br ${r.color}`,children:e.jsx(f,{className:"w-6 h-6 text-white"})})]})},o)})}),e.jsxs(j,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-gradient-to-br from-blue-100 to-indigo-100 rounded-lg",children:e.jsx(E,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"LATS System Navigation"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Access all LATS modules and features"})]})]}),e.jsx(ge,{})]}),e.jsxs(j,{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"p-2 bg-gradient-to-br from-green-100 to-emerald-100 rounded-lg",children:e.jsx(E,{className:"w-5 h-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-gray-900",children:"Recent Activities"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Latest system activities and updates"})]})]}),e.jsx("div",{className:"space-y-4",children:a.recentActivities.map(r=>{const o=r.icon;return e.jsxs("div",{className:"flex items-center gap-4 p-4 bg-gray-50 rounded-lg",children:[e.jsx("div",{className:`p-2 rounded-full ${r.color.replace("text-","bg-").replace("-600","-100")}`,children:e.jsx(o,{className:"w-5 h-5"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-medium text-gray-900",children:r.title}),e.jsx("p",{className:"text-sm text-gray-600",children:r.description}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:r.time})]}),r.amount&&e.jsx("div",{className:"text-right",children:e.jsx("p",{className:"font-semibold text-gray-900",children:F(r.amount)})})]},r.id)})})]})]}),e.jsx(ue,{isOpen:w,onClose:()=>c(!1),onProductCreated:()=>{c(!1)}})]})};export{Ie as default};
