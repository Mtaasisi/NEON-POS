import{j as e,aO as Ge,s as We}from"./index-61458a34.js";import{r as c,R as H,b as me}from"./vendor-36d2c7c1.js";import{a as Ke,t as w,c as Ye,b as Xe,g as Ze,u as Je,d as Qe,e as es,f as ss,h as ts,i as Pe}from"./tradeInApi-5d12dbe0.js";import{format as M}from"./format-aff4c6a2.js";import{u as Re}from"./useBodyScrollLock-341c8b9f.js";import{X as Y,S as J,d as z,O as rs,e as ue,u as re,U as as,q as ne,V as ge,r as ls,t as ns,a3 as he,f as be,y as $e,v as ae,a9 as os,D as is,a6 as ds,l as cs,ax as De,Y as Le,by as xs,cS as ms,i as Fe,b as Ie,J as pe,N as le,a8 as Z,cT as ie,aV as de,cf as ce,ce as xe,af as Ae,G as Ve,aT as us,A as Me,bN as Ee}from"./ui-28e30067.js";import{G as gs}from"./GlassTabs-05c8a392.js";import"./supabase-cf010ec4.js";import"./routing-eb8c310c.js";import"./utils-95f4031a.js";import"./charts-d592fbd1.js";const hs=({transaction:t,onClose:g,onStatusChange:l})=>{const[b,a]=c.useState(!1),[j,y]=c.useState(!1),[_,v]=c.useState("");Re(!0);const C=async()=>{a(!0);const x=await Ke(t.id);a(!1),x.success?(w.success("Transaction approved successfully!"),l==null||l(),g()):w.error(x.error||"Failed to approve transaction")},f=async()=>{a(!0);const x=await Ye(t.id);a(!1),x.success?(w.success("Transaction completed successfully!"),l==null||l(),g()):w.error(x.error||"Failed to complete transaction")},T=async()=>{if(!_.trim()){w.error("Please provide a cancellation reason");return}a(!0);const x=await Xe(t.id,_);a(!1),x.success?(w.success("Transaction cancelled successfully!"),l==null||l(),g()):w.error(x.error||"Failed to cancel transaction")},D=(x=>{const F={pending:{bg:"bg-yellow-100",text:"text-yellow-800",icon:$e,label:"Pending"},approved:{bg:"bg-blue-100",text:"text-blue-800",icon:z,label:"Approved"},completed:{bg:"bg-green-100",text:"text-green-800",icon:z,label:"Completed"},cancelled:{bg:"bg-red-100",text:"text-red-800",icon:be,label:"Cancelled"}};return F[x]||F.pending})(t.status),A=D.icon,E=x=>({excellent:"text-green-600 bg-green-50",good:"text-blue-600 bg-blue-50",fair:"text-yellow-600 bg-yellow-50",poor:"text-red-600 bg-red-50"})[x]||"text-gray-600 bg-gray-50",d=t.status==="pending"||t.status==="approved",u=t.status==="pending",r=t.status==="pending"||t.status==="approved";return e.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center p-4 z-[99999]",role:"dialog","aria-modal":"true",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-5xl w-full max-h-[90vh] flex flex-col overflow-hidden relative",children:[e.jsx("button",{onClick:g,className:"absolute top-4 right-4 w-9 h-9 flex items-center justify-center bg-red-500 hover:bg-red-600 text-white rounded-full transition-colors shadow-lg z-50",children:e.jsx(Y,{className:"w-5 h-5"})}),e.jsx("div",{className:"p-8 bg-white border-b border-gray-200 flex-shrink-0",children:e.jsxs("div",{className:"grid grid-cols-[auto,1fr] gap-6 items-center",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-blue-500 to-blue-600 rounded-full flex items-center justify-center shadow-lg",children:e.jsx(J,{className:"w-8 h-8 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-3",children:"Trade-In Transaction Details"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:`${D.bg} ${D.text} px-4 py-2 rounded-lg flex items-center gap-2`,children:[e.jsx(A,{className:"w-5 h-5"}),e.jsx("span",{className:"font-semibold",children:D.label})]}),t.contract_signed&&e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-green-50 border border-green-200 rounded-lg",children:[e.jsx(z,{className:"w-4 h-4 text-green-600"}),e.jsx("span",{className:"text-sm font-bold text-green-700",children:"Contract Signed"})]})]})]})]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto px-6 py-6",children:[t.status==="completed"&&!t.inventory_item_id&&e.jsxs("div",{className:"mb-6 bg-green-50 border border-green-200 rounded-xl p-4 flex items-start gap-3",children:[e.jsx(rs,{className:"w-5 h-5 text-green-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-green-900",children:"Ready for Inventory"}),e.jsx("p",{className:"text-sm text-green-700 mt-1",children:"This device can now be added to POS inventory and sold to customers."})]})]}),t.status!=="completed"&&t.status!=="cancelled"&&e.jsxs("div",{className:"mb-6 bg-yellow-50 border border-yellow-200 rounded-xl p-4 flex items-start gap-3",children:[e.jsx(ue,{className:"w-5 h-5 text-yellow-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-yellow-900",children:"Not Ready for Sale"}),e.jsxs("p",{className:"text-sm text-yellow-700 mt-1",children:["This device cannot be added to inventory or sold until an admin marks it as ",e.jsx("strong",{children:"Completed"}),"."]})]})]}),t.inventory_item_id&&e.jsxs("div",{className:"mb-6 bg-blue-50 border border-blue-200 rounded-xl p-4 flex items-start gap-3",children:[e.jsx(re,{className:"w-5 h-5 text-blue-600 mt-0.5 flex-shrink-0"}),e.jsxs("div",{children:[e.jsx("div",{className:"font-semibold text-blue-900",children:"Already in Inventory"}),e.jsx("p",{className:"text-sm text-blue-700 mt-1",children:"This device has been added to inventory and is available for sale in POS."})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 rounded-2xl p-6 mb-6 border-2 border-blue-200 shadow-sm",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(J,{className:"w-5 h-5 text-blue-600"}),"Device Information"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-xl p-4 border border-blue-200",children:[e.jsx("label",{className:"text-xs font-medium text-gray-600",children:"Device Name"}),e.jsx("p",{className:"text-base font-bold text-gray-900 mt-1",children:t.device_name})]}),e.jsxs("div",{className:"bg-white rounded-xl p-4 border border-blue-200",children:[e.jsx("label",{className:"text-xs font-medium text-gray-600",children:"Model"}),e.jsx("p",{className:"text-base font-bold text-gray-900 mt-1",children:t.device_model})]}),t.device_imei&&e.jsxs("div",{className:"bg-white rounded-xl p-4 border border-blue-200",children:[e.jsx("label",{className:"text-xs font-medium text-gray-600",children:"IMEI"}),e.jsx("p",{className:"text-base font-mono font-bold text-gray-900 mt-1",children:t.device_imei})]}),t.device_serial_number&&e.jsxs("div",{className:"bg-white rounded-xl p-4 border border-blue-200",children:[e.jsx("label",{className:"text-xs font-medium text-gray-600",children:"Serial Number"}),e.jsx("p",{className:"text-base font-mono font-bold text-gray-900 mt-1",children:t.device_serial_number})]})]})]}),t.customer&&e.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-purple-100 rounded-2xl p-6 mb-6 border-2 border-purple-200 shadow-sm",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(as,{className:"w-5 h-5 text-purple-600"}),"Customer Information"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{className:"bg-white rounded-xl p-4 border border-purple-200",children:[e.jsx("label",{className:"text-xs font-medium text-gray-600",children:"Name"}),e.jsx("p",{className:"text-base font-bold text-gray-900 mt-1",children:t.customer.name})]}),t.customer.phone&&e.jsxs("div",{className:"bg-white rounded-xl p-4 border border-purple-200",children:[e.jsx("label",{className:"text-xs font-medium text-gray-600",children:"Phone"}),e.jsx("p",{className:"text-base font-bold text-gray-900 mt-1",children:t.customer.phone})]}),t.customer.email&&e.jsxs("div",{className:"bg-white rounded-xl p-4 border border-purple-200",children:[e.jsx("label",{className:"text-xs font-medium text-gray-600",children:"Email"}),e.jsx("p",{className:"text-base font-bold text-gray-900 mt-1",children:t.customer.email})]})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-green-100 rounded-2xl p-6 mb-6 border-2 border-green-200 shadow-sm",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(ne,{className:"w-5 h-5 text-green-600"}),"Condition & Pricing"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-4",children:[e.jsxs("div",{className:"bg-white rounded-xl p-4 border border-green-200",children:[e.jsx("label",{className:"text-xs font-medium text-gray-600",children:"Condition"}),e.jsx("div",{className:"mt-2",children:e.jsx("span",{className:`inline-flex px-4 py-2 rounded-lg font-bold capitalize ${E(t.condition_rating)}`,children:t.condition_rating})})]}),e.jsxs("div",{className:"bg-white rounded-xl p-4 border border-green-200",children:[e.jsx("label",{className:"text-xs font-medium text-gray-600",children:"Damage Deductions"}),e.jsx("p",{className:"text-base font-bold text-red-600 mt-1",children:t.total_damage_deductions>0?`-${M.money(t.total_damage_deductions)}`:"None"})]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-4 border border-green-200 space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm text-gray-700",children:"Base Trade-In Price:"}),e.jsx("span",{className:"text-base font-bold text-gray-900",children:M.money(t.base_trade_in_price)})]}),t.total_damage_deductions>0&&e.jsxs("div",{className:"flex justify-between items-center text-red-600",children:[e.jsx("span",{className:"text-sm",children:"Damage Deductions:"}),e.jsxs("span",{className:"text-base font-bold",children:["-",M.money(t.total_damage_deductions)]})]}),e.jsxs("div",{className:"border-t border-green-300 pt-3 flex justify-between items-center",children:[e.jsx("span",{className:"text-lg font-bold text-gray-900",children:"Final Trade-In Value:"}),e.jsx("span",{className:"text-2xl font-bold text-green-700",children:M.money(t.final_trade_in_value)})]})]}),e.jsxs("div",{className:"mt-4 flex flex-wrap gap-3",children:[t.needs_repair&&e.jsxs("div",{className:"flex items-center gap-2 bg-purple-50 text-purple-700 px-4 py-2 rounded-lg border border-purple-200",children:[e.jsx(ge,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium",children:"Needs Repair"})]}),t.ready_for_resale&&e.jsxs("div",{className:"flex items-center gap-2 bg-green-50 text-green-700 px-4 py-2 rounded-lg border border-green-200",children:[e.jsx(re,{className:"w-4 h-4"}),e.jsx("span",{className:"font-medium",children:"Ready for Resale"})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4 mb-6",children:[e.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 border border-gray-200",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-600 mb-2",children:[e.jsx(ls,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Transaction Date"})]}),e.jsx("p",{className:"text-base font-bold text-gray-900",children:M.dateTime(new Date(t.created_at))})]}),t.transaction_number&&e.jsxs("div",{className:"bg-gray-50 rounded-xl p-4 border border-gray-200",children:[e.jsxs("div",{className:"flex items-center gap-2 text-gray-600 mb-2",children:[e.jsx(ns,{className:"w-4 h-4"}),e.jsx("span",{className:"text-sm font-medium",children:"Transaction Number"})]}),e.jsx("p",{className:"text-base font-mono font-bold text-gray-900",children:t.transaction_number})]})]}),(t.staff_notes||t.internal_notes)&&e.jsxs("div",{className:"bg-gray-50 rounded-xl p-6 border border-gray-200",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-900 mb-3 flex items-center gap-2",children:[e.jsx(he,{className:"w-5 h-5 text-gray-600"}),"Notes"]}),t.staff_notes&&e.jsxs("div",{className:"mb-3",children:[e.jsx("label",{className:"text-xs font-medium text-gray-600",children:"Staff Notes"}),e.jsx("p",{className:"text-sm text-gray-700 bg-white p-3 rounded-lg border border-gray-200 mt-1 whitespace-pre-wrap",children:t.staff_notes})]}),t.internal_notes&&e.jsxs("div",{children:[e.jsx("label",{className:"text-xs font-medium text-gray-600",children:"Internal Notes"}),e.jsx("p",{className:"text-sm text-gray-700 bg-white p-3 rounded-lg border border-gray-200 mt-1 whitespace-pre-wrap",children:t.internal_notes})]})]})]}),e.jsx("div",{className:"p-6 pt-4 border-t border-gray-200 bg-white flex-shrink-0",children:e.jsxs("div",{className:"flex justify-between gap-3",children:[e.jsxs("div",{className:"flex gap-3",children:[u&&e.jsxs("button",{onClick:C,disabled:b,className:"px-6 py-3 bg-blue-600 text-white rounded-xl hover:bg-blue-700 transition-colors font-semibold disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 shadow-lg",children:[e.jsx(z,{className:"w-5 h-5"}),b?"Approving...":"Approve"]}),r&&e.jsxs("button",{onClick:f,disabled:b,className:"px-6 py-3 bg-green-600 text-white rounded-xl hover:bg-green-700 transition-colors font-semibold disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 shadow-lg",children:[e.jsx(z,{className:"w-5 h-5"}),b?"Completing...":"Complete"]}),d&&e.jsxs("button",{onClick:()=>y(!0),disabled:b,className:"px-6 py-3 bg-red-600 text-white rounded-xl hover:bg-red-700 transition-colors font-semibold disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 shadow-lg",children:[e.jsx(be,{className:"w-5 h-5"}),"Cancel Transaction"]})]}),e.jsx("button",{onClick:g,disabled:b,className:"px-6 py-3 bg-gray-600 text-white rounded-xl hover:bg-gray-700 transition-colors font-semibold disabled:opacity-50 disabled:cursor-not-allowed shadow-lg",children:"Close"})]})}),j&&e.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center z-[100000] p-4",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-md w-full p-6",children:[e.jsxs("h3",{className:"text-xl font-bold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(ue,{className:"w-6 h-6 text-red-600"}),"Cancel Transaction"]}),e.jsx("p",{className:"text-sm text-gray-600 mb-4",children:"Are you sure you want to cancel this transaction? This action cannot be undone."}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Cancellation Reason *"}),e.jsx("textarea",{value:_,onChange:x=>v(x.target.value),rows:3,className:"w-full px-4 py-2 border-2 border-gray-300 rounded-xl focus:ring-2 focus:ring-red-500 focus:border-red-500",placeholder:"Enter reason for cancellation..."})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{onClick:()=>{y(!1),v("")},className:"px-6 py-2 bg-gray-200 text-gray-700 rounded-xl hover:bg-gray-300 transition-colors font-medium",children:"Cancel"}),e.jsx("button",{onClick:T,disabled:b||!_.trim(),className:"px-6 py-2 bg-red-600 text-white rounded-xl hover:bg-red-700 transition-colors font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:b?"Cancelling...":"Confirm Cancel"})]})]})})]})})},bs=()=>{const[t,g]=c.useState([]),[l,b]=c.useState(!0),[a,j]=c.useState(""),[y,_]=c.useState(!1),[v,C]=c.useState(null);c.useState({});const[f,T]=c.useState(""),[p,D]=c.useState(""),[A,E]=c.useState(void 0),[d,u]=c.useState(void 0),[r,x]=c.useState(a);c.useEffect(()=>{const i=setTimeout(()=>{x(a)},300);return()=>clearTimeout(i)},[a]);const F=c.useCallback(async()=>{b(!0);try{const n=await Ze({search:r||void 0,status:f||void 0,condition_rating:p||void 0,needs_repair:A,ready_for_resale:d});n.success&&n.data?g(n.data):(w.error(n.error||"Failed to load transactions"),g([]))}catch(i){console.error("âŒ [TradeInHistory] Error loading transactions:",i),w.error("Failed to load transactions"),g([])}finally{b(!1)}},[r,f,p,A,d]);c.useEffect(()=>{F()},[f,p,A,d]),c.useEffect(()=>{F()},[r]);const S=H.useMemo(()=>{if(t.length===0)return{totalTransactions:0,totalValue:0,averageValue:0,pendingCount:0,completedCount:0,needsRepairCount:0,readyForResaleCount:0};const i=1e12,n=t.filter(N=>{const B=Number(N.final_trade_in_value)||0;return Math.abs(B)<=i&&isFinite(B)}),m=n.reduce((N,B)=>{const L=Number(B.final_trade_in_value)||0;return N+L},0);return{totalTransactions:t.length,totalValue:m,averageValue:n.length>0?m/n.length:0,pendingCount:t.filter(N=>N.status==="pending").length,completedCount:t.filter(N=>N.status==="completed").length,needsRepairCount:t.filter(N=>N.needs_repair&&!N.ready_for_resale).length,readyForResaleCount:t.filter(N=>N.ready_for_resale).length}},[t]),X=()=>{F()},G=()=>{if(t.length===0){w.error("No transactions to export");return}const i=["Transaction Number","Date","Device Name","Device Model","IMEI","Customer Name","Customer Phone","Condition","Base Price","Damage Deductions","Final Value","Status","Needs Repair","Ready for Resale"],n=t.map(k=>{var O,Q;return[k.transaction_number||"",new Date(k.created_at).toLocaleDateString(),k.device_name||"",k.device_model||"",k.device_imei||"",((O=k.customer)==null?void 0:O.name)||"",((Q=k.customer)==null?void 0:Q.phone)||"",k.condition_rating||"",M.money(k.base_trade_in_price||0),M.money(k.total_damage_deductions||0),M.money(k.final_trade_in_value||0),k.status||"",k.needs_repair?"Yes":"No",k.ready_for_resale?"Yes":"No"]}),m=[i.join(","),...n.map(k=>k.map(O=>`"${String(O).replace(/"/g,'""')}"`).join(","))].join(`
`),N=new Blob([m],{type:"text/csv;charset=utf-8;"}),B=window.URL.createObjectURL(N),L=document.createElement("a");L.href=B,L.download=`trade-in-transactions-${new Date().toISOString().split("T")[0]}.csv`,L.click(),window.URL.revokeObjectURL(B),w.success("Export completed successfully!")},oe=()=>{const i=window.open("","_blank");if(!i){w.error("Please allow popups to print reports");return}const n=`
      <!DOCTYPE html>
      <html>
        <head>
          <title>Trade-In Transactions Report - ${new Date().toLocaleDateString()}</title>
          <style>
            body { font-family: Arial, sans-serif; padding: 20px; }
            h1 { color: #333; border-bottom: 2px solid #2563eb; padding-bottom: 10px; }
            .summary { display: grid; grid-template-columns: repeat(4, 1fr); gap: 15px; margin: 20px 0; }
            .summary-card { border: 1px solid #ddd; padding: 15px; border-radius: 8px; }
            .summary-card h3 { margin: 0 0 10px 0; font-size: 14px; color: #666; }
            .summary-card p { margin: 0; font-size: 24px; font-weight: bold; }
            table { width: 100%; border-collapse: collapse; margin-top: 20px; font-size: 12px; }
            th, td { border: 1px solid #ddd; padding: 8px; text-align: left; }
            th { background-color: #f3f4f6; font-weight: 600; }
            @media print { 
              body { print-color-adjust: exact; -webkit-print-color-adjust: exact; }
            }
          </style>
        </head>
        <body>
          <h1>Trade-In Transactions Report</h1>
          <p>Generated on: ${new Date().toLocaleString()}</p>
          
          <div class="summary">
            <div class="summary-card">
              <h3>Total Transactions</h3>
              <p>${S.totalTransactions}</p>
            </div>
            <div class="summary-card">
              <h3>Total Value</h3>
              <p>${M.money(S.totalValue)}</p>
            </div>
            <div class="summary-card">
              <h3>Needs Repair</h3>
              <p>${S.needsRepairCount}</p>
            </div>
            <div class="summary-card">
              <h3>Ready for Sale</h3>
              <p>${S.readyForResaleCount}</p>
            </div>
          </div>

          <table>
            <thead>
              <tr>
                <th>Transaction #</th>
                <th>Date</th>
                <th>Device</th>
                <th>Customer</th>
                <th>Condition</th>
                <th>Value</th>
                <th>Status</th>
              </tr>
            </thead>
            <tbody>
              ${t.map(m=>{var N;return`
                <tr>
                  <td>${m.transaction_number||""}</td>
                  <td>${new Date(m.created_at).toLocaleDateString()}</td>
                  <td>${m.device_name} ${m.device_model}</td>
                  <td>${((N=m.customer)==null?void 0:N.name)||""}</td>
                  <td>${m.condition_rating||""}</td>
                  <td>${M.money(m.final_trade_in_value||0)}</td>
                  <td>${m.status||""}</td>
                </tr>
              `}).join("")}
            </tbody>
          </table>
        </body>
      </html>
    `;i.document.write(n),i.document.close(),i.print()},W=i=>{const m={pending:{bg:"bg-yellow-100",text:"text-yellow-800",icon:$e},approved:{bg:"bg-blue-100",text:"text-blue-800",icon:z},completed:{bg:"bg-green-100",text:"text-green-800",icon:z},cancelled:{bg:"bg-red-100",text:"text-red-800",icon:be}}[i],N=m.icon;return e.jsxs("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${m.bg} ${m.text} flex items-center gap-1`,children:[e.jsx(N,{className:"w-3 h-3"}),i.charAt(0).toUpperCase()+i.slice(1)]})},P=i=>({excellent:"text-green-600",good:"text-blue-600",fair:"text-yellow-600",poor:"text-red-600"})[i];return e.jsxs("div",{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4 mb-6",children:[e.jsx("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 rounded-lg p-4 border border-blue-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-blue-600 font-medium",children:"Total Transactions"}),e.jsx("p",{className:"text-2xl font-bold text-blue-900 mt-1",children:S.totalTransactions})]}),e.jsx(J,{className:"w-10 h-10 text-blue-600 opacity-50"})]})}),e.jsx("div",{className:"bg-gradient-to-br from-green-50 to-green-100 rounded-lg p-4 border border-green-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-green-600 font-medium",children:"Total Value"}),e.jsx("p",{className:"text-2xl font-bold text-green-900 mt-1",children:M.money(S.totalValue)})]}),e.jsx(ne,{className:"w-10 h-10 text-green-600 opacity-50"})]})}),e.jsx("div",{className:"bg-gradient-to-br from-purple-50 to-purple-100 rounded-lg p-4 border border-purple-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-purple-600 font-medium",children:"Needs Repair"}),e.jsx("p",{className:"text-2xl font-bold text-purple-900 mt-1",children:S.needsRepairCount})]}),e.jsx(ge,{className:"w-10 h-10 text-purple-600 opacity-50"})]})}),e.jsx("div",{className:"bg-gradient-to-br from-orange-50 to-orange-100 rounded-lg p-4 border border-orange-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-orange-600 font-medium",children:"Ready for Sale"}),e.jsx("p",{className:"text-2xl font-bold text-orange-900 mt-1",children:S.readyForResaleCount})]}),e.jsx(re,{className:"w-10 h-10 text-orange-600 opacity-50"})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-sm p-4 mb-6",children:[e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(ae,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search by device, IMEI, or customer...",value:a,onChange:i=>j(i.target.value),onKeyDown:i=>i.key==="Enter"&&X(),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("button",{onClick:()=>_(!y),className:`px-4 py-2 rounded-lg font-medium flex items-center gap-2 transition-colors ${y?"bg-blue-600 text-white":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:[e.jsx(os,{className:"w-5 h-5"}),"Filters"]}),e.jsx("button",{onClick:X,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors font-medium",children:"Search"}),t.length>0&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:G,className:"px-4 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors font-medium flex items-center gap-2",title:"Export to CSV",children:[e.jsx(is,{className:"w-4 h-4"}),"Export CSV"]}),e.jsxs("button",{onClick:oe,className:"px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors font-medium flex items-center gap-2",title:"Print Report",children:[e.jsx(ds,{className:"w-4 h-4"}),"Print"]})]})]}),y&&e.jsxs("div",{className:"mt-4 pt-4 border-t border-gray-200 grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Status"}),e.jsxs("select",{value:f,onChange:i=>T(i.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"All Statuses"}),e.jsx("option",{value:"pending",children:"Pending"}),e.jsx("option",{value:"approved",children:"Approved"}),e.jsx("option",{value:"completed",children:"Completed"}),e.jsx("option",{value:"cancelled",children:"Cancelled"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Condition"}),e.jsxs("select",{value:p,onChange:i=>D(i.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"All Conditions"}),e.jsx("option",{value:"excellent",children:"Excellent"}),e.jsx("option",{value:"good",children:"Good"}),e.jsx("option",{value:"fair",children:"Fair"}),e.jsx("option",{value:"poor",children:"Poor"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Repair Status"}),e.jsxs("select",{value:A===void 0?"":A.toString(),onChange:i=>E(i.target.value===""?void 0:i.target.value==="true"),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"All"}),e.jsx("option",{value:"true",children:"Needs Repair"}),e.jsx("option",{value:"false",children:"No Repair Needed"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Sale Status"}),e.jsxs("select",{value:d===void 0?"":d.toString(),onChange:i=>u(i.target.value===""?void 0:i.target.value==="true"),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"",children:"All"}),e.jsx("option",{value:"true",children:"Ready for Sale"}),e.jsx("option",{value:"false",children:"Not Ready"})]})]})]})]}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:l?e.jsxs("div",{className:"p-12 text-center",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full mx-auto"}),e.jsx("p",{className:"text-gray-600 mt-4",children:"Loading transactions..."})]}):t.length===0?e.jsxs("div",{className:"p-12 text-center",children:[e.jsx(J,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Trade-In Transactions"}),e.jsx("p",{className:"text-gray-600",children:a?"No transactions match your search":"Start trading in devices to see them here"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Transaction"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Device"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Customer"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Condition"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Value"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:t.map(i=>{var n,m;return e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:i.transaction_number}),i.contract_signed&&e.jsxs("div",{className:"text-xs text-green-600 flex items-center gap-1 mt-1",children:[e.jsx(z,{className:"w-3 h-3"}),"Contract Signed"]})]}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:i.device_name}),e.jsx("div",{className:"text-xs text-gray-500",children:i.device_model}),i.device_imei&&e.jsxs("div",{className:"text-xs text-gray-400 mt-1",children:["IMEI: ",i.device_imei]})]}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:"text-sm text-gray-900",children:(n=i.customer)==null?void 0:n.name}),e.jsx("div",{className:"text-xs text-gray-500",children:(m=i.customer)==null?void 0:m.phone})]}),e.jsxs("td",{className:"px-6 py-4",children:[e.jsx("div",{className:`text-sm font-medium capitalize ${P(i.condition_rating)}`,children:i.condition_rating}),i.total_damage_deductions>0&&e.jsxs("div",{className:"text-xs text-red-600 mt-1",children:["-",M.money(i.total_damage_deductions)," deducted"]})]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm font-bold text-gray-900",children:M.money(i.final_trade_in_value)}),i.needs_repair&&e.jsxs("div",{className:"flex items-center gap-1 text-xs text-purple-600 mt-1",children:[e.jsx(ge,{className:"w-3 h-3"}),"Needs Repair"]}),i.ready_for_resale&&e.jsxs("div",{className:"flex items-center gap-1 text-xs text-green-600 mt-1",children:[e.jsx(re,{className:"w-3 h-3"}),"Ready for Sale"]})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:W(i.status)}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm text-gray-900",children:new Date(i.created_at).toLocaleDateString()}),e.jsx("div",{className:"text-xs text-gray-500",children:new Date(i.created_at).toLocaleTimeString()})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:e.jsx("button",{onClick:()=>C(i),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"View Details",children:e.jsx(cs,{className:"w-4 h-4"})})})]},i.id)})})]})})}),t.length>0&&e.jsx("div",{className:"mt-6 bg-gray-50 rounded-lg p-4 border border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between text-sm",children:[e.jsxs("div",{className:"text-gray-600",children:["Showing ",t.length," transaction",t.length!==1?"s":""]}),e.jsxs("div",{className:"text-gray-900 font-medium",children:["Average Value: ",M.money(S.averageValue)]})]})}),v&&e.jsx(hs,{transaction:v,onClose:()=>C(null),onStatusChange:()=>{F(),C(null)}})]})},ps=[{id:"frame_scratch",question:"Has scratches on frame"},{id:"screen_scratch",question:"Has scratches on screen"},{id:"screen_crack",question:"Has cracks on screen"},{id:"back_scratch",question:"Has scratches on back"},{id:"back_crack",question:"Has cracks on back"},{id:"button_damage",question:"Buttons not working properly"},{id:"camera_damage",question:"Camera has issues"},{id:"water_damage",question:"Signs of water damage"},{id:"battery_swollen",question:"Battery is swollen"},{id:"charging_port",question:"Charging port not working"},{id:"speaker_issue",question:"Speaker not working"},{id:"microphone_issue",question:"Microphone not working"},{id:"display_issue",question:"Display has issues (dead pixels, discoloration)"},{id:"housing_damage",question:"Housing is bent or damaged"}],fs=({isOpen:t,onClose:g,onSave:l,initialIssues:b})=>{const[a,j]=c.useState(b||ps.map(d=>({id:d.id,question:d.question,checked:!1,images:[]}))),[y,_]=c.useState(null),v=c.useRef({}),C=d=>{j(u=>{const r=[...u];return r[d]={...r[d],checked:!r[d].checked},r})},f=async(d,u)=>{if(!u.type.startsWith("image/")){alert("Please select an image file");return}if(u.size>10*1024*1024){alert("Image size must be less than 10MB");return}_(d);try{const r=new FileReader;r.onloadend=()=>{const x=r.result;j(F=>{const S=[...F];return S[d]={...S[d],images:[...S[d].images,x]},S}),_(null)},r.onerror=()=>{alert("Failed to read image file"),_(null)},r.readAsDataURL(u)}catch(r){console.error("Error uploading image:",r),alert("Failed to upload image"),_(null)}},T=(d,u)=>{j(r=>{const x=[...r];return x[d]={...x[d],images:x[d].images.filter((F,S)=>S!==u)},x})},p=()=>{const d=a.filter(u=>u.checked).length;return a.length,d===0?"excellent":d<=2?"good":d<=5?"fair":"poor"},D=()=>{const d=a.flatMap(r=>r.images),u=p();l({issues:a,calculatedCondition:u,images:d}),g()};if(!t)return null;const A=a.filter(d=>d.checked).length,E=p();return me.createPortal(e.jsx(e.Fragment,{children:e.jsx("div",{className:"fixed bg-black/60 flex items-center justify-center p-2 sm:p-4 z-[99999]",style:{top:0,left:0,right:0,bottom:0,overflow:"hidden",overscrollBehavior:"none"},role:"dialog","aria-modal":"true",onClick:g,children:e.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-4xl max-h-[95vh] sm:max-h-[90vh] flex flex-col overflow-hidden relative",style:{pointerEvents:"auto"},onClick:d=>d.stopPropagation(),children:[e.jsx("button",{type:"button",onClick:g,className:"absolute top-2 right-2 w-7 h-7 flex items-center justify-center bg-red-500 hover:bg-red-600 text-white rounded-full transition-colors shadow-lg z-50",children:e.jsx(Y,{className:"w-4 h-4"})}),e.jsx("div",{className:"px-4 py-3 bg-white border-b border-gray-200 flex-shrink-0",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-8 h-8 bg-orange-600 rounded-full flex items-center justify-center",children:e.jsx(ue,{className:"w-4 h-4 text-white"})}),e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Device Condition Assessment"})]}),e.jsxs("div",{className:"flex items-center gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Issues:"}),e.jsx("span",{className:"ml-1 font-semibold text-gray-900",children:A})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-600",children:"Condition:"}),e.jsx("span",{className:`ml-1 font-bold ${E==="excellent"?"text-green-600":E==="good"?"text-blue-600":E==="fair"?"text-yellow-600":"text-red-600"}`,children:E.charAt(0).toUpperCase()+E.slice(1)})]})]})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-3",children:e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:a.map((d,u)=>e.jsxs("div",{className:`border rounded-lg p-2 transition-colors ${d.checked?"border-orange-500 bg-orange-50":"border-gray-200 bg-white hover:border-gray-300"}`,children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("button",{type:"button",onClick:()=>C(u),className:`w-4 h-4 flex items-center justify-center rounded border-2 transition-colors flex-shrink-0 ${d.checked?"bg-orange-600 border-orange-600":"bg-white border-gray-300"}`,children:d.checked&&e.jsx(De,{className:"w-2.5 h-2.5 text-white"})}),e.jsx("label",{className:"flex-1 text-xs font-medium text-gray-900 cursor-pointer leading-tight",onClick:()=>C(u),children:d.question})]}),d.checked&&e.jsx("div",{className:"mt-2",children:e.jsxs("div",{className:"flex items-center gap-1.5 flex-wrap",children:[d.images.map((r,x)=>e.jsxs("div",{className:"relative group",children:[e.jsx("img",{src:r,alt:`${d.question} - Image ${x+1}`,className:"w-12 h-12 object-cover rounded border border-gray-300"}),e.jsx("button",{type:"button",onClick:()=>T(u,x),className:"absolute -top-1 -right-1 w-4 h-4 bg-red-500 hover:bg-red-600 text-white rounded-full flex items-center justify-center opacity-0 group-hover:opacity-100 transition-opacity",children:e.jsx(Le,{className:"w-2.5 h-2.5"})})]},x)),e.jsx("input",{ref:r=>{v.current[u]=r},type:"file",accept:"image/*",className:"hidden",onChange:r=>{var F;const x=(F=r.target.files)==null?void 0:F[0];x&&f(u,x),r.target&&(r.target.value="")}}),e.jsx("button",{type:"button",onClick:()=>{var r;return(r=v.current[u])==null?void 0:r.click()},disabled:y===u,className:"w-12 h-12 border-2 border-dashed border-gray-300 rounded flex flex-col items-center justify-center hover:border-orange-500 hover:bg-orange-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:y===u?e.jsx("div",{className:"animate-spin rounded-full h-3 w-3 border-2 border-orange-500 border-t-transparent"}):e.jsx(xs,{className:"w-3 h-3 text-gray-400"})})]})})]},d.id))})}),e.jsxs("div",{className:"flex gap-2 pt-2 pb-3 px-3 border-t border-gray-200 flex-shrink-0 bg-white",children:[e.jsx("button",{type:"button",onClick:g,className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg text-gray-700 text-sm font-medium hover:bg-gray-50 transition-colors",children:"Cancel"}),e.jsxs("button",{type:"button",onClick:D,className:"flex-1 px-3 py-2 bg-gradient-to-r from-orange-500 to-orange-600 text-white rounded-lg text-sm font-semibold hover:from-orange-600 hover:to-orange-700 transition-all flex items-center justify-center gap-1.5",children:[e.jsx(De,{className:"w-4 h-4"}),"Save Assessment"]})]})]})})}),document.body)},te=()=>({device_name:"",device_model:"",base_trade_in_price:0,product_id:void 0,variant_id:void 0,excellent_multiplier:1,good_multiplier:.85,fair_multiplier:.7,poor_multiplier:.5,storage_capacity:"",battery_health:100,has_charger:!1,has_original_box:!1,specifications:{storage:1,battery:1,condition:1,screen:1},notes:"",is_active:!0}),q=({label:t,value:g,onChange:l,onAdjust:b,color:a,badge:j,description:y,isLoading:_=!1,icon:v})=>{const f={green:{border:"border-green-200",bg:"bg-green-500",text:"text-green-600",hover:"hover:bg-green-500 hover:text-white hover:border-green-500",focus:"focus:border-green-500 focus:ring-green-200"},blue:{border:"border-blue-200",bg:"bg-blue-500",text:"text-blue-600",hover:"hover:bg-blue-500 hover:text-white hover:border-blue-500",focus:"focus:border-blue-500 focus:ring-blue-200"},yellow:{border:"border-yellow-200",bg:"bg-yellow-500",text:"text-yellow-600",hover:"hover:bg-yellow-500 hover:text-white hover:border-yellow-500",focus:"focus:border-yellow-500 focus:ring-yellow-200"},red:{border:"border-red-200",bg:"bg-red-500",text:"text-red-600",hover:"hover:bg-red-500 hover:text-white hover:border-red-500",focus:"focus:border-red-500 focus:ring-red-200"},amber:{border:"border-amber-200",bg:"bg-amber-500",text:"text-amber-600",hover:"hover:bg-amber-500 hover:text-white hover:border-amber-500",focus:"focus:border-amber-500 focus:ring-amber-200"}}[a];return e.jsxs("div",{className:`bg-white rounded-xl p-5 border-2 ${f.border} shadow-sm`,children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[j?e.jsx("div",{className:`w-8 h-8 ${f.bg} rounded-full flex items-center justify-center shadow-sm`,children:e.jsx("span",{className:"text-white text-xs font-bold",children:j})}):v?e.jsx(v,{className:`w-5 h-5 ${f.text}`}):null,e.jsx("label",{className:"text-sm font-semibold text-gray-700",children:t})]}),e.jsxs("span",{className:`text-lg font-bold ${f.text}`,children:[g.toFixed(2),"Ã—"]})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("button",{type:"button",onClick:()=>b(-.05),className:`w-10 h-10 flex items-center justify-center bg-white border-2 border-gray-300 ${f.hover} rounded-lg transition-all font-semibold shadow-sm`,disabled:_,children:e.jsx(pe,{className:"w-4 h-4"})}),e.jsx("input",{type:"number",min:"0",max:"2",step:"0.01",value:Number(g.toFixed(2)),onChange:T=>l(parseFloat(T.target.value)||g),className:`flex-1 px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none ${f.focus} focus:ring-2 bg-white text-xl font-bold text-center`,disabled:_}),e.jsx("button",{type:"button",onClick:()=>b(.05),className:`w-10 h-10 flex items-center justify-center bg-white border-2 border-gray-300 ${f.hover} rounded-lg transition-all font-semibold shadow-sm`,disabled:_,children:e.jsx(le,{className:"w-4 h-4"})})]}),e.jsx("p",{className:"text-xs text-gray-500 text-center mt-2",children:y})]})},js=({isOpen:t,onClose:g,price:l,onSave:b})=>{var ve,Ne,we,_e,Ce,ke,Se,Te;const[a,j]=c.useState(!1),[y,_]=c.useState(!1),[v,C]=c.useState([]),[f,T]=c.useState([]),[p,D]=c.useState(""),[A,E]=c.useState(!1),[d,u]=c.useState(null),[r,x]=c.useState(null),[F,S]=c.useState(null),[X,G]=c.useState(!1),[oe,W]=c.useState(!1),[P,i]=c.useState(null),[n,m]=c.useState(te()),[N,B]=c.useState(null),L=H.useCallback(async()=>{if(N)return N;try{const s=await Ge();if(s&&Array.isArray(s))return B(s),s}catch(s){console.error("Error loading products:",s)}return[]},[N]),k=H.useCallback(async s=>{try{const h=(await L()).find(I=>I.id===s);h&&u(h)}catch(o){console.error("Error loading product by ID:",o)}},[L]);c.useEffect(()=>{l?(m({...te(),device_name:l.device_name||"",device_model:l.device_model||"",base_trade_in_price:l.base_trade_in_price||0,product_id:l.product_id||void 0,variant_id:l.variant_id||void 0,excellent_multiplier:l.excellent_multiplier||1,good_multiplier:l.good_multiplier||.85,fair_multiplier:l.fair_multiplier||.7,poor_multiplier:l.poor_multiplier||.5,storage_capacity:l.storage_capacity||"",battery_health:l.battery_health||100,has_charger:l.has_charger||!1,has_original_box:l.has_original_box||!1,specifications:l.specifications||te().specifications,notes:l.notes||"",is_active:l.is_active??!0}),l.product?u(l.product):l.product_id&&k(l.product_id).catch(console.error),l.variant&&x(l.variant)):(m(te()),u(null),x(null),T([]))},[l,k]);const O=H.useCallback(async s=>{try{const{data:o}=await We.from("lats_product_variants").select("id, variant_name, sku, is_parent").eq("product_id",s).is("parent_variant_id",null).order("variant_name");o&&T(o)}catch(o){console.error("Error loading variants:",o)}},[]);c.useEffect(()=>{d!=null&&d.id?O(d.id):(T([]),x(null))},[d,O]),c.useEffect(()=>{if(l!=null&&l.variant_id&&f.length>0&&!r){const s=f.find(o=>o.id===l.variant_id);s&&x(s)}},[f,l==null?void 0:l.variant_id,r]);const Q=H.useCallback(async s=>{if(!s.trim()){C([]);return}const h=(await L()).filter(I=>{var $,R;return(($=I.name)==null?void 0:$.toLowerCase().includes(s.toLowerCase()))||((R=I.sku)==null?void 0:R.toLowerCase().includes(s.toLowerCase()))}).slice(0,10);C(h)},[L]),Be=s=>{u(s),m(o=>({...o,product_id:s.id,device_name:o.device_name||s.name||"",device_model:o.device_model||s.sku||""})),E(!1),D(""),C([])},Ue=s=>{x(s),m(o=>({...o,variant_id:s.id}))},qe=()=>{u(null),x(null),T([]),m(s=>({...s,product_id:void 0,variant_id:void 0}))},fe=s=>{const o=typeof s=="string"?parseFloat(s):s;return o%1===0?o.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0}):o.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})},ee=(s,o,h=0,I)=>{m($=>{const R=$[s]||0,K=Math.max(h,R+o);return{...$,[s]:I?Math.min(I,K):K}})},U=H.useCallback((s,o)=>{m(h=>{var $;if(s.startsWith("specifications.")){const R=s.split(".")[1],K=Math.max(0,Math.min(2,((($=h.specifications)==null?void 0:$[R])||1)+o));return{...h,specifications:{...h.specifications,[R]:Math.round(K*100)/100}}}const I=Math.max(0,Math.min(2,(h[s]||1)+o));return{...h,[s]:Math.round(I*100)/100}})},[]),se=H.useCallback((s,o)=>{m(h=>({...h,specifications:{...h.specifications,[s]:o}}))},[]),ze=()=>{var o,h;let s=n.base_trade_in_price;return(o=n.specifications)!=null&&o.storage&&(s*=n.specifications.storage),(h=n.specifications)!=null&&h.battery&&(s*=n.specifications.battery),s},V=s=>{const{name:o,value:h,type:I}=s.target,$=s.target.checked;if(I==="checkbox")m(R=>({...R,[o]:$}));else if(I==="number")m(R=>({...R,[o]:parseFloat(h)||0}));else{const R=(o==="product_id"||o==="variant_id")&&h===""?void 0:h;m(K=>({...K,[o]:R}))}},Oe=async()=>{try{console.log("ðŸŽ¯ TradeInPriceModal: Starting price creation process"),console.log("ðŸ“ Form data received:",n),j(!0);const s={...n,product_id:n.product_id||void 0,variant_id:n.variant_id||void 0,storage_capacity:n.storage_capacity||void 0,notes:n.notes||void 0},o=l?await Je(l.id,s):await Qe(s);o.success?(console.log("âœ… Price saved successfully"),b(),g()):(console.error("âŒ Failed to save price:",o.error),w.error(o.error||"Failed to save price"))}catch(s){console.error("âŒ TradeInPriceModal: PRICE SAVE FAILED"),console.error("Error Message:",(s==null?void 0:s.message)||"No message"),w.error("Failed to save price. Please try again.")}finally{j(!1),console.log("ðŸ TradeInPriceModal: Price save process ended")}};if(Re(t),c.useEffect(()=>{if(t){const s=document.documentElement.style.overflow;return document.documentElement.style.overflow="hidden",()=>{document.documentElement.style.overflow=s}}},[t]),!t)return null;const je=["device_name","device_model","base_trade_in_price"],He=je.filter(s=>{const o=n[s];return o!=null&&o!==""&&o!==0}).length,ye=je.length-He;return me.createPortal(e.jsxs("div",{className:"fixed bg-black/60 flex items-center justify-center p-4 z-[99999]",style:{top:0,left:0,right:0,bottom:0,overflow:"hidden",overscrollBehavior:"none"},role:"dialog","aria-modal":"true","aria-labelledby":"trade-in-price-modal-title",onClick:g,children:[e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-3xl w-full max-h-[90vh] flex flex-col overflow-hidden relative",style:{pointerEvents:"auto"},onClick:s=>s.stopPropagation(),children:[e.jsx("button",{type:"button",onClick:g,disabled:a,className:"absolute top-4 right-4 w-9 h-9 flex items-center justify-center bg-red-500 hover:bg-red-600 text-white rounded-full transition-colors shadow-lg z-50",children:e.jsx(Y,{className:"w-5 h-5"})}),e.jsx("div",{className:"p-8 bg-white border-b border-gray-200 flex-shrink-0",children:e.jsxs("div",{className:"grid grid-cols-[auto,1fr] gap-6 items-center",children:[e.jsx("div",{className:"w-16 h-16 bg-orange-600 rounded-full flex items-center justify-center shadow-lg",children:e.jsx(ne,{className:"w-8 h-8 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{id:"trade-in-price-modal-title",className:"text-2xl font-bold text-gray-900 mb-2",children:l?"Edit Trade-In Price":"Add Trade-In Price"}),e.jsx("p",{className:"text-sm text-gray-600",children:l?"Update trade-in price information":"Create new trade-in price for devices"})]})]})}),e.jsxs("form",{onSubmit:s=>{s.preventDefault(),Oe()},className:"flex-1 overflow-y-auto p-6",id:"trade-in-price-form",children:[e.jsxs("div",{className:"mb-5",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Device Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Device Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",name:"device_name",value:n.device_name,onChange:V,placeholder:"e.g., iPhone 13 Pro",className:"w-full px-4 py-3 border-2 border-gray-300 rounded-xl focus:outline-none focus:border-orange-500 focus:ring-2 focus:ring-orange-200 transition-colors text-gray-900",disabled:a,required:!0})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Device Model ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx("input",{type:"text",name:"device_model",value:n.device_model,onChange:V,placeholder:"e.g., A2639",className:"w-full px-4 py-3 border-2 border-gray-300 rounded-xl focus:outline-none focus:border-orange-500 focus:ring-2 focus:ring-orange-200 transition-colors text-gray-900",disabled:a,required:!0})]})]}),e.jsxs("div",{className:"mt-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ae,{className:"w-4 h-4 text-gray-600"}),e.jsx("h5",{className:"text-sm font-semibold text-gray-700",children:"Link to Product"}),d&&e.jsx("span",{className:"text-xs bg-blue-100 text-blue-700 px-2 py-0.5 rounded-full",children:"Linked"})]}),e.jsx("button",{type:"button",onClick:()=>E(!A),className:"flex items-center gap-1 px-3 py-1.5 text-sm font-medium text-orange-600 hover:text-orange-700 hover:bg-orange-50 rounded-xl transition-colors",disabled:a,children:A?e.jsxs(e.Fragment,{children:[e.jsx(Y,{className:"w-4 h-4"}),"Cancel"]}):e.jsxs(e.Fragment,{children:[e.jsx(ae,{className:"w-4 h-4"}),"Search Products"]})})]}),A&&e.jsxs("div",{className:"mb-3",children:[e.jsx("input",{type:"text",value:p,onChange:s=>{D(s.target.value),Q(s.target.value)},placeholder:"Search by product name or SKU...",className:"w-full px-4 py-3 border-2 border-gray-300 rounded-xl focus:outline-none focus:border-orange-500 focus:ring-2 focus:ring-orange-200 transition-colors text-gray-900",disabled:a}),v.length>0&&e.jsx("div",{className:"mt-2 max-h-48 overflow-y-auto border-2 border-gray-200 rounded-xl",children:v.map(s=>e.jsxs("button",{type:"button",onClick:()=>Be(s),className:"w-full text-left px-4 py-3 hover:bg-orange-50 border-b border-gray-100 last:border-b-0 transition-colors",children:[e.jsx("div",{className:"font-medium text-gray-900",children:s.name}),e.jsxs("div",{className:"text-sm text-gray-600",children:["SKU: ",s.sku]})]},s.id))})]}),d&&e.jsx("div",{className:"p-3 bg-blue-50 rounded-xl border border-blue-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ms,{className:"w-4 h-4 text-blue-600"}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Linked to:"}),e.jsx("span",{className:"text-sm font-semibold text-blue-600",children:d.name})]}),e.jsx("button",{type:"button",onClick:qe,className:"text-xs text-red-600 hover:text-red-800 hover:underline font-medium",disabled:a,children:"Unlink"})]})}),d&&e.jsxs("div",{className:"mt-4",children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Fe,{className:"w-4 h-4 text-gray-600"}),e.jsx("h5",{className:"text-sm font-semibold text-gray-700",children:"Select Variant"}),r&&e.jsx("span",{className:"text-xs bg-green-100 text-green-700 px-2 py-0.5 rounded-full",children:"Selected"})]})}),f.length===0?e.jsxs("div",{className:"text-center py-6 bg-gray-50 rounded-xl border border-dashed border-gray-300",children:[e.jsx(Fe,{className:"w-8 h-8 text-gray-400 mx-auto mb-2"}),e.jsx("p",{className:"text-sm text-gray-600",children:"No variants available for this product"})]}):e.jsx("div",{className:"space-y-2",children:f.map((s,o)=>{const h=(r==null?void 0:r.id)===s.id,I=F===o;return e.jsxs("div",{className:`p-3 rounded-xl border-2 transition-all ${h?"bg-green-50 border-green-200":"bg-white border-gray-200 hover:border-orange-300"}`,children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h6",{className:"text-sm font-semibold text-gray-900",children:s.variant_name||`Variant ${o+1}`}),h&&e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-0.5 rounded-full text-xs font-bold bg-green-500 text-white",children:[e.jsx("svg",{className:"w-3 h-3",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})}),"Selected"]})]}),s.sku&&e.jsxs("p",{className:"text-xs text-gray-600",children:["SKU: ",s.sku]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:()=>{S(I?null:o)},className:"p-1.5 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx(Ie,{className:`w-4 h-4 text-gray-600 transition-transform ${I?"rotate-180":""}`})}),e.jsx("button",{type:"button",onClick:()=>{h?(x(null),m($=>({...$,variant_id:void 0}))):Ue(s)},className:`px-3 py-1.5 rounded-lg text-xs font-medium transition-all ${h?"bg-red-100 text-red-700 hover:bg-red-200":"bg-orange-100 text-orange-700 hover:bg-orange-200"}`,children:h?"Deselect":"Select"})]})]}),I&&e.jsxs("div",{className:"mt-3 pt-3 border-t border-gray-200 grid grid-cols-2 gap-2",children:[e.jsxs("div",{className:"bg-white rounded-lg p-2 border border-gray-200",children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 mb-1",children:"Variant Name"}),e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:s.variant_name||"N/A"})]}),e.jsxs("div",{className:"bg-white rounded-lg p-2 border border-gray-200",children:[e.jsx("p",{className:"text-xs font-medium text-gray-500 mb-1",children:"SKU"}),e.jsx("p",{className:"text-sm font-semibold text-gray-900 font-mono",children:s.sku||"N/A"})]})]})]},s.id)})})]})]})]}),e.jsxs("div",{className:"mb-5",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Pricing Configuration"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Base Trade-In Price (TZS) ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:()=>ee("base_trade_in_price",-1e3),className:"w-10 h-10 flex items-center justify-center bg-white border-2 border-gray-300 hover:bg-orange-500 hover:text-white hover:border-orange-500 rounded-lg transition-all font-semibold shadow-sm",disabled:a,children:e.jsx(pe,{className:"w-4 h-4"})}),e.jsx("input",{type:"text",required:!0,value:fe(n.base_trade_in_price),onChange:s=>{const o=s.target.value.replace(/,/g,""),h=parseFloat(o)||0;m({...n,base_trade_in_price:h})},className:"flex-1 px-4 py-3 border-2 border-gray-300 rounded-xl focus:outline-none focus:border-orange-500 focus:ring-2 focus:ring-orange-200 bg-white text-xl font-bold text-center transition-colors",disabled:a}),e.jsx("button",{type:"button",onClick:()=>ee("base_trade_in_price",1e3),className:"w-10 h-10 flex items-center justify-center bg-white border-2 border-gray-300 hover:bg-orange-500 hover:text-white hover:border-orange-500 rounded-lg transition-all font-semibold shadow-sm",disabled:a,children:e.jsx(le,{className:"w-4 h-4"})})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-2 text-center",children:"Maximum value for excellent condition device"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Calculated Final Price"}),e.jsx("div",{className:"bg-gradient-to-br from-green-50 to-emerald-50 rounded-xl p-4 border-2 border-green-200",children:e.jsxs("div",{className:"text-center",children:[e.jsxs("div",{className:"text-3xl font-black text-green-600 mb-2",children:[fe(ze())," TZS"]}),e.jsx("div",{className:"text-xs text-gray-600 font-medium mb-3",children:"Base Ã— Storage Ã— Battery"}),e.jsxs("div",{className:"flex items-center justify-center gap-2 text-xs",children:[e.jsxs("span",{className:"bg-blue-50 text-blue-700 px-2 py-1 rounded-full",children:["Storage: ",(((ve=n.specifications)==null?void 0:ve.storage)||1).toFixed(2),"Ã—"]}),e.jsxs("span",{className:"bg-purple-50 text-purple-700 px-2 py-1 rounded-full",children:["Battery: ",(((Ne=n.specifications)==null?void 0:Ne.battery)||1).toFixed(2),"Ã—"]})]})]})})]})]})]}),e.jsxs("div",{className:"mb-5",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Condition Multipliers"}),e.jsx("p",{className:"text-xs text-gray-600 mb-4",children:"Set percentage multipliers for different device conditions"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsx(q,{label:"Excellent Condition",value:n.excellent_multiplier||1,onChange:s=>m(o=>({...o,excellent_multiplier:s})),onAdjust:s=>U("excellent_multiplier",s),color:"green",badge:"A+",description:"Perfect condition, like new",isLoading:a}),e.jsx(q,{label:"Good Condition",value:n.good_multiplier||.85,onChange:s=>m(o=>({...o,good_multiplier:s})),onAdjust:s=>U("good_multiplier",s),color:"blue",badge:"A",description:"Minor wear, fully functional",isLoading:a}),e.jsx(q,{label:"Fair Condition",value:n.fair_multiplier||.7,onChange:s=>m(o=>({...o,fair_multiplier:s})),onAdjust:s=>U("fair_multiplier",s),color:"yellow",badge:"B",description:"Noticeable wear, still usable",isLoading:a}),e.jsx(q,{label:"Poor Condition",value:n.poor_multiplier||.5,onChange:s=>m(o=>({...o,poor_multiplier:s})),onAdjust:s=>U("poor_multiplier",s),color:"red",badge:"C",description:"Heavy wear, may need repairs",isLoading:a})]})]}),e.jsxs("div",{className:"mb-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-700",children:"Condition Assessment"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("button",{type:"button",onClick:()=>W(!0),className:"px-4 py-2 bg-gradient-to-r from-purple-500 to-indigo-600 hover:from-purple-600 hover:to-indigo-700 text-white rounded-xl text-sm font-medium flex items-center gap-2 transition-all shadow-md hover:shadow-lg",disabled:a,children:[e.jsx(Z,{className:"w-4 h-4"}),"Specifications"]}),e.jsxs("button",{type:"button",onClick:()=>G(!0),className:"px-4 py-2 bg-orange-600 hover:bg-orange-700 text-white rounded-xl text-sm font-medium flex items-center gap-2 transition-all shadow-md hover:shadow-lg",disabled:a,children:[e.jsx(ie,{className:"w-4 h-4"}),P?"Edit Assessment":"Assess Condition"]})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-orange-50 to-amber-50 rounded-xl p-6 border border-orange-200",children:[e.jsxs("div",{className:"mb-4 grid grid-cols-2 md:grid-cols-4 gap-3",children:[e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-purple-200",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(de,{className:"w-3.5 h-3.5 text-purple-600"}),e.jsx("span",{className:"text-xs font-medium text-gray-600",children:"Storage"})]}),e.jsx("div",{className:"text-sm font-bold text-gray-900",children:n.storage_capacity||"Not Set"})]}),e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-purple-200",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(ce,{className:"w-3.5 h-3.5 text-purple-600"}),e.jsx("span",{className:"text-xs font-medium text-gray-600",children:"Battery"})]}),e.jsxs("div",{className:"text-sm font-bold text-gray-900",children:[n.battery_health,"%"]})]}),e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-purple-200",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(xe,{className:"w-3.5 h-3.5 text-purple-600"}),e.jsx("span",{className:"text-xs font-medium text-gray-600",children:"Accessories"})]}),e.jsx("div",{className:"text-xs font-medium text-gray-700",children:n.has_charger&&n.has_original_box?"Charger + Box":n.has_charger?"Charger":n.has_original_box?"Box":"None"})]}),e.jsxs("div",{className:"bg-white rounded-lg p-3 border border-amber-200",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(Ae,{className:"w-3.5 h-3.5 text-amber-600"}),e.jsx("span",{className:"text-xs font-medium text-gray-600",children:"Multipliers"})]}),e.jsxs("div",{className:"text-xs font-medium text-gray-700",children:[((((we=n.specifications)==null?void 0:we.storage)||1)*(((_e=n.specifications)==null?void 0:_e.battery)||1)).toFixed(2),"Ã—"]})]})]}),P?e.jsxs("div",{className:"bg-white rounded-lg p-4 border border-orange-200",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-3",children:[e.jsx("div",{className:`w-3 h-3 rounded-full ${P.calculatedCondition==="excellent"?"bg-green-500":P.calculatedCondition==="good"?"bg-blue-500":P.calculatedCondition==="fair"?"bg-yellow-500":"bg-red-500"}`}),e.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"Current Assessment:"}),e.jsx("span",{className:`text-lg font-bold ${P.calculatedCondition==="excellent"?"text-green-600":P.calculatedCondition==="good"?"text-blue-600":P.calculatedCondition==="fair"?"text-yellow-600":"text-red-600"}`,children:P.calculatedCondition.charAt(0).toUpperCase()+P.calculatedCondition.slice(1)})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{className:"bg-orange-50 rounded-lg p-3 border border-orange-200",children:[e.jsx("div",{className:"text-xs font-medium text-gray-700 mb-1",children:"Issues Found"}),e.jsx("div",{className:"text-xl font-bold text-orange-600",children:P.issues.filter(s=>s.checked).length})]}),e.jsxs("div",{className:"bg-blue-50 rounded-lg p-3 border border-blue-200",children:[e.jsx("div",{className:"text-xs font-medium text-gray-700 mb-1",children:"Images Uploaded"}),e.jsx("div",{className:"text-xl font-bold text-blue-600",children:P.images.length})]})]})]}):e.jsxs("div",{className:"bg-white rounded-lg p-6 border border-orange-200 text-center",children:[e.jsx("div",{className:"w-12 h-12 bg-orange-100 rounded-full flex items-center justify-center mx-auto mb-3",children:e.jsx(ie,{className:"w-6 h-6 text-orange-600"})}),e.jsx("h4",{className:"text-sm font-bold text-gray-900 mb-2",children:"No Assessment Yet"}),e.jsx("p",{className:"text-xs text-gray-600 mb-3",children:'Click "Assess Condition" to evaluate the device condition and determine appropriate pricing multipliers.'}),e.jsx("button",{type:"button",onClick:()=>G(!0),className:"px-4 py-2 bg-orange-600 hover:bg-orange-700 text-white rounded-xl text-sm font-medium transition-all shadow-md hover:shadow-lg",disabled:a,children:"Start Assessment"})]})]})]}),e.jsxs("div",{className:"mb-5",children:[e.jsxs("button",{type:"button",onClick:()=>_(!y),className:"w-full flex items-center justify-between p-4 bg-gray-50 hover:bg-gray-100 rounded-xl transition-colors border-2 border-gray-300",children:[e.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"Advanced Options"}),e.jsx(Ie,{className:`w-5 h-5 text-gray-600 transition-transform ${y?"rotate-180":""}`})]}),y&&e.jsxs("div",{className:"mt-4 p-4 bg-gray-50 rounded-xl border-2 border-gray-300 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Product ID"}),e.jsx("input",{type:"text",name:"product_id",value:n.product_id||"",onChange:V,placeholder:"Product ID",className:"w-full px-4 py-3 border-2 border-gray-300 rounded-xl focus:outline-none focus:border-orange-500 focus:ring-2 focus:ring-orange-200 transition-colors text-gray-900",disabled:a})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Variant ID"}),e.jsx("input",{type:"text",name:"variant_id",value:n.variant_id||"",onChange:V,placeholder:"Variant ID",className:"w-full px-4 py-3 border-2 border-gray-300 rounded-xl focus:outline-none focus:border-orange-500 focus:ring-2 focus:ring-orange-200 transition-colors text-gray-900",disabled:a})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes"}),e.jsx("textarea",{name:"notes",value:n.notes,onChange:V,rows:3,placeholder:"Additional notes or comments",className:"w-full px-4 py-3 border-2 border-gray-300 rounded-xl focus:outline-none focus:border-orange-500 focus:ring-2 focus:ring-orange-200 transition-colors text-gray-900 resize-none",disabled:a})]}),e.jsxs("div",{className:"flex items-center space-x-2",children:[e.jsx("input",{type:"checkbox",name:"is_active",checked:n.is_active,onChange:V,className:"w-4 h-4 text-orange-600 bg-gray-100 border-gray-300 rounded focus:ring-orange-500 focus:ring-2",disabled:a}),e.jsx("label",{className:"text-sm font-medium text-gray-700",children:"Active Trade-In Price"})]})]})]}),e.jsxs("div",{className:"pt-4 border-t border-gray-200 flex-shrink-0 bg-white",children:[ye>0&&e.jsxs("div",{className:"mb-3 p-3 bg-orange-50 border border-orange-200 rounded-lg flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5 text-orange-600 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})}),e.jsx("span",{className:"text-sm font-semibold text-orange-700",children:"Please complete all required fields before creating the trade-in price."})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{type:"button",onClick:g,disabled:a,className:"flex-1 px-4 py-3 border-2 border-gray-300 rounded-xl text-gray-700 font-medium hover:bg-gray-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),e.jsx("button",{type:"submit",form:"trade-in-price-form",disabled:a||ye>0,className:"flex-1 px-4 py-3 bg-gradient-to-r from-orange-500 to-orange-600 text-white rounded-xl font-semibold hover:from-orange-600 hover:to-orange-700 transition-all shadow-lg hover:shadow-xl disabled:opacity-50 disabled:cursor-not-allowed flex items-center justify-center gap-2",children:a?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"animate-spin rounded-full h-4 w-4 border-2 border-white border-t-transparent"}),l?"Updating...":"Adding..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ve,{className:"w-5 h-5"}),l?"Update Price":"Add Trade-In Price"]})})]})]})]})]}),X&&e.jsx(fs,{isOpen:X,onClose:()=>G(!1),onSave:s=>{i(s),G(!1)},initialIssues:P==null?void 0:P.issues}),oe&&me.createPortal(e.jsx("div",{className:"fixed bg-black/60 flex items-center justify-center p-4 z-[99999]",style:{top:0,left:0,right:0,bottom:0,overflow:"hidden",overscrollBehavior:"none"},role:"dialog","aria-modal":"true",onClick:()=>W(!1),children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-5xl w-full max-h-[90vh] flex flex-col overflow-hidden relative",style:{pointerEvents:"auto"},onClick:s=>s.stopPropagation(),children:[e.jsx("button",{type:"button",onClick:()=>W(!1),disabled:a,className:"absolute top-4 right-4 w-9 h-9 flex items-center justify-center bg-red-500 hover:bg-red-600 text-white rounded-full transition-colors shadow-lg z-50",children:e.jsx(Y,{className:"w-5 h-5"})}),e.jsx("div",{className:"p-6 bg-gradient-to-r from-purple-600 via-indigo-600 to-purple-600 border-b border-purple-300 flex-shrink-0",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-14 h-14 bg-white/20 backdrop-blur-sm rounded-2xl flex items-center justify-center shadow-lg",children:e.jsx(Z,{className:"w-7 h-7 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-white mb-1",children:"Device Specifications"}),e.jsx("p",{className:"text-sm text-purple-100",children:"Configure device details and pricing multipliers"})]})]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6",children:[e.jsxs("div",{className:"mb-8",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-purple-500 to-indigo-600 rounded-xl flex items-center justify-center shadow-lg",children:e.jsx(xe,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xl font-bold text-gray-900",children:"Device Details"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Enter device specifications and accessories"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-indigo-50 rounded-xl p-5 border-2 border-purple-200 shadow-sm",children:[e.jsxs("label",{className:"block text-sm font-bold text-gray-700 mb-3 flex items-center gap-2",children:[e.jsx(de,{className:"w-4 h-4 text-purple-600"}),"Storage Capacity"]}),e.jsx("input",{type:"text",name:"storage_capacity",value:n.storage_capacity,onChange:V,className:"w-full px-4 py-3 border-2 border-purple-200 rounded-lg focus:outline-none focus:border-purple-500 focus:ring-2 focus:ring-purple-200 text-gray-900 bg-white font-medium",placeholder:"e.g., 256GB",disabled:a})]}),e.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-indigo-50 rounded-xl p-5 border-2 border-purple-200 shadow-sm",children:[e.jsxs("label",{className:"block text-sm font-bold text-gray-700 mb-3 flex items-center gap-2",children:[e.jsx(ce,{className:"w-4 h-4 text-purple-600"}),"Battery Health (%)"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{type:"button",onClick:()=>ee("battery_health",-5,0,100),className:"w-10 h-10 flex items-center justify-center bg-white border-2 border-purple-200 hover:bg-purple-500 hover:text-white hover:border-purple-500 rounded-lg transition-all font-bold shadow-sm",disabled:a,children:e.jsx(pe,{className:"w-4 h-4"})}),e.jsx("input",{type:"number",name:"battery_health",min:"0",max:"100",value:n.battery_health,onChange:V,className:"flex-1 px-4 py-3 border-2 border-purple-200 rounded-lg focus:outline-none focus:border-purple-500 focus:ring-2 focus:ring-purple-200 text-center text-lg font-bold bg-white",disabled:a}),e.jsx("button",{type:"button",onClick:()=>ee("battery_health",5,0,100),className:"w-10 h-10 flex items-center justify-center bg-white border-2 border-purple-200 hover:bg-purple-500 hover:text-white hover:border-purple-500 rounded-lg transition-all font-bold shadow-sm",disabled:a,children:e.jsx(le,{className:"w-4 h-4"})})]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-purple-50 to-indigo-50 rounded-xl p-5 border-2 border-purple-200 shadow-sm",children:[e.jsxs("label",{className:"block text-sm font-bold text-gray-700 mb-3 flex items-center gap-2",children:[e.jsx(xe,{className:"w-4 h-4 text-purple-600"}),"Accessories"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("label",{className:"flex items-center gap-3 p-3 bg-white rounded-lg border-2 border-purple-100 hover:border-purple-300 transition-colors cursor-pointer",children:[e.jsx("input",{type:"checkbox",name:"has_charger",checked:n.has_charger,onChange:V,className:"w-5 h-5 text-purple-600 rounded focus:ring-purple-500",disabled:a}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Charger Included"})]}),e.jsxs("label",{className:"flex items-center gap-3 p-3 bg-white rounded-lg border-2 border-purple-100 hover:border-purple-300 transition-colors cursor-pointer",children:[e.jsx("input",{type:"checkbox",name:"has_original_box",checked:n.has_original_box,onChange:V,className:"w-5 h-5 text-purple-600 rounded focus:ring-purple-500",disabled:a}),e.jsx("span",{className:"text-sm font-medium text-gray-700",children:"Original Box"})]})]})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-6",children:[e.jsx("div",{className:"w-10 h-10 bg-gradient-to-br from-amber-500 to-orange-600 rounded-xl flex items-center justify-center shadow-lg",children:e.jsx(Ae,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xl font-bold text-gray-900",children:"Pricing Multipliers"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Fine-tune pricing based on device specifications"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[e.jsx(q,{label:"Storage Multiplier",value:((Ce=n.specifications)==null?void 0:Ce.storage)||1,onChange:s=>se("storage",s),onAdjust:s=>U("specifications.storage",s),color:"amber",description:"Adjust based on storage capacity",isLoading:a,icon:de}),e.jsx(q,{label:"Battery Multiplier",value:((ke=n.specifications)==null?void 0:ke.battery)||1,onChange:s=>se("battery",s),onAdjust:s=>U("specifications.battery",s),color:"amber",description:"Adjust based on battery health",isLoading:a,icon:ce}),e.jsx(q,{label:"Condition Multiplier",value:((Se=n.specifications)==null?void 0:Se.condition)||1,onChange:s=>se("condition",s),onAdjust:s=>U("specifications.condition",s),color:"amber",description:"Adjust based on overall condition",isLoading:a,icon:ie}),e.jsx(q,{label:"Screen Multiplier",value:((Te=n.specifications)==null?void 0:Te.screen)||1,onChange:s=>se("screen",s),onAdjust:s=>U("specifications.screen",s),color:"amber",description:"Adjust based on screen condition",isLoading:a,icon:Z})]})]})]}),e.jsx("div",{className:"p-6 border-t border-gray-200 bg-gray-50 flex-shrink-0",children:e.jsx("div",{className:"flex items-center justify-end gap-3",children:e.jsx("button",{type:"button",onClick:()=>W(!1),disabled:a,className:"px-6 py-3 border-2 border-gray-300 rounded-xl text-gray-700 font-medium hover:bg-gray-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Done"})})})]})}),document.body)]}),document.body)},ys=()=>{const[t,g]=c.useState([]),[l,b]=c.useState(!0),[a,j]=c.useState(""),[y,_]=c.useState(!0),[v,C]=c.useState(!1),[f,T]=c.useState(null),p=async()=>{b(!0);const r=await es({is_active:y});r.success&&r.data?g(r.data):w.error(r.error||"Failed to load prices"),b(!1)};c.useEffect(()=>{p()},[y]);const D=t.filter(r=>{if(!a)return!0;const x=a.toLowerCase();return r.device_name.toLowerCase().includes(x)||r.device_model.toLowerCase().includes(x)}),A=r=>{T(r),C(!0)},E=async r=>{if(!confirm("Are you sure you want to delete this trade-in price?"))return;const x=await ss(r);x.success?(w.success("Trade-in price deleted"),p()):w.error(x.error||"Failed to delete")},d=()=>{C(!1),T(null)},u=()=>{p(),d()};return e.jsxs("div",{children:[e.jsx("div",{className:"bg-white rounded-lg shadow-sm p-4 mb-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-center justify-between",children:[e.jsxs("div",{className:"relative flex-1 max-w-md",children:[e.jsx(ae,{className:"absolute left-3 top-1/2 -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search device name or model...",value:a,onChange:r=>j(r.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]}),e.jsxs("div",{className:"flex gap-3 items-center",children:[e.jsxs("label",{className:"flex items-center gap-2 cursor-pointer",children:[e.jsx("input",{type:"checkbox",checked:y,onChange:r=>_(r.target.checked),className:"w-4 h-4 text-blue-600 rounded focus:ring-2 focus:ring-blue-500"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Active Only"})]}),e.jsxs("button",{onClick:()=>C(!0),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors flex items-center gap-2 font-medium",children:[e.jsx(le,{className:"w-5 h-5"}),"Add Trade-In Price"]})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow-sm overflow-hidden",children:l?e.jsxs("div",{className:"p-12 text-center",children:[e.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-blue-600 border-t-transparent rounded-full mx-auto"}),e.jsx("p",{className:"text-gray-600 mt-4",children:"Loading prices..."})]}):D.length===0?e.jsxs("div",{className:"p-12 text-center",children:[e.jsx(J,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No Trade-In Prices"}),e.jsx("p",{className:"text-gray-600 mb-6",children:a?"No prices match your search":"Start by adding base trade-in prices for your devices"}),!a&&e.jsx("button",{onClick:()=>C(!0),className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Add First Price"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Device"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Base Price"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Condition Multipliers"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:D.map(r=>e.jsxs("tr",{className:"hover:bg-gray-50 transition-colors",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:r.device_name}),e.jsx("div",{className:"text-sm text-gray-500",children:r.device_model}),r.notes&&e.jsx("div",{className:"text-xs text-gray-400 mt-1",children:r.notes})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"text-lg font-semibold text-gray-900",children:M.money(r.base_trade_in_price)})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"space-y-1 text-sm",children:[e.jsxs("div",{className:"flex justify-between gap-4",children:[e.jsx("span",{className:"text-gray-600",children:"Excellent:"}),e.jsxs("span",{className:"font-medium text-green-600",children:[(r.excellent_multiplier*100).toFixed(0),"%"]})]}),e.jsxs("div",{className:"flex justify-between gap-4",children:[e.jsx("span",{className:"text-gray-600",children:"Good:"}),e.jsxs("span",{className:"font-medium text-blue-600",children:[(r.good_multiplier*100).toFixed(0),"%"]})]}),e.jsxs("div",{className:"flex justify-between gap-4",children:[e.jsx("span",{className:"text-gray-600",children:"Fair:"}),e.jsxs("span",{className:"font-medium text-yellow-600",children:[(r.fair_multiplier*100).toFixed(0),"%"]})]}),e.jsxs("div",{className:"flex justify-between gap-4",children:[e.jsx("span",{className:"text-gray-600",children:"Poor:"}),e.jsxs("span",{className:"font-medium text-red-600",children:[(r.poor_multiplier*100).toFixed(0),"%"]})]})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${r.is_active?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:r.is_active?"Active":"Inactive"})}),e.jsx("td",{className:"px-6 py-4 text-right",children:e.jsxs("div",{className:"flex items-center justify-end gap-2",children:[e.jsx("button",{onClick:()=>A(r),className:"p-2 text-blue-600 hover:bg-blue-50 rounded-lg transition-colors",title:"Edit",children:e.jsx(us,{className:"w-4 h-4"})}),e.jsx("button",{onClick:()=>E(r.id),className:"p-2 text-red-600 hover:bg-red-50 rounded-lg transition-colors",title:"Delete",children:e.jsx(Le,{className:"w-4 h-4"})})]})})]},r.id))})]})})}),v&&e.jsx(js,{isOpen:v,price:f,onClose:d,onSave:u})]})},vs=({isOpen:t,onClose:g})=>{const[l,b]=c.useState(!0),[a,j]=c.useState(!1),[y,_]=c.useState(""),[v,C]=c.useState("");c.useEffect(()=>{t&&f()},[t]);const f=async()=>{b(!0);const p=await ts();p.success&&p.data?(_(p.data.contract_terms||""),C(p.data.ownership_declaration||"")):w.error(p.error||"Failed to load settings"),b(!1)},T=async()=>{if(!y.trim()){w.error("Contract terms cannot be empty");return}if(!v.trim()){w.error("Ownership declaration cannot be empty");return}j(!0);try{const[p,D]=await Promise.all([Pe("contract_terms",y,"Terms and conditions for trade-in contracts"),Pe("ownership_declaration",v,"Customer ownership declaration statement")]);p.success&&D.success?(w.success("Settings saved successfully!"),g()):w.error("Failed to save some settings")}catch{w.error("Failed to save settings")}finally{j(!1)}};return t?e.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center p-4 z-[99999]",role:"dialog","aria-modal":"true",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-4xl w-full max-h-[90vh] flex flex-col overflow-hidden relative",children:[e.jsx("button",{onClick:g,className:"absolute top-4 right-4 w-9 h-9 flex items-center justify-center bg-red-500 hover:bg-red-600 text-white rounded-full transition-colors shadow-lg z-50",children:e.jsx(Y,{className:"w-5 h-5"})}),e.jsx("div",{className:"p-8 bg-white border-b border-gray-200 flex-shrink-0",children:e.jsxs("div",{className:"grid grid-cols-[auto,1fr] gap-6 items-center",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-purple-500 to-purple-600 rounded-full flex items-center justify-center shadow-lg",children:e.jsx(Z,{className:"w-8 h-8 text-white"})}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Trade-In Settings"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Manage terms & conditions and ownership declarations"})]})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto px-6 py-6",children:l?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-purple-600 border-t-transparent rounded-full"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-gradient-to-br from-blue-50 to-blue-100 rounded-2xl p-6 border-2 border-blue-200 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(he,{className:"w-5 h-5 text-blue-600"}),e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Contract Terms & Conditions"})]}),e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-xl p-3 mb-4 flex items-start gap-2",children:[e.jsx(Me,{className:"w-5 h-5 text-yellow-600 mt-0.5 flex-shrink-0"}),e.jsx("p",{className:"text-sm text-yellow-700",children:"These terms will be displayed in all trade-in contracts. Make sure they comply with local laws."})]}),e.jsx("textarea",{value:y,onChange:p=>_(p.target.value),rows:12,className:"w-full px-4 py-3 border-2 border-gray-300 rounded-xl focus:ring-2 focus:ring-blue-500 focus:border-blue-500 bg-white text-sm font-mono",placeholder:"Enter contract terms and conditions..."}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:[y.length," characters"]})]}),e.jsxs("div",{className:"bg-gradient-to-br from-green-50 to-green-100 rounded-2xl p-6 border-2 border-green-200 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx(he,{className:"w-5 h-5 text-green-600"}),e.jsx("h3",{className:"text-lg font-bold text-gray-900",children:"Ownership Declaration"})]}),e.jsxs("div",{className:"bg-yellow-50 border border-yellow-200 rounded-xl p-3 mb-4 flex items-start gap-2",children:[e.jsx(Me,{className:"w-5 h-5 text-yellow-600 mt-0.5 flex-shrink-0"}),e.jsx("p",{className:"text-sm text-yellow-700",children:"This declaration will be shown to customers before they sign the contract."})]}),e.jsx("textarea",{value:v,onChange:p=>C(p.target.value),rows:8,className:"w-full px-4 py-3 border-2 border-gray-300 rounded-xl focus:ring-2 focus:ring-green-500 focus:border-green-500 bg-white text-sm",placeholder:"Enter ownership declaration text..."}),e.jsxs("p",{className:"text-xs text-gray-500 mt-2",children:[v.length," characters"]})]})]})}),e.jsx("div",{className:"p-6 pt-4 border-t border-gray-200 bg-white flex-shrink-0",children:e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{onClick:g,disabled:a,className:"px-6 py-3 bg-gray-200 text-gray-700 rounded-xl hover:bg-gray-300 transition-colors font-semibold disabled:opacity-50",children:"Cancel"}),e.jsx("button",{onClick:T,disabled:a||l||!y.trim()||!v.trim(),className:"px-6 py-3 bg-green-600 text-white rounded-xl hover:bg-green-700 transition-colors font-semibold disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 shadow-lg",children:a?e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Saving..."]}):e.jsxs(e.Fragment,{children:[e.jsx(Ve,{className:"w-5 h-5"}),"Save Settings"]})})]})})]})}):null},Ms=()=>{const[t,g]=c.useState("history"),[l,b]=c.useState(!1),a=[{id:"history",label:"History & Reports",icon:Ee,description:"View all trade-in transactions with filtering and analytics"},{id:"pricing",label:"Pricing Management",icon:ne,description:"Set and manage base trade-in prices for devices"}];return e.jsxs("div",{className:"container mx-auto p-6 max-w-7xl",children:[e.jsx("div",{className:"bg-white rounded-2xl shadow-2xl border border-gray-200 p-8 mb-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-16 h-16 bg-gradient-to-br from-blue-500 to-blue-600 rounded-full flex items-center justify-center shadow-lg flex-shrink-0",children:e.jsx(Ee,{className:"w-8 h-8 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-1",children:"Trade-In Management"}),e.jsx("p",{className:"text-sm text-gray-600",children:"Manage device trade-ins, pricing, and transaction history"})]})]}),e.jsxs("button",{onClick:()=>b(!0),className:"px-6 py-3 bg-gradient-to-r from-purple-500 to-purple-600 text-white rounded-xl hover:from-purple-600 hover:to-purple-700 transition-all font-semibold flex items-center gap-2 shadow-lg hover:shadow-xl",title:"Trade-In Settings",children:[e.jsx(Z,{className:"w-5 h-5"}),"Settings"]})]})}),e.jsx("div",{className:"mb-6",children:e.jsx(gs,{tabs:a.map(j=>({id:j.id,label:j.label,icon:e.jsx(j.icon,{className:"w-5 h-5"}),description:j.description})),activeTab:t,onTabChange:j=>g(j),variant:"cards",size:"md"})}),e.jsxs("div",{className:"tab-content",children:[t==="history"&&e.jsx(bs,{}),t==="pricing"&&e.jsx(ys,{})]}),e.jsx(vs,{isOpen:l,onClose:()=>b(!1)})]})};export{Ms as TradeInManagementPage,Ms as default};
