import{a as ge,s as ee,j as e,q as ue}from"./index-61458a34.js";import{r as d}from"./vendor-36d2c7c1.js";import{n as N,e as se,$ as y,f as Z,q as E,aT as be,x as fe,a5 as te,bj as ae,y as re,a3 as v,v as pe,R as z,P as B,r as V,cY as q,cN as je,l as Ne,c as ye,U as le,X as ve}from"./ui-28e30067.js";import"./supabase-cf010ec4.js";import"./routing-eb8c310c.js";const G=g=>{const u=g.length,C=/[^\x00-\x7F]/.test(g),x=C?70:160,I=Math.ceil(u/x);return{charCount:u,smsUnits:I,charsPerSMS:x,encoding:C?"Unicode":"GSM-7"}},o=g=>{const u=typeof g=="string"?parseFloat(g):g;return u%1===0?u.toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:0}):u.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})},Ue=()=>{const{startLoading:g,completeLoading:u,failLoading:C}=ge(),[x,I]=d.useState([]),[ne,O]=d.useState(!0),[L,ie]=d.useState(""),[U,de]=d.useState("all"),[r,F]=d.useState(null),[X,_]=d.useState(null),[f,A]=d.useState(()=>{const s=localStorage.getItem("sms_price_per_unit");return s?parseFloat(s):50}),[ce,$]=d.useState(!1),[oe,xe]=d.useState(null),[p,J]=d.useState(!1),[j,W]=d.useState(null),[P,w]=d.useState(null),M=d.useRef(!0),R=d.useRef(null);d.useEffect(()=>(M.current=!0,T(),()=>{M.current=!1}),[]),d.useEffect(()=>{const s=a=>{R.current&&!R.current.contains(a.target)&&w(null)};return P&&document.addEventListener("mousedown",s),()=>{document.removeEventListener("mousedown",s)}},[P]);const D=async s=>{if(s.id){W(s.id);try{const a=await ue.resendSMS(s.id);return a.success?(N.success("SMS resent successfully!"),await T(),{success:!0}):(N.error(`Failed to resend SMS: ${a.error||"Unknown error"}`),{success:!1,error:a.error})}catch(a){return console.error("Error retrying SMS:",a),N.error(`Error retrying SMS: ${a.message||"Unknown error"}`),{success:!1,error:a.message||"Unknown error"}}finally{W(null)}}},Y=async(s,a)=>{try{await navigator.clipboard.writeText(s),N.success(`${a} copied to clipboard!`)}catch(t){console.error("Failed to copy:",t),N.error("Failed to copy to clipboard")}},T=async()=>{var a;const s=g("Loading SMS logs...");try{O(!0),_(null),console.log("ðŸ“¡ Fetching SMS logs from all sources...");const{data:t,error:i}=await ee.from("sms_logs").select("*").order("created_at",{ascending:!1});console.log("ðŸ“¥ SMS logs from sms_logs table:",(t==null?void 0:t.length)||0);const{data:h,error:k}=await ee.from("customer_communications").select("*").eq("type","sms").order("created_at",{ascending:!1});if(console.log("ðŸ“¥ SMS logs from customer_communications table:",(h==null?void 0:h.length)||0),i&&k){console.warn("âŒ Both tables failed:",{smsLogsError:i,commError:k}),_("Unable to fetch SMS logs. Please contact your administrator."),N.error("Failed to fetch SMS logs");return}const b=[];if(t){const c=t.map(l=>({id:l.id,recipient_phone:l.recipient_phone,message:l.message,status:l.status,error_message:l.error_message,sent_at:l.sent_at,sent_by:l.sent_by,created_at:l.created_at,device_id:l.device_id,cost:l.cost}));b.push(...c)}if(h){const c=h.map(l=>({id:l.id,recipient_phone:l.phone_number||"N/A",message:l.message,status:l.status,error_message:void 0,sent_at:l.sent_at,sent_by:l.sent_by,created_at:l.created_at,device_id:void 0,cost:void 0}));b.push(...c)}b.sort((c,l)=>{const he=new Date(c.created_at).getTime();return new Date(l.created_at).getTime()-he}),console.log("âœ… Total SMS logs combined:",b.length);const n=b.filter(c=>c&&typeof c.id=="string"&&typeof c.recipient_phone=="string"&&typeof c.message=="string"&&typeof c.status=="string");console.log("ðŸ”§ Valid logs after filtering:",n.length),M.current&&(I(n),u(s))}catch(t){if(console.log("ðŸš¨ Exception caught in fetchSMSLogs:",t),!M.current)return;if(t!=null&&t.error&&(t==null?void 0:t.data)!==void 0){const i=t.error;console.log("ðŸ” Extracted error from response object:",i),i.code==="PGRST116"||(a=i.message)!=null&&a.includes("does not exist")?(console.warn("âš ï¸ SMS logs view not configured yet"),_("SMS logs database not configured. Please contact your administrator.")):(console.warn("âŒ SMS logs database error (from thrown response):",i),_(`Database error: ${i.message||"Unknown database error"}`))}else console.warn("â“ Unable to load SMS logs - unexpected error:",t),_("Unable to load SMS logs. Please try again later.");C(s,"Failed to load SMS logs")}finally{M.current&&O(!1)}},H=x.filter(s=>{if(!s||!s.recipient_phone||!s.message)return!1;const a=(s.recipient_phone||"").includes(L)||s.message.toLowerCase().includes(L.toLowerCase()),t=U==="all"||s.status===U;return a&&t}),K=s=>{switch(s){case"sent":return e.jsx(te,{className:"w-4 h-4"});case"delivered":return e.jsx(ae,{className:"w-4 h-4"});case"failed":return e.jsx(Z,{className:"w-4 h-4"});case"pending":return e.jsx(re,{className:"w-4 h-4"});default:return e.jsx(se,{className:"w-4 h-4"})}},Q=s=>{switch(s){case"sent":return"text-green-700 bg-green-100 border border-green-200";case"delivered":return"text-blue-700 bg-blue-100 border border-blue-200";case"failed":return"text-red-700 bg-red-100 border border-red-200";case"pending":return"text-orange-700 bg-orange-100 border border-orange-200";default:return"text-gray-700 bg-gray-100 border border-gray-200"}},S=s=>new Date(s).toLocaleString("en-TZ",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),m=(()=>{const s=x.length,a=x.filter(n=>n&&n.status==="sent").length,t=x.filter(n=>n&&n.status==="delivered").length,i=x.filter(n=>n&&n.status==="failed").length,h=x.filter(n=>n&&n.status==="pending").length;let k=0,b=0;return x.forEach(n=>{if(!n||!n.message)return;const c=G(n.message);b+=c.smsUnits,k+=c.smsUnits*f}),{total:s,sent:a,delivered:t,failed:i,pending:h,totalCost:k,totalSMSUnits:b}})(),me=s=>{A(s),localStorage.setItem("sms_price_per_unit",s.toString()),N.success(`Price per SMS updated to ${o(s)} TZS`),J(!0),setTimeout(()=>J(!1),600)};return ne?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-6",children:e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsx("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"w-12 h-12 border-4 border-blue-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"}),e.jsx("p",{className:"text-gray-600 font-semibold",children:"Loading SMS logs..."})]})})})})}):X?e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-6",children:e.jsx("div",{className:"max-w-7xl mx-auto",children:e.jsx("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(se,{className:"w-8 h-8 text-red-600"})}),e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Error Loading SMS Logs"}),e.jsx("p",{className:"text-gray-600 mb-6",children:X}),e.jsx("button",{onClick:T,className:"px-6 py-3 bg-blue-600 text-white rounded-xl hover:bg-blue-700 transition-all font-semibold shadow-lg hover:shadow-xl",children:"Try Again"})]})})})}):e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-6",children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsx("div",{className:"mb-6 bg-white rounded-2xl shadow-xl p-8 border-b border-gray-200",children:e.jsxs("div",{className:"grid grid-cols-[auto,1fr] gap-6 items-center",children:[e.jsx("div",{className:"w-16 h-16 bg-blue-600 rounded-full flex items-center justify-center shadow-lg",children:e.jsx(y,{className:"w-8 h-8 text-white"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900 mb-3",children:"SMS Logs"}),e.jsx("p",{className:"text-gray-600 mb-3",children:"View and monitor all SMS activity"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsx(y,{className:"w-4 h-4 text-blue-600"}),e.jsxs("span",{className:"text-sm font-bold text-blue-700",children:[m.total," Total"]})]}),m.failed>0&&e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-red-50 border border-red-200 rounded-lg animate-pulse",children:[e.jsx(Z,{className:"w-4 h-4 text-red-600"}),e.jsxs("span",{className:"text-sm font-bold text-red-700",children:[m.failed," Failed"]})]})]})]})]})}),e.jsx("div",{className:"bg-white rounded-2xl shadow-xl p-6 mb-6 border border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(E,{className:"w-6 h-6 text-orange-600"}),e.jsx("div",{className:"text-sm font-medium text-gray-700",children:"Price per SMS Unit:"}),ce?e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("input",{type:"text",value:o(f),onChange:s=>{const a=s.target.value.replace(/,/g,""),t=parseFloat(a)||0;A(t)},className:"w-32 px-3 py-2 border-2 border-gray-300 rounded-xl focus:outline-none focus:border-orange-500 focus:ring-2 focus:ring-orange-200 font-bold text-lg",autoFocus:!0}),e.jsx("span",{className:"text-sm text-gray-600 font-semibold",children:"TZS"}),e.jsx("button",{onClick:()=>{me(f),$(!1)},className:"px-4 py-2 bg-green-600 text-white rounded-xl hover:bg-green-700 text-sm font-semibold shadow-lg transition-colors",children:"Save"}),e.jsx("button",{onClick:()=>{A(parseFloat(localStorage.getItem("sms_price_per_unit")||"50")),$(!1)},className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-xl hover:bg-gray-400 text-sm font-semibold transition-colors",children:"Cancel"})]}):e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("span",{className:"text-xl font-bold text-orange-600",children:[o(f)," TZS"]}),e.jsxs("button",{onClick:()=>$(!0),className:"flex items-center gap-1 px-3 py-1 text-orange-600 hover:text-orange-800 text-sm font-semibold hover:bg-orange-50 rounded-lg transition-colors",children:[e.jsx(be,{className:"w-4 h-4"}),"Edit"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2 text-sm text-gray-600 bg-blue-50 px-4 py-2 rounded-lg border border-blue-200",children:[e.jsx(fe,{className:"w-4 h-4 text-blue-600"}),e.jsx("span",{children:"This price is used to calculate the cost for each SMS based on message length"})]})]})}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 lg:grid-cols-7 gap-4 mb-6",children:[e.jsx("div",{className:`bg-white rounded-2xl shadow-lg p-5 border-2 border-gray-200 transition-all duration-300 ${p?"scale-105 shadow-xl":""}`,children:e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"w-10 h-10 bg-gray-500 rounded-lg flex items-center justify-center",children:e.jsx(y,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-2xl font-bold text-gray-900",children:o(m.total)}),e.jsx("div",{className:"text-xs font-medium text-gray-600",children:"Total SMS"})]})]})}),e.jsx("div",{className:`bg-white rounded-2xl shadow-lg p-5 border-2 border-green-200 transition-all duration-300 ${p?"scale-105 shadow-xl":""}`,children:e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"w-10 h-10 bg-green-500 rounded-lg flex items-center justify-center",children:e.jsx(te,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:o(m.sent)}),e.jsx("div",{className:"text-xs font-medium text-gray-600",children:"Sent"})]})]})}),e.jsx("div",{className:`bg-white rounded-2xl shadow-lg p-5 border-2 border-blue-200 transition-all duration-300 ${p?"scale-105 shadow-xl":""}`,children:e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-500 rounded-lg flex items-center justify-center",children:e.jsx(ae,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:o(m.delivered)}),e.jsx("div",{className:"text-xs font-medium text-gray-600",children:"Delivered"})]})]})}),e.jsx("div",{className:`bg-white rounded-2xl shadow-lg p-5 border-2 border-red-200 transition-all duration-300 ${p?"scale-105 shadow-xl":""}`,children:e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"w-10 h-10 bg-red-500 rounded-lg flex items-center justify-center",children:e.jsx(Z,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-2xl font-bold text-red-600",children:o(m.failed)}),e.jsx("div",{className:"text-xs font-medium text-gray-600",children:"Failed"})]})]})}),e.jsx("div",{className:`bg-white rounded-2xl shadow-lg p-5 border-2 border-orange-200 transition-all duration-300 ${p?"scale-105 shadow-xl":""}`,children:e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"w-10 h-10 bg-orange-500 rounded-lg flex items-center justify-center",children:e.jsx(re,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-2xl font-bold text-orange-600",children:o(m.pending)}),e.jsx("div",{className:"text-xs font-medium text-gray-600",children:"Pending"})]})]})}),e.jsx("div",{className:`bg-white rounded-2xl shadow-lg p-5 border-2 border-indigo-200 transition-all duration-300 ${p?"scale-105 shadow-xl":""}`,children:e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"w-10 h-10 bg-indigo-500 rounded-lg flex items-center justify-center",children:e.jsx(v,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-2xl font-bold text-indigo-600",children:o(m.totalSMSUnits)}),e.jsx("div",{className:"text-xs font-medium text-gray-600",children:"SMS Units"})]})]})}),e.jsx("div",{className:`bg-white rounded-2xl shadow-lg p-5 border-2 border-purple-200 transition-all duration-300 ${p?"scale-105 shadow-xl":""}`,children:e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:"w-10 h-10 bg-purple-500 rounded-lg flex items-center justify-center",children:e.jsx(E,{className:"w-5 h-5 text-white"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:o(m.totalCost)}),e.jsx("div",{className:"text-xs font-medium text-gray-600",children:"Total Cost"})]})]})})]}),e.jsx("div",{className:"bg-white rounded-2xl shadow-xl p-6 mb-6 border border-gray-200",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(pe,{className:"absolute left-4 top-1/2 transform -translate-y-1/2 w-5 h-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Search by phone number or message...",value:L,onChange:s=>ie(s.target.value),className:"w-full pl-12 pr-4 py-3 border-2 border-gray-300 rounded-xl focus:outline-none focus:border-blue-500 focus:ring-2 focus:ring-blue-200 font-medium"})]}),e.jsx("div",{children:e.jsxs("select",{value:U,onChange:s=>de(s.target.value),className:"px-4 py-3 border-2 border-gray-300 rounded-xl focus:outline-none focus:border-purple-500 focus:ring-2 focus:ring-purple-200 font-semibold cursor-pointer",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"sent",children:"Sent"}),e.jsx("option",{value:"delivered",children:"Delivered"}),e.jsx("option",{value:"failed",children:"Failed"}),e.jsx("option",{value:"pending",children:"Pending"})]})}),e.jsxs("button",{onClick:T,className:"flex items-center justify-center gap-2 px-6 py-3 bg-blue-600 text-white rounded-xl hover:bg-blue-700 transition-all font-semibold shadow-lg hover:shadow-xl",children:[e.jsx(z,{className:"w-5 h-5"}),"Refresh"]})]})}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl overflow-hidden border border-gray-200",children:[e.jsxs("div",{className:"p-6 border-b border-gray-200 bg-gray-50",children:[e.jsx("h2",{className:"text-lg font-bold text-gray-900",children:"SMS Activity Logs"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Click on any log to view detailed information"})]}),e.jsx("div",{className:"divide-y divide-gray-100",children:H.length===0?e.jsxs("div",{className:"text-center py-12 px-6",children:[e.jsx(y,{className:"w-16 h-16 text-gray-400 mx-auto mb-4"}),e.jsx("div",{className:"text-gray-500 text-lg font-semibold mb-2",children:"No SMS logs found"}),e.jsx("div",{className:"text-gray-400 text-sm",children:L||U!=="all"?"Try adjusting your search filters":"SMS logs will appear here when you send messages"})]}):H.map(s=>{if(!s||!s.id)return null;const a=G(s.message||""),t=a.smsUnits*f,i=oe===s.id;return e.jsxs("div",{className:`border-2 rounded-2xl bg-white shadow-sm transition-all duration-300 m-4 ${i?"border-blue-500 shadow-xl":s.status==="failed"?"border-red-200 hover:border-red-300 hover:shadow-md":s.status==="sent"||s.status==="delivered"?"border-green-200 hover:border-green-300 hover:shadow-md":"border-gray-200 hover:border-gray-300 hover:shadow-md"}`,children:[e.jsxs("div",{className:"flex items-start justify-between p-6 cursor-pointer",onClick:()=>xe(i?null:s.id),children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("div",{className:`w-6 h-6 rounded-lg flex items-center justify-center transition-colors ${i?"bg-blue-500":"bg-gray-200"}`,children:e.jsx("svg",{className:`w-4 h-4 text-white transition-transform duration-200 ${i?"rotate-180":""}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 9l-7 7-7-7"})})}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs("span",{className:`inline-flex items-center gap-1.5 px-3 py-1 rounded-full text-xs font-bold ${Q(s.status||"unknown")}`,children:[K(s.status||"unknown"),e.jsx("span",{className:"capitalize",children:s.status||"unknown"})]})})]}),e.jsxs("div",{className:"flex items-center gap-4 mt-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(B,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-sm font-semibold text-gray-900",children:s.recipient_phone||"N/A"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(V,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-xs text-gray-600",children:s.sent_at?S(s.sent_at):s.created_at?S(s.created_at):"N/A"})]})]}),e.jsx("p",{className:"text-sm text-gray-600 mt-2 line-clamp-2",children:s.message||"N/A"})]}),e.jsxs("div",{className:"flex flex-col items-end gap-2 ml-4",children:[e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-lg font-bold text-purple-600",children:[o(t)," TZS"]}),e.jsxs("div",{className:"text-xs text-gray-500",children:[a.smsUnits," unit",a.smsUnits>1?"s":""]})]}),e.jsxs("div",{className:"flex items-center gap-2 mt-2",onClick:h=>h.stopPropagation(),children:[(s.status==="failed"||s.status==="pending")&&e.jsx("button",{onClick:()=>D(s),disabled:j===s.id,className:"flex items-center gap-1.5 px-3 py-1.5 bg-orange-500 hover:bg-orange-600 disabled:bg-orange-300 text-white rounded-lg text-xs font-semibold transition-all shadow-sm hover:shadow-md disabled:cursor-not-allowed",title:"Retry sending SMS",children:j===s.id?e.jsxs(e.Fragment,{children:[e.jsx(z,{className:"w-3.5 h-3.5 animate-spin"}),e.jsx("span",{children:"Retrying..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(q,{className:"w-3.5 h-3.5"}),e.jsx("span",{children:"Retry"})]})}),e.jsxs("div",{className:"relative",ref:R,children:[e.jsx("button",{onClick:()=>w(P===s.id?null:s.id),className:"flex items-center justify-center w-8 h-8 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-lg transition-all shadow-sm hover:shadow-md",title:"More actions",children:e.jsx(je,{className:"w-4 h-4"})}),P===s.id&&e.jsxs("div",{className:"absolute right-0 top-10 z-50 w-48 bg-white rounded-xl shadow-xl border border-gray-200 py-2 overflow-hidden",children:[e.jsxs("button",{onClick:()=>{F(s),w(null)},className:"w-full flex items-center gap-3 px-4 py-2.5 text-sm text-gray-700 hover:bg-blue-50 transition-colors",children:[e.jsx(Ne,{className:"w-4 h-4 text-blue-600"}),e.jsx("span",{className:"font-medium",children:"View Details"})]}),e.jsxs("button",{onClick:()=>{Y(s.message,"Message"),w(null)},className:"w-full flex items-center gap-3 px-4 py-2.5 text-sm text-gray-700 hover:bg-green-50 transition-colors",children:[e.jsx(ye,{className:"w-4 h-4 text-green-600"}),e.jsx("span",{className:"font-medium",children:"Copy Message"})]}),e.jsxs("button",{onClick:()=>{Y(s.recipient_phone,"Phone number"),w(null)},className:"w-full flex items-center gap-3 px-4 py-2.5 text-sm text-gray-700 hover:bg-purple-50 transition-colors",children:[e.jsx(B,{className:"w-4 h-4 text-purple-600"}),e.jsx("span",{className:"font-medium",children:"Copy Phone"})]}),(s.status==="failed"||s.status==="pending")&&e.jsxs("button",{onClick:()=>{D(s),w(null)},disabled:j===s.id,className:"w-full flex items-center gap-3 px-4 py-2.5 text-sm text-gray-700 hover:bg-orange-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:[e.jsx(q,{className:`w-4 h-4 text-orange-600 ${j===s.id?"animate-spin":""}`}),e.jsx("span",{className:"font-medium",children:j===s.id?"Retrying...":"Retry SMS"})]})]})]})]})]})]}),i&&e.jsxs("div",{className:"px-6 pb-6 border-t border-gray-100",children:[e.jsx("div",{className:"bg-white rounded-xl p-4 mb-4 border border-gray-200 shadow-sm",children:e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2.5",children:[e.jsx("div",{className:"w-9 h-9 rounded-lg bg-orange-500 flex items-center justify-center flex-shrink-0",children:e.jsx(v,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-500",children:"Characters"}),e.jsx("p",{className:"text-base font-bold text-orange-600",children:a.charCount})]})]}),e.jsxs("div",{className:"flex items-center gap-2.5",children:[e.jsx("div",{className:"w-9 h-9 rounded-lg bg-indigo-500 flex items-center justify-center flex-shrink-0",children:e.jsx(y,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-500",children:"SMS Units"}),e.jsx("p",{className:"text-base font-bold text-indigo-600",children:a.smsUnits})]})]}),e.jsxs("div",{className:"flex items-center gap-2.5",children:[e.jsx("div",{className:"w-9 h-9 rounded-lg bg-emerald-500 flex items-center justify-center flex-shrink-0",children:e.jsx(E,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-500",children:"Cost"}),e.jsxs("p",{className:"text-base font-bold text-emerald-600",children:[o(t)," TZS"]})]})]}),e.jsxs("div",{className:"flex items-center gap-2.5",children:[e.jsx("div",{className:"w-9 h-9 rounded-lg bg-blue-500 flex items-center justify-center flex-shrink-0",children:e.jsx(v,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-500",children:"Encoding"}),e.jsx("p",{className:"text-sm font-bold text-blue-600",children:a.encoding})]})]})]})}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2",children:"Full Message"}),e.jsx("div",{className:"bg-gray-50 rounded-xl p-4 text-sm text-gray-900 whitespace-pre-wrap border border-gray-200",children:s.message||"N/A"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[s.sent_by&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Sent By"}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(le,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-sm text-gray-900",children:s.sent_by})]})]}),s.device_id&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Device ID"}),e.jsx("span",{className:"text-sm text-gray-900",children:s.device_id})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Created At"}),e.jsx("span",{className:"text-sm text-gray-900",children:s.created_at?S(s.created_at):"N/A"})]}),s.sent_at&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Sent At"}),e.jsx("span",{className:"text-sm text-gray-900",children:S(s.sent_at)})]})]}),s.error_message&&e.jsxs("div",{className:"mt-4",children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2",children:"Error Message"}),e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4 text-sm text-red-800",children:s.error_message})]})]})]},s.id)})})]}),r&&(()=>{const s=G(r.message||""),a=s.smsUnits*f;return e.jsx("div",{className:"fixed inset-0 bg-black/60 flex items-center justify-center p-4 z-[99999]",role:"dialog","aria-modal":"true",children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-2xl w-full max-h-[90vh] flex flex-col overflow-hidden relative",children:[e.jsx("button",{onClick:()=>F(null),className:"absolute top-4 right-4 w-9 h-9 flex items-center justify-center bg-red-500 hover:bg-red-600 text-white rounded-full transition-colors shadow-lg z-50",children:e.jsx(ve,{className:"w-5 h-5"})}),e.jsx("div",{className:"p-8 bg-white border-b border-gray-200 flex-shrink-0",children:e.jsxs("div",{className:"grid grid-cols-[auto,1fr] gap-6 items-center",children:[e.jsx("div",{className:"w-16 h-16 bg-blue-600 rounded-full flex items-center justify-center shadow-lg",children:e.jsx(y,{className:"w-8 h-8 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-2",children:"SMS Details"}),e.jsxs("span",{className:`inline-flex items-center gap-1.5 px-3 py-1 rounded-full text-xs font-bold ${Q(r.status||"unknown")}`,children:[K(r.status||"unknown"),e.jsx("span",{className:"capitalize",children:r.status||"unknown"})]})]})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto p-6",children:e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2",children:"Phone Number"}),e.jsxs("div",{className:"flex items-center gap-2 px-4 py-3 bg-gray-50 rounded-xl border border-gray-200",children:[e.jsx(B,{className:"w-5 h-5 text-gray-500"}),e.jsx("span",{className:"text-sm font-semibold text-gray-900",children:r.recipient_phone||"N/A"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2",children:"Full Message"}),e.jsx("div",{className:"bg-gray-50 rounded-xl p-4 text-sm text-gray-900 whitespace-pre-wrap border border-gray-200",children:r.message||"N/A"})]}),e.jsxs("div",{className:"bg-white rounded-xl p-4 border border-gray-200 shadow-sm",children:[e.jsxs("h4",{className:"text-sm font-bold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(v,{className:"w-4 h-4 text-blue-600"}),"SMS Analytics"]}),e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2.5",children:[e.jsx("div",{className:"w-9 h-9 rounded-lg bg-orange-500 flex items-center justify-center flex-shrink-0",children:e.jsx(v,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-500",children:"Characters"}),e.jsx("p",{className:"text-base font-bold text-orange-600",children:s.charCount})]})]}),e.jsxs("div",{className:"flex items-center gap-2.5",children:[e.jsx("div",{className:"w-9 h-9 rounded-lg bg-indigo-500 flex items-center justify-center flex-shrink-0",children:e.jsx(y,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-500",children:"SMS Units"}),e.jsx("p",{className:"text-base font-bold text-indigo-600",children:s.smsUnits})]})]}),e.jsxs("div",{className:"flex items-center gap-2.5",children:[e.jsx("div",{className:"w-9 h-9 rounded-lg bg-blue-500 flex items-center justify-center flex-shrink-0",children:e.jsx(v,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-500",children:"Encoding"}),e.jsx("p",{className:"text-sm font-bold text-blue-600",children:s.encoding})]})]}),e.jsxs("div",{className:"flex items-center gap-2.5",children:[e.jsx("div",{className:"w-9 h-9 rounded-lg bg-purple-500 flex items-center justify-center flex-shrink-0",children:e.jsx(v,{className:"w-4 h-4 text-white"})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-xs font-medium text-gray-500",children:"Chars/SMS"}),e.jsx("p",{className:"text-sm font-bold text-purple-600",children:s.charsPerSMS})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl p-4 border border-gray-200 shadow-sm",children:[e.jsxs("h4",{className:"text-sm font-bold text-gray-900 mb-4 flex items-center gap-2",children:[e.jsx(E,{className:"w-4 h-4 text-emerald-600"}),"Cost Calculation"]}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center px-3 py-2 bg-gray-50 rounded-lg",children:[e.jsx("span",{className:"text-sm text-gray-600 font-medium",children:"Price per SMS Unit:"}),e.jsxs("span",{className:"text-sm font-bold text-gray-900",children:[o(f)," TZS"]})]}),e.jsxs("div",{className:"flex justify-between items-center px-3 py-2 bg-gray-50 rounded-lg",children:[e.jsx("span",{className:"text-sm text-gray-600 font-medium",children:"SMS Units Used:"}),e.jsx("span",{className:"text-sm font-bold text-gray-900",children:s.smsUnits})]}),e.jsxs("div",{className:"border-t-2 border-emerald-300 pt-3 flex justify-between items-center px-3 py-2 bg-emerald-50 rounded-lg",children:[e.jsx("span",{className:"text-base font-bold text-gray-900",children:"Total Cost:"}),e.jsxs("span",{className:"text-xl font-bold text-emerald-700",children:[o(a)," TZS"]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2",children:"Created At"}),e.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-gray-50 rounded-xl border border-gray-200",children:[e.jsx(V,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-sm text-gray-900",children:r.created_at?S(r.created_at):"N/A"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2",children:"Sent At"}),e.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-gray-50 rounded-xl border border-gray-200",children:[e.jsx(V,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-sm text-gray-900",children:r.sent_at?S(r.sent_at):"Not sent"})]})]})]}),(r.sent_by||r.device_id)&&e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[r.sent_by&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2",children:"Sent By"}),e.jsxs("div",{className:"flex items-center gap-2 px-3 py-2 bg-gray-50 rounded-xl border border-gray-200",children:[e.jsx(le,{className:"w-4 h-4 text-gray-500"}),e.jsx("span",{className:"text-sm text-gray-900",children:r.sent_by})]})]}),r.device_id&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2",children:"Device ID"}),e.jsx("div",{className:"px-3 py-2 bg-gray-50 rounded-xl border border-gray-200",children:e.jsx("span",{className:"text-sm text-gray-900",children:r.device_id})})]})]}),r.error_message&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-2",children:"Error Message"}),e.jsx("div",{className:"bg-red-50 border border-red-200 rounded-xl p-4 text-sm text-red-800",children:r.error_message})]})]})}),e.jsxs("div",{className:"p-6 pt-4 border-t border-gray-200 bg-white flex-shrink-0 flex gap-3",children:[(r.status==="failed"||r.status==="pending")&&e.jsx("button",{onClick:async()=>{if(r.id){const t=await D(r);t!=null&&t.success&&F(null)}},disabled:j===r.id,className:"flex-1 flex items-center justify-center gap-2 px-6 py-3 bg-orange-500 hover:bg-orange-600 disabled:bg-orange-300 text-white rounded-xl font-semibold transition-all shadow-lg hover:shadow-xl disabled:cursor-not-allowed",children:j===r.id?e.jsxs(e.Fragment,{children:[e.jsx(z,{className:"w-5 h-5 animate-spin"}),e.jsx("span",{children:"Retrying..."})]}):e.jsxs(e.Fragment,{children:[e.jsx(q,{className:"w-5 h-5"}),e.jsx("span",{children:"Retry SMS"})]})}),e.jsx("button",{onClick:()=>F(null),className:`px-6 py-3 bg-blue-600 text-white rounded-xl font-semibold hover:bg-blue-700 transition-all shadow-lg hover:shadow-xl ${r.status==="failed"||r.status==="pending"?"flex-1":"w-full"}`,children:"Close"})]})]})})})()]})})};export{Ue as default};
