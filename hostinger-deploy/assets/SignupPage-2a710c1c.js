import{j as e,s as f}from"./index-61458a34.js";import{r as o}from"./vendor-36d2c7c1.js";import{br as k,U as P,e as i,P as S,s as z,aj as j,l as b,d as M,z as c}from"./ui-28e30067.js";import{a as A}from"./routing-eb8c310c.js";import"./supabase-cf010ec4.js";const T=()=>{const d=A(),[r,v]=o.useState({name:"",phone:"",gender:"",password:"",confirmPassword:"",city:"",birthMonth:"",birthDay:"",referralSource:"",acceptTerms:!1}),[m,y]=o.useState(!1),[x,N]=o.useState(!1),[p,u]=o.useState(!1),[t,g]=o.useState({}),w=()=>{const s={};return r.name.trim()?r.name.trim().length<2&&(s.name="Name must be at least 2 characters"):s.name="Name is required",r.phone.trim()?/^[0-9]{10,15}$/.test(r.phone.replace(/[\s-]/g,""))||(s.phone="Please enter a valid phone number"):s.phone="Phone number is required",r.password&&(r.password.length<6&&(s.password="Password must be at least 6 characters"),r.password!==r.confirmPassword&&(s.confirmPassword="Passwords do not match")),r.acceptTerms?(g(s),Object.keys(s).length===0):(c.error("Please accept the terms and conditions"),!1)},a=(s,n)=>{v(l=>({...l,[s]:n})),t[s]&&g(l=>({...l,[s]:void 0}))},C=async s=>{if(s.preventDefault(),!!w())try{u(!0);const{data:n}=await f.from("customers").select("id").eq("phone",r.phone).single();if(n){c.error("Phone number already registered. Please login instead."),u(!1);return}const{data:l,error:h}=await f.from("customers").insert([{name:r.name.trim(),phone:r.phone.trim(),whatsapp:r.phone.trim(),gender:r.gender||null,city:r.city.trim()||null,birth_month:r.birthMonth||null,birth_day:r.birthDay||null,referral_source:r.referralSource.trim()||null,points:0,loyalty_level:"interested",total_spent:0,is_active:!0,joined_date:new Date().toISOString().split("T")[0]}]).select().single();if(h)throw console.error("Signup error:",h),new Error(h.message);if(!l)throw new Error("Failed to create account");localStorage.setItem("customer_id",l.id),c.success("Account created successfully! Welcome! ðŸŽ‰"),setTimeout(()=>{d("/customer-portal/dashboard")},1e3)}catch(n){console.error("Signup error:",n),c.error(n.message||"Failed to create account. Please try again.")}finally{u(!1)}};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-green-500 to-blue-600 flex flex-col",children:[e.jsxs("div",{className:"pt-8 pb-6 px-6 text-center",children:[e.jsx("div",{className:"w-20 h-20 bg-white rounded-full flex items-center justify-center mx-auto mb-4 shadow-lg",children:e.jsx(k,{size:40,className:"text-green-600"})}),e.jsx("h1",{className:"text-3xl font-bold text-white mb-2",children:"Create Account"}),e.jsx("p",{className:"text-green-100",children:"Join us and start shopping today!"})]}),e.jsxs("div",{className:"flex-1 bg-white rounded-t-3xl px-6 py-8 overflow-y-auto",children:[e.jsxs("form",{onSubmit:C,className:"space-y-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Full Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:e.jsx(P,{size:20,className:"text-gray-400"})}),e.jsx("input",{type:"text",value:r.name,onChange:s=>a("name",s.target.value),placeholder:"Enter your full name",className:`w-full pl-12 pr-4 py-3 border rounded-xl focus:outline-none focus:ring-2 focus:ring-green-500 ${t.name?"border-red-500":"border-gray-300"}`})]}),t.name&&e.jsxs("p",{className:"mt-1 text-sm text-red-500 flex items-center gap-1",children:[e.jsx(i,{size:14}),t.name]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Phone Number ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:e.jsx(S,{size:20,className:"text-gray-400"})}),e.jsx("input",{type:"tel",value:r.phone,onChange:s=>a("phone",s.target.value),placeholder:"0712345678",className:`w-full pl-12 pr-4 py-3 border rounded-xl focus:outline-none focus:ring-2 focus:ring-green-500 ${t.phone?"border-red-500":"border-gray-300"}`})]}),t.phone&&e.jsxs("p",{className:"mt-1 text-sm text-red-500 flex items-center gap-1",children:[e.jsx(i,{size:14}),t.phone]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Gender ",e.jsx("span",{className:"text-gray-400 text-xs",children:"(Optional)"})]}),e.jsxs("select",{value:r.gender,onChange:s=>a("gender",s.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-green-500",children:[e.jsx("option",{value:"",children:"Select gender"}),e.jsx("option",{value:"male",children:"Male"}),e.jsx("option",{value:"female",children:"Female"}),e.jsx("option",{value:"other",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["City ",e.jsx("span",{className:"text-gray-400 text-xs",children:"(Optional)"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:e.jsx(z,{size:20,className:"text-gray-400"})}),e.jsx("input",{type:"text",value:r.city,onChange:s=>a("city",s.target.value),placeholder:"Your city",className:"w-full pl-12 pr-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-green-500"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Birthday ",e.jsx("span",{className:"text-gray-400 text-xs",children:"(Optional - for birthday rewards)"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("select",{value:r.birthMonth,onChange:s=>a("birthMonth",s.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-green-500",children:[e.jsx("option",{value:"",children:"Month"}),e.jsx("option",{value:"January",children:"January"}),e.jsx("option",{value:"February",children:"February"}),e.jsx("option",{value:"March",children:"March"}),e.jsx("option",{value:"April",children:"April"}),e.jsx("option",{value:"May",children:"May"}),e.jsx("option",{value:"June",children:"June"}),e.jsx("option",{value:"July",children:"July"}),e.jsx("option",{value:"August",children:"August"}),e.jsx("option",{value:"September",children:"September"}),e.jsx("option",{value:"October",children:"October"}),e.jsx("option",{value:"November",children:"November"}),e.jsx("option",{value:"December",children:"December"})]}),e.jsxs("select",{value:r.birthDay,onChange:s=>a("birthDay",s.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-green-500",children:[e.jsx("option",{value:"",children:"Day"}),Array.from({length:31},(s,n)=>n+1).map(s=>e.jsx("option",{value:s,children:s},s))]})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["How did you hear about us? ",e.jsx("span",{className:"text-gray-400 text-xs",children:"(Optional)"})]}),e.jsxs("select",{value:r.referralSource,onChange:s=>a("referralSource",s.target.value),className:"w-full px-4 py-3 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-green-500",children:[e.jsx("option",{value:"",children:"Select source"}),e.jsx("option",{value:"friend",children:"Friend or Family"}),e.jsx("option",{value:"social_media",children:"Social Media"}),e.jsx("option",{value:"google",children:"Google Search"}),e.jsx("option",{value:"advertisement",children:"Advertisement"}),e.jsx("option",{value:"walk_in",children:"Walk-in"}),e.jsx("option",{value:"other",children:"Other"})]})]}),e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Password ",e.jsx("span",{className:"text-gray-400 text-xs",children:"(Optional)"})]}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:e.jsx("svg",{className:"w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),e.jsx("input",{type:m?"text":"password",value:r.password,onChange:s=>a("password",s.target.value),placeholder:"Create a password (optional)",className:`w-full pl-12 pr-12 py-3 border rounded-xl focus:outline-none focus:ring-2 focus:ring-green-500 ${t.password?"border-red-500":"border-gray-300"}`}),e.jsx("button",{type:"button",onClick:()=>y(!m),className:"absolute inset-y-0 right-0 pr-4 flex items-center",children:m?e.jsx(j,{size:20,className:"text-gray-400"}):e.jsx(b,{size:20,className:"text-gray-400"})})]}),t.password&&e.jsxs("p",{className:"mt-1 text-sm text-red-500 flex items-center gap-1",children:[e.jsx(i,{size:14}),t.password]})]}),r.password&&e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirm Password"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-y-0 left-0 pl-4 flex items-center pointer-events-none",children:e.jsx("svg",{className:"w-5 h-5 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})})}),e.jsx("input",{type:x?"text":"password",value:r.confirmPassword,onChange:s=>a("confirmPassword",s.target.value),placeholder:"Confirm your password",className:`w-full pl-12 pr-12 py-3 border rounded-xl focus:outline-none focus:ring-2 focus:ring-green-500 ${t.confirmPassword?"border-red-500":"border-gray-300"}`}),e.jsx("button",{type:"button",onClick:()=>N(!x),className:"absolute inset-y-0 right-0 pr-4 flex items-center",children:x?e.jsx(j,{size:20,className:"text-gray-400"}):e.jsx(b,{size:20,className:"text-gray-400"})})]}),t.confirmPassword&&e.jsxs("p",{className:"mt-1 text-sm text-red-500 flex items-center gap-1",children:[e.jsx(i,{size:14}),t.confirmPassword]})]}),e.jsxs("div",{className:"flex items-start gap-3 py-2",children:[e.jsx("input",{type:"checkbox",id:"acceptTerms",checked:r.acceptTerms,onChange:s=>a("acceptTerms",s.target.checked),className:"mt-1 w-5 h-5 text-green-600 border-gray-300 rounded focus:ring-green-500"}),e.jsxs("label",{htmlFor:"acceptTerms",className:"text-sm text-gray-700",children:["I accept the"," ",e.jsx("button",{type:"button",className:"text-green-600 font-medium hover:underline",children:"Terms & Conditions"})," ","and"," ",e.jsx("button",{type:"button",className:"text-green-600 font-medium hover:underline",children:"Privacy Policy"})]})]}),e.jsxs("div",{className:"bg-green-50 border border-green-200 rounded-xl p-4 space-y-2",children:[e.jsxs("h3",{className:"font-semibold text-green-900 flex items-center gap-2",children:[e.jsx(M,{size:18,className:"text-green-600"}),"Benefits of Creating an Account"]}),e.jsxs("ul",{className:"space-y-1 text-sm text-green-800",children:[e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-green-600",children:"â€¢"}),e.jsx("span",{children:"Earn loyalty points on every purchase"})]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-green-600",children:"â€¢"}),e.jsx("span",{children:"Track your orders and delivery status"})]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-green-600",children:"â€¢"}),e.jsx("span",{children:"Get exclusive deals and early access"})]}),e.jsxs("li",{className:"flex items-center gap-2",children:[e.jsx("span",{className:"text-green-600",children:"â€¢"}),e.jsx("span",{children:"Faster checkout with saved information"})]})]})]}),e.jsx("button",{type:"submit",disabled:p,className:"w-full bg-green-600 text-white py-4 rounded-xl font-bold text-lg hover:bg-green-700 active:scale-95 transition-all disabled:opacity-50 disabled:cursor-not-allowed",children:p?e.jsxs("div",{className:"flex items-center justify-center gap-2",children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white"}),e.jsx("span",{children:"Creating Account..."})]}):"Create Account"}),e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute inset-0 flex items-center",children:e.jsx("div",{className:"w-full border-t border-gray-300"})}),e.jsx("div",{className:"relative flex justify-center text-sm",children:e.jsx("span",{className:"px-4 bg-white text-gray-500",children:"OR"})})]}),e.jsx("button",{type:"button",onClick:()=>d("/customer-portal/products"),className:"w-full border-2 border-gray-300 text-gray-700 py-3 rounded-xl font-medium hover:bg-gray-50 active:scale-95 transition-all",children:"Continue as Guest"})]}),e.jsx("div",{className:"mt-6 text-center",children:e.jsxs("p",{className:"text-gray-600",children:["Already have an account?"," ",e.jsx("button",{onClick:()=>d("/customer-portal/login"),className:"text-green-600 font-bold hover:underline",children:"Login"})]})}),e.jsx("div",{className:"mt-6 p-4 bg-blue-50 rounded-xl",children:e.jsxs("p",{className:"text-sm text-gray-600 text-center",children:["Need help? Contact us at"," ",e.jsx("a",{href:"tel:+255712345678",className:"text-blue-600 font-medium",children:"+255 712 345 678"})]})})]})]})};export{T as default};
