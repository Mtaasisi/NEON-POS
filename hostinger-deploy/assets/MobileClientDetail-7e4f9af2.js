import{_ as ot}from"./supabase-cf010ec4.js";import{u as xt,s as m,ab as pt,j as e,k as u,ae as mt,ad as ut}from"./index-61458a34.js";import{r as a}from"./vendor-36d2c7c1.js";import{z as x,h as ht,o as U,P as gt,ae as bt,d as ae,r as re,m as yt,q as ft,S as ze,br as le,y as jt,u as Nt,T as vt,b0 as wt,j as kt,p as St}from"./ui-28e30067.js";import{a as Ct}from"./appointments-0b344a33.js";import{f as _t}from"./returns-8e3dd741.js";import{d as Dt,a as Pt}from"./routing-eb8c310c.js";const Ot=()=>{const{clientId:r}=Dt(),J=Pt(),{currentUser:b}=xt(),[s,H]=a.useState(null),[Le,ne]=a.useState(!0),[_,Q]=a.useState("activity"),[zt,Me]=a.useState([]),[N,We]=a.useState([]),[Ie,Re]=a.useState([]),[v,Ee]=a.useState([]),[w,Te]=a.useState([]),[z,$e]=a.useState([]),[n,qe]=a.useState(null),[Lt,ie]=a.useState(!1),[W,ce]=a.useState([]),[G,de]=a.useState([]),[k,oe]=a.useState([]),[L,xe]=a.useState([]),[Mt,pe]=a.useState(!1),[M,me]=a.useState(null),[Wt,ue]=a.useState(!1),[Fe,I]=a.useState(!1),[S,R]=a.useState(""),[E,he]=a.useState(!1),[Oe,T]=a.useState(!1),[h,Y]=a.useState(""),[ge,be]=a.useState(""),[ye,fe]=a.useState(!1),[Be,$]=a.useState(!1),[Ve,je]=a.useState(!1),[Ne,ve]=a.useState(!1),[Ue,q]=a.useState(!1),[K,F]=a.useState(!1),[O,we]=a.useState(""),[B,ke]=a.useState(""),[V,Se]=a.useState(""),[Ce,_e]=a.useState(""),[De,Pe]=a.useState(!1),[d,f]=a.useState({});a.useEffect(()=>{r&&(X(),Je(),Z(),ee())},[r]);const X=async()=>{if(r){ne(!0);try{const{data:t,error:l}=await m.from("customers").select("*").eq("id",r).single();if(l)throw l;const i={...t,totalSpent:t.total_spent,createdAt:t.created_at,updatedAt:t.updated_at};H(i);const{data:g}=await m.from("lats_sales").select("*").eq("customer_id",r).order("created_at",{ascending:!1}).limit(10);g&&Me(g)}catch(t){console.error("Error loading client:",t),x.error("Failed to load client details")}finally{ne(!1)}}},Je=async()=>{if(r){ie(!0);try{const{data:t}=await m.from("devices").select("*").eq("customer_id",r).order("created_at",{ascending:!1});if(t){const p=t.map(o=>({...o,customerId:o.customer_id,createdAt:o.created_at}));We(p)}const{data:l}=await m.from("customer_payments").select("*").eq("customer_id",r).order("payment_date",{ascending:!1});if(l){const p=l.map(o=>({id:o.id,customerId:o.customer_id,deviceId:o.device_id,amount:o.amount,method:o.method,type:o.payment_type,status:o.status,date:o.payment_date,createdAt:o.created_at}));Re(p)}const{data:i}=await m.from("lats_sales").select("*").eq("customer_id",r).order("created_at",{ascending:!1});if(i&&(Ee(i),i.length>0)){const p=i.map(j=>j.id),{data:o}=await m.from("lats_sale_items").select("*").in("sale_id",p);o&&Te(o.map(j=>j))}try{const{data:p}=await m.from("devices").select("id").eq("customer_id",r),o=(p==null?void 0:p.map(C=>C.id))||[];let j=[];o.length>0&&(j=(await m.from("lats_spare_part_usage").select("*").in("device_id",o).order("created_at",{ascending:!1})).data||[]),j&&$e(j)}catch{console.log("Spare parts data not available")}const g=He(r,i||[],t||[],l||[]);qe(g)}catch(t){console.error("Error fetching enhanced customer data:",t)}finally{ie(!1)}}},Z=async()=>{if(r){pe(!0);try{try{const t=await Ct(r);ce(t||[])}catch(t){console.error("Error fetching appointments:",t),ce([])}try{const t=await _t(r);de(t||[])}catch(t){console.error("Error fetching returns:",t),de([])}try{const{data:t}=await m.from("customer_communications").select("*").eq("customer_id",r).order("sent_at",{ascending:!1}).limit(50);t&&oe(t)}catch(t){console.error("Error fetching communication history:",t),oe([])}try{const{data:t}=await m.from("customers").select("id, name, phone, created_at, total_spent").eq("referred_by",r).order("created_at",{ascending:!1});t&&xe(t)}catch(t){console.error("Error fetching referrals:",t),xe([])}}catch(t){console.error("Error loading additional customer data:",t)}finally{pe(!1)}}},ee=async()=>{if(r){ue(!0);try{const t=await pt(r);me(t)}catch(t){console.error("Error fetching customer status:",t),me(null)}finally{ue(!1)}}},He=(t,l,i,g)=>{const p=l.reduce((c,y)=>c+(parseFloat(y.total_amount)||0),0),j=i.filter(c=>c.customer_id===t).map(c=>c.id),C=g.filter(c=>c.deviceId&&j.includes(c.deviceId)),te=C.reduce((c,y)=>c+(y.amount||0),0),Ze=C.filter(c=>c.type==="deposit").reduce((c,y)=>c+(y.amount||0),0),et=C.filter(c=>c.type==="payment").reduce((c,y)=>c+(y.amount||0),0),tt=C.filter(c=>c.type==="refund").reduce((c,y)=>c+(y.amount||0),0),P=p+te,st=l.length>0?p/l.length:0,se=l.length>0?new Date(l[0].created_at):null,at=se?Math.floor((Date.now()-se.getTime())/(1e3*60*60*24)):null,rt=new Set(w.map(c=>c.product_id)).size,lt=w.reduce((c,y)=>c+(y.quantity||0),0),nt=(s==null?void 0:s.createdAt)||(s==null?void 0:s.created_at)||Date.now(),it=Math.floor((Date.now()-new Date(nt).getTime())/(1e3*60*60*24)),ct=Math.max(1,Math.floor(it/30)),dt=l.length/ct;let A="Regular Customer";return P>1e7?A="Diamond Customer":P>5e6?A="Platinum Customer":P>1e6?A="Gold Customer":P>5e5?A="VIP Customer":P>1e5&&(A="Top Customer"),{totalSpent:P,totalPosSpent:p,totalDeviceSpent:te,deviceBreakdown:{payments:et,deposits:Ze,refunds:tt,totalPayments:te},averageOrderValue:st,lastPurchaseDate:se,daysSinceLastPurchase:at,totalOrders:l.length,totalDevices:i.length,activeRepairs:i.filter(c=>["assigned","diagnosis-started","awaiting-parts","in-repair","reassembled-testing"].includes(c.status)).length,completedRepairs:i.filter(c=>c.status==="done").length,uniqueProducts:rt,totalItems:lt,purchaseFrequency:Number(dt.toFixed(2)),customerRanking:A}},D=async t=>{if(r)try{await mt(r,t),await ee()}catch(l){console.error("Error tracking activity:",l)}},Qe=()=>{s!=null&&s.phone&&(window.location.href=`tel:${s.phone}`)},Ae=async()=>{if(!(!S.trim()||!s)){he(!0);try{const t=s.phone.replace(/\D/g,""),{smartNotificationService:l}=await ot(()=>import("./smartNotificationService-2a2d3be1.js"),["assets/smartNotificationService-2a2d3be1.js","assets/supabase-cf010ec4.js","assets/whatsappService-09f99080.js","assets/index-61458a34.js","assets/vendor-36d2c7c1.js","assets/routing-eb8c310c.js","assets/ui-28e30067.js","assets/index-e1f77ed5.css","assets/notificationSettingsService-1df2b297.js","assets/format-aff4c6a2.js","assets/formatPhoneForInvoice-e7084c6d.js"]),i=await l.sendNotification(t,S);if(i.success){const g=i.method==="whatsapp"?"whatsapp":"sms",p=i.method==="whatsapp"?"WhatsApp":"SMS";try{await m.from("customer_communications").insert({customer_id:r,type:g,message:S,status:"sent",phone_number:t,sent_by:b==null?void 0:b.id,sent_at:new Date().toISOString()})}catch(o){console.warn("Could not log message:",o)}x.success(`${p} sent successfully!`),R(""),I(!1),await Z(),await D("sms_sent")}else x.error(`SMS Failed: ${i.error||"Unknown error"}`)}catch(t){x.error((t==null?void 0:t.message)||"Failed to send SMS")}finally{he(!1)}}},Ge=async()=>{if(!(!h||!s)){fe(!0);try{const t=parseInt(h);if(isNaN(t)){x.error("Invalid points amount");return}const l=(s.points||0)+t,{error:i}=await m.from("customers").update({points:l}).eq("id",r);if(i)throw i;try{await m.from("loyalty_points_transactions").insert({customer_id:r,points:t,transaction_type:t>0?"earned":"redeemed",reason:ge||"Manual adjustment",created_by:b==null?void 0:b.id,created_at:new Date().toISOString()})}catch(g){console.warn("Could not log points transaction:",g)}x.success(`${t>0?"Added":"Deducted"} ${Math.abs(t)} points!`),H({...s,points:l}),Y(""),be(""),T(!1),await D("points_updated")}catch(t){x.error((t==null?void 0:t.message)||"Failed to update points")}finally{fe(!1)}}},Ye=async()=>{if(!(!r||!b)){ve(!0);try{const t=await ut(r,b.id);t.success?(je(!0),t.wasReactivated?x.success("Customer checked in and reactivated! Points awarded."):x.success("Check-in successful! Points awarded."),await ee(),await X(),s&&H({...s,isActive:!0,lastVisit:new Date().toISOString()})):x.error(t.message||"Check-in failed")}catch(t){x.error((t==null?void 0:t.message)||"Check-in failed")}finally{ve(!1)}}},Ke=async()=>{if(!O||!B||!V){x.error("Please fill in all required fields");return}Pe(!0);try{const{error:t}=await m.from("appointments").insert({customer_id:r,appointment_date:O,appointment_time:B,service_type:V,notes:Ce,status:"pending",created_by:b==null?void 0:b.id,created_at:new Date().toISOString()});if(t)throw t;x.success("Appointment created successfully!"),q(!1),we(""),ke(""),Se(""),_e(""),await Z(),await D("appointment_created")}catch(t){x.error((t==null?void 0:t.message)||"Failed to create appointment")}finally{Pe(!1)}},Xe=async()=>{if(!d.name||!d.phone){x.error("Name and phone are required");return}try{const{error:t}=await m.from("customers").update({name:d.name,phone:d.phone,email:d.email,whatsapp:d.whatsapp,address:d.address,city:d.city,country:d.country,notes:d.notes,updated_at:new Date().toISOString()}).eq("id",r);if(t)throw t;x.success("Customer updated successfully!"),F(!1),await X()}catch(t){x.error((t==null?void 0:t.message)||"Failed to update customer")}};return a.useEffect(()=>{K&&s&&f({name:s.name||"",phone:s.phone||"",email:s.email||"",whatsapp:s.whatsapp||"",address:s.address||"",city:s.city||"",country:s.country||"",notes:typeof s.notes=="string"?s.notes:""})},[K,s]),Le?e.jsx("div",{className:"flex flex-col h-full bg-white",children:e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-500 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-500",children:"Loading client..."})]})})}):s?e.jsxs("div",{className:"flex flex-col h-full bg-white",children:[e.jsx("div",{className:"bg-white border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between px-4 py-3",children:[e.jsxs("button",{onClick:()=>J("/mobile/clients"),className:"flex items-center gap-1 text-blue-500",children:[e.jsx(ht,{size:20}),e.jsx("span",{className:"text-[17px]",children:"Back"})]}),e.jsx("h1",{className:"text-[17px] font-semibold text-gray-900 absolute left-1/2 transform -translate-x-1/2",children:s.name}),e.jsx("button",{onClick:()=>J(`/mobile/clients/${r}/edit`),className:"text-blue-500 text-[17px]",children:"Edit"})]})}),e.jsx("div",{className:"bg-white px-2 py-4 border-b border-gray-200",children:e.jsxs("div",{className:"grid grid-cols-6 gap-2",children:[e.jsxs("button",{onClick:()=>{I(!0),D("sms_opened")},className:"flex flex-col items-center gap-1",children:[e.jsx(U,{size:24,className:"text-blue-500",strokeWidth:1.5}),e.jsx("span",{className:"text-[9px] text-gray-600",children:"SMS"})]}),e.jsxs("button",{onClick:Qe,className:"flex flex-col items-center gap-1",children:[e.jsx(gt,{size:24,className:"text-blue-500",strokeWidth:1.5}),e.jsx("span",{className:"text-[9px] text-gray-600",children:"call"})]}),e.jsxs("button",{onClick:()=>T(!0),className:"flex flex-col items-center gap-1",children:[e.jsx(bt,{size:24,className:"text-blue-500",strokeWidth:1.5}),e.jsx("span",{className:"text-[9px] text-gray-600",children:"points"})]}),e.jsxs("button",{onClick:()=>{$(!0),D("checkin_opened")},className:"flex flex-col items-center gap-1",children:[e.jsx(ae,{size:24,className:"text-blue-500",strokeWidth:1.5}),e.jsx("span",{className:"text-[9px] text-gray-600",children:"check-in"})]}),e.jsxs("button",{onClick:()=>{q(!0),D("appointment_opened")},className:"flex flex-col items-center gap-1",children:[e.jsx(re,{size:24,className:"text-blue-500",strokeWidth:1.5}),e.jsx("span",{className:"text-[9px] text-gray-600",children:"schedule"})]}),e.jsxs("button",{onClick:()=>F(!0),className:"flex flex-col items-center gap-1",children:[e.jsx(yt,{size:24,className:"text-blue-500",strokeWidth:1.5}),e.jsx("span",{className:"text-[9px] text-gray-600",children:"edit"})]})]})}),e.jsx("div",{className:"bg-white px-4 py-3",children:e.jsxs("div",{className:"bg-gray-100 rounded-lg p-0.5 flex",children:[e.jsx("button",{onClick:()=>Q("activity"),className:`flex-1 py-2 text-center text-[12px] font-medium rounded-md transition-all ${_==="activity"?"bg-white text-gray-900 font-semibold shadow-sm":"text-gray-600"}`,children:"Activity"}),e.jsx("button",{onClick:()=>Q("info"),className:`flex-1 py-2 text-center text-[12px] font-medium rounded-md transition-all ${_==="info"?"bg-white text-gray-900 font-semibold shadow-sm":"text-gray-600"}`,children:"Info"}),e.jsx("button",{onClick:()=>Q("journey"),className:`flex-1 py-2 text-center text-[12px] font-medium rounded-md transition-all ${_==="journey"?"bg-white text-gray-900 font-semibold shadow-sm":"text-gray-600"}`,children:"Journey"})]})}),e.jsxs("div",{className:"flex-1 overflow-y-auto pb-20",children:[_==="activity"&&e.jsxs("div",{className:"bg-white space-y-4 pb-6",children:[M&&e.jsx("div",{className:"px-4 py-3 bg-blue-50 border-b border-blue-100",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-[13px] font-semibold text-gray-900",children:M.statusReason||"Active Customer"}),M.daysSinceActivity!==null&&e.jsxs("div",{className:"text-[11px] text-gray-600 mt-0.5",children:["Last activity: ",M.daysSinceActivity===0?"Today":`${M.daysSinceActivity} days ago`]})]}),(n==null?void 0:n.customerRanking)&&e.jsx("div",{className:"bg-blue-500 text-white px-3 py-1 rounded-full text-[10px] font-semibold",children:n.customerRanking})]})}),e.jsxs("div",{className:"px-4 py-4 grid grid-cols-4 gap-2 border-b border-gray-200",children:[e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xl font-semibold text-gray-900",children:(n==null?void 0:n.totalOrders)||v.length}),e.jsx("div",{className:"text-[10px] text-gray-500 mt-1",children:"Orders"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xl font-semibold text-gray-900",children:(n==null?void 0:n.totalDevices)||N.length}),e.jsx("div",{className:"text-[10px] text-gray-500 mt-1",children:"Devices"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xl font-semibold text-gray-900",children:u((n==null?void 0:n.totalSpent)||0).replace("Tsh ","")}),e.jsx("div",{className:"text-[10px] text-gray-500 mt-1",children:"Spent"})]}),e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-xl font-semibold text-blue-500",children:s.points||s.loyaltyPoints||0}),e.jsx("div",{className:"text-[10px] text-gray-500 mt-1",children:"Points"})]})]}),n&&e.jsxs("div",{className:"px-4",children:[e.jsxs("h3",{className:"text-[13px] font-semibold text-gray-500 uppercase tracking-wide mb-3 flex items-center gap-2",children:[e.jsx(ft,{size:16,className:"text-green-500"}),"Financial Breakdown"]}),e.jsxs("div",{className:"bg-white rounded-2xl border border-gray-200 overflow-hidden shadow-sm",children:[e.jsxs("div",{className:"px-4 py-3 flex justify-between items-center border-b border-gray-100",children:[e.jsx("span",{className:"text-[15px] text-gray-600",children:"POS Sales"}),e.jsx("span",{className:"text-[16px] font-semibold text-gray-900",children:u(n.totalPosSpent||0)})]}),e.jsxs("div",{className:"px-4 py-3 flex justify-between items-center border-b border-gray-100",children:[e.jsx("span",{className:"text-[15px] text-gray-600",children:"Device Payments"}),e.jsx("span",{className:"text-[16px] font-semibold text-gray-900",children:u(n.totalDeviceSpent||0)})]}),n.deviceBreakdown&&e.jsxs("div",{className:"px-4 py-2 bg-gray-50 space-y-2",children:[e.jsxs("div",{className:"flex justify-between text-[13px]",children:[e.jsx("span",{className:"text-gray-500 ml-3",children:"â€¢ Deposits"}),e.jsx("span",{className:"text-blue-600 font-medium",children:u(n.deviceBreakdown.deposits||0)})]}),e.jsxs("div",{className:"flex justify-between text-[13px]",children:[e.jsx("span",{className:"text-gray-500 ml-3",children:"â€¢ Payments"}),e.jsx("span",{className:"text-green-600 font-medium",children:u(n.deviceBreakdown.payments||0)})]}),n.deviceBreakdown.refunds>0&&e.jsxs("div",{className:"flex justify-between text-[13px]",children:[e.jsx("span",{className:"text-gray-500 ml-3",children:"â€¢ Refunds"}),e.jsxs("span",{className:"text-red-600 font-medium",children:["-",u(n.deviceBreakdown.refunds||0)]})]})]}),e.jsxs("div",{className:"px-4 py-3 bg-green-50 flex justify-between items-center",children:[e.jsx("span",{className:"text-[16px] font-semibold text-gray-900",children:"Total Spent"}),e.jsx("span",{className:"text-[18px] font-bold text-green-600",children:u(n.totalSpent||0)})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-2 mt-3",children:[e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-3 text-center shadow-sm",children:[e.jsx("div",{className:"text-[11px] text-gray-500 uppercase tracking-wide mb-1",children:"Avg Order"}),e.jsx("div",{className:"text-[17px] font-bold text-gray-900",children:u(n.averageOrderValue||0).replace("Tsh ","")})]}),e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-3 text-center shadow-sm",children:[e.jsx("div",{className:"text-[11px] text-gray-500 uppercase tracking-wide mb-1",children:"Frequency"}),e.jsxs("div",{className:"text-[17px] font-bold text-gray-900",children:[n.purchaseFrequency,"/mo"]})]}),n.uniqueProducts>0&&e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-3 text-center shadow-sm",children:[e.jsx("div",{className:"text-[11px] text-gray-500 uppercase tracking-wide mb-1",children:"Products"}),e.jsx("div",{className:"text-[17px] font-bold text-gray-900",children:n.uniqueProducts})]}),n.totalItems>0&&e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-3 text-center shadow-sm",children:[e.jsx("div",{className:"text-[11px] text-gray-500 uppercase tracking-wide mb-1",children:"Total Items"}),e.jsx("div",{className:"text-[17px] font-bold text-gray-900",children:n.totalItems})]})]})]}),N.length>0&&e.jsxs("div",{className:"px-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("h3",{className:"text-[13px] font-semibold text-gray-500 uppercase tracking-wide flex items-center gap-2",children:[e.jsx(ze,{size:16,className:"text-blue-500"}),"Repairs (",N.length,")"]}),e.jsxs("span",{className:"text-[11px] px-2 py-1 bg-blue-100 text-blue-600 rounded-full font-semibold",children:[(n==null?void 0:n.activeRepairs)||0," active"]})]}),e.jsxs("div",{className:"space-y-2",children:[N.slice(0,5).map(t=>{const l=Ie.filter(i=>i.deviceId===t.id&&i.status==="completed").reduce((i,g)=>i+(Number(g.amount)||0),0);return e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-3 shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"text-[15px] font-semibold text-gray-900",children:[t.brand," ",t.model]}),e.jsx("div",{className:"text-[13px] text-gray-600 mt-1 line-clamp-2",children:t.issueDescription})]}),e.jsx("span",{className:`text-[10px] px-2 py-1 rounded-full font-bold uppercase ${t.status==="done"?"bg-green-100 text-green-700":t.status==="failed"?"bg-red-100 text-red-700":"bg-blue-100 text-blue-700"}`,children:t.status.replace(/-/g," ")})]}),e.jsxs("div",{className:"flex justify-between items-center mt-2 pt-2 border-t border-gray-100",children:[e.jsx("span",{className:"text-[12px] text-gray-500",children:new Date(t.createdAt).toLocaleDateString()}),l>0&&e.jsx("span",{className:"text-[13px] text-green-600 font-semibold",children:u(l)})]})]},t.id)}),N.length>5&&e.jsxs("button",{className:"w-full text-center text-[14px] text-blue-500 py-2 hover:bg-gray-50 active:bg-gray-100 rounded-lg transition-colors font-medium",children:["View all ",N.length," devices"]})]})]}),e.jsxs("div",{className:"px-4",children:[e.jsxs("h3",{className:"text-[13px] font-semibold text-gray-500 uppercase tracking-wide mb-3 flex items-center gap-2",children:[e.jsx(le,{size:16,className:"text-green-500"}),"Recent Sales (",v.length,")"]}),v.length>0?e.jsxs("div",{className:"space-y-2",children:[v.slice(0,5).map(t=>e.jsx("div",{className:"bg-white rounded-xl border border-gray-200 p-3 shadow-sm",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"text-[15px] font-semibold text-gray-900",children:["Sale #",t.sale_number||t.id.slice(0,8)]}),e.jsxs("div",{className:"text-[13px] text-gray-500 mt-1 flex items-center gap-1",children:[e.jsx(jt,{size:12}),new Date(t.created_at).toLocaleDateString()]})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("div",{className:"text-[16px] font-bold text-green-600",children:["TSh ",(t.total_amount||0).toLocaleString()]}),e.jsx("div",{className:"text-[12px] text-gray-500 capitalize mt-1",children:t.payment_method})]})]})},t.id)),v.length>5&&e.jsxs("button",{className:"w-full text-center text-[14px] text-blue-500 py-2 hover:bg-gray-50 active:bg-gray-100 rounded-lg transition-colors font-medium",children:["View all ",v.length," sales"]})]}):e.jsxs("div",{className:"text-center py-8 text-gray-400",children:[e.jsx(le,{size:36,className:"mx-auto mb-2",strokeWidth:1.5}),e.jsx("p",{className:"text-[14px]",children:"No sales yet"})]})]}),W.length>0&&e.jsxs("div",{className:"px-4",children:[e.jsxs("h3",{className:"text-[13px] font-semibold text-gray-500 uppercase tracking-wide mb-3 flex items-center gap-2",children:[e.jsx(re,{size:16,className:"text-purple-500"}),"Appointments (",W.length,")"]}),e.jsx("div",{className:"space-y-2",children:W.slice(0,3).map(t=>e.jsx("div",{className:"bg-white rounded-xl border border-gray-200 p-3 shadow-sm",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-[15px] font-semibold text-gray-900 capitalize",children:t.service_type}),e.jsxs("div",{className:"text-[13px] text-gray-500 mt-1",children:[new Date(t.appointment_date).toLocaleDateString()," â€¢ ",t.appointment_time]})]}),e.jsx("span",{className:`text-[10px] px-2 py-1 rounded-full font-bold uppercase ${t.status==="completed"?"bg-green-100 text-green-700":t.status==="confirmed"?"bg-blue-100 text-blue-700":"bg-yellow-100 text-yellow-700"}`,children:t.status})]})},t.id))})]}),k.length>0&&e.jsxs("div",{className:"px-4",children:[e.jsxs("h3",{className:"text-[13px] font-semibold text-gray-500 uppercase tracking-wide mb-3 flex items-center gap-2",children:[e.jsx(U,{size:16,className:"text-green-500"}),"Messages (",k.length,")"]}),e.jsx("div",{className:"space-y-2",children:k.slice(0,3).map((t,l)=>e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-3 shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("span",{className:"text-[11px] font-bold text-gray-500 uppercase tracking-wide",children:t.type||"SMS"}),e.jsx("span",{className:`text-[10px] px-2 py-0.5 rounded-full font-bold uppercase ${t.status==="delivered"?"bg-green-100 text-green-700":t.status==="sent"?"bg-blue-100 text-blue-700":"bg-red-100 text-red-700"}`,children:t.status})]}),e.jsx("div",{className:"text-[14px] text-gray-900 mb-2 line-clamp-2",children:t.message}),e.jsx("div",{className:"text-[12px] text-gray-500",children:new Date(t.created_at||t.sent_at).toLocaleString()})]},l))})]}),k.length>0&&e.jsxs("div",{className:"px-4",children:[e.jsxs("h3",{className:"text-[13px] font-semibold text-gray-500 uppercase tracking-wide mb-3 flex items-center gap-2",children:[e.jsx(U,{size:16,className:"text-green-500"}),"Messages (",k.length,")"]}),e.jsx("div",{className:"space-y-2",children:k.slice(0,3).map((t,l)=>e.jsxs("div",{className:"bg-white rounded-xl border border-gray-200 p-3 shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsx("span",{className:"text-[11px] font-bold text-gray-500 uppercase tracking-wide",children:t.type||"SMS"}),e.jsx("span",{className:`text-[10px] px-2 py-0.5 rounded-full font-bold uppercase ${t.status==="delivered"?"bg-green-100 text-green-700":t.status==="sent"?"bg-blue-100 text-blue-700":"bg-red-100 text-red-700"}`,children:t.status})]}),e.jsx("div",{className:"text-[14px] text-gray-900 mb-2 line-clamp-2",children:t.message}),e.jsx("div",{className:"text-[12px] text-gray-500",children:new Date(t.created_at||t.sent_at).toLocaleString()})]},l))})]}),w.length>0&&e.jsxs("div",{className:"px-4",children:[e.jsxs("h3",{className:"text-[13px] font-semibold text-gray-500 uppercase tracking-wide mb-3 flex items-center gap-2",children:[e.jsx(Nt,{size:16,className:"text-indigo-500"}),"Purchased Products (",w.length,")"]}),e.jsxs("div",{className:"space-y-2",children:[w.slice(0,5).map((t,l)=>{var i;return e.jsx("div",{className:"bg-white rounded-xl border border-gray-200 p-3 shadow-sm",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"text-[15px] font-semibold text-gray-900",children:["Product #",(i=t.product_id)==null?void 0:i.slice(0,8)]}),e.jsxs("div",{className:"text-[13px] text-gray-500 mt-1",children:["Qty: ",t.quantity," Ã— ",u(t.unit_price||0)]})]}),e.jsx("div",{className:"text-[16px] font-bold text-gray-900",children:u(t.total_price||0)})]})},l)}),w.length>5&&e.jsxs("button",{className:"w-full text-center text-[14px] text-blue-500 py-2 hover:bg-gray-50 active:bg-gray-100 rounded-lg transition-colors font-medium",children:["View all ",w.length," items"]})]})]}),z.length>0&&e.jsxs("div",{className:"px-4",children:[e.jsxs("h3",{className:"text-[13px] font-semibold text-gray-500 uppercase tracking-wide mb-3 flex items-center gap-2",children:[e.jsx(vt,{size:16,className:"text-orange-500"}),"Spare Parts Used (",z.length,")"]}),e.jsxs("div",{className:"space-y-2",children:[z.slice(0,5).map(t=>e.jsx("div",{className:"bg-white rounded-xl border border-gray-200 p-3 shadow-sm",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-[15px] font-semibold text-gray-900",children:t.spare_part_name||"Spare Part"}),e.jsxs("div",{className:"text-[13px] text-gray-500 mt-1",children:["Qty: ",t.quantity||1," â€¢ ",new Date(t.created_at||t.used_at).toLocaleDateString()]})]}),t.cost&&e.jsx("div",{className:"text-[16px] font-bold text-gray-900",children:u(t.cost)})]})},t.id)),z.length>5&&e.jsxs("button",{className:"w-full text-center text-[14px] text-blue-500 py-2 hover:bg-gray-50 active:bg-gray-100 rounded-lg transition-colors font-medium",children:["View all ",z.length," parts"]})]})]}),G.length>0&&e.jsxs("div",{className:"px-4",children:[e.jsxs("h3",{className:"text-[13px] font-semibold text-gray-500 uppercase tracking-wide mb-3 flex items-center gap-2",children:[e.jsx(wt,{size:16,className:"text-red-500"}),"Returns & Warranty (",G.length,")"]}),e.jsx("div",{className:"space-y-2",children:G.map(t=>e.jsxs("div",{className:"bg-white rounded-xl border border-red-200 p-3 shadow-sm",children:[e.jsxs("div",{className:"flex justify-between items-start mb-2",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-[15px] font-semibold text-gray-900",children:t.reason||"Product Return"}),e.jsx("div",{className:"text-[13px] text-gray-500 mt-1",children:new Date(t.created_at).toLocaleDateString()})]}),e.jsx("span",{className:`text-[10px] px-2 py-1 rounded-full font-bold uppercase ${t.status==="completed"?"bg-green-100 text-green-700":t.status==="pending"?"bg-yellow-100 text-yellow-700":"bg-gray-100 text-gray-700"}`,children:t.status})]}),t.refund_amount&&e.jsx("div",{className:"pt-2 border-t border-gray-100",children:e.jsxs("div",{className:"text-[14px] text-red-600 font-semibold",children:["Refund: ",u(t.refund_amount)]})})]},t.id))})]}),L.length>0&&e.jsxs("div",{className:"px-4",children:[e.jsxs("h3",{className:"text-[13px] font-semibold text-gray-500 uppercase tracking-wide mb-3 flex items-center gap-2",children:[e.jsx(kt,{size:16,className:"text-purple-500"}),"Customers Referred (",L.length,")"]}),e.jsxs("div",{className:"space-y-2",children:[L.slice(0,3).map(t=>e.jsx("div",{className:"bg-white rounded-xl border border-purple-200 p-3 shadow-sm",children:e.jsxs("div",{className:"flex justify-between items-start",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("div",{className:"text-[15px] font-semibold text-gray-900",children:t.name}),e.jsx("div",{className:"text-[13px] text-gray-500 mt-1",children:t.phone}),e.jsxs("div",{className:"text-[12px] text-gray-400 mt-1",children:["Joined ",new Date(t.created_at).toLocaleDateString()]})]}),t.total_spent>0&&e.jsx("div",{className:"text-[16px] font-bold text-purple-600",children:u(t.total_spent)})]})},t.id)),L.length>3&&e.jsxs("button",{className:"w-full text-center text-[14px] text-blue-500 py-2 hover:bg-gray-50 active:bg-gray-100 rounded-lg transition-colors font-medium",children:["View all ",L.length," referrals"]})]})]})]}),_==="info"&&e.jsxs("div",{className:"bg-white",children:[e.jsxs("div",{className:"px-5 py-4 flex justify-between items-center border-b border-gray-200",children:[e.jsx("span",{className:"text-gray-900 text-[15px]",children:"Name"}),e.jsx("span",{className:"text-gray-900 text-[15px] text-right font-medium",children:s.name})]}),s.phone&&e.jsxs("div",{className:"px-5 py-4 flex justify-between items-center border-b border-gray-200",children:[e.jsx("span",{className:"text-gray-900 text-[15px]",children:"mobile"}),e.jsx("a",{href:`tel:${s.phone}`,className:"text-blue-500 text-[15px]",children:s.phone})]}),s.whatsapp&&e.jsxs("div",{className:"px-5 py-4 flex justify-between items-center border-b border-gray-200",children:[e.jsx("span",{className:"text-gray-900 text-[15px]",children:"WhatsApp"}),e.jsx("a",{href:`https://wa.me/${s.whatsapp.replace(/\D/g,"")}`,className:"text-blue-500 text-[15px]",children:s.whatsapp})]}),s.email&&e.jsxs("div",{className:"px-5 py-4 flex justify-between items-center border-b border-gray-200",children:[e.jsx("span",{className:"text-gray-900 text-[15px]",children:"email"}),e.jsx("a",{href:`mailto:${s.email}`,className:"text-blue-500 text-[15px]",children:s.email})]}),s.gender&&e.jsxs("div",{className:"px-5 py-4 flex justify-between items-center border-b border-gray-200",children:[e.jsx("span",{className:"text-gray-900 text-[15px]",children:"Gender"}),e.jsx("span",{className:"text-gray-900 text-[15px] capitalize",children:s.gender})]}),s.birthMonth&&s.birthDay&&e.jsxs("div",{className:"px-5 py-4 flex justify-between items-center border-b border-gray-200",children:[e.jsx("span",{className:"text-gray-900 text-[15px]",children:"Birthday"}),e.jsxs("span",{className:"text-gray-900 text-[15px]",children:[s.birthMonth,"/",s.birthDay]})]}),s.address&&e.jsxs("div",{className:"px-5 py-4 flex justify-between items-start border-b border-gray-200",children:[e.jsx("span",{className:"text-gray-900 text-[15px]",children:"Address"}),e.jsx("span",{className:"text-gray-900 text-[15px] text-right max-w-[60%]",children:s.address})]}),s.city&&e.jsxs("div",{className:"px-5 py-4 flex justify-between items-center border-b border-gray-200",children:[e.jsx("span",{className:"text-gray-900 text-[15px]",children:"City"}),e.jsx("span",{className:"text-gray-900 text-[15px]",children:s.city})]}),s.country&&e.jsxs("div",{className:"px-5 py-4 flex justify-between items-center border-b border-gray-200",children:[e.jsx("span",{className:"text-gray-900 text-[15px]",children:"Country"}),e.jsx("span",{className:"text-gray-900 text-[15px]",children:s.country})]}),s.website&&e.jsxs("div",{className:"px-5 py-4 flex justify-between items-center border-b border-gray-200",children:[e.jsx("span",{className:"text-gray-900 text-[15px]",children:"Website"}),e.jsx("a",{href:s.website.startsWith("http")?s.website:`https://${s.website}`,target:"_blank",rel:"noopener noreferrer",className:"text-blue-500 text-[15px]",children:s.website})]}),s.loyaltyLevel&&e.jsxs("div",{className:"px-5 py-4 flex justify-between items-center border-b border-gray-200",children:[e.jsx("span",{className:"text-gray-900 text-[15px]",children:"Loyalty Level"}),e.jsx("span",{className:"text-gray-900 text-[15px] font-medium",children:s.loyaltyLevel})]}),s.colorTag&&e.jsxs("div",{className:"px-5 py-4 flex justify-between items-center border-b border-gray-200",children:[e.jsx("span",{className:"text-gray-900 text-[15px]",children:"Tag"}),e.jsx("span",{className:"text-gray-900 text-[15px] capitalize",children:s.colorTag})]}),(s.points!==void 0||s.loyaltyPoints!==void 0||s.loyalty_points!==void 0)&&e.jsxs("div",{className:"px-5 py-4 flex justify-between items-center border-b border-gray-200",children:[e.jsx("span",{className:"text-gray-900 text-[15px]",children:"Loyalty Points"}),e.jsxs("span",{className:"text-blue-500 text-[15px]",children:[s.points||s.loyaltyPoints||s.loyalty_points||0," pts"]})]}),(s.totalSpent!==void 0||s.total_purchases!==void 0)&&e.jsxs("div",{className:"px-5 py-4 flex justify-between items-center border-b border-gray-200",children:[e.jsx("span",{className:"text-gray-900 text-[15px]",children:"Total Spent"}),e.jsxs("span",{className:"text-gray-900 text-[15px]",children:["TSh ",(s.totalSpent||s.total_purchases||0).toLocaleString()]})]}),s.totalPurchases!==void 0&&e.jsxs("div",{className:"px-5 py-4 flex justify-between items-center border-b border-gray-200",children:[e.jsx("span",{className:"text-gray-900 text-[15px]",children:"Total Purchases"}),e.jsx("span",{className:"text-gray-900 text-[15px]",children:s.totalPurchases})]}),s.lastPurchaseDate&&e.jsxs("div",{className:"px-5 py-4 flex justify-between items-center border-b border-gray-200",children:[e.jsx("span",{className:"text-gray-900 text-[15px]",children:"Last Purchase"}),e.jsx("span",{className:"text-gray-900 text-[15px]",children:new Date(s.lastPurchaseDate).toLocaleDateString()})]}),s.totalCalls!==void 0&&s.totalCalls>0&&e.jsxs("div",{className:"px-5 py-4 flex justify-between items-center border-b border-gray-200",children:[e.jsx("span",{className:"text-gray-900 text-[15px]",children:"Total Calls"}),e.jsx("span",{className:"text-gray-900 text-[15px]",children:s.totalCalls})]}),s.callLoyaltyLevel&&e.jsxs("div",{className:"px-5 py-4 flex justify-between items-center border-b border-gray-200",children:[e.jsx("span",{className:"text-gray-900 text-[15px]",children:"Call Level"}),e.jsx("span",{className:"text-gray-900 text-[15px] font-medium",children:s.callLoyaltyLevel})]}),s.lastCallDate&&e.jsxs("div",{className:"px-5 py-4 flex justify-between items-center border-b border-gray-200",children:[e.jsx("span",{className:"text-gray-900 text-[15px]",children:"Last Call"}),e.jsx("span",{className:"text-gray-900 text-[15px]",children:new Date(s.lastCallDate).toLocaleDateString()})]}),s.branchName&&e.jsxs("div",{className:"px-5 py-4 flex justify-between items-center border-b border-gray-200",children:[e.jsx("span",{className:"text-gray-900 text-[15px]",children:"Branch"}),e.jsx("span",{className:"text-gray-900 text-[15px]",children:s.branchName})]}),s.referralSource&&e.jsxs("div",{className:"px-5 py-4 flex justify-between items-center border-b border-gray-200",children:[e.jsx("span",{className:"text-gray-900 text-[15px]",children:"Referral Source"}),e.jsx("span",{className:"text-gray-900 text-[15px]",children:s.referralSource})]}),e.jsxs("div",{className:"px-5 py-4 flex justify-between items-center border-b border-gray-200",children:[e.jsx("span",{className:"text-gray-900 text-[15px]",children:"Status"}),e.jsx("span",{className:`text-[15px] font-medium ${s.isActive?"text-green-600":"text-red-600"}`,children:s.isActive!==!1?"Active":"Inactive"})]}),e.jsxs("div",{className:"px-5 py-4 flex justify-between items-center border-b border-gray-200",children:[e.jsx("span",{className:"text-gray-900 text-[15px]",children:"Customer Since"}),e.jsx("span",{className:"text-gray-900 text-[15px]",children:new Date(s.createdAt||s.joinedDate||s.created_at).toLocaleDateString()})]}),s.lastVisit&&e.jsxs("div",{className:"px-5 py-4 flex justify-between items-center border-b border-gray-200",children:[e.jsx("span",{className:"text-gray-900 text-[15px]",children:"Last Visit"}),e.jsx("span",{className:"text-gray-900 text-[15px]",children:new Date(s.lastVisit).toLocaleDateString()})]}),s.notes&&e.jsxs("div",{className:"px-5 py-4 border-b border-gray-200",children:[e.jsx("div",{className:"text-gray-900 text-[15px] mb-2",children:"Notes"}),e.jsx("div",{className:"text-gray-600 text-[15px]",children:typeof s.notes=="string"?s.notes:Array.isArray(s.notes)&&s.notes.length>0?s.notes[s.notes.length-1].content||s.notes[s.notes.length-1]:""})]})]}),_==="journey"&&e.jsxs("div",{className:"bg-[#f2f2f7] space-y-3 pb-6",children:[e.jsxs("div",{className:"px-4 py-4 bg-white",children:[e.jsx("h2",{className:"text-[17px] font-semibold text-gray-900 mb-1",children:"Customer Journey"}),e.jsx("p",{className:"text-[14px] text-gray-500",children:"Complete timeline of all interactions"})]}),e.jsx("div",{className:"px-4",children:e.jsxs("div",{className:"relative",children:[e.jsx("div",{className:"absolute left-4 top-0 bottom-0 w-1 bg-gradient-to-b from-blue-200 via-purple-200 to-green-200 rounded-full"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"relative flex gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-blue-500 to-blue-600 flex items-center justify-center flex-shrink-0 z-10 shadow-md",children:e.jsx(St,{size:18,className:"text-white",strokeWidth:2.5})}),e.jsxs("div",{className:"flex-1 bg-white rounded-xl border border-gray-200 p-3 shadow-sm",children:[e.jsx("div",{className:"font-semibold text-[15px] text-gray-900",children:"Customer Created"}),e.jsx("div",{className:"text-[13px] text-gray-500 mt-1",children:new Date(s.createdAt||s.created_at).toLocaleDateString()})]})]}),N.slice(0,5).map(t=>e.jsxs("div",{className:"relative flex gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-purple-500 to-purple-600 flex items-center justify-center flex-shrink-0 z-10 shadow-md",children:e.jsx(ze,{size:18,className:"text-white",strokeWidth:2.5})}),e.jsxs("div",{className:"flex-1 bg-white rounded-xl border border-gray-200 p-3 shadow-sm",children:[e.jsxs("div",{className:"font-semibold text-[15px] text-gray-900",children:[t.brand," ",t.model]}),e.jsx("div",{className:"text-[13px] text-gray-600 mt-1 line-clamp-2",children:t.issueDescription}),e.jsxs("div",{className:"flex justify-between items-center mt-2 pt-2 border-t border-gray-100",children:[e.jsx("span",{className:"text-[12px] text-gray-500",children:new Date(t.createdAt).toLocaleDateString()}),e.jsx("span",{className:`text-[10px] px-2 py-1 rounded-full font-bold uppercase ${t.status==="done"?"bg-green-100 text-green-700":"bg-blue-100 text-blue-700"}`,children:t.status})]})]})]},t.id)),v.slice(0,5).map(t=>e.jsxs("div",{className:"relative flex gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-green-500 to-green-600 flex items-center justify-center flex-shrink-0 z-10 shadow-md",children:e.jsx(le,{size:18,className:"text-white",strokeWidth:2.5})}),e.jsxs("div",{className:"flex-1 bg-white rounded-xl border border-gray-200 p-3 shadow-sm",children:[e.jsxs("div",{className:"font-semibold text-[15px] text-gray-900",children:["Sale #",t.sale_number||t.id.slice(0,8)]}),e.jsxs("div",{className:"flex justify-between items-center mt-2",children:[e.jsx("span",{className:"text-[13px] text-gray-500",children:new Date(t.created_at).toLocaleDateString()}),e.jsxs("span",{className:"text-[15px] font-bold text-green-600",children:["TSh ",(t.total_amount||0).toLocaleString()]})]})]})]},t.id)),W.slice(0,3).map(t=>e.jsxs("div",{className:"relative flex gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-orange-500 to-orange-600 flex items-center justify-center flex-shrink-0 z-10 shadow-md",children:e.jsx(re,{size:18,className:"text-white",strokeWidth:2.5})}),e.jsxs("div",{className:"flex-1 bg-white rounded-xl border border-gray-200 p-3 shadow-sm",children:[e.jsx("div",{className:"font-semibold text-[15px] text-gray-900 capitalize",children:t.service_type}),e.jsxs("div",{className:"text-[13px] text-gray-500 mt-1",children:[new Date(t.appointment_date).toLocaleDateString()," â€¢ ",t.appointment_time]})]})]},t.id)),k.slice(0,3).map((t,l)=>{var i;return e.jsxs("div",{className:"relative flex gap-3",children:[e.jsx("div",{className:"w-10 h-10 rounded-full bg-gradient-to-br from-blue-400 to-blue-500 flex items-center justify-center flex-shrink-0 z-10 shadow-md",children:e.jsx(U,{size:18,className:"text-white",strokeWidth:2.5})}),e.jsxs("div",{className:"flex-1 bg-white rounded-xl border border-gray-200 p-3 shadow-sm",children:[e.jsxs("div",{className:"font-semibold text-[15px] text-gray-900",children:[((i=t.type)==null?void 0:i.toUpperCase())||"SMS"," Message"]}),e.jsx("div",{className:"text-[13px] text-gray-600 mt-1 line-clamp-2",children:t.message}),e.jsx("div",{className:"text-[12px] text-gray-500 mt-2",children:new Date(t.sent_at||t.created_at).toLocaleDateString()})]})]},l)})]})]})})]})]}),Fe&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-end",style:{backgroundColor:"rgba(0, 0, 0, 0.4)"},onClick:()=>I(!1),children:e.jsxs("div",{className:"w-full bg-white rounded-t-[20px] max-h-[90vh] overflow-y-auto animate-slide-up",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-gray-200 sticky top-0 bg-white z-10",children:[e.jsx("button",{onClick:()=>I(!1),className:"text-blue-500 text-[17px]",children:"Cancel"}),e.jsx("h3",{className:"text-[17px] font-semibold text-gray-900",children:"Send SMS"}),e.jsx("button",{onClick:Ae,disabled:E||!S.trim(),className:"text-blue-500 text-[17px] font-semibold disabled:text-gray-400",children:E?"Sending...":"Send"})]}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsx("div",{className:"border-t border-b border-gray-200 -mx-4",children:e.jsxs("div",{className:"px-4 py-3 flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-900 text-[15px]",children:"To"}),e.jsx("span",{className:"text-gray-900 text-[15px] font-medium",children:s==null?void 0:s.phone})]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[13px] text-gray-500 uppercase tracking-wide mb-2 px-1",children:"Message"}),e.jsx("textarea",{value:S,onChange:t=>R(t.target.value),rows:6,className:"w-full px-4 py-3 bg-[#f2f2f7] border-0 rounded-xl text-[16px] text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none",placeholder:"Type your message...",style:{WebkitAppearance:"none"},autoFocus:!0}),e.jsxs("div",{className:"text-[13px] text-gray-400 mt-2 px-1",children:[S.length," characters"]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[13px] text-gray-500 uppercase tracking-wide mb-2 px-1",children:"Quick Templates"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("button",{onClick:()=>R(`Hi ${s==null?void 0:s.name}, your order is ready for pickup!`),className:"w-full p-3 bg-gray-50 rounded-lg text-left text-[14px] text-gray-700 hover:bg-gray-100 active:bg-gray-200 transition-colors",children:"ðŸ“¦ Order Ready"}),e.jsx("button",{onClick:()=>R(`Hi ${s==null?void 0:s.name}, thank you for your purchase!`),className:"w-full p-3 bg-gray-50 rounded-lg text-left text-[14px] text-gray-700 hover:bg-gray-100 active:bg-gray-200 transition-colors",children:"ðŸ™ Thank You"})]})]})]}),e.jsx("div",{className:"px-4 pb-4 pt-2",children:e.jsx("button",{onClick:Ae,disabled:E||!S.trim(),className:"w-full py-4 bg-blue-500 text-white rounded-xl font-semibold text-[17px] disabled:bg-gray-300 disabled:cursor-not-allowed hover:bg-blue-600 active:bg-blue-700 transition-all shadow-sm",children:E?e.jsxs("span",{className:"flex items-center justify-center gap-2",children:[e.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Sending..."]}):"Send SMS"})})]})}),Oe&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-end",style:{backgroundColor:"rgba(0, 0, 0, 0.4)"},onClick:()=>T(!1),children:e.jsxs("div",{className:"w-full bg-white rounded-t-[20px] max-h-[90vh] overflow-y-auto animate-slide-up",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-gray-200 sticky top-0 bg-white z-10",children:[e.jsx("button",{onClick:()=>T(!1),className:"text-blue-500 text-[17px]",children:"Cancel"}),e.jsx("h3",{className:"text-[17px] font-semibold text-gray-900",children:"Manage Points"}),e.jsx("button",{onClick:Ge,disabled:ye||!h,className:"text-blue-500 text-[17px] font-semibold disabled:text-gray-400",children:ye?"Saving...":"Done"})]}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{className:"text-center py-6 bg-gradient-to-br from-blue-500 to-blue-600 rounded-2xl",children:[e.jsx("div",{className:"text-[13px] text-blue-100 uppercase tracking-wide mb-2",children:"Current Points"}),e.jsx("div",{className:"text-[48px] font-bold text-white",children:(s==null?void 0:s.points)||0}),e.jsx("div",{className:"text-[15px] text-blue-100",children:"loyalty points"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[13px] text-gray-500 uppercase tracking-wide mb-2 px-1",children:"Adjust Points"}),e.jsx("div",{className:"relative",children:e.jsx("input",{type:"number",value:h,onChange:t=>Y(t.target.value),className:"w-full px-4 py-4 bg-[#f2f2f7] border-0 rounded-xl text-[20px] font-semibold text-center text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"0",style:{WebkitAppearance:"none"},autoFocus:!0})}),e.jsx("div",{className:"text-[13px] text-gray-500 mt-2 text-center px-1",children:"Use positive numbers to add, negative to remove"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[13px] text-gray-500 uppercase tracking-wide mb-2 px-1",children:"Quick Add"}),e.jsx("div",{className:"grid grid-cols-4 gap-2",children:[10,25,50,100].map(t=>e.jsxs("button",{onClick:()=>Y(t.toString()),className:"py-3 bg-gray-100 text-gray-900 rounded-xl text-[15px] font-semibold hover:bg-gray-200 active:bg-gray-300 transition-colors",children:["+",t]},t))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[13px] text-gray-500 uppercase tracking-wide mb-2 px-1",children:"Reason (Optional)"}),e.jsx("input",{type:"text",value:ge,onChange:t=>be(t.target.value),className:"w-full px-4 py-3 bg-[#f2f2f7] border-0 rounded-xl text-[16px] text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"E.g., Bonus points, Purchase return",style:{WebkitAppearance:"none"}})]}),h&&e.jsx("div",{className:`p-4 rounded-xl ${parseInt(h)>=0?"bg-green-50 border border-green-200":"bg-red-50 border border-red-200"}`,children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:`text-[13px] ${parseInt(h)>=0?"text-green-600":"text-red-600"} font-medium mb-1`,children:parseInt(h)>=0?"Adding Points":"Removing Points"}),e.jsxs("div",{className:`text-[24px] font-bold ${parseInt(h)>=0?"text-green-600":"text-red-600"}`,children:[parseInt(h)>=0?"+":"",h]}),e.jsxs("div",{className:"text-[15px] text-gray-600 mt-2",children:["New balance: ",((s==null?void 0:s.points)||0)+parseInt(h||"0")," points"]})]})})]})]})}),Be&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-center justify-center",style:{backgroundColor:"rgba(0, 0, 0, 0.4)"},onClick:()=>$(!1),children:e.jsx("div",{className:"w-[90%] max-w-sm bg-white rounded-2xl overflow-hidden shadow-2xl animate-scale-up",onClick:t=>t.stopPropagation(),children:Ve?e.jsxs("div",{className:"text-center py-8 px-6",children:[e.jsx("div",{className:"w-20 h-20 bg-green-100 rounded-full flex items-center justify-center mx-auto mb-4",children:e.jsx(ae,{size:40,className:"text-green-600",strokeWidth:2.5})}),e.jsx("h4",{className:"text-[20px] font-bold text-gray-900 mb-2",children:"Check-in Successful!"}),e.jsx("p",{className:"text-[16px] text-gray-600 mb-1",children:"20 points awarded"}),e.jsxs("p",{className:"text-[14px] text-gray-500",children:["to ",s==null?void 0:s.name]}),e.jsx("button",{onClick:()=>{$(!1),je(!1)},className:"mt-6 w-full py-3.5 bg-blue-500 text-white rounded-xl font-semibold text-[17px] hover:bg-blue-600 active:bg-blue-700 transition-all",children:"Done"})]}):e.jsxs("div",{className:"p-6",children:[e.jsx("h3",{className:"text-[20px] font-bold text-gray-900 mb-1 text-center",children:"Customer Check-in"}),e.jsxs("div",{className:"text-center mb-6 mt-4",children:[e.jsx("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-3",children:e.jsx(ae,{size:32,className:"text-blue-600",strokeWidth:2.5})}),e.jsx("p",{className:"text-[18px] font-semibold text-gray-900",children:s==null?void 0:s.name}),e.jsx("p",{className:"text-[15px] text-gray-500 mt-1",children:s==null?void 0:s.phone})]}),e.jsx("button",{onClick:Ye,disabled:Ne,className:"w-full py-4 bg-green-500 text-white rounded-xl font-semibold text-[17px] disabled:bg-gray-300 disabled:cursor-not-allowed mb-3 hover:bg-green-600 active:bg-green-700 transition-all shadow-sm",children:Ne?e.jsxs("span",{className:"flex items-center justify-center gap-2",children:[e.jsx("div",{className:"w-5 h-5 border-2 border-white border-t-transparent rounded-full animate-spin"}),"Checking in..."]}):"âœ“ Check In Now"}),e.jsx("button",{onClick:()=>$(!1),className:"w-full py-3 text-gray-700 rounded-xl font-medium text-[16px] hover:bg-gray-50 active:bg-gray-100 transition-colors",children:"Cancel"})]})})}),Ue&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-end",style:{backgroundColor:"rgba(0, 0, 0, 0.4)"},onClick:()=>q(!1),children:e.jsxs("div",{className:"w-full bg-white rounded-t-[20px] max-h-[90vh] overflow-y-auto animate-slide-up",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-gray-200 sticky top-0 bg-white z-10",children:[e.jsx("button",{onClick:()=>q(!1),className:"text-blue-500 text-[17px]",children:"Cancel"}),e.jsx("h3",{className:"text-[17px] font-semibold text-gray-900",children:"New Appointment"}),e.jsx("button",{onClick:Ke,disabled:De||!O||!B||!V,className:"text-blue-500 text-[17px] font-semibold disabled:text-gray-400",children:De?"Saving...":"Done"})]}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{className:"border-t border-b border-gray-200 -mx-4",children:[e.jsxs("div",{className:"px-4 py-3 flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-900 text-[15px]",children:"Customer"}),e.jsx("span",{className:"text-gray-900 text-[15px] font-medium",children:s==null?void 0:s.name})]}),e.jsxs("div",{className:"px-4 py-3 flex items-center justify-between border-t border-gray-200",children:[e.jsx("span",{className:"text-gray-900 text-[15px]",children:"Phone"}),e.jsx("span",{className:"text-gray-900 text-[15px] font-mono",children:s==null?void 0:s.phone})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[13px] text-gray-500 uppercase tracking-wide mb-2 px-1",children:"Date & Time"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"date",value:O,onChange:t=>we(t.target.value),className:"flex-1 px-4 py-3 bg-[#f2f2f7] border-0 rounded-xl text-[16px] text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500",style:{WebkitAppearance:"none"}}),e.jsx("input",{type:"time",value:B,onChange:t=>ke(t.target.value),className:"px-4 py-3 bg-[#f2f2f7] border-0 rounded-xl text-[16px] text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500",style:{WebkitAppearance:"none",width:"140px"}})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[13px] text-gray-500 uppercase tracking-wide mb-2 px-1",children:"Service Type"}),e.jsxs("select",{value:V,onChange:t=>Se(t.target.value),className:"w-full px-4 py-3 bg-[#f2f2f7] border-0 rounded-xl text-[16px] text-gray-900 focus:outline-none focus:ring-2 focus:ring-blue-500",style:{WebkitAppearance:"none"},children:[e.jsx("option",{value:"",children:"Select service"}),e.jsx("option",{value:"repair",children:"ðŸ”§ Repair"}),e.jsx("option",{value:"consultation",children:"ðŸ’¬ Consultation"}),e.jsx("option",{value:"pickup",children:"ðŸ“¦ Pickup"}),e.jsx("option",{value:"delivery",children:"ðŸšš Delivery"}),e.jsx("option",{value:"other",children:"ðŸ“ Other"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[13px] text-gray-500 uppercase tracking-wide mb-2 px-1",children:"Notes (Optional)"}),e.jsx("textarea",{value:Ce,onChange:t=>_e(t.target.value),rows:4,className:"w-full px-4 py-3 bg-[#f2f2f7] border-0 rounded-xl text-[16px] text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none",placeholder:"Additional notes...",style:{WebkitAppearance:"none"}})]})]})]})}),K&&e.jsx("div",{className:"fixed inset-0 z-50 flex items-end",style:{backgroundColor:"rgba(0, 0, 0, 0.4)"},onClick:()=>F(!1),children:e.jsxs("div",{className:"w-full bg-white rounded-t-[20px] max-h-[90vh] overflow-y-auto animate-slide-up",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b border-gray-200 sticky top-0 bg-white z-10",children:[e.jsx("button",{onClick:()=>F(!1),className:"text-blue-500 text-[17px]",children:"Cancel"}),e.jsx("h3",{className:"text-[17px] font-semibold text-gray-900",children:"Edit Customer"}),e.jsx("button",{onClick:Xe,disabled:!d.name||!d.phone,className:"text-blue-500 text-[17px] font-semibold disabled:text-gray-400",children:"Save"})]}),e.jsxs("div",{className:"p-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-[13px] text-gray-500 uppercase tracking-wide mb-2 px-1",children:"Basic Information"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("input",{type:"text",value:d.name||"",onChange:t=>f({...d,name:t.target.value}),className:"w-full px-4 py-3 bg-[#f2f2f7] border-0 rounded-xl text-[16px] text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Customer name",style:{WebkitAppearance:"none"}}),e.jsx("input",{type:"tel",value:d.phone||"",onChange:t=>f({...d,phone:t.target.value}),className:"w-full px-4 py-3 bg-[#f2f2f7] border-0 rounded-xl text-[16px] text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Phone number",style:{WebkitAppearance:"none"}})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[13px] text-gray-500 uppercase tracking-wide mb-2 px-1",children:"Contact Details"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("input",{type:"email",value:d.email||"",onChange:t=>f({...d,email:t.target.value}),className:"w-full px-4 py-3 bg-[#f2f2f7] border-0 rounded-xl text-[16px] text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Email address",style:{WebkitAppearance:"none"}}),e.jsx("input",{type:"tel",value:d.whatsapp||"",onChange:t=>f({...d,whatsapp:t.target.value}),className:"w-full px-4 py-3 bg-[#f2f2f7] border-0 rounded-xl text-[16px] text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"WhatsApp number",style:{WebkitAppearance:"none"}})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[13px] text-gray-500 uppercase tracking-wide mb-2 px-1",children:"Location"}),e.jsxs("div",{className:"space-y-2",children:[e.jsx("input",{type:"text",value:d.address||"",onChange:t=>f({...d,address:t.target.value}),className:"w-full px-4 py-3 bg-[#f2f2f7] border-0 rounded-xl text-[16px] text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Street address",style:{WebkitAppearance:"none"}}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:d.city||"",onChange:t=>f({...d,city:t.target.value}),className:"flex-1 px-4 py-3 bg-[#f2f2f7] border-0 rounded-xl text-[16px] text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"City",style:{WebkitAppearance:"none"}}),e.jsx("input",{type:"text",value:d.country||"",onChange:t=>f({...d,country:t.target.value}),className:"flex-1 px-4 py-3 bg-[#f2f2f7] border-0 rounded-xl text-[16px] text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Country",style:{WebkitAppearance:"none"}})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-[13px] text-gray-500 uppercase tracking-wide mb-2 px-1",children:"Notes"}),e.jsx("textarea",{value:d.notes||"",onChange:t=>f({...d,notes:t.target.value}),rows:4,className:"w-full px-4 py-3 bg-[#f2f2f7] border-0 rounded-xl text-[16px] text-gray-900 placeholder-gray-400 focus:outline-none focus:ring-2 focus:ring-blue-500 resize-none",placeholder:"Additional notes...",style:{WebkitAppearance:"none"}})]})]})]})})]}):e.jsx("div",{className:"flex flex-col h-full bg-white",children:e.jsx("div",{className:"flex-1 flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"text-6xl mb-3",children:"ðŸ‘¤"}),e.jsx("p",{className:"text-gray-500",children:"Client not found"}),e.jsx("button",{onClick:()=>J("/mobile/clients"),className:"mt-4 px-4 py-2 bg-blue-500 text-white rounded-lg",children:"Back to Clients"})]})})})},At=`
  @keyframes slideUp {
    from {
      transform: translateY(100%);
    }
    to {
      transform: translateY(0);
    }
  }
  @keyframes scaleUp {
    from {
      transform: scale(0.9);
      opacity: 0;
    }
    to {
      transform: scale(1);
      opacity: 1;
    }
  }
  .animate-slide-up {
    animation: slideUp 0.3s ease-out;
  }
  .animate-scale-up {
    animation: scaleUp 0.3s ease-out;
  }
`;if(typeof document<"u"&&!document.getElementById("mobile-client-detail-styles")){const r=document.createElement("style");r.id="mobile-client-detail-styles",r.textContent=At,document.head.appendChild(r)}export{Ot as default};
