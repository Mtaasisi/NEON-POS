import{a as C,j as e,G as u}from"./index-61458a34.js";import{r as t}from"./vendor-36d2c7c1.js";import{M as b}from"./Modal-a5e4c1ba.js";import{s as n}from"./storeLocationApi-1725ef86.js";import{e as D}from"./ui-28e30067.js";import"./supabase-cf010ec4.js";import"./routing-eb8c310c.js";import"./useBodyScrollLock-341c8b9f.js";const O=()=>{const{startLoading:m,completeLoading:x,failLoading:g}=C(),[h,l]=t.useState([]),[E,f]=t.useState(null),[p,c]=t.useState(!0);t.useState(!1),t.useState(null),t.useState(null);const[o,i]=t.useState(null);t.useState(!1);const[A,j]=t.useState([]),[F,y]=t.useState([]),[r,M]=t.useState({});t.useState(""),t.useState(!1),t.useEffect(()=>{d()},[]),t.useEffect(()=>{L()},[r]);const d=async()=>{const s=m("Loading store locations...");try{c(!0);const[a,w,N,v]=await Promise.all([n.getAll(),n.getStats(),n.getCities(),n.getRegions()]);l(a),f(w),j(N),y(v),x(s)}catch(a){console.error("Error loading data:",a),g(s,"Failed to load locations")}finally{c(!1)}},L=async()=>{try{const s=await n.getAll(r);l(s)}catch(s){console.error("Error loading locations:",s)}},S=async s=>{try{await n.delete(s.id),i(null),await d()}catch(a){console.error("Error deleting location:",a),alert(a instanceof Error?a.message:"Failed to delete location")}};return h.filter(s=>{if(r.search){const a=r.search.toLowerCase();return s.name.toLowerCase().includes(a)||s.code.toLowerCase().includes(a)||s.city.toLowerCase().includes(a)||s.address.toLowerCase().includes(a)}return!0}),p?e.jsx("div",{className:"flex items-center justify-center min-h-screen",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-blue-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Loading store locations..."})]})}):e.jsx("div",{className:"container mx-auto px-4 py-6",children:e.jsx(b,{isOpen:!!o,onClose:()=>i(null),title:"Delete Location",size:"md",children:o&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(D,{className:"w-6 h-6 text-red-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:"Are you sure you want to delete this location?"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"This action cannot be undone. All data associated with this location will be permanently removed."})]})]}),e.jsxs("div",{className:"bg-gray-50 p-3 rounded-lg",children:[e.jsx("p",{className:"font-medium",children:o.name}),e.jsxs("p",{className:"text-sm text-gray-600",children:[o.address,", ",o.city]})]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(u,{variant:"outline",onClick:()=>i(null),children:"Cancel"}),e.jsx(u,{variant:"destructive",onClick:()=>S(o),children:"Delete Location"})]})]})})})};export{O as StoreLocationManagementPage,O as default};
