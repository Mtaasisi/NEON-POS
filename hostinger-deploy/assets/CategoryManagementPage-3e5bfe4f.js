import{a6 as p,u as T,j as e,G as S,e as g,a7 as G,a8 as M,a9 as O}from"./index-61458a34.js";import{r as l}from"./vendor-36d2c7c1.js";import{n as m,h as P,v as R,N as B,T as V,m as I,Y as Q,X as $}from"./ui-28e30067.js";import{u as q}from"./useDialog-6eb5c329.js";import{a as U}from"./routing-eb8c310c.js";import"./supabase-cf010ec4.js";const Y=(F={})=>{const{activeOnly:y=!1,searchQuery:u="",autoFetch:j=!0,forceRefresh:o=!1}=F,[b,v]=l.useState([]),[x,s]=l.useState(!1),[C,c]=l.useState(null),n=l.useCallback(async(i=!1)=>{try{s(!0),c(null);let a;u?a=await p.searchCategories(u,i):y?a=await p.getActiveCategories(i):a=await p.getCategories(i),v(a)}catch(a){const h=a instanceof Error?a.message:"Failed to fetch categories";c(h),console.error("Error fetching categories:",a)}finally{s(!1)}},[y,u]),d=l.useCallback(async()=>{await n(!0)},[n]),k=l.useCallback(async i=>{try{s(!0),c(null);const a=await p.searchCategories(i);v(a)}catch(a){const h=a instanceof Error?a.message:"Failed to search categories";c(h),console.error("Error searching categories:",a)}finally{s(!1)}},[]),f=l.useCallback(i=>b.find(a=>a.id===i)||null,[b]),N=l.useCallback(async()=>await p.getCategoryStats(),[]);return l.useEffect(()=>{j&&n(o)},[j,o,n]),{categories:b,loading:x,error:C,refetch:d,search:k,getCategoryById:f,getCategoryStats:N}},Z=()=>{T();const F=U(),{confirm:y}=q(),[u,j]=l.useState([]),[o,b]=l.useState(""),[v,x]=l.useState(!1),[s,C]=l.useState(null),[c,n]=l.useState(!1),{categories:d,loading:k,error:f,refetch:N}=Y({activeOnly:!0,autoFetch:!0}),i=[{value:"#3B82F6",label:"Blue"},{value:"#10B981",label:"Green"},{value:"#8B5CF6",label:"Purple"},{value:"#F59E0B",label:"Orange"},{value:"#EF4444",label:"Red"},{value:"#EC4899",label:"Pink"},{value:"#6366F1",label:"Indigo"},{value:"#EAB308",label:"Yellow"},{value:"#14B8A6",label:"Teal"},{value:"#06B6D4",label:"Cyan"},{value:"#F97316",label:"Amber"},{value:"#059669",label:"Emerald"},{value:"#7C3AED",label:"Violet"},{value:"#475569",label:"Slate"},{value:"#E11D48",label:"Rose"},{value:"#0284C7",label:"Sky"},{value:"#84CC16",label:"Lime"},{value:"#C026D3",label:"Fuchsia"},{value:"#EA580C",label:"Orange"},{value:"#4F46E5",label:"Indigo"},{value:"#6B7280",label:"Gray"}];l.useEffect(()=>{},[]),l.useEffect(()=>{a()},[d,o]),l.useEffect(()=>{f&&m.error("Failed to fetch categories: "+f)},[f]);const a=()=>{let t=d;o.trim()&&(t=t.filter(r=>{var E;return r.name.toLowerCase().includes(o.toLowerCase())||((E=r.description)==null?void 0:E.toLowerCase().includes(o.toLowerCase()))})),j(t)},h=async t=>{b(t)},D=async t=>{n(!0);try{s?(await G(s.id,t),m.success("Category updated successfully!")):(await M(t),m.success("Category created successfully!")),await N()}catch(r){throw m.error(r.message||"Failed to save category"),r}finally{n(!1)}},A=async t=>{if(await y(`Are you sure you want to delete ${t.name}?`))try{await O(t.id),m.success("Category deleted successfully!"),await N()}catch{m.error("Failed to delete category")}},z=t=>{C(t),x(!0)},w=()=>{x(!1),C(null)},L=t=>{const r={"#3B82F6":"bg-blue-100 text-blue-800","#10B981":"bg-green-100 text-green-800","#8B5CF6":"bg-purple-100 text-purple-800","#F59E0B":"bg-orange-100 text-orange-800","#EF4444":"bg-red-100 text-red-800","#EC4899":"bg-pink-100 text-pink-800","#6366F1":"bg-indigo-100 text-indigo-800","#EAB308":"bg-yellow-100 text-yellow-800","#14B8A6":"bg-teal-100 text-teal-800","#06B6D4":"bg-cyan-100 text-cyan-800","#F97316":"bg-amber-100 text-amber-800","#059669":"bg-emerald-100 text-emerald-800","#7C3AED":"bg-violet-100 text-violet-800","#475569":"bg-slate-100 text-slate-800","#E11D48":"bg-rose-100 text-rose-800","#0284C7":"bg-sky-100 text-sky-800","#84CC16":"bg-lime-100 text-lime-800","#C026D3":"bg-fuchsia-100 text-fuchsia-800","#EA580C":"bg-orange-100 text-orange-800","#4F46E5":"bg-indigo-100 text-indigo-800","#6B7280":"bg-gray-100 text-gray-800"};return r[t]||r["#6B7280"]};return e.jsxs("div",{className:"p-4 sm:p-6 max-w-6xl mx-auto",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsxs(S,{onClick:()=>F("/dashboard"),className:"flex items-center gap-2",children:[e.jsx(P,{size:20}),"Back to Dashboard"]}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Category Management"}),e.jsx("p",{className:"text-gray-600",children:"Manage device categories and their colors"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4 mb-6",children:[e.jsxs(g,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-blue-600",children:d.length}),e.jsx("div",{className:"text-sm text-gray-600",children:"Total Categories"})]}),e.jsxs(g,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-green-600",children:d.filter(t=>t.description).length}),e.jsx("div",{className:"text-sm text-gray-600",children:"With Description"})]}),e.jsxs(g,{className:"p-4 text-center",children:[e.jsx("div",{className:"text-2xl font-bold text-purple-600",children:new Set(d.map(t=>t.color)).size}),e.jsx("div",{className:"text-sm text-gray-600",children:"Color Variants"})]})]}),e.jsx(g,{className:"mb-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4 items-center justify-between",children:[e.jsx("div",{className:"flex items-center gap-4",children:e.jsxs("div",{className:"relative flex-1 md:w-80",children:[e.jsx(R,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400",size:20}),e.jsx("input",{type:"text",placeholder:"Search categories...",value:o,onChange:t=>h(t.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent"})]})}),e.jsx("div",{className:"flex items-center gap-2",children:e.jsxs(S,{onClick:()=>x(!0),className:"flex items-center gap-2",children:[e.jsx(B,{size:16}),"Add Category"]})})]})}),k?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsx("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"})}):u.length===0?e.jsxs(g,{className:"text-center py-12",children:[e.jsx(V,{className:"w-12 h-12 text-gray-400 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No categories found"}),e.jsx("p",{className:"text-gray-600 mb-4",children:o?"Try adjusting your search":"Get started by creating your first category"}),!o&&e.jsxs(S,{onClick:()=>x(!0),className:"flex items-center gap-2",children:[e.jsx(B,{size:16}),"Create First Category"]})]}):e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 xl:grid-cols-4 gap-4",children:u.map(t=>e.jsxs(g,{className:"relative group",children:[e.jsx("div",{className:"flex items-center justify-center h-32 mb-4 rounded-lg",style:{backgroundColor:t.color+"20"},children:e.jsx("div",{className:"text-4xl font-bold rounded-full w-16 h-16 flex items-center justify-center",style:{backgroundColor:t.color,color:"white"},children:t.name.charAt(0)})}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("h3",{className:"font-semibold text-gray-900 text-lg",children:t.name}),e.jsx("div",{className:"flex items-center gap-1",children:e.jsx("span",{className:"w-2 h-2 bg-green-500 rounded-full"})})]}),t.description&&e.jsx("p",{className:"text-sm text-gray-600 line-clamp-2",children:t.description}),e.jsx("div",{className:"flex flex-wrap gap-1",children:e.jsxs("span",{className:`inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium ${L(t.color)}`,style:{backgroundColor:t.color+"20",color:t.color},children:[e.jsx("div",{className:"w-2 h-2 rounded-full",style:{backgroundColor:t.color}}),t.color]})}),e.jsxs("div",{className:"flex items-center justify-between pt-3 border-t border-gray-100",children:[e.jsx("div",{className:"flex items-center gap-1 text-xs text-gray-500",children:e.jsxs("span",{children:["Created: ",new Date(t.created_at).toLocaleDateString()]})}),e.jsxs("div",{className:"flex items-center gap-1 opacity-0 group-hover:opacity-100 transition-opacity",children:[e.jsx("button",{onClick:()=>z(t),className:"p-1 text-gray-500 hover:text-blue-600 transition-colors",title:"Edit Category",children:e.jsx(I,{size:14})}),e.jsx("button",{onClick:()=>A(t),className:"p-1 text-gray-500 hover:text-red-600 transition-colors",title:"Delete Category",children:e.jsx(Q,{size:14})})]})]})]})]},t.id))}),v&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 p-4",onClick:t=>{t.target===t.currentTarget&&w()},children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between p-6 border-b",children:[e.jsx("h2",{className:"text-xl font-semibold",children:s?`Edit Category: ${s.name}`:"Add New Category"}),e.jsx("button",{onClick:w,className:"p-2 hover:bg-gray-100 rounded-lg transition-colors",children:e.jsx($,{size:20})})]}),e.jsxs("form",{onSubmit:t=>{t.preventDefault();const r=new FormData(t.currentTarget),E={name:r.get("name"),description:r.get("description"),color:r.get("color")};D(E),w()},className:"p-6 space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category Name *"}),e.jsx("input",{name:"name",type:"text",defaultValue:(s==null?void 0:s.name)||"",className:"w-full px-4 py-3 text-lg border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200",placeholder:"Enter category name",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Color"}),e.jsx("select",{name:"color",defaultValue:(s==null?void 0:s.color)||"#3B82F6",className:"w-full px-4 py-3 text-lg border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200",children:i.map(t=>e.jsx("option",{value:t.value,children:t.label},t.value))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),e.jsx("textarea",{name:"description",defaultValue:(s==null?void 0:s.description)||"",className:"w-full px-4 py-3 text-lg border-2 border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200",placeholder:"Enter category description",rows:3})]}),e.jsxs("div",{className:"flex gap-4",children:[e.jsx("button",{type:"submit",disabled:c,className:"flex-1 px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors disabled:opacity-50",children:c?e.jsxs("div",{className:"flex items-center justify-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"}),s?"Updating...":"Adding..."]}):s?"Update Category":"Add Category"}),e.jsx("button",{type:"button",onClick:w,disabled:c,className:"px-6 py-3 bg-gray-300 text-gray-700 rounded-lg hover:bg-gray-400 transition-colors disabled:opacity-50",children:"Cancel"})]})]})]})})]})};export{Z as default};
