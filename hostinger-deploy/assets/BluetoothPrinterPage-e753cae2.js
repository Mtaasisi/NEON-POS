import{j as e,e as d,G as l}from"./index-61458a34.js";import{r as u}from"./vendor-36d2c7c1.js";import{u as q}from"./useBluetoothPrinter-0ea2abfe.js";import{cy as C,R as Q,d as K,f as V,a8 as J,W as Y,e as _,a6 as h,G as ee,aQ as S,Z as se,h as te}from"./ui-28e30067.js";import{a as le}from"./routing-eb8c310c.js";import"./supabase-cf010ec4.js";const re=({className:m="",onPrinterConnected:g,onPrinterDisconnected:b})=>{var w;const{isInitialized:P,isConnected:r,isConnecting:x,isPrinting:a,connectedDevice:n,availableDevices:j,settings:i,error:f,initialize:T,requestDevice:k,connect:L,disconnect:R,print:N,printReceipt:B,printLabel:D,updateSettings:c,clearError:E}=q(),[y,v]=u.useState(!1),[p,z]=u.useState(!1),[U,A]=u.useState(`Test Print
Hello from LATS CHANCE!

Date: `+new Date().toLocaleString()),[t,o]=u.useState({title:"Test Product",barcode:"123456789",qrCode:"https://latschance.com",text:"Sample product description",price:"TZS 5,000",sku:"SKU-001",size:"M",color:"Blue"}),I=async s=>{await L(s)&&g&&g(s)},H=async()=>{await R(),b&&b()},W=async()=>{try{if(console.log("Starting test print..."),console.log("Is connected:",r),console.log("Connected device:",n),!r){alert("Please connect to a printer first");return}const s=`TEST PRINT
Hello World!
Date: `+new Date().toLocaleString()+`




`;console.log("Simple test content:",s),await N({content:s,copies:1}),console.log("Test print completed successfully"),alert("Test print sent successfully!")}catch(s){console.error("Test print failed:",s),alert(`Test print failed: ${s.message}`)}},Z=async()=>{try{if(console.log("Starting test receipt print..."),!r){alert("Please connect to a printer first");return}await B({header:"LATS CHANCE STORE",items:[{name:"Test Product 1",quantity:2,price:1e3,total:2e3},{name:"Test Product 2",quantity:1,price:1500,total:1500}],subtotal:3500,tax:630,discount:0,total:4130,paymentMethod:"Cash",cashier:"Test User",footer:"Thank you for your purchase!"}),console.log("Test receipt print completed successfully")}catch(s){console.error("Test receipt print failed:",s),alert(`Test receipt print failed: ${s.message}`)}},M=async()=>{try{if(console.log("Starting test label print..."),console.log("Label data:",t),!r){alert("Please connect to a printer first");return}await D(t),console.log("Test label print completed successfully")}catch(s){console.error("Test label print failed:",s),alert(`Test label print failed: ${s.message}`)}},$=async()=>{try{if(console.log("Starting raw test print..."),!r){alert("Please connect to a printer first");return}const s=`RAW TEST
Simple text
No commands




`;console.log("Raw test content:",s),await N({content:s,copies:1}),console.log("Raw test print completed successfully"),alert("Raw test print sent successfully!")}catch(s){console.error("Raw test print failed:",s),alert(`Raw test print failed: ${s.message}`)}},G=async()=>{try{if(console.log("Starting ultra simple test..."),!r){alert("Please connect to a printer first");return}const s=`ULTRA SIMPLE
Just text
No commands
No formatting




`;if(console.log("Ultra simple content:",s),bluetoothPrinterService.characteristic){const F=new TextEncoder().encode(s);await bluetoothPrinterService.characteristic.writeValue(F),console.log("Ultra simple test sent directly to characteristic"),alert("Ultra simple test sent directly!")}else alert("No characteristic available")}catch(s){console.error("Ultra simple test failed:",s),alert(`Ultra simple test failed: ${s.message}`)}},O=()=>{v(!1)};return P?e.jsxs("div",{className:`space-y-4 ${m}`,children:[e.jsx(d,{className:"p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`p-2 rounded-full ${r?"bg-green-100":"bg-gray-100"}`,children:r?e.jsx(K,{className:"w-5 h-5 text-green-600"}):e.jsx(V,{className:"w-5 h-5 text-gray-400"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold",children:"Bluetooth Printer"}),e.jsx("p",{className:"text-sm text-gray-600",children:r?`Connected to ${(n==null?void 0:n.name)||"Unknown Printer"}`:"Not connected"})]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(l,{onClick:()=>v(!y),variant:"ghost",size:"sm",children:e.jsx(J,{className:"w-4 h-4"})}),r?e.jsxs(l,{onClick:H,variant:"secondary",size:"sm",disabled:x,children:[e.jsx(Y,{className:"w-4 h-4 mr-1"}),"Disconnect"]}):e.jsxs(l,{onClick:k,variant:"primary",size:"sm",disabled:x,children:[e.jsx(C,{className:"w-4 h-4 mr-1"}),x?"Connecting...":"Connect"]})]})]})}),f&&e.jsx(d,{className:"p-4 border-l-4 border-red-500 bg-red-50",children:e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx(_,{className:"w-5 h-5 text-red-500 mt-0.5"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm text-red-700",children:f}),e.jsx(l,{onClick:E,variant:"ghost",size:"sm",className:"mt-2",children:"Dismiss"})]})]})}),j.length>0&&!r&&e.jsxs(d,{className:"p-4",children:[e.jsx("h4",{className:"font-semibold mb-3",children:"Available Printers"}),e.jsx("div",{className:"space-y-2",children:j.map(s=>e.jsxs("div",{className:"flex items-center justify-between p-3 border border-gray-200 rounded-lg",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(h,{className:"w-5 h-5 text-blue-500"}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium",children:s.name}),e.jsx("p",{className:"text-sm text-gray-600",children:s.address})]})]}),e.jsx(l,{onClick:()=>I(s.id),variant:"primary",size:"sm",disabled:x,children:"Connect"})]},s.id))})]}),y&&e.jsxs(d,{className:"p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h4",{className:"font-semibold",children:"Printer Settings"}),e.jsxs(l,{onClick:O,variant:"primary",size:"sm",children:[e.jsx(ee,{className:"w-4 h-4 mr-1"}),"Save"]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Paper Width (mm)"}),e.jsxs("select",{value:i.paperWidth,onChange:s=>c({paperWidth:Number(s.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:50,children:"50mm (Label)"}),e.jsx("option",{value:58,children:"58mm (Narrow)"}),e.jsx("option",{value:80,children:"80mm (Standard)"}),e.jsx("option",{value:112,children:"112mm (Wide)"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Print Copies"}),e.jsx("input",{type:"number",min:"1",max:"10",value:i.printCopies,onChange:s=>c({printCopies:Number(s.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Label Height (mm)"}),e.jsx("input",{type:"number",min:"10",max:"100",value:i.labelHeight,onChange:s=>c({labelHeight:Number(s.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"DPI (Dots Per Inch)"}),e.jsxs("select",{value:i.dpi,onChange:s=>c({dpi:Number(s.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:203,children:"203 DPI (Standard)"}),e.jsx("option",{value:300,children:"300 DPI (High Quality)"}),e.jsx("option",{value:600,children:"600 DPI (Ultra High)"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Default Print Type"}),e.jsxs("select",{value:i.defaultPrintType,onChange:s=>c({defaultPrintType:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",children:[e.jsx("option",{value:"receipt",children:"Receipt"}),e.jsx("option",{value:"label",children:"Label"})]}),((w=n==null?void 0:n.name)==null?void 0:w.toLowerCase().includes("xp-p301a"))&&e.jsx("p",{className:"text-xs text-blue-600 mt-1",children:"XP-P301A supports both receipt and label printing modes"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Auto-Connect"}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:i.autoConnect,onChange:s=>c({autoConnect:s.target.checked}),className:"w-4 h-4 text-blue-600 border-gray-300 rounded focus:ring-blue-500"}),e.jsx("span",{className:"ml-2 text-sm text-gray-600",children:"Automatically reconnect when available"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Connection Timeout (ms)"}),e.jsx("input",{type:"number",min:"1000",max:"30000",step:"1000",value:i.connectionTimeout,onChange:s=>c({connectionTimeout:Number(s.target.value)}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500"})]})]})]}),r&&e.jsxs(d,{className:"p-4",children:[e.jsxs("h4",{className:"font-semibold mb-3 flex items-center gap-2",children:[e.jsx(S,{className:"w-5 h-5"}),"Test Print"]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Test Content"}),e.jsx("textarea",{value:U,onChange:s=>A(s.target.value),rows:4,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500",placeholder:"Enter test content to print..."})]}),e.jsxs("div",{className:"flex gap-2 flex-wrap",children:[e.jsxs(l,{onClick:W,variant:"primary",disabled:a,className:"flex-1 min-w-[120px]",children:[e.jsx(h,{className:"w-4 h-4 mr-2"}),a?"Printing...":"Test Print"]}),e.jsxs(l,{onClick:Z,variant:"secondary",disabled:a,className:"flex-1 min-w-[120px]",children:[e.jsx(h,{className:"w-4 h-4 mr-2"}),"Test Receipt"]}),e.jsxs(l,{onClick:$,variant:"outline",disabled:a,className:"flex-1 min-w-[120px]",children:[e.jsx(S,{className:"w-4 h-4 mr-2"}),"Raw Test"]}),e.jsxs(l,{onClick:G,variant:"outline",disabled:a,className:"flex-1 min-w-[120px]",children:[e.jsx(se,{className:"w-4 h-4 mr-2"}),"Ultra Simple"]})]}),e.jsxs("div",{className:"border-t pt-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("h5",{className:"font-medium text-gray-900",children:"Label Printing"}),e.jsxs(l,{onClick:()=>z(!p),variant:"ghost",size:"sm",children:[p?"Hide":"Show"," Label Form"]})]}),p&&e.jsxs("div",{className:"space-y-3 p-3 bg-gray-50 rounded-lg",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Title"}),e.jsx("input",{type:"text",value:t.title,onChange:s=>o({...t,title:s.target.value}),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Price"}),e.jsx("input",{type:"text",value:t.price,onChange:s=>o({...t,price:s.target.value}),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Barcode"}),e.jsx("input",{type:"text",value:t.barcode,onChange:s=>o({...t,barcode:s.target.value}),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"SKU"}),e.jsx("input",{type:"text",value:t.sku,onChange:s=>o({...t,sku:s.target.value}),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Size"}),e.jsx("input",{type:"text",value:t.size,onChange:s=>o({...t,size:s.target.value}),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Color"}),e.jsx("input",{type:"text",value:t.color,onChange:s=>o({...t,color:s.target.value}),className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),e.jsx("textarea",{value:t.text,onChange:s=>o({...t,text:s.target.value}),rows:2,className:"w-full px-2 py-1 text-sm border border-gray-300 rounded focus:outline-none focus:ring-1 focus:ring-blue-500"})]})]}),e.jsxs(l,{onClick:M,variant:"secondary",disabled:a,className:"w-full",children:[e.jsx(h,{className:"w-4 h-4 mr-2"}),a?"Printing...":"Test Label"]})]})]})]})]}):e.jsx(d,{className:`p-6 ${m}`,children:e.jsxs("div",{className:"text-center",children:[e.jsx(C,{className:"w-12 h-12 mx-auto mb-4 text-blue-500"}),e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"Bluetooth Printer"}),e.jsx("p",{className:"text-gray-600 mb-4",children:"Initializing Bluetooth printer service..."}),e.jsxs(l,{onClick:T,variant:"primary",className:"w-full",children:[e.jsx(Q,{className:"w-4 h-4 mr-2"}),"Initialize"]})]})})},me=()=>{const m=le();return e.jsx("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-4",children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-6",children:[e.jsx("button",{onClick:()=>m(-1),className:"p-2 hover:bg-white hover:shadow-md rounded-lg transition-all duration-200",children:e.jsx(te,{className:"w-6 h-6 text-gray-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Bluetooth Printer Management"}),e.jsx("p",{className:"text-gray-600",children:"Connect and manage your Bluetooth thermal and label printers"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-6",children:[e.jsx("div",{className:"lg:col-span-2",children:e.jsx(re,{})}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Quick Setup Guide"}),e.jsxs("div",{className:"space-y-3 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-6 h-6 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center text-xs font-semibold mt-0.5",children:"1"}),e.jsx("p",{children:"Make sure your Bluetooth printer is turned on and in pairing mode"})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-6 h-6 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center text-xs font-semibold mt-0.5",children:"2"}),e.jsx("p",{children:'Click "Connect" to search for available Bluetooth printers'})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-6 h-6 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center text-xs font-semibold mt-0.5",children:"3"}),e.jsx("p",{children:"Select your printer from the list and wait for connection"})]}),e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"w-6 h-6 bg-blue-100 text-blue-600 rounded-full flex items-center justify-center text-xs font-semibold mt-0.5",children:"4"}),e.jsx("p",{children:'Use "Test Print" to verify the connection works properly'})]}),e.jsxs("div",{className:"mt-4 p-3 bg-blue-50 rounded-lg border border-blue-200",children:[e.jsx("h4",{className:"font-semibold text-blue-900 mb-2",children:"XP-P301A Specific Setup:"}),e.jsxs("ul",{className:"text-xs text-blue-800 space-y-1",children:[e.jsx("li",{children:"• Ensure battery is charged (3+ hours printing time)"}),e.jsx("li",{children:"• Use 25-80mm paper width for receipts"}),e.jsx("li",{children:"• Use 25-80mm label paper for labels"}),e.jsx("li",{children:"• Supports both ESC/POS and TSPL emulation"}),e.jsx("li",{children:"• 203 DPI resolution for crisp printing"}),e.jsx("li",{children:"• 70mm/s print speed"})]})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Supported Printers"}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[e.jsx("p",{className:"font-medium text-gray-700",children:"Thermal Receipt Printers:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 ml-2",children:[e.jsx("li",{children:"Star TSP100 series"}),e.jsx("li",{children:"Citizen CT-S310II"}),e.jsx("li",{children:"Epson TM-T88VI"}),e.jsx("li",{children:"Generic ESC/POS printers"})]}),e.jsx("p",{className:"font-medium text-gray-700 mt-3",children:"Dual Function Printers:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 ml-2",children:[e.jsxs("li",{children:[e.jsx("strong",{children:"Xprinter XP-P301A"})," (Receipt & Label)"]}),e.jsx("li",{children:"Other Xprinter mobile models"})]}),e.jsx("p",{className:"font-medium text-gray-700 mt-3",children:"Label Printers:"}),e.jsxs("ul",{className:"list-disc list-inside space-y-1 ml-2",children:[e.jsx("li",{children:"Zebra ZD220"}),e.jsx("li",{children:"Zebra ZD420"}),e.jsx("li",{children:"Zebra ZD620"}),e.jsx("li",{children:"Brother QL-820NWB"}),e.jsx("li",{children:"Dymo LabelWriter 450"}),e.jsx("li",{children:"Generic label printers"})]}),e.jsx("p",{className:"text-xs text-gray-500 mt-3",children:"Most Bluetooth thermal and label printers with ESC/POS or ZPL support should work"})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Troubleshooting"}),e.jsxs("div",{className:"space-y-3 text-sm text-gray-600",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-700",children:"Can't find printer?"}),e.jsx("p",{className:"text-xs",children:"Make sure Bluetooth is enabled and printer is in pairing mode"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-700",children:"Connection fails?"}),e.jsx("p",{className:"text-xs",children:"Try restarting the printer and clearing browser Bluetooth cache"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-700",children:"Print not working?"}),e.jsx("p",{className:"text-xs",children:"Check paper and ensure printer is not in error state"})]})]})]}),e.jsxs("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Browser Support"}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-600",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),e.jsx("span",{children:"Chrome 56+ (Recommended)"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 bg-green-500 rounded-full"}),e.jsx("span",{children:"Edge 79+"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 bg-yellow-500 rounded-full"}),e.jsx("span",{children:"Firefox 55+ (Limited)"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-3 h-3 bg-red-500 rounded-full"}),e.jsx("span",{children:"Safari (Not supported)"})]})]})]})]})]})]})})};export{me as default};
