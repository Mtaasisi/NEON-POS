import{j as e}from"./index-61458a34.js";import{r as h,R as U}from"./vendor-36d2c7c1.js";import{o as q,s as n,l as Z,h as $,n as J,u as O,C as o}from"./forms-ebbdb905.js";import{t as L}from"./zod-78f78e6c.js";import{aw as X,X as p,$ as ee,a as ae,b as te,ag as I,aP as F,n as d}from"./ui-28e30067.js";const re=q({name:n().min(1,"Supplier name is required").max(100,"Supplier name must be less than 100 characters"),company_name:n().max(100,"Company name must be less than 100 characters").optional(),description:n().max(500,"Description must be less than 500 characters").optional(),contact_person:n().max(100,"Contact person must be less than 100 characters").optional(),email:n().email("Invalid email format").max(100,"Email must be less than 100 characters").optional().or(Z("")),phone:n().max(20,"Phone number must be less than 20 characters").optional(),whatsapp:n().max(20,"WhatsApp number must be less than 20 characters").optional(),wechat:n().max(50,"WeChat ID must be less than 50 characters").optional(),address:n().max(200,"Address must be less than 200 characters").optional(),city:n().max(50,"City must be less than 50 characters").optional(),country:n().max(50,"Country must be less than 50 characters").optional(),tax_id:n().max(50,"Tax ID must be less than 50 characters").optional(),payment_terms:n().max(200,"Payment terms must be less than 200 characters").optional(),preferred_currency:n().max(10,"Currency code must be less than 10 characters").optional(),exchange_rate:$([J().min(0,"Exchange rate must be positive"),n()]).optional().transform(a=>{if(a===""||a===void 0||a===null)return;const b=typeof a=="string"?parseFloat(a):a;return isNaN(b)?void 0:b}),notes:n().max(1e3,"Notes must be less than 1000 characters").optional()}),de=({supplier:a,onSubmit:b,onCancel:K,onClose:w,loading:g=!1,className:W=""})=>{const[y,G]=h.useState(!1),[f,v]=h.useState((a==null?void 0:a.wechat_qr_code)||null),[j,C]=h.useState((a==null?void 0:a.alipay_qr_code)||null),[S,B]=h.useState((a==null?void 0:a.bank_account_details)||""),R=U.useRef(null),_=U.useRef(null),{control:s,handleSubmit:Q,formState:{errors:c,isDirty:k},watch:N,reset:A,setValue:E}=O({resolver:L(re),defaultValues:{name:(a==null?void 0:a.name)||"",company_name:(a==null?void 0:a.company_name)||"",description:(a==null?void 0:a.description)||"",contact_person:(a==null?void 0:a.contact_person)||"",email:(a==null?void 0:a.email)||"",phone:(a==null?void 0:a.phone)||"",whatsapp:(a==null?void 0:a.whatsapp)||"",wechat:(a==null?void 0:a.wechat)||"",address:(a==null?void 0:a.address)||"",city:(a==null?void 0:a.city)||"",country:(a==null?void 0:a.country)||"",tax_id:(a==null?void 0:a.tax_id)||"",payment_terms:(a==null?void 0:a.payment_terms)||"",preferred_currency:(a==null?void 0:a.preferred_currency)||"TZS",exchange_rate:(a==null?void 0:a.exchange_rate)||void 0,notes:(a==null?void 0:a.notes)||""}}),u=N("country"),M=N("preferred_currency");N("notes");const H={Tanzania:"TZS",UAE:"AED",China:"CNY","Hong Kong":"HKD",India:"INR",Kenya:"KES",USA:"USD",UK:"GBP",Germany:"EUR",France:"EUR",Japan:"JPY","South Korea":"KRW",Singapore:"SGD",Thailand:"THB",Vietnam:"VND",Malaysia:"MYR",Indonesia:"IDR",Philippines:"PHP",Turkey:"TRY",Egypt:"EGP","South Africa":"ZAR",Nigeria:"NGN",Ghana:"GHS",Uganda:"UGX",Rwanda:"RWF",Ethiopia:"ETB",Morocco:"MAD","Saudi Arabia":"SAR",Pakistan:"PKR"};h.useEffect(()=>{if(u&&!a){const t=H[u];t&&E("preferred_currency",t)}},[u,a,E]);const D=(t,r)=>{var m;const i=(m=t.target.files)==null?void 0:m[0];if(i){if(!i.type.startsWith("image/")){d.error("Please upload an image file");return}if(i.size>2*1024*1024){d.error("Image size should be less than 2MB");return}try{const l=new FileReader;l.onloadend=()=>{try{const x=l.result;if(!x){d.error("Failed to read image file");return}r==="wechat"?(v(x),d.success("WeChat QR code uploaded")):(C(x),d.success("Alipay QR code uploaded"))}catch(x){console.error("Error processing image:",x),d.error("Failed to process image")}},l.onerror=()=>{console.error("FileReader error:",l.error),d.error("Failed to read image file. Please try again.")},l.readAsDataURL(i)}catch(l){console.error("Error uploading QR code:",l),d.error("Failed to upload image. Please try again.")}t.target.value=""}},P=t=>{t==="wechat"?v(null):C(null)},Y=async t=>{try{const r={...t,wechat_qr_code:f||void 0,alipay_qr_code:j||void 0,bank_account_details:S||void 0,is_active:(a==null?void 0:a.is_active)??!0};await b(r),A(t)}catch(r){console.error("Supplier form submission error:",r)}},T=()=>{const t=K||w;t&&(k?confirm("Discard changes?")&&(A(),t()):t())},z=["Tanzania","UAE","China","Hong Kong","India","Kenya","USA","UK","Germany","France","Japan","South Korea","Singapore","Thailand","Vietnam","Malaysia","Indonesia","Philippines","Turkey","Egypt","South Africa","Nigeria","Ghana","Uganda","Rwanda","Ethiopia","Morocco","Saudi Arabia","Pakistan"],V=[{code:"TZS",name:"Tanzanian Shilling"},{code:"USD",name:"US Dollar"},{code:"EUR",name:"Euro"},{code:"GBP",name:"British Pound"},{code:"CNY",name:"Chinese Yuan"},{code:"AED",name:"UAE Dirham"},{code:"INR",name:"Indian Rupee"},{code:"KES",name:"Kenyan Shilling"},{code:"HKD",name:"Hong Kong Dollar"},{code:"JPY",name:"Japanese Yen"},{code:"KRW",name:"South Korean Won"},{code:"SGD",name:"Singapore Dollar"},{code:"THB",name:"Thai Baht"},{code:"VND",name:"Vietnamese Dong"},{code:"MYR",name:"Malaysian Ringgit"},{code:"IDR",name:"Indonesian Rupiah"},{code:"PHP",name:"Philippine Peso"},{code:"TRY",name:"Turkish Lira"},{code:"EGP",name:"Egyptian Pound"},{code:"ZAR",name:"South African Rand"},{code:"NGN",name:"Nigerian Naira"},{code:"GHS",name:"Ghanaian Cedi"},{code:"UGX",name:"Ugandan Shilling"},{code:"RWF",name:"Rwandan Franc"},{code:"ETB",name:"Ethiopian Birr"},{code:"MAD",name:"Moroccan Dirham"},{code:"SAR",name:"Saudi Riyal"},{code:"PKR",name:"Pakistani Rupee"}];return e.jsx("div",{className:`bg-white rounded-lg shadow-xl max-w-4xl w-full max-h-[90vh] overflow-y-auto ${W}`,children:e.jsxs("form",{onSubmit:Q(Y),className:"p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-6",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:e.jsx(X,{className:"w-5 h-5 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-xl font-bold text-gray-900",children:a?"Edit Supplier":"Add New Supplier"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Update supplier information"})]})]}),w&&e.jsx("button",{type:"button",onClick:T,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(p,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-4",children:"Supplier Identity"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsxs("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Supplier Name ",e.jsx("span",{className:"text-red-500",children:"*"})]}),e.jsx(o,{name:"name",control:s,render:({field:t})=>e.jsx("input",{type:"text",...t,placeholder:"Enter supplier name",className:`w-full px-4 py-3 border-2 rounded-lg focus:outline-none transition-colors text-gray-900 ${c.name?"border-red-500 focus:border-red-600":"border-gray-200 focus:border-blue-500"}`})}),c.name&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:c.name.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Company Name"}),e.jsx(o,{name:"company_name",control:s,render:({field:t})=>e.jsx("input",{type:"text",...t,placeholder:"Enter company name",className:"w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:border-blue-500 transition-colors text-gray-900"})})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Contact Person"}),e.jsx(o,{name:"contact_person",control:s,render:({field:t})=>e.jsx("input",{type:"text",...t,placeholder:"Enter contact person name",className:"w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:border-blue-500 transition-colors text-gray-900"})})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-4",children:"Contact Details"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Phone Number"}),e.jsx(o,{name:"phone",control:s,render:({field:t})=>e.jsx("input",{type:"tel",...t,placeholder:"+255 123 456 789",className:"w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:border-blue-500 transition-colors text-gray-900"})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Email"}),e.jsx(o,{name:"email",control:s,render:({field:t})=>e.jsx("input",{type:"email",...t,placeholder:"supplier@example.com",className:`w-full px-4 py-3 border-2 rounded-lg focus:outline-none transition-colors text-gray-900 ${c.email?"border-red-500 focus:border-red-600":"border-gray-200 focus:border-blue-500"}`})}),c.email&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:c.email.message})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"WhatsApp"}),e.jsxs("div",{className:"relative",children:[e.jsx(o,{name:"whatsapp",control:s,render:({field:t})=>e.jsx("input",{type:"tel",...t,placeholder:"+255 123 456 789",className:"w-full px-4 py-3 pr-10 border-2 border-gray-200 rounded-lg focus:outline-none focus:border-blue-500 transition-colors text-gray-900"})}),e.jsx(ee,{className:"absolute right-3 top-1/2 -translate-y-1/2 w-5 h-5 text-green-500"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"WeChat ID"}),e.jsxs("div",{className:"relative",children:[e.jsx(o,{name:"wechat",control:s,render:({field:t})=>e.jsx("input",{type:"text",...t,placeholder:"Enter WeChat ID",className:"w-full px-4 py-3 pr-10 border-2 border-gray-200 rounded-lg focus:outline-none focus:border-blue-500 transition-colors text-gray-900"})}),e.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2 w-5 h-5 bg-green-600 rounded-sm flex items-center justify-center",children:e.jsx("span",{className:"text-white text-xs font-bold",children:"W"})})]})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-4",children:"Location"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Country"}),e.jsx(o,{name:"country",control:s,render:({field:t})=>e.jsxs("select",{...t,className:"w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:border-blue-500 transition-colors text-gray-900",children:[e.jsx("option",{value:"",children:"Select country"}),z.map(r=>e.jsx("option",{value:r,children:r},r))]})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"City"}),e.jsx(o,{name:"city",control:s,render:({field:t})=>e.jsx("input",{type:"text",...t,placeholder:"Enter city",className:"w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:border-blue-500 transition-colors text-gray-900"})})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Address"}),e.jsx(o,{name:"address",control:s,render:({field:t})=>e.jsx("textarea",{...t,rows:2,placeholder:"Enter full street address",className:"w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:border-blue-500 transition-colors text-gray-900 resize-none"})})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-4",children:"Financial Terms"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Preferred Currency"}),e.jsx(o,{name:"preferred_currency",control:s,render:({field:t})=>e.jsxs("select",{...t,className:"w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:border-blue-500 transition-colors text-gray-900",children:[e.jsx("option",{value:"",children:"Select currency"}),V.map(r=>e.jsxs("option",{value:r.code,children:[r.code," - ",r.name]},r.code))]})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Exchange Rate"}),e.jsx(o,{name:"exchange_rate",control:s,render:({field:t})=>{var r;return e.jsx("input",{type:"number",step:"0.01",min:"0",value:((r=t.value)==null?void 0:r.toString())||"",onChange:i=>{const m=i.target.value;if(m==="")t.onChange(void 0);else{const l=parseFloat(m);t.onChange(isNaN(l)?void 0:l)}},placeholder:`1 ${M||"USD"} = ? TZS`,className:`w-full px-4 py-3 border-2 rounded-lg focus:outline-none transition-colors text-gray-900 ${c.exchange_rate?"border-red-500 focus:border-red-600":"border-gray-200 focus:border-blue-500"}`})}}),c.exchange_rate&&e.jsx("p",{className:"text-red-500 text-sm mt-1",children:c.exchange_rate.message})]})]})]}),e.jsxs("div",{className:"mb-6",children:[e.jsxs("button",{type:"button",onClick:()=>G(!y),className:"w-full flex items-center justify-between p-4 bg-gray-50 hover:bg-gray-100 rounded-lg transition-colors border-2 border-gray-200",children:[e.jsx("span",{className:"text-sm font-semibold text-gray-700",children:"Advanced Options"}),y?e.jsx(ae,{className:"w-5 h-5 text-gray-600"}):e.jsx(te,{className:"w-5 h-5 text-gray-600"})]}),y&&e.jsxs("div",{className:"mt-4 p-4 border-2 border-gray-200 rounded-lg bg-gray-50/50",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Tax ID"}),e.jsx(o,{name:"tax_id",control:s,render:({field:t})=>e.jsx("input",{type:"text",...t,placeholder:"Enter tax identification number",className:"w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:border-blue-500 transition-colors text-gray-900 bg-white"})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Payment Terms"}),e.jsx(o,{name:"payment_terms",control:s,render:({field:t})=>e.jsx("input",{type:"text",...t,placeholder:"e.g., Net 30, Net 60, COD",className:"w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:border-blue-500 transition-colors text-gray-900 bg-white"})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Description"}),e.jsx(o,{name:"description",control:s,render:({field:t})=>e.jsx("textarea",{...t,rows:3,placeholder:"Brief description of the supplier",className:"w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:border-blue-500 transition-colors text-gray-900 resize-none bg-white"})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes"}),e.jsx(o,{name:"notes",control:s,render:({field:t})=>e.jsx("textarea",{...t,rows:3,placeholder:"Any additional information about this supplier",className:"w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:border-blue-500 transition-colors text-gray-900 resize-none bg-white"})})]})]}),u==="China"&&e.jsxs("div",{className:"mt-6 pt-6 border-t-2 border-gray-300",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-4",children:[e.jsx("h5",{className:"text-sm font-semibold text-gray-700",children:"Payment Information"}),e.jsx("span",{className:"text-xs bg-red-50 text-red-600 px-2 py-0.5 rounded-full",children:"ðŸ‡¨ðŸ‡³ China"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"WeChat Pay QR Code"}),f?e.jsxs("div",{className:"relative w-full h-32 border-2 border-green-300 rounded-lg overflow-hidden bg-green-50",children:[e.jsx("img",{src:f,alt:"WeChat QR Code",className:"w-full h-full object-contain"}),e.jsx("button",{type:"button",onClick:()=>P("wechat"),className:"absolute top-2 right-2 p-1 bg-red-500 text-white rounded-full hover:bg-red-600 transition-colors",children:e.jsx(p,{className:"w-3 h-3"})}),e.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-green-600/90 text-white text-xs py-1 px-2 flex items-center gap-1",children:[e.jsx(F,{className:"w-3 h-3"}),"WeChat Pay"]})]}):e.jsxs("div",{onClick:()=>{var t;return(t=R.current)==null?void 0:t.click()},className:"flex flex-col items-center justify-center w-full h-32 border-2 border-dashed border-gray-300 rounded-lg cursor-pointer hover:border-green-500 hover:bg-green-50 transition-colors bg-white",children:[e.jsx(I,{className:"w-6 h-6 text-gray-400 mb-1"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Upload WeChat QR"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Click to browse"}),e.jsx("input",{ref:R,type:"file",className:"hidden",accept:"image/*",onChange:t=>D(t,"wechat")})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Alipay QR Code"}),j?e.jsxs("div",{className:"relative w-full h-32 border-2 border-blue-300 rounded-lg overflow-hidden bg-blue-50",children:[e.jsx("img",{src:j,alt:"Alipay QR Code",className:"w-full h-full object-contain"}),e.jsx("button",{type:"button",onClick:()=>P("alipay"),className:"absolute top-2 right-2 p-1 bg-red-500 text-white rounded-full hover:bg-red-600 transition-colors",children:e.jsx(p,{className:"w-3 h-3"})}),e.jsxs("div",{className:"absolute bottom-0 left-0 right-0 bg-blue-600/90 text-white text-xs py-1 px-2 flex items-center gap-1",children:[e.jsx(F,{className:"w-3 h-3"}),"Alipay"]})]}):e.jsxs("div",{onClick:()=>{var t;return(t=_.current)==null?void 0:t.click()},className:"flex flex-col items-center justify-center w-full h-32 border-2 border-dashed border-gray-300 rounded-lg cursor-pointer hover:border-blue-500 hover:bg-blue-50 transition-colors bg-white",children:[e.jsx(I,{className:"w-6 h-6 text-gray-400 mb-1"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Upload Alipay QR"}),e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:"Click to browse"}),e.jsx("input",{ref:_,type:"file",className:"hidden",accept:"image/*",onChange:t=>D(t,"alipay")})]})]}),e.jsxs("div",{className:"md:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Bank Account Details"}),e.jsx("textarea",{value:S,onChange:t=>B(t.target.value),rows:2,placeholder:"Bank name, Account number, SWIFT/BIC code, etc.",className:"w-full px-4 py-3 border-2 border-gray-200 rounded-lg focus:outline-none focus:border-blue-500 transition-colors text-gray-900 resize-none bg-white"})]})]})]})]})]}),e.jsxs("div",{className:"flex gap-3 pt-4 border-t border-gray-200",children:[e.jsx("button",{type:"button",onClick:T,disabled:g,className:"flex-1 px-4 py-3 border-2 border-gray-200 rounded-lg text-gray-700 font-medium hover:bg-gray-50 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:g||!k,className:"flex-1 px-4 py-3 bg-blue-600 text-white rounded-lg font-medium hover:bg-blue-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed",children:g?"Saving...":a?"Update Supplier":"Create Supplier"})]})]})})};export{de as S};
