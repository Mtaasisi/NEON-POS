import{_ as E}from"./supabase-cf010ec4.js";import{aj as P,a1 as T,s as c}from"./index-61458a34.js";import{customerCacheService as K}from"./customerCacheService-9b459c09.js";import{childVariantsCacheService as N}from"./childVariantsCacheService-9368f4c7.js";import"./vendor-36d2c7c1.js";import"./routing-eb8c310c.js";import"./ui-28e30067.js";class ${constructor(){this.STORAGE_KEY="pos_full_database",this.VERSION="1.0"}async downloadFullDatabase(e){const s=Date.now(),o=[{name:"products",fn:()=>this.downloadProducts()},{name:"customers",fn:()=>this.downloadCustomers()},{name:"categories",fn:()=>this.downloadCategories()},{name:"suppliers",fn:()=>this.downloadSuppliers()},{name:"paymentMethods",fn:()=>this.downloadPaymentMethods()},{name:"paymentAccounts",fn:()=>this.downloadPaymentAccounts()},{name:"variants",fn:()=>this.downloadVariants()},{name:"childVariants",fn:()=>this.downloadChildVariants()},{name:"employees",fn:()=>this.downloadEmployees()},{name:"branches",fn:()=>this.downloadBranches()},{name:"installmentPlans",fn:()=>this.downloadInstallmentPlans()},{name:"recentSales",fn:()=>this.downloadRecentSales()},{name:"stockLevels",fn:()=>this.downloadStockLevels()},{name:"settings",fn:()=>this.downloadSettings()}],t={success:!1,data:{products:0,customers:0,categories:0,suppliers:0,paymentMethods:0,paymentAccounts:0,variants:0,childVariants:0,employees:0,branches:0,installmentPlans:0,recentSales:0,stockLevels:0,settings:0},timestamp:new Date().toISOString()};try{for(let r=0;r<o.length;r++){const a=o[r];e&&e({current:r+1,total:o.length,currentTask:a.name,percentage:Math.round((r+1)/o.length*100)});const i=await a.fn();t.data[a.name]=i.length,a.name==="products"?P.saveProducts(i):a.name==="customers"&&K.saveCustomers(i);const g=T.getState();if(a.name==="products")g.setProducts(i);else if(a.name==="customers")g.setCustomers(i);else if(a.name==="categories")g.setCategories(i);else if(a.name==="suppliers")g.setSuppliers(i);else if(a.name==="paymentMethods")g.setPaymentMethods(i);else if(a.name==="paymentAccounts")g.setPaymentAccounts(i);else if(a.name==="variants")g.setParentVariants(i);else if(a.name==="childVariants")g.setChildVariants(i);else if(a.name==="employees")g.setEmployees(i);else if(a.name==="branches")g.setBranches(i);else if(a.name==="installmentPlans"){const{installmentCacheService:u}=await E(()=>import("./index-61458a34.js").then(D=>D.bl),["assets/index-61458a34.js","assets/vendor-36d2c7c1.js","assets/supabase-cf010ec4.js","assets/routing-eb8c310c.js","assets/ui-28e30067.js","assets/index-e1f77ed5.css"]),w=localStorage.getItem("current_branch_id");w&&u.saveInstallments(i,w)}else a.name==="recentSales"?localStorage.setItem("pos_recent_sales_cache",JSON.stringify({data:i,timestamp:Date.now(),version:"1.0"})):a.name==="stockLevels"?localStorage.setItem("pos_stock_levels_cache",JSON.stringify({data:i,timestamp:Date.now(),version:"1.0"})):a.name==="settings"&&localStorage.setItem("pos_settings_cache",JSON.stringify({data:i,timestamp:Date.now(),version:"1.0"}))}const n={version:this.VERSION,timestamp:new Date().toISOString(),downloadTime:Date.now()-s,data:t.data};localStorage.setItem(this.STORAGE_KEY,JSON.stringify(n)),t.success=!0,console.log("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"),console.log("âœ… [FullDatabaseDownload] DOWNLOAD COMPLETED"),console.log("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”");const _=Object.values(t.data).reduce((r,a)=>r+a,0);console.log("ğŸ“Š Download Summary:",{totalItems:_,products:t.data.products,customers:t.data.customers,categories:t.data.categories,suppliers:t.data.suppliers,variants:t.data.variants,childVariants:t.data.childVariants,employees:t.data.employees,branches:t.data.branches,paymentMethods:t.data.paymentMethods,paymentAccounts:t.data.paymentAccounts,installmentPlans:t.data.installmentPlans,recentSales:t.data.recentSales,stockLevels:t.data.stockLevels,settings:t.data.settings,downloadTime:`${(Date.now()-s)/1e3}s`}),console.log("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"),console.log("ğŸ” [Verification] Checking all downloaded data..."),console.log("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”");const l=T.getState(),d={};if(t.data.products>0){const{productCacheService:r}=await E(()=>import("./index-61458a34.js").then(w=>w.bi),["assets/index-61458a34.js","assets/vendor-36d2c7c1.js","assets/supabase-cf010ec4.js","assets/routing-eb8c310c.js","assets/ui-28e30067.js","assets/index-e1f77ed5.css"]),a=r.getProducts(),i=l.products,g=(a==null?void 0:a.filter(w=>w.variants&&w.variants.length>0).length)||0,u=(a==null?void 0:a.reduce((w,D)=>{var A;return w+(((A=D.variants)==null?void 0:A.length)||0)},0))||0;d.products={downloaded:t.data.products,inCache:(a==null?void 0:a.length)||0,inStore:i.length,withVariants:g,totalVariants:u,status:((a==null?void 0:a.length)||0)===t.data.products&&i.length===t.data.products?"âœ… OK":"âš ï¸ MISMATCH"},g===0&&(d.products.warning="âš ï¸ No products have variants!")}if(t.data.customers>0){const{customerCacheService:r}=await E(()=>import("./customerCacheService-9b459c09.js"),[]),a=r.getCustomers(),i=l.customers;d.customers={downloaded:t.data.customers,inCache:(a==null?void 0:a.length)||0,inStore:i.length,status:((a==null?void 0:a.length)||0)===t.data.customers&&i.length===t.data.customers?"âœ… OK":"âš ï¸ MISMATCH"}}if(t.data.categories>0){const r=l.categories;d.categories={downloaded:t.data.categories,inStore:r.length,status:r.length===t.data.categories?"âœ… OK":"âš ï¸ MISMATCH"}}if(t.data.suppliers>0){const r=l.suppliers;d.suppliers={downloaded:t.data.suppliers,inStore:r.length,status:r.length===t.data.suppliers?"âœ… OK":"âš ï¸ MISMATCH"}}if(t.data.paymentMethods>0){const r=l.paymentMethods;d.paymentMethods={downloaded:t.data.paymentMethods,inStore:r.length,status:r.length===t.data.paymentMethods?"âœ… OK":"âš ï¸ MISMATCH"}}if(t.data.paymentAccounts>0){const r=l.paymentAccounts;d.paymentAccounts={downloaded:t.data.paymentAccounts,inStore:r.length,status:r.length===t.data.paymentAccounts?"âœ… OK":"âš ï¸ MISMATCH"}}if(t.data.variants>0){const r=l.parentVariants;d.variants={downloaded:t.data.variants,inStore:r.length,status:r.length===t.data.variants?"âœ… OK":"âš ï¸ MISMATCH"}}if(t.data.childVariants>0){const r=l.childVariants;d.childVariants={downloaded:t.data.childVariants,inStore:r.length,status:r.length===t.data.childVariants?"âœ… OK":"âš ï¸ MISMATCH"}}if(t.data.employees>0){const r=l.employees;d.employees={downloaded:t.data.employees,inStore:r.length,status:r.length===t.data.employees?"âœ… OK":"âš ï¸ MISMATCH"}}if(t.data.branches>0){const r=l.branches;d.branches={downloaded:t.data.branches,inStore:r.length,status:r.length===t.data.branches?"âœ… OK":"âš ï¸ MISMATCH"}}try{const r=localStorage.getItem("pos_recent_sales_cache"),a=r?JSON.parse(r).data:[];d.recentSales={downloaded:t.data.recentSales,inCache:a.length,status:a.length===t.data.recentSales?"âœ… OK":"âš ï¸ MISMATCH"}}catch{d.recentSales={downloaded:t.data.recentSales,inCache:0,status:"âŒ ERROR"}}try{const r=localStorage.getItem("pos_stock_levels_cache"),a=r?JSON.parse(r).data:[];d.stockLevels={downloaded:t.data.stockLevels,inCache:a.length,status:a.length===t.data.stockLevels?"âœ… OK":"âš ï¸ MISMATCH"}}catch{d.stockLevels={downloaded:t.data.stockLevels,inCache:0,status:"âŒ ERROR"}}try{const r=localStorage.getItem("pos_settings_cache"),a=r?JSON.parse(r).data:[];d.settings={downloaded:t.data.settings,inCache:Array.isArray(a)?a.length:a?1:0,status:"âœ… OK"}}catch{d.settings={downloaded:t.data.settings,inCache:0,status:"âŒ ERROR"}}console.log("ğŸ“‹ Verification Results:"),Object.entries(d).forEach(([r,a])=>{console.log(`  ${r}:`,a)});const h=Object.values(d).every(r=>r.status==="âœ… OK"),v=Object.values(d).some(r=>r.status==="âš ï¸ MISMATCH"||r.warning),f=Object.values(d).some(r=>r.status==="âŒ ERROR");return console.log("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"),h&&!v?console.log("âœ… [Verification] ALL DATA TYPES VERIFIED SUCCESSFULLY"):f?console.error("âŒ [Verification] SOME DATA TYPES HAVE ERRORS"):console.warn("âš ï¸ [Verification] SOME DATA TYPES HAVE WARNINGS"),console.log("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"),console.log("ğŸ’¾ Storage:",{timestamp:new Date().toISOString(),version:this.VERSION}),console.log("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"),console.log("ğŸ” [Download] Running automatic verification..."),(await this.verifyAllData()).allOk||console.warn("âš ï¸ [Download] Verification found issues - please check console logs above"),t}catch(n){return console.error("âŒ [FullDatabaseDownload] Download failed:",n),t.error=n instanceof Error?n.message:"Unknown error",t}}async downloadProducts(){try{console.log("ğŸ” [Download] Starting product download with variants...");const e=localStorage.getItem("current_branch_id");let s=null;if(e){const{data:a}=await c.from("store_locations").select("id, name, data_isolation_mode, share_products").eq("id",e).single();s=a}let o=c.from("lats_products").select("id, name, description, sku, barcode, category_id, supplier_id, cost_price, stock_quantity, min_stock_level, max_stock_level, is_active, image_url, brand, model, warranty_period, created_at, updated_at, specification, condition, selling_price, total_quantity, total_value, storage_room_id, shelf_id, branch_id, is_shared, sharing_mode, visible_to_branches").eq("is_active",!0).order("created_at",{ascending:!1});e&&s?s.data_isolation_mode==="isolated"?o=o.eq("branch_id",e):s.data_isolation_mode==="shared"||s.data_isolation_mode==="hybrid"&&(s.share_products||(o=o.eq("branch_id",e))):e&&(o=o.or(`branch_id.eq.${e},branch_id.is.null,is_shared.eq.true`));const{data:t,error:n}=await o;if(n)throw n;if(!t||t.length===0)return console.warn("âš ï¸ [Download] No products found"),[];console.log(`âœ… [Download] Fetched ${t.length} products, now fetching variants...`);const _=t.map(a=>a.id).filter(Boolean);if(_.length===0)return t.map(a=>({...a,variants:[]}));let l=c.from("lats_product_variants").select("id, product_id, name, variant_name, sku, attributes, variant_attributes, cost_price, selling_price, quantity, reserved_quantity, min_quantity, created_at, updated_at, branch_id, is_shared, is_parent, variant_type, parent_variant_id").in("product_id",_).is("parent_variant_id",null).eq("is_active",!0).order("name");e&&s?s.data_isolation_mode==="isolated"?(l=l.eq("branch_id",e),console.log(`ğŸ”’ [Download] ISOLATED MODE - Variants: Only showing from branch ${e}`)):s.data_isolation_mode==="shared"?console.log("ğŸ“Š [Download] SHARED MODE - Variants: Showing all variants"):s.data_isolation_mode==="hybrid"&&(s.share_inventory?(l=l.or(`branch_id.eq.${e},is_shared.eq.true,branch_id.is.null`),console.log(`âš–ï¸ [Download] HYBRID MODE - Variants are SHARED - Showing branch ${e} + shared variants`)):(l=l.eq("branch_id",e),console.log(`âš–ï¸ [Download] HYBRID MODE - Variants are NOT SHARED - Only showing branch ${e}`))):e&&(l=l.or(`branch_id.eq.${e},branch_id.is.null`));const{data:d,error:h}=await l;h&&console.warn("âš ï¸ [Download] Error fetching variants:",h);const v=d||[];console.log(`âœ… [Download] Fetched ${v.length} variants`);const f=new Map;v.forEach(a=>{f.has(a.product_id)||f.set(a.product_id,[]),f.get(a.product_id).push(a)});const S=t.map(a=>{const i=f.get(a.id)||[],g=i[0];return{id:a.id,name:a.name,description:a.description,sku:a.sku,barcode:a.barcode,specification:a.specification,images:a.image_url?[a.image_url]:[],image_url:a.image_url||null,categoryId:a.category_id,supplierId:a.supplier_id,isActive:a.is_active,price:a.selling_price||(g==null?void 0:g.selling_price)||0,costPrice:a.cost_price||(g==null?void 0:g.cost_price)||0,stockQuantity:a.stock_quantity||0,minStockLevel:a.min_stock_level||0,totalQuantity:a.total_quantity||0,totalValue:a.total_value||0,createdAt:a.created_at,updatedAt:a.updated_at,variants:i.map(u=>({id:u.id,productId:u.product_id,sku:u.sku,name:u.variant_name||u.name||"Unnamed",attributes:u.variant_attributes||u.attributes||{},costPrice:u.cost_price||0,sellingPrice:u.selling_price||0,price:u.selling_price||0,stockQuantity:u.quantity||0,minStockLevel:u.min_quantity||0,quantity:u.quantity||0,minQuantity:u.min_quantity||0,weight:null,dimensions:null,createdAt:u.created_at,updatedAt:u.updated_at}))}}),r=S.filter(a=>a.variants.length>0).length;return console.log(`âœ… [Download] Products with variants: ${r} / ${S.length}`),S}catch(e){throw console.error("âŒ [Download] Error downloading products:",e),e}}async downloadCustomers(){const{data:e,error:s}=await c.from("customers").select("*").order("created_at",{ascending:!1});if(s)throw s;return e||[]}async downloadCategories(){try{let{data:e,error:s}=await c.from("lats_categories").select("*").eq("is_active",!0).order("name",{ascending:!0});if(s||!e||e.length===0){console.log("â„¹ï¸ [Download] Trying categories without is_active filter...");const{data:o,error:t}=await c.from("lats_categories").select("*").order("name",{ascending:!0});!t&&o&&(e=o,s=null)}if(s){console.warn("âš ï¸ [Download] lats_categories not found, trying legacy categories table");const{data:o,error:t}=await c.from("categories").select("*").order("name",{ascending:!0});return t?(console.warn("âš ï¸ [Download] Legacy categories table also failed:",t),[]):o||[]}return e||[]}catch(e){return console.warn("âš ï¸ [Download] Failed to download categories:",e),[]}}async downloadSuppliers(){try{let{data:e,error:s}=await c.from("lats_suppliers").select("*").eq("is_active",!0).order("name",{ascending:!0});if(s||!e||e.length===0){console.log("â„¹ï¸ [Download] Trying suppliers without is_active filter...");const{data:o,error:t}=await c.from("lats_suppliers").select("*").order("name",{ascending:!0});!t&&o&&(e=o,s=null)}if(s){console.warn("âš ï¸ [Download] lats_suppliers not found, trying legacy suppliers table");const{data:o,error:t}=await c.from("suppliers").select("*").order("name",{ascending:!0});return t?(console.warn("âš ï¸ [Download] Legacy suppliers table also failed:",t),[]):o||[]}return e||[]}catch(e){return console.warn("âš ï¸ [Download] Failed to download suppliers:",e),[]}}async downloadPaymentMethods(){try{const{data:e,error:s}=await c.from("finance_accounts").select("*").eq("is_active",!0).eq("is_payment_method",!0).order("name",{ascending:!0});if(s){console.log("â„¹ï¸ [Download] Trying legacy payment_methods table...");const{data:o,error:t}=await c.from("payment_methods").select("*").order("name",{ascending:!0});return!t&&o?o||[]:(console.warn("âš ï¸ [Download] Payment methods not found:",s),[])}return e||[]}catch(e){return console.warn("âš ï¸ [Download] Failed to download payment methods:",e),[]}}async downloadPaymentAccounts(){try{let{data:e,error:s}=await c.from("finance_accounts").select("*").eq("is_active",!0).order("name",{ascending:!0});if(s||!e||e.length===0){console.log("â„¹ï¸ [Download] Trying payment accounts without is_active filter...");const{data:o,error:t}=await c.from("finance_accounts").select("*").order("name",{ascending:!0});!t&&o&&(e=o,s=null)}return s?(console.warn("âš ï¸ [Download] Failed to download payment accounts:",s),[]):e||[]}catch(e){return console.warn("âš ï¸ [Download] Failed to download payment accounts:",e),[]}}async downloadVariants(){const{data:e,error:s}=await c.from("lats_product_variants").select("*").is("parent_variant_id",null).eq("is_active",!0).order("variant_name");if(s)throw s;return e||[]}async downloadChildVariants(){const{data:e,error:s}=await c.from("lats_product_variants").select("*").eq("variant_type","imei_child").eq("is_active",!0).gt("quantity",0).order("created_at",{ascending:!1});if(s)throw s;return e||[]}async downloadEmployees(){try{let{data:e,error:s}=await c.from("lats_employees").select("*").eq("is_active",!0).order("name",{ascending:!0});if(s||!e||e.length===0){console.log("â„¹ï¸ [Download] Trying lats_employees without is_active filter...");const{data:o,error:t}=await c.from("lats_employees").select("*").order("name",{ascending:!0});!t&&o&&(e=o,s=null)}if(s||!e||e.length===0){console.log("â„¹ï¸ [Download] Trying legacy employees table...");const{data:o,error:t}=await c.from("employees").select("*").or("is_active.eq.true,status.eq.active").order("full_name",{ascending:!0});if(!t&&o&&o.length>0)return o||[]}return s?(console.warn("âš ï¸ [Download] Failed to download employees:",s),[]):e||[]}catch(e){return console.warn("âš ï¸ [Download] Failed to download employees:",e),[]}}async downloadBranches(){const{data:e,error:s}=await c.from("store_locations").select("*").eq("is_active",!0).order("name",{ascending:!0});if(s)throw s;return e||[]}async downloadInstallmentPlans(){try{const e=localStorage.getItem("current_branch_id");let s=c.from("customer_installment_plans").select("*").in("status",["active","pending"]).order("created_at",{ascending:!1}).limit(1e3);e&&(s=s.eq("branch_id",e));const{data:o,error:t}=await s;return t?(console.warn("âš ï¸ [Download] Failed to download installment plans:",t),[]):o||[]}catch(e){return console.warn("âš ï¸ [Download] Failed to download installment plans:",e),[]}}async downloadRecentSales(){const e=localStorage.getItem("current_branch_id"),s=new Date;s.setDate(s.getDate()-7);try{let o=c.from("lats_sales").select("id, sale_number, customer_id, total_amount, payment_status, created_at, branch_id").gte("created_at",s.toISOString()).order("created_at",{ascending:!1}).limit(500);e&&(o=o.eq("branch_id",e));const{data:t,error:n}=await o;if(n)throw n;return t||[]}catch(o){return console.warn("âš ï¸ [Download] Failed to download recent sales:",o),[]}}async downloadStockLevels(){try{const{data:e,error:s}=await c.from("lats_product_variants").select("id, variant_name, sku, quantity, product_id, is_active").eq("is_active",!0).gt("quantity",0).order("quantity",{ascending:!1});if(s)throw s;return e||[]}catch(e){return console.warn("âš ï¸ [Download] Failed to download stock levels:",e),[]}}async downloadSettings(){var e,s,o;try{const t={};try{const{data:n,error:_}=await c.from("lats_pos_general_settings").select("*").limit(1).maybeSingle();!_&&n&&(t.general=n)}catch(n){(n==null?void 0:n.code)==="42P01"||(e=n==null?void 0:n.message)!=null&&e.includes("does not exist")?console.log("â„¹ï¸ [Download] General settings table not found (optional)"):console.warn("âš ï¸ [Download] Failed to download general settings:",n)}try{const{data:n,error:_}=await c.from("settings").select("key, value").limit(100);!_&&n&&n.length>0&&(t.legacy=n)}catch(n){((n==null?void 0:n.code)==="42P01"||(s=n==null?void 0:n.message)!=null&&s.includes("does not exist"))&&console.log("â„¹ï¸ [Download] Legacy settings table not found (optional)")}try{const{data:n,error:_}=await c.from("lats_pos_dynamic_pricing_settings").select("*").limit(1).maybeSingle();!_&&n&&(t.pricing=n)}catch(n){((n==null?void 0:n.code)==="42P01"||(o=n==null?void 0:n.message)!=null&&o.includes("does not exist"))&&console.log("â„¹ï¸ [Download] Pricing settings table not found (optional)")}return[t]}catch(t){return console.warn("âš ï¸ [Download] Failed to download settings:",t),[]}}getDownloadMetadata(){try{const e=localStorage.getItem(this.STORAGE_KEY);return e?JSON.parse(e):null}catch{return null}}isDownloaded(){const e=this.getDownloadMetadata();if(!e)return!1;const s=new Date(e.timestamp).getTime();return Date.now()-s<24*60*60*1e3}clearDownload(){localStorage.removeItem(this.STORAGE_KEY),localStorage.removeItem("pos_recent_sales_cache"),localStorage.removeItem("pos_stock_levels_cache"),localStorage.removeItem("pos_settings_cache"),P.clearProducts(),K.clearCustomers(),N.clearCache();try{const{installmentCacheService:e}=require("../lib/installmentCacheService"),s=localStorage.getItem("current_branch_id");s&&e.clearInstallments(s)}catch(e){console.warn("âš ï¸ [Download] Failed to clear installment cache:",e)}}async verifyAllData(){console.log("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"),console.log("ğŸ” [Data Verification] Checking all downloaded data..."),console.log("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”");const e=this.getDownloadMetadata();if(!e)return console.log("âŒ [Verification] No database downloaded"),{allOk:!1,results:{},summary:"No database downloaded"};const s=T.getState(),o={},{productCacheService:t}=await E(()=>import("./index-61458a34.js").then(m=>m.bi),["assets/index-61458a34.js","assets/vendor-36d2c7c1.js","assets/supabase-cf010ec4.js","assets/routing-eb8c310c.js","assets/ui-28e30067.js","assets/index-e1f77ed5.css"]),n=t.getProducts(),_=s.products,l=e.data.products||0;if(l>0){const m=(n==null?void 0:n.filter(y=>y.variants&&y.variants.length>0).length)||0,p=(n==null?void 0:n.reduce((y,F)=>{var H;return y+(((H=F.variants)==null?void 0:H.length)||0)},0))||0;o.products={expected:l,inCache:(n==null?void 0:n.length)||0,inStore:_.length,withVariants:m,totalVariants:p,variantCoverage:n!=null&&n.length?Math.round(m/n.length*100)+"%":"0%",status:((n==null?void 0:n.length)||0)===l&&_.length===l?"âœ… OK":"âš ï¸ MISMATCH",issues:[]},m===0&&l>0&&o.products.issues.push("No products have variants"),((n==null?void 0:n.length)||0)!==l&&o.products.issues.push(`Cache mismatch: expected ${l}, got ${(n==null?void 0:n.length)||0}`)}const{customerCacheService:d}=await E(()=>import("./customerCacheService-9b459c09.js"),[]),h=d.getCustomers(),v=s.customers,f=e.data.customers||0;f>0&&(o.customers={expected:f,inCache:(h==null?void 0:h.length)||0,inStore:v.length,status:((h==null?void 0:h.length)||0)===f&&v.length===f?"âœ… OK":"âš ï¸ MISMATCH",issues:[]},((h==null?void 0:h.length)||0)!==f&&o.customers.issues.push(`Cache mismatch: expected ${f}, got ${(h==null?void 0:h.length)||0}`));const S=s.categories,r=e.data.categories||0;r>0&&(o.categories={expected:r,inStore:S.length,status:S.length===r?"âœ… OK":"âš ï¸ MISMATCH",issues:[]},S.length!==r&&o.categories.issues.push(`Store mismatch: expected ${r}, got ${S.length}`));const a=s.suppliers,i=e.data.suppliers||0;i>0&&(o.suppliers={expected:i,inStore:a.length,status:a.length===i?"âœ… OK":"âš ï¸ MISMATCH",issues:[]});const g=s.paymentMethods,u=e.data.paymentMethods||0;u>0&&(o.paymentMethods={expected:u,inStore:g.length,status:g.length===u?"âœ… OK":"âš ï¸ MISMATCH",issues:[]});const w=s.paymentAccounts,D=e.data.paymentAccounts||0;D>0&&(o.paymentAccounts={expected:D,inStore:w.length,status:w.length===D?"âœ… OK":"âš ï¸ MISMATCH",issues:[]});const A=s.parentVariants,M=e.data.variants||0;M>0&&(o.variants={expected:M,inStore:A.length,status:A.length===M?"âœ… OK":"âš ï¸ MISMATCH",issues:[]});const k=s.childVariants,b=e.data.childVariants||0;b>0&&(o.childVariants={expected:b,inStore:k.length,status:k.length===b?"âœ… OK":"âš ï¸ MISMATCH",issues:[]});const R=s.employees,C=e.data.employees||0;C>0&&(o.employees={expected:C,inStore:R.length,status:R.length===C?"âœ… OK":"âš ï¸ MISMATCH",issues:[]});const q=s.branches,I=e.data.branches||0;I>0&&(o.branches={expected:I,inStore:q.length,status:q.length===I?"âœ… OK":"âš ï¸ MISMATCH",issues:[]});try{const m=localStorage.getItem("pos_recent_sales_cache"),p=m?JSON.parse(m).data:[],y=e.data.recentSales||0;y>0&&(o.recentSales={expected:y,inCache:p.length,status:p.length===y?"âœ… OK":"âš ï¸ MISMATCH",issues:[]})}catch{o.recentSales={expected:e.data.recentSales||0,inCache:0,status:"âŒ ERROR",issues:["Failed to read cache"]}}try{const m=localStorage.getItem("pos_stock_levels_cache"),p=m?JSON.parse(m).data:[],y=e.data.stockLevels||0;y>0&&(o.stockLevels={expected:y,inCache:p.length,status:p.length===y?"âœ… OK":"âš ï¸ MISMATCH",issues:[]})}catch{o.stockLevels={expected:e.data.stockLevels||0,inCache:0,status:"âŒ ERROR",issues:["Failed to read cache"]}}console.log("ğŸ“‹ Verification Results:"),Object.entries(o).forEach(([m,p])=>{console.log(`  ${m}:`,{status:p.status,expected:p.expected,actual:p.inCache||p.inStore,...p.issues&&p.issues.length>0?{issues:p.issues}:{}})});const L=Object.values(o).every(m=>m.status==="âœ… OK"),x=Object.values(o).some(m=>m.status==="âš ï¸ MISMATCH"),V=Object.values(o).some(m=>m.status==="âŒ ERROR");let O="";return L&&!x&&!V?(O="âœ… ALL DATA TYPES VERIFIED SUCCESSFULLY",console.log("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"),console.log(`âœ… [Verification] ${O}`)):V?(O="âŒ SOME DATA TYPES HAVE ERRORS",console.log("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"),console.error(`âŒ [Verification] ${O}`)):(O="âš ï¸ SOME DATA TYPES HAVE WARNINGS",console.log("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"),console.warn(`âš ï¸ [Verification] ${O}`)),console.log("â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”"),{allOk:L&&!x&&!V,results:o,summary:O}}}const z=new $;export{z as fullDatabaseDownloadService};
