import{b as $,j as e}from"./index-61458a34.js";import{r as a}from"./vendor-36d2c7c1.js";import{z as g}from"./ui-28e30067.js";import{f as T,a as q}from"./phoneUtils-a8934478.js";import{u as H,S as V}from"./useSuccessModal-081786c4.js";import{S as _}from"./SuccessModalIcons-fe811e4d.js";import{M as Q,S as U,a as B,b as O,c as X,d as Y}from"./MobileSheetContent-25c73501.js";const oe=({isOpen:c,onClose:h,onCustomerCreated:m,onAddAnother:f})=>{const{addCustomer:P}=$(),l=H(),[i,y]=a.useState(""),[r,S]=a.useState(""),[d,u]=a.useState(""),[s,x]=a.useState(""),[b,j]=a.useState(""),[v,C]=a.useState(""),[w,M]=a.useState(""),[N,z]=a.useState(""),[p,A]=a.useState(""),[D,W]=a.useState(!1),[k,F]=a.useState(!1),[o,I]=a.useState(!0),E=["Dar es Salaam","Arusha","Mwanza","Dodoma","Mbeya","Tanga","Morogoro","Iringa","Tabora","Kigoma","Mara","Kagera","Shinyanga","Singida","Rukwa","Ruvuma","Lindi","Mtwara","Pwani","Manyara","Geita","Simiyu","Katavi","Njombe","Songwe"],G=["January","February","March","April","May","June","July","August","September","October","November","December"],L=["Walk-in","Facebook","Instagram","WhatsApp","Google","Friend Referral","Returning Customer","Advertisement","Other"];a.useEffect(()=>{o&&r&&!d&&u(r)},[r,o]),a.useEffect(()=>{c&&R()},[c]);const R=()=>{y(""),S(""),u(""),x(""),j(""),C(""),M(""),z(""),A(""),I(!0),F(!1)},J=()=>i.trim()?r.trim()?!0:(g.error("Phone number is required"),!1):(g.error("Customer name is required"),!1),K=async()=>{if(J())try{W(!0);const t={name:i.trim(),phone:T(r),email:"",gender:s||"male",city:b||"",whatsapp:o?q(d||r):"",referralSource:N||"",birthMonth:v||"",birthDay:w||"",notes:p?[{id:Date.now().toString(),content:p,createdAt:new Date().toISOString(),createdBy:"system"}]:[],loyaltyLevel:"interested",colorTag:"new",referrals:[],totalSpent:0,points:0,lastVisit:new Date().toISOString(),isActive:!0,devices:[]},n=await P(t);n&&(l.show(`${n.name} has been added to your customer list!`,{title:"Customer Added! ðŸŽ‰",icon:_.customerAdded,autoCloseDelay:0,actionButtons:[{label:"Add Another",onClick:()=>{l.hide(),R(),f&&f()},variant:"primary"},{label:"Done",onClick:()=>{l.hide(),h()},variant:"secondary"}]}),m&&m(n))}catch(t){console.error("Error adding customer:",t),g.error(t.message||"Failed to add customer")}finally{W(!1)}};return e.jsxs(e.Fragment,{children:[e.jsxs(Q,{isOpen:c,onClose:h,title:"Add Customer",subtitle:r?T(r):"New Customer",leftButtonText:"Cancel",rightButtonText:D?"Adding...":"Add",rightButtonDisabled:D||!i.trim()||!r.trim(),onRightButtonClick:K,children:[e.jsxs(U,{children:[e.jsx(B,{placeholder:"Customer name",value:i,onChange:y,autoFocus:!0}),e.jsx(B,{placeholder:"Phone number",value:r,onChange:S,type:"tel"}),e.jsx("div",{style:{padding:"14px 16px"},children:e.jsxs("div",{style:{display:"flex",alignItems:"center",gap:"12px"},children:[e.jsx("input",{type:"tel",placeholder:"WhatsApp number",value:d,onChange:t=>u(t.target.value),disabled:!o,className:"flex-1 outline-none bg-transparent border-0 p-0 disabled:text-gray-400",style:{fontSize:"17px",fontWeight:"400",color:d?"#000000":"#C7C7CC",letterSpacing:"-0.41px"}}),e.jsxs("label",{style:{display:"flex",alignItems:"center",gap:"8px",flexShrink:0},children:[e.jsx("input",{type:"checkbox",checked:o,onChange:t=>I(t.target.checked),className:"w-4 h-4 text-blue-500 rounded"}),e.jsx("span",{className:"text-gray-500",style:{fontSize:"13px",fontWeight:"400",letterSpacing:"-0.08px"},children:"Same as phone"})]})]})})]}),e.jsx(O,{}),e.jsxs("div",{className:"border-t border-b border-gray-200",children:[e.jsx("div",{style:{padding:"14px 16px"},children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-gray-900",style:{fontSize:"17px",fontWeight:"400",letterSpacing:"-0.41px"},children:"Gender"}),e.jsx("span",{className:"text-gray-900 font-semibold",style:{fontSize:"17px",letterSpacing:"-0.41px"},children:s==="male"?"Male":s==="female"?"Female":"--"})]})}),e.jsx("div",{className:"border-t border-gray-200",style:{padding:"14px 16px"},children:e.jsxs("div",{style:{display:"flex",gap:"12px"},children:[e.jsx("button",{type:"button",onClick:()=>x("male"),className:`flex-1 rounded-lg font-medium transition-all ${s==="male"?"bg-blue-500 text-white":"bg-gray-100 text-gray-700"}`,style:{fontSize:"15px",padding:"10px 16px",letterSpacing:"-0.24px"},children:"Male"}),e.jsx("button",{type:"button",onClick:()=>x("female"),className:`flex-1 rounded-lg font-medium transition-all ${s==="female"?"bg-blue-500 text-white":"bg-gray-100 text-gray-700"}`,style:{fontSize:"15px",padding:"10px 16px",letterSpacing:"-0.24px"},children:"Female"})]})})]}),e.jsx(O,{}),e.jsx(X,{title:"More options",subtitle:"Location, birthday, referral source",isOpen:k,onToggle:()=>F(!k),children:e.jsx("div",{style:{padding:"16px",paddingTop:"12px"},children:e.jsxs("div",{style:{display:"flex",flexDirection:"column",gap:"12px"},children:[e.jsxs("select",{value:b,onChange:t=>j(t.target.value),className:"w-full bg-gray-100 border-0 rounded-lg text-gray-900 outline-none",style:{fontSize:"15px",fontWeight:"400",padding:"12px 16px",letterSpacing:"-0.24px"},children:[e.jsx("option",{value:"",children:"City / Region"}),E.map(t=>e.jsx("option",{value:t,children:t},t))]}),e.jsxs("div",{style:{display:"flex",gap:"12px"},children:[e.jsxs("select",{value:v,onChange:t=>C(t.target.value),className:"flex-1 bg-gray-100 border-0 rounded-lg text-gray-900 outline-none",style:{fontSize:"15px",fontWeight:"400",padding:"12px 16px",letterSpacing:"-0.24px"},children:[e.jsx("option",{value:"",children:"Month"}),G.map((t,n)=>e.jsx("option",{value:String(n+1),children:t},t))]}),e.jsxs("select",{value:w,onChange:t=>M(t.target.value),className:"bg-gray-100 border-0 rounded-lg text-gray-900 outline-none",style:{fontSize:"15px",fontWeight:"400",padding:"12px 16px",letterSpacing:"-0.24px",width:"96px"},children:[e.jsx("option",{value:"",children:"Day"}),Array.from({length:31},(t,n)=>n+1).map(t=>e.jsx("option",{value:String(t),children:t},t))]})]}),e.jsxs("select",{value:N,onChange:t=>z(t.target.value),className:"w-full bg-gray-100 border-0 rounded-lg text-gray-900 outline-none",style:{fontSize:"15px",fontWeight:"400",padding:"12px 16px",letterSpacing:"-0.24px"},children:[e.jsx("option",{value:"",children:"How did they find us?"}),L.map(t=>e.jsx("option",{value:t,children:t},t))]}),e.jsx("textarea",{value:p,onChange:t=>A(t.target.value),placeholder:"Notes (Optional)",rows:3,className:"w-full bg-gray-100 border-0 rounded-lg placeholder-gray-400 outline-none resize-none",style:{fontSize:"15px",fontWeight:"400",padding:"12px 16px",letterSpacing:"-0.24px",color:p?"#000000":"#C7C7CC"}})]})})}),e.jsx(Y,{})]}),e.jsx(V,{...l.props})]})};export{oe as M};
