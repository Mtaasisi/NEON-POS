import{j as t}from"./index-61458a34.js";import{c as re,g as ae,R as se,r as N}from"./vendor-36d2c7c1.js";import{_ as ne,a as ie,b as oe,P as w,d as le}from"./charts-d592fbd1.js";import{t as ce}from"./toPropertyKey-7cc7522c.js";import{_ as de}from"./pdf-e6e38bab.js";import{h as he,t as C,m as ue,n as me}from"./tradeInApi-5d12dbe0.js";import{format as pe}from"./format-aff4c6a2.js";import{u as fe}from"./useBodyScrollLock-341c8b9f.js";import{a3 as xe,a6 as ve,X as H,ag as ge,A as ye,d as be}from"./ui-28e30067.js";function _e(a,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");a.prototype=Object.create(r&&r.prototype,{constructor:{value:a,writable:!0,configurable:!0}}),Object.defineProperty(a,"prototype",{writable:!1}),r&&ne(a,r)}function O(a){return O=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},O(a)}function Y(){try{var a=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Y=function(){return!!a})()}function je(a,r){if(r&&(de(r)=="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ie(a)}function we(a){var r=Y();return function(){var s,e=O(a);if(r){var n=O(this).constructor;s=Reflect.construct(e,arguments,n)}else s=e.apply(this,arguments);return je(this,s)}}function Ne(a,r){if(!(a instanceof r))throw new TypeError("Cannot call a class as a function")}function X(a,r){for(var s=0;s<r.length;s++){var e=r[s];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(a,ce(e.key),e)}}function Pe(a,r,s){return r&&X(a.prototype,r),s&&X(a,s),Object.defineProperty(a,"prototype",{writable:!1}),a}function Ce(a,r){if(a==null)return{};var s,e,n=oe(a,r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(a);for(e=0;e<o.length;e++)s=o[e],r.indexOf(s)===-1&&{}.propertyIsEnumerable.call(a,s)&&(n[s]=a[s])}return n}function E(a,r,s){this.x=a,this.y=r,this.time=s||new Date().getTime()}E.prototype.velocityFrom=function(a){return this.time!==a.time?this.distanceTo(a)/(this.time-a.time):1};E.prototype.distanceTo=function(a){return Math.sqrt(Math.pow(this.x-a.x,2)+Math.pow(this.y-a.y,2))};E.prototype.equals=function(a){return this.x===a.x&&this.y===a.y&&this.time===a.time};function z(a,r,s,e){this.startPoint=a,this.control1=r,this.control2=s,this.endPoint=e}z.prototype.length=function(){for(var a=10,r=0,s=void 0,e=void 0,n=0;n<=a;n+=1){var o=n/a,c=this._point(o,this.startPoint.x,this.control1.x,this.control2.x,this.endPoint.x),i=this._point(o,this.startPoint.y,this.control1.y,this.control2.y,this.endPoint.y);if(n>0){var d=c-s,l=i-e;r+=Math.sqrt(d*d+l*l)}s=c,e=i}return r};z.prototype._point=function(a,r,s,e,n){return r*(1-a)*(1-a)*(1-a)+3*s*(1-a)*(1-a)*a+3*e*(1-a)*a*a+n*a*a*a};function De(a,r,s){var e,n,o,c=null,i=0;s||(s={});var d=function(){i=s.leading===!1?0:Date.now(),c=null,o=a.apply(e,n),c||(e=n=null)};return function(){var l=Date.now();!i&&s.leading===!1&&(i=l);var h=r-(l-i);return e=this,n=arguments,h<=0||h>r?(c&&(clearTimeout(c),c=null),i=l,o=a.apply(e,n),c||(e=n=null)):!c&&s.trailing!==!1&&(c=setTimeout(d,h)),o}}function p(a,r){var s=this,e=r||{};this.velocityFilterWeight=e.velocityFilterWeight||.7,this.minWidth=e.minWidth||.5,this.maxWidth=e.maxWidth||2.5,this.throttle="throttle"in e?e.throttle:16,this.minDistance="minDistance"in e?e.minDistance:5,this.throttle?this._strokeMoveUpdate=De(p.prototype._strokeUpdate,this.throttle):this._strokeMoveUpdate=p.prototype._strokeUpdate,this.dotSize=e.dotSize||function(){return(this.minWidth+this.maxWidth)/2},this.penColor=e.penColor||"black",this.backgroundColor=e.backgroundColor||"rgba(0,0,0,0)",this.onBegin=e.onBegin,this.onEnd=e.onEnd,this._canvas=a,this._ctx=a.getContext("2d"),this.clear(),this._handleMouseDown=function(n){n.which===1&&(s._mouseButtonDown=!0,s._strokeBegin(n))},this._handleMouseMove=function(n){s._mouseButtonDown&&s._strokeMoveUpdate(n)},this._handleMouseUp=function(n){n.which===1&&s._mouseButtonDown&&(s._mouseButtonDown=!1,s._strokeEnd(n))},this._handleTouchStart=function(n){if(n.targetTouches.length===1){var o=n.changedTouches[0];s._strokeBegin(o)}},this._handleTouchMove=function(n){n.preventDefault();var o=n.targetTouches[0];s._strokeMoveUpdate(o)},this._handleTouchEnd=function(n){var o=n.target===s._canvas;o&&(n.preventDefault(),s._strokeEnd(n))},this.on()}p.prototype.clear=function(){var a=this._ctx,r=this._canvas;a.fillStyle=this.backgroundColor,a.clearRect(0,0,r.width,r.height),a.fillRect(0,0,r.width,r.height),this._data=[],this._reset(),this._isEmpty=!0};p.prototype.fromDataURL=function(a){var r=this,s=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},e=new Image,n=s.ratio||window.devicePixelRatio||1,o=s.width||this._canvas.width/n,c=s.height||this._canvas.height/n;this._reset(),e.src=a,e.onload=function(){r._ctx.drawImage(e,0,0,o,c)},this._isEmpty=!1};p.prototype.toDataURL=function(a){var r;switch(a){case"image/svg+xml":return this._toSVG();default:for(var s=arguments.length,e=Array(s>1?s-1:0),n=1;n<s;n++)e[n-1]=arguments[n];return(r=this._canvas).toDataURL.apply(r,[a].concat(e))}};p.prototype.on=function(){this._handleMouseEvents(),this._handleTouchEvents()};p.prototype.off=function(){this._canvas.removeEventListener("mousedown",this._handleMouseDown),this._canvas.removeEventListener("mousemove",this._handleMouseMove),document.removeEventListener("mouseup",this._handleMouseUp),this._canvas.removeEventListener("touchstart",this._handleTouchStart),this._canvas.removeEventListener("touchmove",this._handleTouchMove),this._canvas.removeEventListener("touchend",this._handleTouchEnd)};p.prototype.isEmpty=function(){return this._isEmpty};p.prototype._strokeBegin=function(a){this._data.push([]),this._reset(),this._strokeUpdate(a),typeof this.onBegin=="function"&&this.onBegin(a)};p.prototype._strokeUpdate=function(a){var r=a.clientX,s=a.clientY,e=this._createPoint(r,s),n=this._data[this._data.length-1],o=n&&n[n.length-1],c=o&&e.distanceTo(o)<this.minDistance;if(!(o&&c)){var i=this._addPoint(e),d=i.curve,l=i.widths;d&&l&&this._drawCurve(d,l.start,l.end),this._data[this._data.length-1].push({x:e.x,y:e.y,time:e.time,color:this.penColor})}};p.prototype._strokeEnd=function(a){var r=this.points.length>2,s=this.points[0];if(!r&&s&&this._drawDot(s),s){var e=this._data[this._data.length-1],n=e[e.length-1];s.equals(n)||e.push({x:s.x,y:s.y,time:s.time,color:this.penColor})}typeof this.onEnd=="function"&&this.onEnd(a)};p.prototype._handleMouseEvents=function(){this._mouseButtonDown=!1,this._canvas.addEventListener("mousedown",this._handleMouseDown),this._canvas.addEventListener("mousemove",this._handleMouseMove),document.addEventListener("mouseup",this._handleMouseUp)};p.prototype._handleTouchEvents=function(){this._canvas.style.msTouchAction="none",this._canvas.style.touchAction="none",this._canvas.addEventListener("touchstart",this._handleTouchStart),this._canvas.addEventListener("touchmove",this._handleTouchMove),this._canvas.addEventListener("touchend",this._handleTouchEnd)};p.prototype._reset=function(){this.points=[],this._lastVelocity=0,this._lastWidth=(this.minWidth+this.maxWidth)/2,this._ctx.fillStyle=this.penColor};p.prototype._createPoint=function(a,r,s){var e=this._canvas.getBoundingClientRect();return new E(a-e.left,r-e.top,s||new Date().getTime())};p.prototype._addPoint=function(a){var r=this.points,s=void 0;if(r.push(a),r.length>2){r.length===3&&r.unshift(r[0]),s=this._calculateCurveControlPoints(r[0],r[1],r[2]);var e=s.c2;s=this._calculateCurveControlPoints(r[1],r[2],r[3]);var n=s.c1,o=new z(r[1],e,n,r[2]),c=this._calculateCurveWidths(o);return r.shift(),{curve:o,widths:c}}return{}};p.prototype._calculateCurveControlPoints=function(a,r,s){var e=a.x-r.x,n=a.y-r.y,o=r.x-s.x,c=r.y-s.y,i={x:(a.x+r.x)/2,y:(a.y+r.y)/2},d={x:(r.x+s.x)/2,y:(r.y+s.y)/2},l=Math.sqrt(e*e+n*n),h=Math.sqrt(o*o+c*c),m=i.x-d.x,u=i.y-d.y,f=h/(l+h),x={x:d.x+m*f,y:d.y+u*f},g=r.x-x.x,b=r.y-x.y;return{c1:new E(i.x+g,i.y+b),c2:new E(d.x+g,d.y+b)}};p.prototype._calculateCurveWidths=function(a){var r=a.startPoint,s=a.endPoint,e={start:null,end:null},n=this.velocityFilterWeight*s.velocityFrom(r)+(1-this.velocityFilterWeight)*this._lastVelocity,o=this._strokeWidth(n);return e.start=this._lastWidth,e.end=o,this._lastVelocity=n,this._lastWidth=o,e};p.prototype._strokeWidth=function(a){return Math.max(this.maxWidth/(a+1),this.minWidth)};p.prototype._drawPoint=function(a,r,s){var e=this._ctx;e.moveTo(a,r),e.arc(a,r,s,0,2*Math.PI,!1),this._isEmpty=!1};p.prototype._drawCurve=function(a,r,s){var e=this._ctx,n=s-r,o=Math.floor(a.length());e.beginPath();for(var c=0;c<o;c+=1){var i=c/o,d=i*i,l=d*i,h=1-i,m=h*h,u=m*h,f=u*a.startPoint.x;f+=3*m*i*a.control1.x,f+=3*h*d*a.control2.x,f+=l*a.endPoint.x;var x=u*a.startPoint.y;x+=3*m*i*a.control1.y,x+=3*h*d*a.control2.y,x+=l*a.endPoint.y;var g=r+l*n;this._drawPoint(f,x,g)}e.closePath(),e.fill()};p.prototype._drawDot=function(a){var r=this._ctx,s=typeof this.dotSize=="function"?this.dotSize():this.dotSize;r.beginPath(),this._drawPoint(a.x,a.y,s),r.closePath(),r.fill()};p.prototype._fromData=function(a,r,s){for(var e=0;e<a.length;e+=1){var n=a[e];if(n.length>1)for(var o=0;o<n.length;o+=1){var c=n[o],i=new E(c.x,c.y,c.time),d=c.color;if(o===0)this.penColor=d,this._reset(),this._addPoint(i);else if(o!==n.length-1){var l=this._addPoint(i),h=l.curve,m=l.widths;h&&m&&r(h,m,d)}}else{this._reset();var u=n[0];s(u)}}};p.prototype._toSVG=function(){var a=this,r=this._data,s=this._canvas,e=Math.max(window.devicePixelRatio||1,1),n=0,o=0,c=s.width/e,i=s.height/e,d=document.createElementNS("http://www.w3.org/2000/svg","svg");d.setAttributeNS(null,"width",s.width),d.setAttributeNS(null,"height",s.height),this._fromData(r,function(y,_,P){var j=document.createElement("path");if(!isNaN(y.control1.x)&&!isNaN(y.control1.y)&&!isNaN(y.control2.x)&&!isNaN(y.control2.y)){var T="M "+y.startPoint.x.toFixed(3)+","+y.startPoint.y.toFixed(3)+" "+("C "+y.control1.x.toFixed(3)+","+y.control1.y.toFixed(3)+" ")+(y.control2.x.toFixed(3)+","+y.control2.y.toFixed(3)+" ")+(y.endPoint.x.toFixed(3)+","+y.endPoint.y.toFixed(3));j.setAttribute("d",T),j.setAttribute("stroke-width",(_.end*2.25).toFixed(3)),j.setAttribute("stroke",P),j.setAttribute("fill","none"),j.setAttribute("stroke-linecap","round"),d.appendChild(j)}},function(y){var _=document.createElement("circle"),P=typeof a.dotSize=="function"?a.dotSize():a.dotSize;_.setAttribute("r",P),_.setAttribute("cx",y.x),_.setAttribute("cy",y.y),_.setAttribute("fill",y.color),d.appendChild(_)});var l="data:image/svg+xml;base64,",h='<svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink"'+(' viewBox="'+n+" "+o+" "+c+" "+i+'"')+(' width="'+c+'"')+(' height="'+i+'"')+">",m=d.innerHTML;if(m===void 0){var u=document.createElement("dummy"),f=d.childNodes;u.innerHTML="";for(var x=0;x<f.length;x+=1)u.appendChild(f[x].cloneNode(!0));m=u.innerHTML}var g="</svg>",b=h+m+g;return l+btoa(b)};p.prototype.fromData=function(a){var r=this;this.clear(),this._fromData(a,function(s,e){return r._drawCurve(s,e.start,e.end)},function(s){return r._drawDot(s)}),this._data=a};p.prototype.toData=function(){return this._data};var $={exports:{}};(function(a,r){(function(s,e){a.exports=e()})(re,function(){return function(s){function e(o){if(n[o])return n[o].exports;var c=n[o]={exports:{},id:o,loaded:!1};return s[o].call(c.exports,c,c.exports,e),c.loaded=!0,c.exports}var n={};return e.m=s,e.c=n,e.p="",e(0)}([function(s,e){function n(l){var h=l.getContext("2d"),m=l.width,u=l.height,f=h.getImageData(0,0,m,u).data,x=i(!0,m,u,f),g=i(!1,m,u,f),b=d(!0,m,u,f),y=d(!1,m,u,f),_=y-b+1,P=g-x+1,j=h.getImageData(b,x,_,P);return l.width=_,l.height=P,h.clearRect(0,0,_,P),h.putImageData(j,0,0),l}function o(l,h,m,u){return{red:u[4*(m*h+l)],green:u[4*(m*h+l)+1],blue:u[4*(m*h+l)+2],alpha:u[4*(m*h+l)+3]}}function c(l,h,m,u){return o(l,h,m,u).alpha}function i(l,h,m,u){for(var f=l?1:-1,x=l?0:m-1,g=x;l?g<m:g>-1;g+=f)for(var b=0;b<h;b++)if(c(b,g,h,u))return g;return null}function d(l,h,m,u){for(var f=l?1:-1,x=l?0:h-1,g=x;l?g<h:g>-1;g+=f)for(var b=0;b<m;b++)if(c(g,b,h,u))return g;return null}Object.defineProperty(e,"__esModule",{value:!0}),e.default=n}])})})($);var Se=$.exports;const Ee=ae(Se);var Te=["canvasProps","clearOnResize"],M=function(a){_e(s,a);var r=we(s);function s(){var e;Ne(this,s);for(var n=arguments.length,o=new Array(n),c=0;c<n;c++)o[c]=arguments[c];return e=r.call.apply(r,[this].concat(o)),e.staticThis=e.constructor,e._sigPad=null,e._canvas=null,e.setRef=function(i){e._canvas=i,e._canvas===null&&(e._sigPad=null)},e._excludeOurProps=function(){var i=e.props;i.canvasProps,i.clearOnResize;var d=Ce(i,Te);return d},e.componentDidMount=function(){var i=e.getCanvas();e._sigPad=new p(i,e._excludeOurProps()),e._resizeCanvas(),e.on()},e.componentWillUnmount=function(){e.off()},e.componentDidUpdate=function(){Object.assign(e._sigPad,e._excludeOurProps())},e.getCanvas=function(){if(e._canvas===null)throw e.staticThis.refNullError;return e._canvas},e.getTrimmedCanvas=function(){var i=e.getCanvas(),d=document.createElement("canvas");return d.width=i.width,d.height=i.height,d.getContext("2d").drawImage(i,0,0),Ee(d)},e.getSignaturePad=function(){if(e._sigPad===null)throw e.staticThis.refNullError;return e._sigPad},e._checkClearOnResize=function(){e.props.clearOnResize&&e._resizeCanvas()},e._resizeCanvas=function(){var i,d,l=(i=e.props.canvasProps)!==null&&i!==void 0?i:{},h=l.width,m=l.height;if(!(typeof h<"u"&&typeof m<"u")){var u=e.getCanvas(),f=Math.max((d=window.devicePixelRatio)!==null&&d!==void 0?d:1,1);typeof h>"u"&&(u.width=u.offsetWidth*f),typeof m>"u"&&(u.height=u.offsetHeight*f),u.getContext("2d").scale(f,f),e.clear()}},e.render=function(){var i=e.props.canvasProps;return se.createElement("canvas",le({ref:e.setRef},i))},e.on=function(){return window.addEventListener("resize",e._checkClearOnResize),e.getSignaturePad().on()},e.off=function(){return window.removeEventListener("resize",e._checkClearOnResize),e.getSignaturePad().off()},e.clear=function(){return e.getSignaturePad().clear()},e.isEmpty=function(){return e.getSignaturePad().isEmpty()},e.fromDataURL=function(i,d){return e.getSignaturePad().fromDataURL(i,d)},e.toDataURL=function(i,d){return e.getSignaturePad().toDataURL(i,d)},e.fromData=function(i){return e.getSignaturePad().fromData(i)},e.toData=function(){return e.getSignaturePad().toData()},e}return Pe(s)}(N.Component);M.propTypes={velocityFilterWeight:w.number,minWidth:w.number,maxWidth:w.number,minDistance:w.number,dotSize:w.oneOfType([w.number,w.func]),penColor:w.string,throttle:w.number,onEnd:w.func,onBegin:w.func,canvasProps:w.object,clearOnResize:w.bool};M.defaultProps={clearOnResize:!0};M.refNullError=new Error("react-signature-canvas is currently mounting or unmounting: React refs are null during this phase.");const Ue=({isOpen:a,transaction:r,onClose:s,onContractSigned:e})=>{var A,W,U,F,B,q;const[n,o]=N.useState(!0),[c,i]=N.useState(""),[d,l]=N.useState("");fe(a);const[h,m]=N.useState(""),[u,f]=N.useState("national_id"),[x,g]=N.useState(!1),[b,y]=N.useState(!1),[_,P]=N.useState(r.customer_id_photo_url||null),j=N.useRef(null),T=N.useRef(null),I=N.useRef(null);N.useEffect(()=>{a&&G()},[a]);const G=async()=>{o(!0);const v=await he();v.success&&v.data&&(i(v.data.contract_terms||""),l(v.data.ownership_declaration||"")),o(!1)},K=()=>{var v;(v=T.current)==null||v.clear()},J=()=>{var v;(v=I.current)==null||v.clear()},Q=v=>{var R;const S=(R=v.target.files)==null?void 0:R[0];if(!S)return;if(!S.type.startsWith("image/")){C.error("Please select an image file");return}if(S.size>5*1024*1024){C.error("File size must be less than 5MB");return}const k=new FileReader;k.onload=async L=>{var V;const D=(V=L.target)==null?void 0:V.result;if(D){P(D);try{await ue(r.id,{customer_id_photo_url:D}),C.success("ID photo uploaded")}catch(te){console.error("Error saving ID photo:",te)}}},k.readAsDataURL(S)},Z=async v=>{var S,k,R,L;if(v.preventDefault(),!h){C.error("Please enter customer ID number");return}if(!x){C.error("Customer must agree to terms and conditions");return}if((S=T.current)!=null&&S.isEmpty()){C.error("Customer signature is required");return}if((k=I.current)!=null&&k.isEmpty()){C.error("Staff signature is required");return}y(!0);try{const D=await me(r,{transaction_id:r.id,customer_id_number:h,customer_id_type:u,customer_agreed_terms:x,customer_signature_data:(R=T.current)==null?void 0:R.toDataURL(),staff_signature_data:(L=I.current)==null?void 0:L.toDataURL()});D.success?(C.success("Contract signed successfully"),e(),s()):C.error(D.error||"Failed to create contract")}catch(D){console.error("Error creating contract:",D),C.error("Failed to create contract")}finally{y(!1)}},ee=()=>{window.print()};return a?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"fixed bg-black bg-opacity-50",onClick:s,style:{left:"var(--sidebar-width, 0px)",top:"var(--topbar-height, 64px)",right:0,bottom:0,zIndex:35}}),t.jsx("div",{className:"fixed flex items-center justify-center p-4",style:{left:"var(--sidebar-width, 0px)",top:"var(--topbar-height, 64px)",right:0,bottom:0,zIndex:50,pointerEvents:"none"},children:t.jsxs("div",{className:"bg-white rounded-xl shadow-2xl w-full max-w-5xl max-h-[90vh] overflow-hidden flex flex-col",style:{pointerEvents:"auto"},children:[t.jsx("div",{className:"p-6 border-b border-gray-200 bg-gradient-to-r from-purple-600 to-purple-700 print:hidden",children:t.jsxs("div",{className:"flex items-center justify-between",children:[t.jsxs("div",{className:"flex items-center gap-3",children:[t.jsx(xe,{className:"w-8 h-8 text-white"}),t.jsxs("div",{children:[t.jsx("h2",{className:"text-2xl font-bold text-white",children:"Trade-In Purchase Contract"}),t.jsx("p",{className:"text-purple-100 text-sm mt-1",children:"Legal agreement for device trade-in"})]})]}),t.jsxs("div",{className:"flex items-center gap-2",children:[t.jsx("button",{onClick:ee,className:"p-2 hover:bg-purple-800 rounded-lg transition-colors text-white",title:"Print Contract",children:t.jsx(ve,{className:"w-5 h-5"})}),t.jsx("button",{onClick:s,className:"p-2 hover:bg-purple-800 rounded-lg transition-colors text-white",children:t.jsx(H,{className:"w-6 h-6"})})]})]})}),t.jsx("div",{className:"flex-1 overflow-y-auto p-8",children:n?t.jsx("div",{className:"flex items-center justify-center h-64",children:t.jsx("div",{className:"animate-spin w-8 h-8 border-4 border-purple-600 border-t-transparent rounded-full"})}):t.jsxs("form",{onSubmit:Z,className:"space-y-8",children:[t.jsxs("div",{className:"text-center border-b-2 border-gray-300 pb-6",children:[t.jsx("h1",{className:"text-3xl font-bold text-gray-900 mb-2",children:"DEVICE TRADE-IN PURCHASE AGREEMENT"}),t.jsxs("p",{className:"text-gray-600",children:["Contract Number: ",r.transaction_number]}),t.jsxs("p",{className:"text-gray-600",children:["Date: ",new Date().toLocaleDateString()]})]}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t.jsxs("div",{className:"bg-gray-50 p-6 rounded-lg",children:[t.jsx("h3",{className:"font-bold text-gray-900 mb-4 uppercase text-sm",children:"Seller (Customer)"}),t.jsxs("div",{className:"space-y-2 text-sm",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-600",children:"Name:"})," ",t.jsx("span",{className:"font-medium",children:(A=r.customer)==null?void 0:A.name})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-600",children:"Phone:"})," ",t.jsx("span",{className:"font-medium",children:(W=r.customer)==null?void 0:W.phone})]}),((U=r.customer)==null?void 0:U.email)&&t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-600",children:"Email:"})," ",t.jsx("span",{className:"font-medium",children:r.customer.email})]}),((F=r.customer)==null?void 0:F.address)&&t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-600",children:"Address:"})," ",t.jsx("span",{className:"font-medium",children:r.customer.address})]})]}),t.jsx("div",{className:"mt-4 pt-4 border-t border-gray-200 print:hidden",children:t.jsxs("div",{className:"space-y-3",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ID Type *"}),t.jsxs("select",{value:u,onChange:v=>f(v.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500",required:!0,children:[t.jsx("option",{value:"national_id",children:"National ID"}),t.jsx("option",{value:"passport",children:"Passport"}),t.jsx("option",{value:"drivers_license",children:"Driver's License"}),t.jsx("option",{value:"other",children:"Other"})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ID Number *"}),t.jsx("input",{type:"text",value:h,onChange:v=>m(v.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500",placeholder:"Enter ID number",required:!0})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"ID Photo (Optional)"}),t.jsx("input",{ref:j,type:"file",accept:"image/*",onChange:Q,className:"hidden"}),_?t.jsxs("div",{className:"relative",children:[t.jsx("img",{src:_,alt:"ID Photo",className:"w-full h-48 object-contain border-2 border-gray-300 rounded-lg"}),t.jsx("button",{type:"button",onClick:()=>{P(null),j.current&&(j.current.value="")},className:"absolute top-2 right-2 p-2 bg-red-500 text-white rounded-full hover:bg-red-600",children:t.jsx(H,{className:"w-4 h-4"})})]}):t.jsxs("button",{type:"button",onClick:()=>{var v;return(v=j.current)==null?void 0:v.click()},className:"w-full px-4 py-3 border-2 border-dashed border-gray-300 rounded-lg hover:border-purple-500 hover:bg-purple-50 transition-colors flex items-center justify-center gap-2",children:[t.jsx(ge,{className:"w-5 h-5 text-gray-400"}),t.jsx("span",{className:"text-sm text-gray-600",children:"Upload ID Photo"})]})]})]})}),t.jsxs("div",{className:"mt-4 text-sm print:block hidden",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-600",children:"ID Type:"})," ",t.jsx("span",{className:"font-medium",children:u.replace("_"," ").toUpperCase()})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-600",children:"ID Number:"})," ",t.jsx("span",{className:"font-medium",children:h})]})]})]}),t.jsxs("div",{className:"bg-gray-50 p-6 rounded-lg",children:[t.jsx("h3",{className:"font-bold text-gray-900 mb-4 uppercase text-sm",children:"Buyer (Company)"}),t.jsxs("div",{className:"space-y-2 text-sm",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-600",children:"Company:"})," ",t.jsx("span",{className:"font-medium",children:"Your Company Name"})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-600",children:"Branch:"})," ",t.jsx("span",{className:"font-medium",children:((B=r.branch)==null?void 0:B.name)||"Main Branch"})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-600",children:"Staff:"})," ",t.jsx("span",{className:"font-medium",children:r.created_by||"Staff Member"})]})]})]})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-bold text-gray-900 mb-4 uppercase text-sm border-b pb-2",children:"Device Information"}),t.jsxs("div",{className:"bg-blue-50 p-6 rounded-lg space-y-3",children:[t.jsxs("div",{className:"grid grid-cols-2 gap-4 text-sm",children:[t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-600",children:"Device Name:"})," ",t.jsx("span",{className:"font-medium",children:r.device_name})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-600",children:"Model:"})," ",t.jsx("span",{className:"font-medium",children:r.device_model})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-600",children:"IMEI:"})," ",t.jsx("span",{className:"font-medium",children:r.device_imei||"N/A"})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-600",children:"Serial Number:"})," ",t.jsx("span",{className:"font-medium",children:r.device_serial_number||"N/A"})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-600",children:"Condition:"})," ",t.jsx("span",{className:"font-medium capitalize",children:r.condition_rating})]}),t.jsxs("div",{children:[t.jsx("span",{className:"text-gray-600",children:"Agreed Value:"})," ",t.jsx("span",{className:"font-bold text-green-600",children:pe.money(r.final_trade_in_value)})]})]}),r.condition_description&&t.jsxs("div",{className:"pt-3 border-t border-blue-200",children:[t.jsx("span",{className:"text-gray-600 text-sm",children:"Condition Notes:"}),t.jsx("p",{className:"text-sm mt-1",children:r.condition_description})]})]})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-bold text-gray-900 mb-4 uppercase text-sm border-b pb-2",children:"Ownership Declaration"}),t.jsx("div",{className:"bg-yellow-50 border-l-4 border-yellow-400 p-4",children:t.jsxs("div",{className:"flex gap-3",children:[t.jsx(ye,{className:"w-5 h-5 text-yellow-600 flex-shrink-0 mt-1"}),t.jsx("div",{className:"text-sm text-gray-700 whitespace-pre-line",children:d})]})})]}),t.jsxs("div",{children:[t.jsx("h3",{className:"font-bold text-gray-900 mb-4 uppercase text-sm border-b pb-2",children:"Terms and Conditions"}),t.jsx("div",{className:"bg-gray-50 p-6 rounded-lg max-h-64 overflow-y-auto",children:t.jsx("div",{className:"text-sm text-gray-700 whitespace-pre-line space-y-2",children:c})})]}),t.jsx("div",{className:"bg-green-50 border-2 border-green-200 p-6 rounded-lg print:hidden",children:t.jsxs("label",{className:"flex items-start gap-3 cursor-pointer",children:[t.jsx("input",{type:"checkbox",checked:x,onChange:v=>g(v.target.checked),className:"w-5 h-5 text-green-600 rounded focus:ring-2 focus:ring-green-500 mt-1",required:!0}),t.jsxs("div",{className:"flex-1",children:[t.jsx("span",{className:"font-semibold text-gray-900",children:"I have read, understood, and agree to all terms and conditions stated above."}),t.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"I confirm that I am the legal owner of the device and have the right to sell it."})]})]})}),t.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-900 mb-3",children:"Customer Signature *"}),t.jsxs("div",{className:"border-2 border-gray-300 rounded-lg p-2 bg-white print:hidden",children:[t.jsx(M,{ref:T,canvasProps:{className:"w-full h-32 border border-gray-200 rounded"}}),t.jsx("button",{type:"button",onClick:K,className:"mt-2 text-xs text-red-600 hover:text-red-700",children:"Clear Signature"})]}),t.jsxs("div",{className:"mt-2 text-sm text-gray-600",children:[t.jsxs("div",{children:["Name: ",(q=r.customer)==null?void 0:q.name]}),t.jsxs("div",{children:["Date: ",new Date().toLocaleDateString()]})]})]}),t.jsxs("div",{children:[t.jsx("label",{className:"block text-sm font-medium text-gray-900 mb-3",children:"Staff Signature *"}),t.jsxs("div",{className:"border-2 border-gray-300 rounded-lg p-2 bg-white print:hidden",children:[t.jsx(M,{ref:I,canvasProps:{className:"w-full h-32 border border-gray-200 rounded"}}),t.jsx("button",{type:"button",onClick:J,className:"mt-2 text-xs text-red-600 hover:text-red-700",children:"Clear Signature"})]}),t.jsxs("div",{className:"mt-2 text-sm text-gray-600",children:[t.jsxs("div",{children:["Staff Member: ",r.created_by||"Staff Name"]}),t.jsxs("div",{children:["Date: ",new Date().toLocaleDateString()]})]})]})]}),t.jsxs("div",{className:"flex justify-end gap-3 pt-6 border-t-2 border-gray-200 print:hidden",children:[t.jsx("button",{type:"button",onClick:s,className:"px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-colors",disabled:b,children:"Cancel"}),t.jsx("button",{type:"submit",disabled:b||!x,className:"px-8 py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 transition-colors disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2 font-semibold",children:b?t.jsxs(t.Fragment,{children:[t.jsx("div",{className:"animate-spin w-5 h-5 border-2 border-white border-t-transparent rounded-full"}),"Saving Contract..."]}):t.jsxs(t.Fragment,{children:[t.jsx(be,{className:"w-5 h-5"}),"Sign & Complete Contract"]})})]})]})}),t.jsx("style",{children:`
          @media print {
            @page {
              size: A4;
              margin: 20mm;
            }
            
            body {
              print-color-adjust: exact;
              -webkit-print-color-adjust: exact;
            }
          }
        `})]})})]}):null};export{Ue as T};
