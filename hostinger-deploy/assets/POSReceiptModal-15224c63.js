import{j as e}from"./index-61458a34.js";import{r as M,b as q}from"./vendor-36d2c7c1.js";import{u as R}from"./useBluetoothPrinter-0ea2abfe.js";import{u as T}from"./useBusinessInfo-62d31733.js";import{u as A}from"./useBodyScrollLock-341c8b9f.js";import{format as E}from"./format-aff4c6a2.js";import{p as I}from"./formatPhoneForInvoice-e7084c6d.js";import{X as L,b7 as W,u as F,d as O,f as $,cy as z,a8 as D,a6 as X,S as H,$ as Q}from"./ui-28e30067.js";import"./supabase-cf010ec4.js";import"./routing-eb8c310c.js";const te=({isOpen:m,onClose:o,receipt:g,receiptData:j,formatMoney:f,onPrint:y,onSendWhatsApp:N,onSendSMS:v,isTaxEnabled:w=!0})=>{var h,p,b,u;const s=g||j,n=f||E.money,k=y||(()=>console.log("Print not implemented")),P=N||(()=>console.log("WhatsApp not implemented")),C=v||(()=>console.log("SMS not implemented")),{isConnected:i,isPrinting:x,printReceipt:S,connectedDevice:c}=R(),{businessInfo:a}=T();A(m);const[d,B]=M.useState(!1);return!m||!s?null:q.createPortal(e.jsx("div",{className:"fixed bg-black/60 flex items-center justify-center p-4 z-[99999]",style:{top:0,left:0,right:0,bottom:0},role:"dialog","aria-modal":"true","aria-labelledby":"receipt-modal-title",onClick:o,children:e.jsxs("div",{className:"bg-white rounded-2xl shadow-2xl max-w-3xl w-full max-h-[90vh] flex flex-col overflow-hidden relative",onClick:t=>t.stopPropagation(),children:[e.jsx("button",{onClick:o,className:"absolute top-4 right-4 w-9 h-9 flex items-center justify-center bg-red-500 hover:bg-red-600 text-white rounded-full transition-colors shadow-lg z-50",children:e.jsx(L,{className:"w-5 h-5"})}),e.jsx("div",{className:"p-8 bg-white border-b border-gray-200 flex-shrink-0",children:e.jsxs("div",{className:"grid grid-cols-[auto,1fr] gap-6 items-center",children:[e.jsx("div",{className:"w-16 h-16 bg-green-600 rounded-full flex items-center justify-center shadow-lg",children:e.jsx(W,{className:"w-8 h-8 text-white"})}),e.jsxs("div",{children:[e.jsx("h3",{id:"receipt-modal-title",className:"text-2xl font-bold text-gray-900 mb-3",children:"Sale Receipt"}),e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-green-50 border border-green-200 rounded-lg",children:[e.jsx("svg",{className:"w-4 h-4 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:3,d:"M5 13l4 4L19 7"})}),e.jsx("span",{className:"text-sm font-bold text-green-700",children:"Transaction Completed"})]}),s.items&&s.items.length>0&&e.jsxs("div",{className:"flex items-center gap-2 px-4 py-2 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsx(F,{className:"w-4 h-4 text-blue-600"}),e.jsxs("span",{className:"text-sm font-bold text-blue-700",children:[s.items.length," Item",s.items.length>1?"s":""]})]})]})]})]})}),e.jsx("div",{className:"flex-1 overflow-y-auto px-6 py-4",children:e.jsxs("div",{className:"bg-white rounded-xl border-2 border-gray-200 p-6 mb-4 shadow-sm",children:[e.jsxs("div",{className:"text-center mb-6 pb-6 border-b border-gray-200",children:[a.logo&&e.jsx("div",{className:"mb-4",children:e.jsx("img",{src:a.logo,alt:`${a.name} Logo`,className:"h-20 w-auto mx-auto object-contain"})}),e.jsx("h3",{className:"text-2xl font-bold text-gray-900 mb-2",children:a.name}),a.address&&e.jsx("p",{className:"text-sm text-gray-600",children:a.address}),e.jsxs("div",{className:"flex flex-col items-center justify-center gap-1 mt-2",children:[a.phone&&(()=>{const t=I(a.phone);return e.jsx("div",{className:"flex flex-wrap items-center justify-center gap-2",children:t.map((l,r)=>e.jsxs("p",{className:"text-xs text-gray-500 flex items-center gap-1",children:[l.whatsapp&&e.jsx("span",{className:"text-green-600",title:"WhatsApp",children:"ðŸ“±"}),e.jsx("span",{children:l.phone})]},r))})})(),a.email&&e.jsx("p",{className:"text-xs text-gray-500",children:a.email})]})]}),e.jsxs("div",{className:"mb-6 pb-6 border-b border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsx("span",{className:"text-sm font-semibold text-gray-600",children:"Receipt #"}),e.jsx("span",{className:"text-base font-bold text-gray-900",children:(s==null?void 0:s.receiptNumber)||"N/A"})]}),e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Date & Time"}),e.jsxs("span",{className:"text-sm font-medium text-gray-900",children:[s.date," at ",s.time]})]}),e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Cashier"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:s.cashier})]})]}),s.customer&&e.jsxs("div",{className:"mb-6 pb-6 border-b border-gray-200",children:[e.jsx("h4",{className:"text-sm font-bold text-gray-900 mb-3 uppercase tracking-wide",children:"Customer Information"}),e.jsxs("div",{className:"space-y-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Name"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:s.customer.name})]}),s.customer.phone&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Phone"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:s.customer.phone})]}),s.customer.email&&e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Email"}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:s.customer.email})]})]})]}),e.jsxs("div",{className:"mb-6 pb-6 border-b border-gray-200",children:[e.jsx("h4",{className:"text-sm font-bold text-gray-900 mb-4 uppercase tracking-wide",children:"Items"}),e.jsx("div",{className:"space-y-3",children:(h=s.items)==null?void 0:h.map((t,l)=>e.jsxs("div",{className:"flex justify-between items-start py-3 px-3 rounded-lg hover:bg-gray-50 transition-colors border-b border-gray-100 last:border-0",children:[e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"font-semibold text-gray-900 mb-1",children:t.productName}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Qty: ",t.quantity," Ã— ",n(t.unitPrice)]})]}),e.jsx("p",{className:"font-bold text-gray-900 text-base ml-4",children:n(t.quantity*t.unitPrice)})]},l))})]}),e.jsx("div",{className:"mb-6",children:e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Subtotal"}),e.jsx("span",{className:"text-base font-semibold text-gray-900",children:n(s.subtotal)})]}),w&&s.tax>0&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Tax"}),e.jsx("span",{className:"text-base font-semibold text-gray-900",children:n(s.tax)})]}),s.discount>0&&e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("span",{className:"text-sm font-medium text-gray-600",children:"Discount"}),e.jsxs("span",{className:"text-base font-semibold text-red-600",children:["-",n(s.discount)]})]}),e.jsxs("div",{className:"flex justify-between items-center pt-3 border-t-2 border-gray-300",children:[e.jsx("span",{className:"text-lg font-bold text-gray-900",children:"Total"}),e.jsx("span",{className:"text-2xl font-bold text-green-600",children:n(s.total)})]})]})}),e.jsx("div",{className:"mb-4 pb-4 border-b border-gray-200",children:e.jsxs("div",{className:"flex items-center gap-3 p-3 bg-blue-50 rounded-lg border border-blue-200",children:[e.jsx("div",{className:"w-10 h-10 rounded-lg bg-blue-500 flex items-center justify-center flex-shrink-0",children:e.jsx("span",{className:"text-xl",children:((p=s.paymentMethod)==null?void 0:p.icon)||"ðŸ’³"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:((b=s.paymentMethod)==null?void 0:b.name)||"Payment"}),((u=s.paymentMethod)==null?void 0:u.description)&&e.jsx("p",{className:"text-xs text-gray-600",children:s.paymentMethod.description})]})]})}),e.jsxs("div",{className:"text-center pt-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-700 mb-1",children:"Thank you for your purchase!"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Please keep this receipt for your records"})]})]})}),e.jsxs("div",{className:"p-6 pt-4 border-t border-gray-200 bg-white flex-shrink-0",children:[e.jsxs("div",{className:"mb-4 p-4 bg-gray-50 rounded-xl border border-gray-200",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:`w-10 h-10 rounded-lg flex items-center justify-center ${i?"bg-green-100":"bg-gray-100"}`,children:i?e.jsx(O,{className:"w-5 h-5 text-green-600"}):e.jsx($,{className:"w-5 h-5 text-gray-400"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-sm text-gray-900",children:i?"Bluetooth Printer Connected":"Bluetooth Printer Not Connected"}),e.jsx("p",{className:"text-xs text-gray-600",children:i?c==null?void 0:c.name:"Connect a Bluetooth printer to print receipts"})]})]}),e.jsx("button",{onClick:()=>B(!d),className:"px-4 py-2 text-sm font-medium text-blue-600 hover:text-blue-700 hover:bg-blue-50 rounded-lg transition-colors",children:d?"Hide":"Options"})]}),d&&e.jsx("div",{className:"mt-3 pt-3 border-t border-gray-200",children:e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[e.jsxs("button",{onClick:async()=>{var t,l;try{await S({header:a.name,items:((t=s.items)==null?void 0:t.map(r=>({name:r.productName,quantity:r.quantity,price:r.unitPrice,total:r.quantity*r.unitPrice})))||[],subtotal:s.subtotal,tax:s.tax,discount:s.discount,total:s.total,paymentMethod:((l=s.paymentMethod)==null?void 0:l.name)||"Payment",cashier:s.cashier,footer:"Thank you for your purchase!"})}catch(r){console.error("Failed to print via Bluetooth:",r),alert("Failed to print via Bluetooth printer")}},disabled:!i||x,className:"p-3 bg-blue-500 hover:bg-blue-600 disabled:bg-gray-300 disabled:cursor-not-allowed text-white rounded-xl transition-colors duration-200 flex items-center justify-center gap-2 font-semibold shadow-sm",children:[e.jsx(z,{className:"w-4 h-4"}),x?"Printing...":"Bluetooth Print"]}),e.jsxs("button",{onClick:()=>{window.open("/bluetooth-printer","_blank")},className:"p-3 bg-gray-500 hover:bg-gray-600 text-white rounded-xl transition-colors duration-200 flex items-center justify-center gap-2 font-semibold shadow-sm",children:[e.jsx(D,{className:"w-4 h-4"}),"Manage Printer"]})]})})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-3 mb-4",children:[e.jsxs("button",{onClick:k,className:"p-4 bg-blue-500 hover:bg-blue-600 text-white rounded-xl transition-all duration-200 flex items-center justify-center gap-2 font-semibold shadow-lg hover:shadow-xl",children:[e.jsx(X,{className:"w-5 h-5"}),"Print"]}),e.jsxs("button",{onClick:P,className:"p-4 bg-green-500 hover:bg-green-600 text-white rounded-xl transition-all duration-200 flex items-center justify-center gap-2 font-semibold shadow-lg hover:shadow-xl",children:[e.jsx(H,{className:"w-5 h-5"}),"WhatsApp"]}),e.jsxs("button",{onClick:C,className:"p-4 bg-purple-500 hover:bg-purple-600 text-white rounded-xl transition-all duration-200 flex items-center justify-center gap-2 font-semibold shadow-lg hover:shadow-xl",children:[e.jsx(Q,{className:"w-5 h-5"}),"SMS"]})]}),e.jsx("button",{onClick:o,className:"w-full py-3.5 bg-gray-100 hover:bg-gray-200 text-gray-700 rounded-xl font-semibold transition-all duration-200 shadow-sm hover:shadow-md",children:"Close"})]})]})}),document.body)};export{te as default};
