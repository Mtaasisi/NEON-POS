import{j as e}from"./index-61458a34.js";import{r as d}from"./vendor-36d2c7c1.js";import{S as h}from"./ShareReceiptModal-8db20b0e.js";import{aP as g,d as p,f as u,D as N}from"./ui-28e30067.js";import"./supabase-cf010ec4.js";import"./routing-eb8c310c.js";import"./whatsappService-09f99080.js";import"./useSuccessModal-081786c4.js";import"./useBodyScrollLock-341c8b9f.js";import"./SuccessModalIcons-fe811e4d.js";import"./useBusinessInfo-62d31733.js";import"./formatPhoneForInvoice-e7084c6d.js";import"./pdf-e6e38bab.js";import"./html2canvas.esm-6bd083a4.js";const D=()=>{const[l,i]=d.useState(!1),[s,n]=d.useState({status:"idle",message:"Ready to test PNG generation"}),r=x=>{try{const a=document.createElement("canvas");a.width=100,a.height=100;const t=a.getContext("2d");if(t)return t.fillStyle="#f0f0f0",t.fillRect(0,0,100,100),t.strokeStyle="#ccc",t.lineWidth=2,t.strokeRect(0,0,100,100),t.fillStyle="#666",t.font="bold 12px Arial",t.textAlign="center",t.textBaseline="middle",t.fillText(x,50,50),a.toDataURL("image/png")}catch(a){console.warn("Failed to generate placeholder image:",a)}return"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAADUlEQVR42mNk+M9QDwADhgGAWjR9awAAAABJRU5ErkJggg=="},o={receiptNumber:`TEST-${Date.now()}`,amount:25e4,subtotal:23e4,tax:2e4,discount:0,paymentMethod:{name:"Cash",description:"Cash Payment",icon:"ðŸ’µ"},customerName:"John Doe",customerPhone:"+255 123 456 789",customerEmail:"john.doe@example.com",customerCity:"Dar es Salaam",sellerName:"Test Cashier",items:[{productName:"iPhone 15 Pro",variantName:"256GB Natural Titanium",quantity:1,unitPrice:15e4,totalPrice:15e4,image:r("iPhone"),selectedSerialNumbers:[{id:"1",serial_number:"SN123456789",imei:"IMEI987654321"}]},{productName:"Samsung Galaxy S24",variantName:"128GB Phantom Black",quantity:1,unitPrice:8e4,totalPrice:8e4,image:r("Samsung")},{productName:"AirPods Pro",variantName:"2nd Generation",quantity:1,unitPrice:5e4,totalPrice:5e4,image:r("AirPods")}]},c=async()=>{n({status:"testing",message:"Opening receipt modal..."}),i(!0)},m=()=>{i(!1),n({status:"idle",message:"Test completed. Check console for details."})};return e.jsxs("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 to-indigo-100 p-8",children:[e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 mb-6",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx("div",{className:"p-3 bg-blue-100 rounded-xl",children:e.jsx(g,{className:"w-8 h-8 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"PNG Generation Test"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Test the receipt PNG generation functionality"})]})]}),e.jsx("div",{className:`mt-6 p-4 rounded-lg border-2 ${s.status==="success"?"bg-green-50 border-green-200":s.status==="error"?"bg-red-50 border-red-200":s.status==="testing"?"bg-yellow-50 border-yellow-200":"bg-gray-50 border-gray-200"}`,children:e.jsxs("div",{className:"flex items-center gap-3",children:[s.status==="success"&&e.jsx(p,{className:"w-5 h-5 text-green-600"}),s.status==="error"&&e.jsx(u,{className:"w-5 h-5 text-red-600"}),s.status==="testing"&&e.jsx("div",{className:"w-5 h-5 border-2 border-yellow-600 border-t-transparent rounded-full animate-spin"}),e.jsxs("div",{children:[e.jsx("p",{className:`font-semibold ${s.status==="success"?"text-green-800":s.status==="error"?"text-red-800":s.status==="testing"?"text-yellow-800":"text-gray-800"}`,children:s.message}),s.error&&e.jsx("p",{className:"text-sm text-red-600 mt-1",children:s.error})]})]})})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 mb-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Test Instructions"}),e.jsxs("ol",{className:"list-decimal list-inside space-y-2 text-gray-700",children:[e.jsx("li",{children:'Click the "Open Test Receipt" button below'}),e.jsx("li",{children:"Wait for the receipt modal to open and fully render"}),e.jsx("li",{children:'Click the "Download PNG" button in the modal'}),e.jsx("li",{children:"Check your browser console (F12) for detailed logs"}),e.jsx("li",{children:"Verify that the PNG file downloads successfully"}),e.jsx("li",{children:"Check the downloaded PNG file to ensure it looks correct"})]})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 mb-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Sample Receipt Data"}),e.jsx("div",{className:"bg-gray-50 rounded-lg p-4 overflow-x-auto",children:e.jsx("pre",{className:"text-sm text-gray-700",children:JSON.stringify(o,null,2)})})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8",children:[e.jsxs("button",{onClick:c,disabled:l,className:"w-full flex items-center justify-center gap-3 px-6 py-4 bg-gradient-to-r from-blue-600 to-indigo-600 text-white rounded-xl font-semibold text-lg hover:from-blue-700 hover:to-indigo-700 transition-all disabled:opacity-50 disabled:cursor-not-allowed shadow-lg hover:shadow-xl",children:[e.jsx(N,{className:"w-6 h-6"}),l?"Modal is Open - Test PNG Generation":"Open Test Receipt"]}),l&&e.jsx("div",{className:"mt-4 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:e.jsxs("p",{className:"text-sm text-blue-800",children:[e.jsx("strong",{children:"Modal is open!"}),' Now click the "Download PNG" button in the modal to test PNG generation.',e.jsx("br",{}),e.jsx("span",{className:"text-xs mt-2 block",children:"ðŸ’¡ Tip: Open browser console (F12) to see detailed generation logs"})]})})]}),e.jsxs("div",{className:"bg-white rounded-2xl shadow-xl p-8 mt-6",children:[e.jsx("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"What to Look For in Console"}),e.jsxs("div",{className:"space-y-2 text-sm text-gray-700",children:[e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-green-600 font-bold",children:"âœ“"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Converting images to base64 for PNG..."})," - Image conversion started"]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-green-600 font-bold",children:"âœ“"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Preview dimensions: [width]x[height]"})," - Element dimensions detected"]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-green-600 font-bold",children:"âœ“"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Starting html2canvas with options..."})," - Canvas generation started"]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-green-600 font-bold",children:"âœ“"}),e.jsxs("span",{children:[e.jsx("strong",{children:"Canvas generated successfully"})," - PNG created successfully"]})]}),e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("span",{className:"text-green-600 font-bold",children:"âœ“"}),e.jsxs("span",{children:[e.jsx("strong",{children:"PNG generated successfully"})," - File ready for download"]})]}),e.jsxs("div",{className:"flex items-start gap-2 mt-4",children:[e.jsx("span",{className:"text-red-600 font-bold",children:"âœ—"}),e.jsx("span",{children:"If you see errors, they will be logged with detailed information"})]})]})]})]}),e.jsx(h,{isOpen:l,onClose:m,receiptData:o})]})};export{D as default};
