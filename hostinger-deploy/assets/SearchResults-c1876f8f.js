import{j as e,s as P}from"./index-61458a34.js";import{y as X,X as nt,aF as wt,S as oe,p as de,u as te,af as Y,aE as me,ap as ot,aB as ct,av as lt,$ as ne,r as ue,q as dt,g as mt,a3 as ge,e as Ye,b as Je,aI as _t,aG as At,l as St,m as Xe,Y as kt,O as Ct,aq as Dt,a6 as Bt,c as et,bj as he,b1 as Et,v as Lt,Z as $t,cc as Pt}from"./ui-28e30067.js";import{r as R}from"./vendor-36d2c7c1.js";import{m as Rt}from"./phoneUtils-a8934478.js";import{a as ut}from"./routing-eb8c310c.js";const Es=({recentSearches:l,onSearch:t,onRemoveSearch:r,userRole:o})=>{const d=()=>{const s=[];return s.push({label:"Active Devices",icon:e.jsx(oe,{size:20}),query:"status:active type:device",color:"blue"},{label:"New Customers",icon:e.jsx(de,{size:20}),query:"type:customer",color:"green"},{label:"Overdue Devices",icon:e.jsx(X,{size:20}),query:"status:pending type:device",color:"red"}),(o==="admin"||o==="customer-care")&&s.push({label:"All Products",icon:e.jsx(te,{size:20}),query:"type:product",color:"purple"},{label:"Recent Sales",icon:e.jsx(Y,{size:20}),query:"type:sale",color:"amber"}),o==="admin"&&s.push({label:"Payment Reports",icon:e.jsx(me,{size:20}),query:"type:payment",color:"emerald"},{label:"Loyalty Members",icon:e.jsx(ot,{size:20}),query:"type:loyalty",color:"yellow"},{label:"Inventory Alerts",icon:e.jsx(ct,{size:20}),query:"type:product",color:"orange"},{label:"Sales Reports",icon:e.jsx(lt,{size:20}),query:"type:report",color:"indigo"}),o==="customer-care"&&s.push({label:"Customer Issues",icon:e.jsx(ne,{size:20}),query:"status:issue",color:"pink"},{label:"Appointments",icon:e.jsx(ue,{size:20}),query:"type:appointment",color:"cyan"}),s},m=()=>{const s=[{title:"Devices",icon:e.jsx(oe,{size:24}),color:"blue",items:[{label:"By Status",query:"status:"},{label:"By Model",query:"model:"},{label:"By Customer",query:"customer:"}]},{title:"Customers",icon:e.jsx(de,{size:24}),color:"green",items:[{label:"By Name",query:"name:"},{label:"By Phone",query:"phone:"},{label:"By Email",query:"email:"},{label:"By Location",query:"location:"}]}];return(o==="admin"||o==="customer-care")&&s.push({title:"Products",icon:e.jsx(te,{size:24}),color:"purple",items:[{label:"By Name",query:"product:"},{label:"By Category",query:"category:"},{label:"By Price",query:"price:"}]}),o==="admin"&&s.push({title:"Sales & Finance",icon:e.jsx(dt,{size:24}),color:"emerald",items:[{label:"By Date",query:"date:"},{label:"By Amount",query:"amount:"},{label:"By Payment Method",query:"payment:"},{label:"By Customer",query:"customer:"}]}),s},u=d(),i=m();return e.jsxs("div",{className:"space-y-5",children:[e.jsxs("div",{className:"text-center py-3",children:[e.jsx("h1",{className:"text-2xl font-semibold text-gray-900 mb-1.5",children:"Search Everything"}),e.jsx("p",{className:"text-gray-500 max-w-2xl mx-auto text-sm",children:"Find devices, customers, products, and more"})]}),l.length>0&&e.jsxs("div",{className:"bg-white rounded-xl p-4 border border-gray-200/50 shadow-sm",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-3",children:[e.jsx(X,{size:16,className:"text-gray-400"}),e.jsx("h2",{className:"text-xs font-semibold text-gray-700",children:"Recent"})]}),e.jsx("div",{className:"flex flex-wrap gap-1.5",children:l.map((s,p)=>e.jsxs("div",{className:"flex items-center gap-1.5 px-2.5 py-1.5 bg-gray-100 hover:bg-gray-200 rounded-lg transition-all duration-150 cursor-pointer group",onClick:()=>t(s),children:[e.jsx("span",{className:"text-xs text-gray-700 font-medium",children:s}),e.jsx("button",{onClick:h=>{h.stopPropagation(),r(s)},className:"p-0.5 rounded hover:bg-gray-300 transition-colors opacity-0 group-hover:opacity-100",children:e.jsx(nt,{size:12,className:"text-gray-500"})})]},p))})]}),e.jsxs("div",{className:"bg-white rounded-xl p-4 border border-gray-200/50 shadow-sm",children:[e.jsx("h2",{className:"text-xs font-semibold text-gray-700 mb-3",children:"Quick Access"}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-3 lg:grid-cols-4 gap-1.5",children:u.map((s,p)=>e.jsxs("button",{onClick:()=>t(s.query),className:"flex items-center gap-2 p-2.5 rounded-lg bg-gray-50 hover:bg-gray-100 transition-all duration-150 text-left group",children:[e.jsx("div",{className:"p-1.5 rounded-md bg-white shadow-sm",children:s.icon}),e.jsx("span",{className:"text-xs font-medium text-gray-700 group-hover:text-gray-900 truncate",children:s.label})]},p))})]}),e.jsxs("div",{className:"bg-white rounded-xl p-4 border border-gray-200/50 shadow-sm",children:[e.jsx("h2",{className:"text-xs font-semibold text-gray-700 mb-3",children:"Categories"}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:i.map((s,p)=>e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1.5",children:[e.jsx("div",{className:"p-1.5 rounded-md bg-gray-100",children:s.icon}),e.jsx("h3",{className:"font-semibold text-gray-800 text-xs",children:s.title})]}),e.jsx("div",{className:"space-y-0.5 pl-0.5",children:s.items.map((h,x)=>e.jsxs("button",{onClick:()=>t(h.query),className:"flex items-center gap-2 w-full px-2.5 py-1.5 rounded-md hover:bg-gray-100 transition-all duration-150 text-left group",children:[e.jsx("span",{className:"text-xs text-gray-600 group-hover:text-gray-800",children:h.label}),e.jsx(wt,{size:12,className:"text-gray-400 opacity-0 group-hover:opacity-100 transition-all ml-auto"})]},x))})]},p))})]}),e.jsxs("div",{className:"bg-blue-50/40 rounded-xl p-4 border border-blue-200/30 shadow-sm",children:[e.jsx("h2",{className:"text-xs font-semibold text-gray-700 mb-3",children:"Search Tips"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-2",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("p",{className:"text-xs text-gray-600 bg-white/60 rounded-lg p-2.5",children:[e.jsx("strong",{className:"text-gray-800 font-semibold",children:"Use filters:"}),' Type "status:active" to find active devices']}),e.jsxs("p",{className:"text-xs text-gray-600 bg-white/60 rounded-lg p-2.5",children:[e.jsx("strong",{className:"text-gray-800 font-semibold",children:"Search by date:"}),' Type "date:2024-01" to find items from January 2024']}),e.jsxs("p",{className:"text-xs text-gray-600 bg-white/60 rounded-lg p-2.5",children:[e.jsx("strong",{className:"text-gray-800 font-semibold",children:"Combine terms:"}),' Type "iphone status:active" to find active iPhones']})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsxs("p",{className:"text-xs text-gray-600 bg-white/60 rounded-lg p-2.5",children:[e.jsx("strong",{className:"text-gray-800 font-semibold",children:"Exact match:"}),' Use quotes for exact phrases: "John Doe"']}),e.jsxs("p",{className:"text-xs text-gray-600 bg-white/60 rounded-lg p-2.5",children:[e.jsx("strong",{className:"text-gray-800 font-semibold",children:"Price range:"}),' Type "price:1000-5000" to find items in price range']}),e.jsxs("p",{className:"text-xs text-gray-600 bg-white/60 rounded-lg p-2.5",children:[e.jsx("strong",{className:"text-gray-800 font-semibold",children:"Location search:"}),' Type "location:Nairobi" to find items by location']})]})]})]})]})};function G(l){return Array.isArray?Array.isArray(l):gt(l)==="[object Array]"}const It=1/0;function Mt(l){if(typeof l=="string")return l;let t=l+"";return t=="0"&&1/l==-It?"-0":t}function Tt(l){return l==null?"":Mt(l)}function W(l){return typeof l=="string"}function ht(l){return typeof l=="number"}function Ft(l){return l===!0||l===!1||zt(l)&&gt(l)=="[object Boolean]"}function pt(l){return typeof l=="object"}function zt(l){return pt(l)&&l!==null}function V(l){return l!=null}function ye(l){return!l.trim().length}function gt(l){return l==null?l===void 0?"[object Undefined]":"[object Null]":Object.prototype.toString.call(l)}const qt="Incorrect 'index' type",Ut=l=>`Invalid value for key ${l}`,Vt=l=>`Pattern length exceeds max of ${l}.`,Ot=l=>`Missing ${l} property in key`,Zt=l=>`Property 'weight' in key '${l}' must be a positive integer`,tt=Object.prototype.hasOwnProperty;class Qt{constructor(t){this._keys=[],this._keyMap={};let r=0;t.forEach(o=>{let d=xt(o);this._keys.push(d),this._keyMap[d.id]=d,r+=d.weight}),this._keys.forEach(o=>{o.weight/=r})}get(t){return this._keyMap[t]}keys(){return this._keys}toJSON(){return JSON.stringify(this._keys)}}function xt(l){let t=null,r=null,o=null,d=1,m=null;if(W(l)||G(l))o=l,t=st(l),r=fe(l);else{if(!tt.call(l,"name"))throw new Error(Ot("name"));const u=l.name;if(o=u,tt.call(l,"weight")&&(d=l.weight,d<=0))throw new Error(Zt(u));t=st(u),r=fe(u),m=l.getFn}return{path:t,id:r,weight:d,src:o,getFn:m}}function st(l){return G(l)?l:l.split(".")}function fe(l){return G(l)?l.join("."):l}function Ht(l,t){let r=[],o=!1;const d=(m,u,i)=>{if(V(m))if(!u[i])r.push(m);else{let s=u[i];const p=m[s];if(!V(p))return;if(i===u.length-1&&(W(p)||ht(p)||Ft(p)))r.push(Tt(p));else if(G(p)){o=!0;for(let h=0,x=p.length;h<x;h+=1)d(p[h],u,i+1)}else u.length&&d(p,u,i+1)}};return d(l,W(t)?t.split("."):t,0),o?r:r[0]}const Kt={includeMatches:!1,findAllMatches:!1,minMatchCharLength:1},Wt={isCaseSensitive:!1,ignoreDiacritics:!1,includeScore:!1,keys:[],shouldSort:!0,sortFn:(l,t)=>l.score===t.score?l.idx<t.idx?-1:1:l.score<t.score?-1:1},Gt={location:0,threshold:.6,distance:100},Yt={useExtendedSearch:!1,getFn:Ht,ignoreLocation:!1,ignoreFieldNorm:!1,fieldNormWeight:1};var w={...Wt,...Kt,...Gt,...Yt};const Jt=/[^ ]+/g;function Xt(l=1,t=3){const r=new Map,o=Math.pow(10,t);return{get(d){const m=d.match(Jt).length;if(r.has(m))return r.get(m);const u=1/Math.pow(m,.5*l),i=parseFloat(Math.round(u*o)/o);return r.set(m,i),i},clear(){r.clear()}}}class Ae{constructor({getFn:t=w.getFn,fieldNormWeight:r=w.fieldNormWeight}={}){this.norm=Xt(r,3),this.getFn=t,this.isCreated=!1,this.setIndexRecords()}setSources(t=[]){this.docs=t}setIndexRecords(t=[]){this.records=t}setKeys(t=[]){this.keys=t,this._keysMap={},t.forEach((r,o)=>{this._keysMap[r.id]=o})}create(){this.isCreated||!this.docs.length||(this.isCreated=!0,W(this.docs[0])?this.docs.forEach((t,r)=>{this._addString(t,r)}):this.docs.forEach((t,r)=>{this._addObject(t,r)}),this.norm.clear())}add(t){const r=this.size();W(t)?this._addString(t,r):this._addObject(t,r)}removeAt(t){this.records.splice(t,1);for(let r=t,o=this.size();r<o;r+=1)this.records[r].i-=1}getValueForItemAtKeyId(t,r){return t[this._keysMap[r]]}size(){return this.records.length}_addString(t,r){if(!V(t)||ye(t))return;let o={v:t,i:r,n:this.norm.get(t)};this.records.push(o)}_addObject(t,r){let o={i:r,$:{}};this.keys.forEach((d,m)=>{let u=d.getFn?d.getFn(t):this.getFn(t,d.path);if(V(u)){if(G(u)){let i=[];const s=[{nestedArrIndex:-1,value:u}];for(;s.length;){const{nestedArrIndex:p,value:h}=s.pop();if(V(h))if(W(h)&&!ye(h)){let x={v:h,i:p,n:this.norm.get(h)};i.push(x)}else G(h)&&h.forEach((x,n)=>{s.push({nestedArrIndex:n,value:x})})}o.$[m]=i}else if(W(u)&&!ye(u)){let i={v:u,n:this.norm.get(u)};o.$[m]=i}}}),this.records.push(o)}toJSON(){return{keys:this.keys,records:this.records}}}function bt(l,t,{getFn:r=w.getFn,fieldNormWeight:o=w.fieldNormWeight}={}){const d=new Ae({getFn:r,fieldNormWeight:o});return d.setKeys(l.map(xt)),d.setSources(t),d.create(),d}function es(l,{getFn:t=w.getFn,fieldNormWeight:r=w.fieldNormWeight}={}){const{keys:o,records:d}=l,m=new Ae({getFn:t,fieldNormWeight:r});return m.setKeys(o),m.setIndexRecords(d),m}function pe(l,{errors:t=0,currentLocation:r=0,expectedLocation:o=0,distance:d=w.distance,ignoreLocation:m=w.ignoreLocation}={}){const u=t/l.length;if(m)return u;const i=Math.abs(o-r);return d?u+i/d:i?1:u}function ts(l=[],t=w.minMatchCharLength){let r=[],o=-1,d=-1,m=0;for(let u=l.length;m<u;m+=1){let i=l[m];i&&o===-1?o=m:!i&&o!==-1&&(d=m-1,d-o+1>=t&&r.push([o,d]),o=-1)}return l[m-1]&&m-o>=t&&r.push([o,m-1]),r}const ee=32;function ss(l,t,r,{location:o=w.location,distance:d=w.distance,threshold:m=w.threshold,findAllMatches:u=w.findAllMatches,minMatchCharLength:i=w.minMatchCharLength,includeMatches:s=w.includeMatches,ignoreLocation:p=w.ignoreLocation}={}){if(t.length>ee)throw new Error(Vt(ee));const h=t.length,x=l.length,n=Math.max(0,Math.min(o,x));let v=m,g=n;const c=i>1||s,f=c?Array(x):[];let b;for(;(b=l.indexOf(t,g))>-1;){let B=pe(t,{currentLocation:b,expectedLocation:n,distance:d,ignoreLocation:p});if(v=Math.min(B,v),g=b+h,c){let D=0;for(;D<h;)f[b+D]=1,D+=1}}g=-1;let A=[],k=1,C=h+x;const j=1<<h-1;for(let B=0;B<h;B+=1){let D=0,E=C;for(;D<E;)pe(t,{errors:B,currentLocation:n+E,expectedLocation:n,distance:d,ignoreLocation:p})<=v?D=E:C=E,E=Math.floor((C-D)/2+D);C=E;let O=Math.max(1,n-E+1),Z=u?x:Math.min(n+E,x)+h,I=Array(Z+2);I[Z+1]=(1<<B)-1;for(let S=Z;S>=O;S-=1){let U=S-1,se=r[l.charAt(U)];if(c&&(f[U]=+!!se),I[S]=(I[S+1]<<1|1)&se,B&&(I[S]|=(A[S+1]|A[S])<<1|1|A[S+1]),I[S]&j&&(k=pe(t,{errors:B,currentLocation:U,expectedLocation:n,distance:d,ignoreLocation:p}),k<=v)){if(v=k,g=U,g<=n)break;O=Math.max(1,2*n-g)}}if(pe(t,{errors:B+1,currentLocation:n,expectedLocation:n,distance:d,ignoreLocation:p})>v)break;A=I}const F={isMatch:g>=0,score:Math.max(.001,k)};if(c){const B=ts(f,i);B.length?s&&(F.indices=B):F.isMatch=!1}return F}function as(l){let t={};for(let r=0,o=l.length;r<o;r+=1){const d=l.charAt(r);t[d]=(t[d]||0)|1<<o-r-1}return t}const xe=String.prototype.normalize?l=>l.normalize("NFD").replace(/[\u0300-\u036F\u0483-\u0489\u0591-\u05BD\u05BF\u05C1\u05C2\u05C4\u05C5\u05C7\u0610-\u061A\u064B-\u065F\u0670\u06D6-\u06DC\u06DF-\u06E4\u06E7\u06E8\u06EA-\u06ED\u0711\u0730-\u074A\u07A6-\u07B0\u07EB-\u07F3\u07FD\u0816-\u0819\u081B-\u0823\u0825-\u0827\u0829-\u082D\u0859-\u085B\u08D3-\u08E1\u08E3-\u0903\u093A-\u093C\u093E-\u094F\u0951-\u0957\u0962\u0963\u0981-\u0983\u09BC\u09BE-\u09C4\u09C7\u09C8\u09CB-\u09CD\u09D7\u09E2\u09E3\u09FE\u0A01-\u0A03\u0A3C\u0A3E-\u0A42\u0A47\u0A48\u0A4B-\u0A4D\u0A51\u0A70\u0A71\u0A75\u0A81-\u0A83\u0ABC\u0ABE-\u0AC5\u0AC7-\u0AC9\u0ACB-\u0ACD\u0AE2\u0AE3\u0AFA-\u0AFF\u0B01-\u0B03\u0B3C\u0B3E-\u0B44\u0B47\u0B48\u0B4B-\u0B4D\u0B56\u0B57\u0B62\u0B63\u0B82\u0BBE-\u0BC2\u0BC6-\u0BC8\u0BCA-\u0BCD\u0BD7\u0C00-\u0C04\u0C3E-\u0C44\u0C46-\u0C48\u0C4A-\u0C4D\u0C55\u0C56\u0C62\u0C63\u0C81-\u0C83\u0CBC\u0CBE-\u0CC4\u0CC6-\u0CC8\u0CCA-\u0CCD\u0CD5\u0CD6\u0CE2\u0CE3\u0D00-\u0D03\u0D3B\u0D3C\u0D3E-\u0D44\u0D46-\u0D48\u0D4A-\u0D4D\u0D57\u0D62\u0D63\u0D82\u0D83\u0DCA\u0DCF-\u0DD4\u0DD6\u0DD8-\u0DDF\u0DF2\u0DF3\u0E31\u0E34-\u0E3A\u0E47-\u0E4E\u0EB1\u0EB4-\u0EB9\u0EBB\u0EBC\u0EC8-\u0ECD\u0F18\u0F19\u0F35\u0F37\u0F39\u0F3E\u0F3F\u0F71-\u0F84\u0F86\u0F87\u0F8D-\u0F97\u0F99-\u0FBC\u0FC6\u102B-\u103E\u1056-\u1059\u105E-\u1060\u1062-\u1064\u1067-\u106D\u1071-\u1074\u1082-\u108D\u108F\u109A-\u109D\u135D-\u135F\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17B4-\u17D3\u17DD\u180B-\u180D\u1885\u1886\u18A9\u1920-\u192B\u1930-\u193B\u1A17-\u1A1B\u1A55-\u1A5E\u1A60-\u1A7C\u1A7F\u1AB0-\u1ABE\u1B00-\u1B04\u1B34-\u1B44\u1B6B-\u1B73\u1B80-\u1B82\u1BA1-\u1BAD\u1BE6-\u1BF3\u1C24-\u1C37\u1CD0-\u1CD2\u1CD4-\u1CE8\u1CED\u1CF2-\u1CF4\u1CF7-\u1CF9\u1DC0-\u1DF9\u1DFB-\u1DFF\u20D0-\u20F0\u2CEF-\u2CF1\u2D7F\u2DE0-\u2DFF\u302A-\u302F\u3099\u309A\uA66F-\uA672\uA674-\uA67D\uA69E\uA69F\uA6F0\uA6F1\uA802\uA806\uA80B\uA823-\uA827\uA880\uA881\uA8B4-\uA8C5\uA8E0-\uA8F1\uA8FF\uA926-\uA92D\uA947-\uA953\uA980-\uA983\uA9B3-\uA9C0\uA9E5\uAA29-\uAA36\uAA43\uAA4C\uAA4D\uAA7B-\uAA7D\uAAB0\uAAB2-\uAAB4\uAAB7\uAAB8\uAABE\uAABF\uAAC1\uAAEB-\uAAEF\uAAF5\uAAF6\uABE3-\uABEA\uABEC\uABED\uFB1E\uFE00-\uFE0F\uFE20-\uFE2F]/g,""):l=>l;class yt{constructor(t,{location:r=w.location,threshold:o=w.threshold,distance:d=w.distance,includeMatches:m=w.includeMatches,findAllMatches:u=w.findAllMatches,minMatchCharLength:i=w.minMatchCharLength,isCaseSensitive:s=w.isCaseSensitive,ignoreDiacritics:p=w.ignoreDiacritics,ignoreLocation:h=w.ignoreLocation}={}){if(this.options={location:r,threshold:o,distance:d,includeMatches:m,findAllMatches:u,minMatchCharLength:i,isCaseSensitive:s,ignoreDiacritics:p,ignoreLocation:h},t=s?t:t.toLowerCase(),t=p?xe(t):t,this.pattern=t,this.chunks=[],!this.pattern.length)return;const x=(v,g)=>{this.chunks.push({pattern:v,alphabet:as(v),startIndex:g})},n=this.pattern.length;if(n>ee){let v=0;const g=n%ee,c=n-g;for(;v<c;)x(this.pattern.substr(v,ee),v),v+=ee;if(g){const f=n-ee;x(this.pattern.substr(f),f)}}else x(this.pattern,0)}searchIn(t){const{isCaseSensitive:r,ignoreDiacritics:o,includeMatches:d}=this.options;if(t=r?t:t.toLowerCase(),t=o?xe(t):t,this.pattern===t){let c={isMatch:!0,score:0};return d&&(c.indices=[[0,t.length-1]]),c}const{location:m,distance:u,threshold:i,findAllMatches:s,minMatchCharLength:p,ignoreLocation:h}=this.options;let x=[],n=0,v=!1;this.chunks.forEach(({pattern:c,alphabet:f,startIndex:b})=>{const{isMatch:A,score:k,indices:C}=ss(t,c,f,{location:m+b,distance:u,threshold:i,findAllMatches:s,minMatchCharLength:p,includeMatches:d,ignoreLocation:h});A&&(v=!0),n+=k,A&&C&&(x=[...x,...C])});let g={isMatch:v,score:v?n/this.chunks.length:1};return v&&d&&(g.indices=x),g}}class J{constructor(t){this.pattern=t}static isMultiMatch(t){return at(t,this.multiRegex)}static isSingleMatch(t){return at(t,this.singleRegex)}search(){}}function at(l,t){const r=l.match(t);return r?r[1]:null}class rs extends J{constructor(t){super(t)}static get type(){return"exact"}static get multiRegex(){return/^="(.*)"$/}static get singleRegex(){return/^=(.*)$/}search(t){const r=t===this.pattern;return{isMatch:r,score:r?0:1,indices:[0,this.pattern.length-1]}}}class is extends J{constructor(t){super(t)}static get type(){return"inverse-exact"}static get multiRegex(){return/^!"(.*)"$/}static get singleRegex(){return/^!(.*)$/}search(t){const o=t.indexOf(this.pattern)===-1;return{isMatch:o,score:o?0:1,indices:[0,t.length-1]}}}class ns extends J{constructor(t){super(t)}static get type(){return"prefix-exact"}static get multiRegex(){return/^\^"(.*)"$/}static get singleRegex(){return/^\^(.*)$/}search(t){const r=t.startsWith(this.pattern);return{isMatch:r,score:r?0:1,indices:[0,this.pattern.length-1]}}}class os extends J{constructor(t){super(t)}static get type(){return"inverse-prefix-exact"}static get multiRegex(){return/^!\^"(.*)"$/}static get singleRegex(){return/^!\^(.*)$/}search(t){const r=!t.startsWith(this.pattern);return{isMatch:r,score:r?0:1,indices:[0,t.length-1]}}}class cs extends J{constructor(t){super(t)}static get type(){return"suffix-exact"}static get multiRegex(){return/^"(.*)"\$$/}static get singleRegex(){return/^(.*)\$$/}search(t){const r=t.endsWith(this.pattern);return{isMatch:r,score:r?0:1,indices:[t.length-this.pattern.length,t.length-1]}}}class ls extends J{constructor(t){super(t)}static get type(){return"inverse-suffix-exact"}static get multiRegex(){return/^!"(.*)"\$$/}static get singleRegex(){return/^!(.*)\$$/}search(t){const r=!t.endsWith(this.pattern);return{isMatch:r,score:r?0:1,indices:[0,t.length-1]}}}class ft extends J{constructor(t,{location:r=w.location,threshold:o=w.threshold,distance:d=w.distance,includeMatches:m=w.includeMatches,findAllMatches:u=w.findAllMatches,minMatchCharLength:i=w.minMatchCharLength,isCaseSensitive:s=w.isCaseSensitive,ignoreDiacritics:p=w.ignoreDiacritics,ignoreLocation:h=w.ignoreLocation}={}){super(t),this._bitapSearch=new yt(t,{location:r,threshold:o,distance:d,includeMatches:m,findAllMatches:u,minMatchCharLength:i,isCaseSensitive:s,ignoreDiacritics:p,ignoreLocation:h})}static get type(){return"fuzzy"}static get multiRegex(){return/^"(.*)"$/}static get singleRegex(){return/^(.*)$/}search(t){return this._bitapSearch.searchIn(t)}}class Nt extends J{constructor(t){super(t)}static get type(){return"include"}static get multiRegex(){return/^'"(.*)"$/}static get singleRegex(){return/^'(.*)$/}search(t){let r=0,o;const d=[],m=this.pattern.length;for(;(o=t.indexOf(this.pattern,r))>-1;)r=o+m,d.push([o,r-1]);const u=!!d.length;return{isMatch:u,score:u?0:1,indices:d}}}const Ne=[rs,Nt,ns,os,ls,cs,is,ft],rt=Ne.length,ds=/ +(?=(?:[^\"]*\"[^\"]*\")*[^\"]*$)/,ms="|";function us(l,t={}){return l.split(ms).map(r=>{let o=r.trim().split(ds).filter(m=>m&&!!m.trim()),d=[];for(let m=0,u=o.length;m<u;m+=1){const i=o[m];let s=!1,p=-1;for(;!s&&++p<rt;){const h=Ne[p];let x=h.isMultiMatch(i);x&&(d.push(new h(x,t)),s=!0)}if(!s)for(p=-1;++p<rt;){const h=Ne[p];let x=h.isSingleMatch(i);if(x){d.push(new h(x,t));break}}}return d})}const hs=new Set([ft.type,Nt.type]);class ps{constructor(t,{isCaseSensitive:r=w.isCaseSensitive,ignoreDiacritics:o=w.ignoreDiacritics,includeMatches:d=w.includeMatches,minMatchCharLength:m=w.minMatchCharLength,ignoreLocation:u=w.ignoreLocation,findAllMatches:i=w.findAllMatches,location:s=w.location,threshold:p=w.threshold,distance:h=w.distance}={}){this.query=null,this.options={isCaseSensitive:r,ignoreDiacritics:o,includeMatches:d,minMatchCharLength:m,findAllMatches:i,ignoreLocation:u,location:s,threshold:p,distance:h},t=r?t:t.toLowerCase(),t=o?xe(t):t,this.pattern=t,this.query=us(this.pattern,this.options)}static condition(t,r){return r.useExtendedSearch}searchIn(t){const r=this.query;if(!r)return{isMatch:!1,score:1};const{includeMatches:o,isCaseSensitive:d,ignoreDiacritics:m}=this.options;t=d?t:t.toLowerCase(),t=m?xe(t):t;let u=0,i=[],s=0;for(let p=0,h=r.length;p<h;p+=1){const x=r[p];i.length=0,u=0;for(let n=0,v=x.length;n<v;n+=1){const g=x[n],{isMatch:c,indices:f,score:b}=g.search(t);if(c){if(u+=1,s+=b,o){const A=g.constructor.type;hs.has(A)?i=[...i,...f]:i.push(f)}}else{s=0,u=0,i.length=0;break}}if(u){let n={isMatch:!0,score:s/u};return o&&(n.indices=i),n}}return{isMatch:!1,score:1}}}const je=[];function gs(...l){je.push(...l)}function ve(l,t){for(let r=0,o=je.length;r<o;r+=1){let d=je[r];if(d.condition(l,t))return new d(l,t)}return new yt(l,t)}const be={AND:"$and",OR:"$or"},we={PATH:"$path",PATTERN:"$val"},_e=l=>!!(l[be.AND]||l[be.OR]),xs=l=>!!l[we.PATH],bs=l=>!G(l)&&pt(l)&&!_e(l),it=l=>({[be.AND]:Object.keys(l).map(t=>({[t]:l[t]}))});function jt(l,t,{auto:r=!0}={}){const o=d=>{let m=Object.keys(d);const u=xs(d);if(!u&&m.length>1&&!_e(d))return o(it(d));if(bs(d)){const s=u?d[we.PATH]:m[0],p=u?d[we.PATTERN]:d[s];if(!W(p))throw new Error(Ut(s));const h={keyId:fe(s),pattern:p};return r&&(h.searcher=ve(p,t)),h}let i={children:[],operator:m[0]};return m.forEach(s=>{const p=d[s];G(p)&&p.forEach(h=>{i.children.push(o(h))})}),i};return _e(l)||(l=it(l)),o(l)}function ys(l,{ignoreFieldNorm:t=w.ignoreFieldNorm}){l.forEach(r=>{let o=1;r.matches.forEach(({key:d,norm:m,score:u})=>{const i=d?d.weight:null;o*=Math.pow(u===0&&i?Number.EPSILON:u,(i||1)*(t?1:m))}),r.score=o})}function fs(l,t){const r=l.matches;t.matches=[],V(r)&&r.forEach(o=>{if(!V(o.indices)||!o.indices.length)return;const{indices:d,value:m}=o;let u={indices:d,value:m};o.key&&(u.key=o.key.src),o.idx>-1&&(u.refIndex=o.idx),t.matches.push(u)})}function Ns(l,t){t.score=l.score}function js(l,t,{includeMatches:r=w.includeMatches,includeScore:o=w.includeScore}={}){const d=[];return r&&d.push(fs),o&&d.push(Ns),l.map(m=>{const{idx:u}=m,i={item:t[u],refIndex:u};return d.length&&d.forEach(s=>{s(m,i)}),i})}class K{constructor(t,r={},o){this.options={...w,...r},this.options.useExtendedSearch,this._keyStore=new Qt(this.options.keys),this.setCollection(t,o)}setCollection(t,r){if(this._docs=t,r&&!(r instanceof Ae))throw new Error(qt);this._myIndex=r||bt(this.options.keys,this._docs,{getFn:this.options.getFn,fieldNormWeight:this.options.fieldNormWeight})}add(t){V(t)&&(this._docs.push(t),this._myIndex.add(t))}remove(t=()=>!1){const r=[];for(let o=0,d=this._docs.length;o<d;o+=1){const m=this._docs[o];t(m,o)&&(this.removeAt(o),o-=1,d-=1,r.push(m))}return r}removeAt(t){this._docs.splice(t,1),this._myIndex.removeAt(t)}getIndex(){return this._myIndex}search(t,{limit:r=-1}={}){const{includeMatches:o,includeScore:d,shouldSort:m,sortFn:u,ignoreFieldNorm:i}=this.options;let s=W(t)?W(this._docs[0])?this._searchStringList(t):this._searchObjectList(t):this._searchLogical(t);return ys(s,{ignoreFieldNorm:i}),m&&s.sort(u),ht(r)&&r>-1&&(s=s.slice(0,r)),js(s,this._docs,{includeMatches:o,includeScore:d})}_searchStringList(t){const r=ve(t,this.options),{records:o}=this._myIndex,d=[];return o.forEach(({v:m,i:u,n:i})=>{if(!V(m))return;const{isMatch:s,score:p,indices:h}=r.searchIn(m);s&&d.push({item:m,idx:u,matches:[{score:p,value:m,norm:i,indices:h}]})}),d}_searchLogical(t){const r=jt(t,this.options),o=(i,s,p)=>{if(!i.children){const{keyId:x,searcher:n}=i,v=this._findMatches({key:this._keyStore.get(x),value:this._myIndex.getValueForItemAtKeyId(s,x),searcher:n});return v&&v.length?[{idx:p,item:s,matches:v}]:[]}const h=[];for(let x=0,n=i.children.length;x<n;x+=1){const v=i.children[x],g=o(v,s,p);if(g.length)h.push(...g);else if(i.operator===be.AND)return[]}return h},d=this._myIndex.records,m={},u=[];return d.forEach(({$:i,i:s})=>{if(V(i)){let p=o(r,i,s);p.length&&(m[s]||(m[s]={idx:s,item:i,matches:[]},u.push(m[s])),p.forEach(({matches:h})=>{m[s].matches.push(...h)}))}}),u}_searchObjectList(t){const r=ve(t,this.options),{keys:o,records:d}=this._myIndex,m=[];return d.forEach(({$:u,i})=>{if(!V(u))return;let s=[];o.forEach((p,h)=>{s.push(...this._findMatches({key:p,value:u[h],searcher:r}))}),s.length&&m.push({idx:i,item:u,matches:s})}),m}_findMatches({key:t,value:r,searcher:o}){if(!V(r))return[];let d=[];if(G(r))r.forEach(({v:m,i:u,n:i})=>{if(!V(m))return;const{isMatch:s,score:p,indices:h}=o.searchIn(m);s&&d.push({score:p,key:t,value:m,idx:u,norm:i,indices:h})});else{const{v:m,n:u}=r,{isMatch:i,score:s,indices:p}=o.searchIn(m);i&&d.push({score:s,key:t,value:m,norm:u,indices:p})}return d}}K.version="7.1.0";K.createIndex=bt;K.parseIndex=es;K.config=w;K.parseQuery=jt;gs(ps);const vs=[{id:"dashboard",path:"/dashboard",title:"Dashboard",description:"View overview and analytics",icon:"ðŸ“Š",category:"main",allowedRoles:["admin","customer-care","technician","manager"]},{id:"devices",path:"/devices",title:"Devices",description:"Manage repair devices",icon:"ðŸ“±",category:"main",allowedRoles:["admin","customer-care","technician"]},{id:"customers",path:"/customers",title:"Customers",description:"Manage customer information",icon:"ðŸ‘¥",category:"main",allowedRoles:["admin","customer-care"]},{id:"pos",path:"/pos",title:"Point of Sale",description:"New sale transaction",icon:"ðŸ’°",category:"main",allowedRoles:["admin","customer-care"]},{id:"settings",path:"/settings",title:"Settings",description:"Application settings",icon:"âš™ï¸",category:"main",allowedRoles:["admin","customer-care","technician","manager"]},{id:"lats-dashboard",path:"/lats",title:"LATS Dashboard",description:"LATS module dashboard",icon:"ðŸ“Š",category:"lats",allowedRoles:["admin"]},{id:"inventory",path:"/lats/unified-inventory",title:"Inventory",description:"Manage product inventory",icon:"ðŸ“¦",category:"lats",allowedRoles:["admin"]},{id:"inventory-management",path:"/lats/inventory-management",title:"Inventory Management",description:"Advanced inventory management",icon:"ðŸ“¦",category:"lats",allowedRoles:["admin"]},{id:"storage-rooms",path:"/lats/storage-rooms",title:"Storage Rooms",description:"Manage storage locations",icon:"ðŸ¢",category:"lats",allowedRoles:["admin"]},{id:"spare-parts",path:"/lats/spare-parts",title:"Spare Parts",description:"Manage spare parts inventory",icon:"ðŸ”§",category:"lats",allowedRoles:["admin","technician"]},{id:"stock-transfers",path:"/lats/stock-transfers",title:"Stock Transfers",description:"Transfer stock between locations",icon:"ðŸ“¤",category:"lats",allowedRoles:["admin"]},{id:"sales",path:"/lats/sales-reports",title:"Sales Reports",description:"View sales history and reports",icon:"ðŸ“ˆ",category:"lats",allowedRoles:["admin","customer-care"]},{id:"loyalty",path:"/lats/loyalty",title:"Loyalty Management",description:"Customer loyalty programs",icon:"ðŸŽ",category:"lats",allowedRoles:["admin"]},{id:"purchase-orders",path:"/lats/purchase-orders",title:"Purchase Orders",description:"Manage supplier orders",icon:"ðŸ›’",category:"lats",allowedRoles:["admin"]},{id:"create-purchase-order",path:"/lats/purchase-order/create",title:"Create Purchase Order",description:"Create new purchase order",icon:"âž•",category:"lats",allowedRoles:["admin"]},{id:"shipped-items",path:"/lats/purchase-orders/shipped-items",title:"Shipped Items",description:"View shipped purchase order items",icon:"ðŸ“¦",category:"lats",allowedRoles:["admin"]},{id:"trade-in",path:"/lats/trade-in/management",title:"Trade-In Management",description:"Manage trade-in transactions",icon:"ðŸ”„",category:"lats",allowedRoles:["admin"]},{id:"admin-reports",path:"/admin/reports",title:"Admin Reports",description:"Administrative reports",icon:"ðŸ“Š",category:"admin",allowedRoles:["admin","manager"]},{id:"error-logs",path:"/admin/error-logs",title:"Cache Error Logs",description:"Monitor cache management errors in offline operations",icon:"ðŸš¨",category:"admin",allowedRoles:["admin"]},{id:"customer-update",path:"/customers/update",title:"Customer Data Update",description:"Update customer information",icon:"ðŸ‘¤",category:"main",allowedRoles:["admin"]},{id:"new-device",path:"/devices/new",title:"New Device",description:"Add new repair device",icon:"ðŸ“±",category:"main",allowedRoles:["admin","customer-care"]},{id:"sms-control",path:"/sms",title:"SMS Control Center",description:"SMS management and control",icon:"ðŸ’¬",category:"sms",allowedRoles:["admin","customer-care"]},{id:"bulk-sms",path:"/sms/bulk",title:"Bulk SMS",description:"Send bulk SMS messages",icon:"ðŸ“¨",category:"sms",allowedRoles:["admin","customer-care"]},{id:"sms-logs",path:"/sms/logs",title:"SMS Logs",description:"View SMS message logs",icon:"ðŸ“‹",category:"sms",allowedRoles:["admin","customer-care"]},{id:"sms-settings",path:"/sms/settings",title:"SMS Settings",description:"Configure SMS settings",icon:"âš™ï¸",category:"sms",allowedRoles:["admin"]},{id:"scheduled-messages",path:"/sms/scheduled",title:"Scheduled Messages",description:"Manage scheduled bulk SMS and WhatsApp messages",icon:"ðŸ“…",category:"sms",allowedRoles:["admin","customer-care"]},{id:"appointments",path:"/appointments",title:"Appointments",description:"Manage appointments",icon:"ðŸ“…",category:"main",allowedRoles:["admin","customer-care","technician"]},{id:"reminders",path:"/reminders",title:"Reminders",description:"Manage reminders",icon:"â°",category:"main",allowedRoles:["admin","customer-care","technician"]},{id:"special-orders",path:"/special-orders",title:"Special Orders",description:"Manage special orders",icon:"ðŸ“",category:"main",allowedRoles:["admin","sales","manager","customer-care"]},{id:"installments",path:"/installments",title:"Installments",description:"Manage installment plans",icon:"ðŸ’³",category:"main",allowedRoles:["admin","sales","manager","customer-care"]},{id:"employees",path:"/employees",title:"Employees",description:"Manage employees",icon:"ðŸ‘¨â€ðŸ’¼",category:"employee",allowedRoles:["admin","manager"]},{id:"my-attendance",path:"/my-attendance",title:"My Attendance",description:"View your attendance",icon:"âœ…",category:"employee",allowedRoles:["admin","customer-care","technician","manager","sales"]},{id:"admin-settings",path:"/admin-settings",title:"Admin Settings",description:"Administrative settings",icon:"âš™ï¸",category:"admin",allowedRoles:["admin"]},{id:"user-management",path:"/users",title:"User Management",description:"Manage users and permissions",icon:"ðŸ‘¥",category:"admin",allowedRoles:["admin"]},{id:"integration-settings",path:"/integration-settings",title:"Integration Settings",description:"Configure integrations",icon:"ðŸ”—",category:"admin",allowedRoles:["admin"]},{id:"integrations-test",path:"/integrations-test",title:"Integrations Test",description:"Test integrations",icon:"ðŸ§ª",category:"admin",allowedRoles:["admin"]},{id:"payments",path:"/payments",title:"Payments",description:"Track payment transactions",icon:"ðŸ’³",category:"main",allowedRoles:["admin"]},{id:"expenses",path:"/expenses",title:"Expenses",description:"Manage expenses",icon:"ðŸ’°",category:"main",allowedRoles:["admin"]},{id:"category-management",path:"/category-management",title:"Category Management",description:"Manage product categories",icon:"ðŸ“‚",category:"admin",allowedRoles:["admin"]},{id:"store-locations",path:"/store-locations",title:"Store Locations",description:"Manage store locations",icon:"ðŸ“",category:"admin",allowedRoles:["admin"]},{id:"supplier-management",path:"/supplier-management",title:"Supplier Management",description:"Manage suppliers",icon:"ðŸª",category:"admin",allowedRoles:["admin"]},{id:"suppliers",path:"/lats/purchase-orders/suppliers",title:"Suppliers",description:"Manage suppliers",icon:"ðŸª",category:"lats",allowedRoles:["admin"]},{id:"excel-import",path:"/excel-import",title:"Excel Import",description:"Import data from Excel",icon:"ðŸ“¥",category:"data",allowedRoles:["admin"]},{id:"excel-templates",path:"/excel-templates",title:"Excel Templates",description:"Download Excel templates",icon:"ðŸ“„",category:"data",allowedRoles:["admin"]},{id:"customer-import",path:"/customers/import",title:"Customer Import",description:"Import customers from Excel",icon:"ðŸ“¥",category:"data",allowedRoles:["admin"]},{id:"ad-generator",path:"/ad-generator",title:"Product Ad Generator",description:"Generate product advertisements",icon:"ðŸŽ¨",category:"tools",allowedRoles:["admin"]},{id:"bluetooth-printer",path:"/bluetooth-printer",title:"Bluetooth Printer",description:"Configure Bluetooth printer",icon:"ðŸ–¨ï¸",category:"tools",allowedRoles:["admin","customer-care"]}];function ws(l){return vs.filter(t=>!t.allowedRoles||t.allowedRoles.length===0?!0:t.allowedRoles.includes(l))}class _s{constructor(t){this.cache=new Map,this.cacheExpiry=3e4,this.userRole=t}getCached(t){const r=this.cache.get(t);return r&&Date.now()-r.timestamp<this.cacheExpiry?r.results:null}setCache(t,r){this.cache.set(t,{results:r,timestamp:Date.now()})}clearCache(){this.cache.clear()}parseQuery(t){const r={},o=[],d=[],m=/"([^"]+)"/g;let u;for(;(u=m.exec(t))!==null;)d.push(u[1]);let i=t.replace(m,"");const s=/(\w+):([^\s"']+)/g;let p;for(;(p=s.exec(i))!==null;){const x=p[1];let n=p[2];if(x==="date"&&/^\d{4}-\d{2}$/.test(n)){const[v,g]=n.split("-"),c=`${v}-${g}-01`,f=new Date(parseInt(v),parseInt(g),0).getDate(),b=`${v}-${g}-${f}`;r[x]=`${c}-${b}`}else r[x]=n}const h=i.replace(s,"").trim();if(h){const x=h.split(/\s+/).filter(n=>n.length>0);o.push(...x)}return o.push(...d),{filters:r,terms:o}}async searchDevices(t,r){try{let o=P.from("devices").select(`
          id,
          model,
          serial_number,
          status,
          problem_description,
          estimated_completion_date,
          created_at,
          updated_at
        `).order("created_at",{ascending:!1});t.status&&(o=o.eq("status",t.status));const{data:d,error:m}=await o;if(m)return console.error("Error fetching devices:",m),[];if(!d||d.length===0)return[];let i=d.map(s=>({id:s.id,model:s.model||"",serialNumber:s.serial_number||"",status:s.status||"",issue:s.problem_description||"",expectedReturnDate:s.estimated_completion_date||"",createdAt:s.created_at,updatedAt:s.updated_at}));if(t.model&&(i=i.filter(s=>s.model.toLowerCase().includes(t.model.toLowerCase()))),r.length>0){const s=r.filter(f=>f.includes(" ")||f.length>3),p=r.filter(f=>!f.includes(" ")&&f.length<=3);let h=[];s.length>0&&(s.forEach(f=>{const b=i.filter(A=>A.model.toLowerCase().includes(f.toLowerCase())||A.serialNumber.toLowerCase().includes(f.toLowerCase())||A.issue.toLowerCase().includes(f.toLowerCase()));h.push(...b)}),h=h.filter((f,b,A)=>b===A.findIndex(k=>k.id===f.id)));const x=p.length>0?p.join(" "):r.join(" "),v=new K(i,{keys:["model","serialNumber","issue","status"],threshold:.3,includeScore:!0,includeMatches:!0}).search(x);return[...h.map(f=>({item:f,score:0,matches:[]})),...v].filter((f,b,A)=>b===A.findIndex(k=>k.item.id===f.item.id)).map(f=>{var k;const b=f.item,A=((k=f.matches)==null?void 0:k.map(C=>C.key||""))||[];return{id:b.id,type:"device",title:b.model,subtitle:b.serialNumber||"No serial number",description:`Status: ${b.status}${b.issue?" | Issue: "+b.issue:""}`,url:`/devices/${b.id}`,metadata:{status:b.status,serialNumber:b.serialNumber,issue:b.issue,expectedReturnDate:b.expectedReturnDate},priority:b.status==="pending"||b.status==="in-progress"?1:2,score:f.score,matches:A,createdAt:b.createdAt,updatedAt:b.updatedAt}})}return i.map(s=>({id:s.id,type:"device",title:s.model,subtitle:s.serialNumber||"No serial number",description:`Status: ${s.status}${s.issue?" | Issue: "+s.issue:""}`,url:`/devices/${s.id}`,metadata:{status:s.status,serialNumber:s.serialNumber,issue:s.issue,expectedReturnDate:s.expectedReturnDate},priority:s.status==="pending"||s.status==="in-progress"?1:2,createdAt:s.createdAt,updatedAt:s.updatedAt}))}catch(o){return console.error("Error in searchDevices:",o),[]}}async searchCustomers(t,r){try{let o=P.from("customers").select(`
          id,
          name,
          phone,
          email,
          city,
          notes,
          gender,
          whatsapp,
          birthday,
          national_id,
          referral_source,
          location_description,
          loyalty_level,
          points,
          total_spent,
          total_purchases,
          last_visit,
          joined_date,
          is_active,
          color_tag,
          customer_tag,
          total_calls,
          call_loyalty_level,
          created_at,
          updated_at
        `).order("created_at",{ascending:!1});const{data:d,error:m}=await o;if(m)return console.error("Error fetching customers:",m),[];if(!d||d.length===0)return[];let i=d.map(s=>({id:s.id,name:s.name||"",phone:s.phone||"",email:s.email||"",location:s.city||"",notes:s.notes||"",gender:s.gender||"",whatsapp:s.whatsapp||"",birthday:s.birthday||"",nationalId:s.national_id||"",referralSource:s.referral_source||"",locationDescription:s.location_description||"",loyaltyLevel:s.loyalty_level||"",points:s.points||0,totalSpent:s.total_spent||0,totalPurchases:s.total_purchases||0,lastVisit:s.last_visit||"",joinedDate:s.joined_date||s.created_at||"",isActive:s.is_active!==!1,colorTag:s.color_tag||"",customerTag:s.customer_tag||"",totalCalls:s.total_calls||0,callLoyaltyLevel:s.call_loyalty_level||"",createdAt:s.created_at,updatedAt:s.updated_at}));if(t.name||t.customer){const s=t.customer||t.name;i=i.filter(p=>p.name.toLowerCase().includes(s.toLowerCase()))}if(t.phone&&(i=i.filter(s=>s.phone?Rt(s.phone,t.phone):!1)),t.email&&(i=i.filter(s=>s.email.toLowerCase().includes(t.email.toLowerCase()))),t.location&&(i=i.filter(s=>s.location.toLowerCase().includes(t.location.toLowerCase()))),r.length>0){const s=new K(i,{keys:["name","phone","email","location","notes"],threshold:.3,includeScore:!0,includeMatches:!0}),p=r.join(" ");return s.search(p).map(x=>{var g;const n=x.item,v=((g=x.matches)==null?void 0:g.map(c=>c.key||""))||[];return{id:n.id,type:"customer",title:n.name,subtitle:n.phone,description:`${n.email||"No email"} | ${n.location||"No location"}`,url:`/customers/${n.id}`,metadata:{email:n.email,location:n.location,phone:n.phone,whatsapp:n.whatsapp,gender:n.gender,city:n.city,locationDescription:n.locationDescription,nationalId:n.nationalId,referralSource:n.referralSource,loyaltyLevel:n.loyaltyLevel,points:n.points,totalSpent:n.totalSpent,lastVisit:n.lastVisit,isActive:n.isActive,totalPurchases:n.totalPurchases,colorTag:n.colorTag,customerTag:n.customerTag,birthday:n.birthday,joinedDate:n.joinedDate,totalCalls:n.totalCalls,callLoyaltyLevel:n.callLoyaltyLevel,notes:n.notes},priority:0,score:x.score,matches:v,createdAt:n.createdAt,updatedAt:n.updatedAt}})}return i.map(s=>({id:s.id,type:"customer",title:s.name,subtitle:s.phone,description:`${s.email||"No email"} | ${s.location||"No location"}`,url:`/customers/${s.id}`,metadata:{email:s.email,location:s.location,phone:s.phone,whatsapp:s.whatsapp,gender:s.gender,city:s.city,loyaltyLevel:s.loyalty_level,points:s.points,totalSpent:s.total_spent,lastVisit:s.last_visit,isActive:s.is_active,totalPurchases:s.total_purchases,colorTag:s.color_tag,birthday:s.birthday,joinedDate:s.joined_date,totalCalls:s.total_calls,callLoyaltyLevel:s.call_loyalty_level},priority:0,createdAt:s.createdAt,updatedAt:s.updatedAt}))}catch(o){return console.error("Error in searchCustomers:",o),[]}}async searchProducts(t,r){if(this.userRole!=="admin"&&this.userRole!=="customer-care")return[];try{let o=P.from("lats_products").select(`
          id,
          name,
          description,
          sku,
          barcode,
          cost_price,
          selling_price,
          stock_quantity,
          min_stock_level,
          category_id,
          branch_id,
          is_active,
          created_at,
          updated_at,
          lats_categories(name),
          lats_product_variants(
            id,
            sku,
            name,
            variant_name,
            cost_price,
            selling_price,
            unit_price,
            quantity,
            parent_variant_id,
            is_parent,
            variant_type
          )
        `).order("created_at",{ascending:!1});t.category&&(o=o.eq("category_id",t.category));const{data:d,error:m}=await o;if(m)return console.error("Error fetching products:",m),[];if(!d||d.length===0)return[];const u=d.map(g=>g.id),{data:i,error:s}=await P.from("lats_product_variants").select(`
          id,
          product_id,
          sku,
          name,
          variant_name,
          cost_price,
          selling_price,
          unit_price,
          quantity,
          parent_variant_id,
          is_parent,
          variant_type,
          is_active
        `).in("product_id",u).eq("is_active",!0);s&&console.error("Error fetching variants:",s);const p=new Map;i&&i.forEach(g=>{const c=g.product_id;p.has(c)||p.set(c,[]),p.get(c).push(g)}),d.length>0;let x=d.map(g=>{var a;let c=p.get(g.id)||[];c.length===0&&g.lats_product_variants&&(c=Array.isArray(g.lats_product_variants)?g.lats_product_variants:[g.lats_product_variants]);const f=c.filter(N=>!N.parent_variant_id),b=c.filter(N=>N.parent_variant_id),A=new Map;b.forEach(N=>{const _=N.parent_variant_id;A.has(_)||A.set(_,[]),A.get(_).push(N)});const k=f.map(N=>({...N,children:A.get(N.id)||[]})),C=c,j=N=>{if(N==null||N==="")return null;const _=Number(N);return isNaN(_)?null:_},F=j(g.selling_price)??j(g.sellingPrice)??j(g.price)??j(g.unit_price),B=j(g.cost_price)??j(g.costPrice);let D=null,E=null;const O=N=>j(N.sellingPrice)??j(N.price)??j(N.unit_price)??j(N.selling_price),Z=N=>j(N.cost_price)??j(N.costPrice);for(const N of C){const _=O(N),L=Z(N);_!=null&&D===null&&(D=_),L!=null&&E===null&&(E=L)}for(const N of k){const _=O(N),L=Z(N);if(_!=null&&D===null&&(D=_),L!=null&&E===null&&(E=L),N.children&&N.children.length>0)for(const T of N.children){const ae=O(T),Q=Z(T);ae!=null&&D===null&&(D=ae),Q!=null&&E===null&&(E=Q)}}let I=null;F!=null&&F>0?I=F:D!=null&&D>0?I=D:F!=null?I=F:D!=null&&(I=D);let M=null;B!=null&&B>0?M=B:E!=null&&E>0?M=E:B!=null?M=B:E!=null&&(M=E);const S=C.reduce((N,_)=>{const L=_.quantity??_.stock_quantity??0,T=typeof L=="number"?L:L!=null?Number(L):0;return N+(isNaN(T)?0:T)},0),se=(g.stock_quantity!=null?Number(g.stock_quantity):0)||S||0;return{id:g.id,name:g.name||"",description:g.description||"",sku:g.sku||"",barcode:g.barcode||"",price:I??null,costPrice:M??null,sellingPrice:I??null,stockQuantity:se,categoryId:g.category_id||"",categoryName:((a=g.lats_categories)==null?void 0:a.name)||"",branchId:g.branch_id||"",isActive:g.is_active??!0,variants:k,allVariants:C,hasPrice:I!=null,createdAt:g.created_at,updatedAt:g.updated_at}});if(t.price){const g=t.price.split("-");if(g.length===2){const c=parseFloat(g[0]),f=g[1]?parseFloat(g[1]):1/0;x=x.filter(b=>b.price!=null&&b.price>=c&&b.price<=f)}else{const c=parseFloat(t.price);x=x.filter(f=>f.price!=null&&f.price===c)}}if(t.stock&&(x=x.filter(g=>{const c=g.stockQuantity||0;switch(t.stock){case"in-stock":return c>0;case"low-stock":const f=g.minStockLevel||10;return c>0&&c<=f;case"out-of-stock":return c===0;default:return!0}})),t.category&&!t.category.match(/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i)&&(x=x.filter(g=>{var c;return(c=g.categoryName)==null?void 0:c.toLowerCase().includes(t.category.toLowerCase())})),r.length>0){const g=r.join(" ").toLowerCase(),f=new K(x,{keys:["name","description","sku","barcode","categoryName"],threshold:.5,includeScore:!0,includeMatches:!0,ignoreLocation:!0,minMatchCharLength:2}).search(g);let b=f;f.length===0&&(b=x.filter(j=>[j.name||"",j.description||"",j.sku||"",j.barcode||"",j.categoryName||""].join(" ").toLowerCase().includes(g)).map(j=>({item:j,score:.5,matches:[]})));const A=new Set;return b.filter(C=>{const j=C.item.id;return A.has(j)?!1:(A.add(j),!0)}).map(C=>{var B,D;const j=C.item,F=((B=C.matches)==null?void 0:B.map(E=>E.key||""))||[];return{id:j.id,type:"product",title:j.name,subtitle:j.sku,description:j.description||`Price: ${j.price!=null?`TZS ${j.price.toLocaleString()}`:"No price"} | Stock: ${j.stockQuantity}`,url:"/lats/unified-inventory",metadata:{price:j.price,sellingPrice:j.sellingPrice,costPrice:j.costPrice,stock:j.stockQuantity,category:j.categoryId,categoryName:j.categoryName,sku:j.sku,barcode:j.barcode,isActive:j.isActive,hasVariants:j.variants&&j.variants.length>0,variantCount:((D=j.variants)==null?void 0:D.length)||0,variants:j.variants,hasPrice:j.hasPrice},priority:j.stockQuantity<10?1:2,score:C.score,matches:F,createdAt:j.createdAt,updatedAt:j.updatedAt}})}const n=new Set;return x.filter(g=>n.has(g.id)?!1:(n.add(g.id),!0)).map(g=>{var c;return{id:g.id,type:"product",title:g.name,subtitle:g.sku,description:g.description||`Price: ${g.price!=null?`TZS ${g.price.toLocaleString()}`:"No price"} | Stock: ${g.stockQuantity}`,url:"/lats/unified-inventory",metadata:{price:g.price,sellingPrice:g.sellingPrice,costPrice:g.costPrice,stock:g.stockQuantity,category:g.categoryId,categoryName:g.categoryName,sku:g.sku,barcode:g.barcode,isActive:g.isActive,hasVariants:g.variants&&g.variants.length>0,variantCount:((c=g.variants)==null?void 0:c.length)||0,variants:g.variants,hasPrice:g.hasPrice},priority:g.stockQuantity<10?1:2,createdAt:g.createdAt,updatedAt:g.updatedAt}})}catch(o){return console.error("Error in searchProducts:",o),[]}}async searchInstallmentPlans(t,r){try{let o=P.from("customer_installment_plans").select(`
          id,
          plan_number,
          customer_id,
          sale_id,
          total_amount,
          balance_due,
          status,
          created_at,
          updated_at,
          customer:customers!customer_id(id, name, phone, email)
        `).order("created_at",{ascending:!1});const{data:d,error:m}=await o;if(m)return console.error("Error fetching installment plans:",m),[];if(!d||d.length===0)return[];const u=d.map(i=>{var s,p;return{id:i.id,planNumber:i.plan_number||"",customerName:((s=i.customer)==null?void 0:s.name)||"",customerPhone:((p=i.customer)==null?void 0:p.phone)||"",totalAmount:Number(i.total_amount||0),balanceDue:Number(i.balance_due||0),status:i.status||"",createdAt:i.created_at,updatedAt:i.updated_at}});if(r.length>0){const i=r.join(" ").toLowerCase();return u.filter(p=>p.planNumber.toLowerCase().includes(i)||p.customerName.toLowerCase().includes(i)||p.customerPhone.includes(i)).map(p=>({id:p.id,type:"payment",title:`Installment Plan ${p.planNumber}`,subtitle:p.customerName||"Unknown Customer",description:`Total: TZS ${p.totalAmount.toLocaleString()} | Balance: TZS ${p.balanceDue.toLocaleString()} | Status: ${p.status}`,url:"/installments",metadata:{planNumber:p.planNumber,customerName:p.customerName,customerPhone:p.customerPhone,totalAmount:p.totalAmount,balanceDue:p.balanceDue,status:p.status},priority:p.status==="active"?1:2,createdAt:p.createdAt,updatedAt:p.updatedAt}))}return u.map(i=>({id:i.id,type:"payment",title:`Installment Plan ${i.planNumber}`,subtitle:i.customerName||"Unknown Customer",description:`Total: TZS ${i.totalAmount.toLocaleString()} | Balance: TZS ${i.balanceDue.toLocaleString()} | Status: ${i.status}`,url:"/installments",metadata:{planNumber:i.planNumber,customerName:i.customerName,customerPhone:i.customerPhone,totalAmount:i.totalAmount,balanceDue:i.balanceDue,status:i.status},priority:i.status==="active"?1:2,createdAt:i.createdAt,updatedAt:i.updatedAt}))}catch(o){return console.error("Error in searchInstallmentPlans:",o),[]}}async searchByInstallmentPlanNumber(t){var r,o,d;try{const{data:m,error:u}=await P.from("customer_installment_plans").select(`
          id,
          plan_number,
          customer_id,
          sale_id,
          total_amount,
          balance_due,
          status,
          created_at,
          updated_at,
          customer:customers!customer_id(id, name, phone, email)
        `).eq("plan_number",t.toUpperCase()).single();return u||!m?[]:[{id:m.id,type:"payment",title:`Installment Plan ${m.plan_number}`,subtitle:((r=m.customer)==null?void 0:r.name)||"Unknown Customer",description:`Total: TZS ${Number(m.total_amount||0).toLocaleString()} | Balance: TZS ${Number(m.balance_due||0).toLocaleString()} | Status: ${m.status}`,url:"/installments",metadata:{planNumber:m.plan_number,customerName:(o=m.customer)==null?void 0:o.name,customerPhone:(d=m.customer)==null?void 0:d.phone,totalAmount:Number(m.total_amount||0),balanceDue:Number(m.balance_due||0),status:m.status},priority:0,createdAt:m.created_at,updatedAt:m.updated_at}]}catch(m){return console.error("Error in searchByInstallmentPlanNumber:",m),[]}}async searchByNumericID(t){const r=[],o=parseInt(t,10);if(isNaN(o))return[];try{const{data:d,error:m}=await P.from("lats_sales").select("id, sale_number, customer_name, customer_phone, total_amount, created_at, updated_at").or(`sale_number.eq.${t},sale_number.ilike.%${t}%`);!m&&d&&d.length>0&&d.forEach(h=>{r.push({id:h.id,type:"sale",title:`Sale #${h.sale_number||h.id}`,subtitle:h.customer_name||"Walk-in Customer",description:`Amount: TZS ${(h.total_amount||0).toLocaleString()} | Date: ${new Date(h.created_at).toLocaleDateString()}`,url:"/lats/sales-reports",metadata:{amount:h.total_amount,date:h.created_at,customer:h.customer_name},priority:0,createdAt:h.created_at,updatedAt:h.updated_at})});const{data:u,error:i}=await P.from("customer_installment_plans").select(`
          id,
          plan_number,
          customer_id,
          total_amount,
          balance_due,
          status,
          created_at,
          updated_at,
          customer:customers!customer_id(id, name, phone, email)
        `).ilike("plan_number",`%${t}%`);!i&&u&&u.length>0&&u.forEach(h=>{var x,n,v;r.push({id:h.id,type:"payment",title:`Installment Plan ${h.plan_number}`,subtitle:((x=h.customer)==null?void 0:x.name)||"Unknown Customer",description:`Total: TZS ${Number(h.total_amount||0).toLocaleString()} | Balance: TZS ${Number(h.balance_due||0).toLocaleString()} | Status: ${h.status}`,url:"/installments",metadata:{planNumber:h.plan_number,customerName:(n=h.customer)==null?void 0:n.name,customerPhone:(v=h.customer)==null?void 0:v.phone,totalAmount:Number(h.total_amount||0),balanceDue:Number(h.balance_due||0),status:h.status},priority:0,createdAt:h.created_at,updatedAt:h.updated_at})});const{data:s,error:p}=await P.from("devices").select("id, model, serial_number, status, problem_description, created_at, updated_at").or(`serial_number.ilike.%${t}%`);if(!p&&s&&s.length>0&&s.forEach(h=>{r.push({id:h.id,type:"device",title:h.model||"Device",subtitle:h.serial_number||"No serial number",description:`Status: ${h.status||"Unknown"}${h.problem_description?" | Issue: "+h.problem_description:""}`,url:`/devices/${h.id}`,metadata:{status:h.status,serialNumber:h.serial_number,issue:h.problem_description},priority:0,createdAt:h.created_at,updatedAt:h.updated_at})}),this.userRole==="admin"||this.userRole==="customer-care"){const{data:h,error:x}=await P.from("lats_products").select("id, name, sku, barcode, selling_price, stock_quantity, created_at, updated_at").or(`sku.ilike.%${t}%,barcode.ilike.%${t}%`);!x&&h&&h.length>0&&h.forEach(n=>{r.push({id:n.id,type:"product",title:n.name||"Product",subtitle:n.sku||"No SKU",description:`Price: TZS ${(n.selling_price||0).toLocaleString()} | Stock: ${n.stock_quantity||0}`,url:"/lats/unified-inventory",metadata:{price:n.selling_price,stock:n.stock_quantity,sku:n.sku,barcode:n.barcode},priority:0,createdAt:n.created_at,updatedAt:n.updated_at})})}return r}catch(d){return console.error("Error in searchByNumericID:",d),[]}}async searchSales(t,r){if(this.userRole!=="admin")return[];try{const{data:o,error:d}=await P.from("lats_sales").select(`
          id,
          sale_number,
          customer_name,
          customer_phone,
          total_amount,
          created_at,
          updated_at
        `).order("created_at",{ascending:!1});if(d)return console.error("Error fetching sales for search:",d),[];let u=(o||[]).map(i=>({id:i.id,saleNumber:i.sale_number||"",totalAmount:i.total_amount||0,customerName:i.customer_name||"Walk-in Customer",customerPhone:i.customer_phone||"",createdAt:i.created_at,updatedAt:i.updated_at}));if(t.date){const i=t.date;if(i.includes("-")){const[s,p]=i.split("-");u=u.filter(h=>{const x=new Date(h.createdAt);return x>=new Date(s)&&x<=new Date(p)})}else u=u.filter(s=>{const p=new Date(s.createdAt),h=parseInt(i);return p.getFullYear()===h})}if(t.amount){const i=t.amount.split("-");if(i.length===2){const s=parseFloat(i[0]),p=i[1]?parseFloat(i[1]):1/0;u=u.filter(h=>h.totalAmount>=s&&h.totalAmount<=p)}else{const s=parseFloat(t.amount);u=u.filter(p=>p.totalAmount===s)}}if(t.customer&&(u=u.filter(i=>i.customerName.toLowerCase().includes(t.customer.toLowerCase()))),r.length>0){const i=new K(u,{keys:["saleNumber","customerName","customerPhone"],threshold:.3,includeScore:!0,includeMatches:!0}),s=r.join(" ");return i.search(s).map(h=>{var v;const x=h.item,n=((v=h.matches)==null?void 0:v.map(g=>g.key||""))||[];return{id:x.id,type:"sale",title:`Sale #${x.id}`,subtitle:x.customerName,description:`Amount: TZS ${x.totalAmount.toLocaleString()} | Date: ${new Date(x.createdAt).toLocaleDateString()}`,url:"/lats/sales-reports",metadata:{amount:x.totalAmount,date:x.createdAt,customer:x.customerName},priority:2,score:h.score,matches:n,createdAt:x.createdAt,updatedAt:x.updatedAt}})}return u.map(i=>({id:i.id,type:"sale",title:`Sale #${i.id}`,subtitle:i.customerName,description:`Amount: TZS ${i.totalAmount.toLocaleString()} | Date: ${new Date(i.createdAt).toLocaleDateString()}`,url:"/lats/sales-reports",metadata:{amount:i.totalAmount,date:i.createdAt,customer:i.customerName},priority:2,createdAt:i.createdAt,updatedAt:i.updatedAt}))}catch(o){return console.error("Error in searchSales:",o),[]}}searchPagesAndActions(t){const r=ws(this.userRole);if(t.length>0){const o=new K(r,{keys:["title","description","path"],threshold:.4,includeScore:!0,includeMatches:!0}),d=t.join(" ");return o.search(d).map(u=>{var p;const i=u.item,s=((p=u.matches)==null?void 0:p.map(h=>h.key||""))||[];return{id:i.id,type:"page",title:i.title,subtitle:"Navigate to page",description:i.description,url:i.path,metadata:{icon:i.icon,category:i.category},priority:0,score:u.score,matches:s}})}return r.map(o=>({id:o.id,type:"page",title:o.title,subtitle:"Navigate to page",description:o.description,url:o.path,metadata:{icon:o.icon,category:o.category},priority:0}))}isUUID(t){return/^[0-9a-f]{8}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{4}-[0-9a-f]{12}$/i.test(t.trim())}isInstallmentPlanNumber(t){return/^INS-\d+$/i.test(t.trim())}isNumericID(t){return/^\d+$/.test(t.trim())}async searchByUUID(t){var o,d,m;const r=[];try{const[u,i,s,p,h,x]=await Promise.all([P.from("devices").select("id, model, serial_number, status, problem_description, created_at, updated_at").eq("id",t).single(),P.from("customers").select("id, name, phone, email, city, notes, created_at, updated_at").eq("id",t).single(),P.from("lats_products").select("id, name, sku, barcode, selling_price, stock_quantity, created_at, updated_at").eq("id",t).single(),P.from("lats_sales").select("id, sale_number, customer_name, customer_phone, total_amount, created_at, updated_at").eq("id",t).single(),P.from("lats_product_variants").select("id, product_id, name, sku, selling_price, stock_quantity, created_at, updated_at").eq("id",t).single(),P.from("customer_installment_plans").select(`
            id,
            plan_number,
            customer_id,
            total_amount,
            balance_due,
            status,
            created_at,
            updated_at,
            customer:customers!customer_id(id, name, phone, email)
          `).eq("id",t).single()]);if(u.data&&!u.error){const n=u.data;r.push({id:n.id,type:"device",title:n.model||"Device",subtitle:n.serial_number||"No serial number",description:`Status: ${n.status||"Unknown"}${n.problem_description?" | Issue: "+n.problem_description:""}`,url:`/devices/${n.id}`,metadata:{status:n.status,serialNumber:n.serial_number,issue:n.problem_description},priority:0,createdAt:n.created_at,updatedAt:n.updated_at})}if(i.data&&!i.error){const n=i.data;r.push({id:n.id,type:"customer",title:n.name||"Customer",subtitle:n.phone||"No phone",description:`${n.email||"No email"} | ${n.city||"No location"}`,url:`/customers/${n.id}`,metadata:{email:n.email,location:n.city,phone:n.phone},priority:0,createdAt:n.created_at,updatedAt:n.updated_at})}if(s.data&&!s.error){const n=s.data;r.push({id:n.id,type:"product",title:n.name||"Product",subtitle:n.sku||"No SKU",description:`Price: TZS ${(n.selling_price||0).toLocaleString()} | Stock: ${n.stock_quantity||0}`,url:"/lats/unified-inventory",metadata:{price:n.selling_price,stock:n.stock_quantity,sku:n.sku,barcode:n.barcode},priority:0,createdAt:n.created_at,updatedAt:n.updated_at})}if(p.data&&!p.error){const n=p.data;r.push({id:n.id,type:"sale",title:`Sale #${n.sale_number||n.id}`,subtitle:n.customer_name||"Walk-in Customer",description:`Amount: TZS ${(n.total_amount||0).toLocaleString()} | Date: ${new Date(n.created_at).toLocaleDateString()}`,url:"/lats/sales-reports",metadata:{amount:n.total_amount,date:n.created_at,customer:n.customer_name},priority:0,createdAt:n.created_at,updatedAt:n.updated_at})}if(h.data&&!h.error){const n=h.data,{data:v}=await P.from("lats_products").select("name").eq("id",n.product_id).single();r.push({id:n.id,type:"product",title:`${(v==null?void 0:v.name)||"Product"} - ${n.name||"Variant"}`,subtitle:n.sku||"No SKU",description:`Price: TZS ${(n.selling_price||0).toLocaleString()} | Stock: ${n.stock_quantity||0}`,url:"/lats/unified-inventory",metadata:{price:n.selling_price,stock:n.stock_quantity,sku:n.sku,productId:n.product_id,variantId:n.id},priority:0,createdAt:n.created_at,updatedAt:n.updated_at})}if(x.data&&!x.error){const n=x.data;r.push({id:n.id,type:"payment",title:`Installment Plan ${n.plan_number}`,subtitle:((o=n.customer)==null?void 0:o.name)||"Unknown Customer",description:`Total: TZS ${Number(n.total_amount||0).toLocaleString()} | Balance: TZS ${Number(n.balance_due||0).toLocaleString()} | Status: ${n.status}`,url:"/installments",metadata:{planNumber:n.plan_number,customerName:(d=n.customer)==null?void 0:d.name,customerPhone:(m=n.customer)==null?void 0:m.phone,totalAmount:Number(n.total_amount||0),balanceDue:Number(n.balance_due||0),status:n.status},priority:0,createdAt:n.created_at,updatedAt:n.updated_at})}return r}catch(u){return console.error("Error in searchByUUID:",u),[]}}async search(t){var i;const r=this.getCached(t);if(r)return r;const o=t.trim();if(this.isUUID(o)){const s=await this.searchByUUID(o);if(s.length>0)return this.setCache(t,s),s}if(this.isInstallmentPlanNumber(o)){const s=await this.searchByInstallmentPlanNumber(o);if(s.length>0)return this.setCache(t,s),s}if(this.isNumericID(o)){const s=await this.searchByNumericID(o);if(s.length>0)return this.setCache(t,s),s}const{filters:d,terms:m}=this.parseQuery(t),u=[];try{const s=this.searchPagesAndActions(m);u.push(...s);const p=(i=d.type)==null?void 0:i.toLowerCase(),h=!p||p==="all",x=[];h||p==="device"?x.push(this.searchDevices(d,m)):x.push(Promise.resolve([])),h||p==="customer"?x.push(this.searchCustomers(d,m)):x.push(Promise.resolve([])),h||p==="product"?x.push(this.searchProducts(d,m)):x.push(Promise.resolve([])),h||p==="sale"?x.push(this.searchSales(d,m)):x.push(Promise.resolve([])),h||p==="payment"||p==="installment"?x.push(this.searchInstallmentPlans(d,m)):x.push(Promise.resolve([]));const[n,v,g,c,f]=await Promise.all(x);u.push(...n),u.push(...v),u.push(...g),u.push(...c),u.push(...f);const b=u.sort((A,k)=>A.priority!==k.priority?A.priority-k.priority:A.score!==void 0&&k.score!==void 0?A.score-k.score:A.createdAt&&k.createdAt?new Date(k.createdAt).getTime()-new Date(A.createdAt).getTime():A.title.localeCompare(k.title));return this.setCache(t,b),b}catch(s){return console.error("Error in search:",s),[]}}}const As=({customerId:l,customerName:t,onClose:r})=>{const o=ut(),[d,m]=R.useState(!0),[u,i]=R.useState("overview"),[s,p]=R.useState({devices:[],sales:[],payments:[],appointments:[],notes:[],messages:[],totalSpent:0,lastActivity:"",customerInfo:null});R.useEffect(()=>{h()},[l]);const h=async()=>{m(!0);try{const{data:c}=await P.from("customers").select("*").eq("id",l).single(),{data:f,error:b}=await P.from("devices").select("*").eq("customer_id",l).order("created_at",{ascending:!1}).limit(50);b&&console.error("Error fetching devices:",b);const{data:A,error:k}=await P.from("customer_payments").select("*").eq("customer_id",l).order("payment_date",{ascending:!1}).limit(50);k&&console.error("Error fetching payments:",k);let C=[];if(c!=null&&c.phone){const{data:S,error:U}=await P.from("lats_sales").select(`
            *,
            lats_customers!inner (
              phone
            )
          `).eq("lats_customers.phone",c.phone).order("created_at",{ascending:!1}).limit(50);U?(console.error("Error fetching sales:",U),console.log("Sales error details:",U)):C=S||[]}else console.log("No customer phone found, skipping sales fetch");const{data:j,error:F}=await P.from("appointments").select("*").eq("customer_id",l).order("appointment_date",{ascending:!1}).limit(50);F&&console.error("Error fetching appointments:",F);const{data:B,error:D}=await P.from("customer_notes").select("*").eq("customer_id",l).order("created_at",{ascending:!1}).limit(50);D&&console.error("Error fetching notes:",D);const{data:E,error:O}=await P.from("customer_messages").select("*").eq("customer_id",l).order("created_at",{ascending:!1}).limit(50);O&&console.error("Error fetching messages:",O);const Z=(C||[]).reduce((S,U)=>S+(parseFloat(U.total_amount)||0),0),I=[...(f||[]).map(S=>new Date(S.created_at)),...(C||[]).map(S=>new Date(S.created_at)),...(A||[]).map(S=>new Date(S.payment_date)),...(j||[]).map(S=>new Date(S.appointment_date)),...(B||[]).map(S=>new Date(S.created_at)),...(E||[]).map(S=>new Date(S.created_at))].filter(S=>!isNaN(S.getTime())),M=I.length>0?new Date(Math.max(...I.map(S=>S.getTime()))).toLocaleDateString():"No activity";p({devices:f||[],sales:C||[],payments:A||[],appointments:j||[],notes:B||[],messages:E||[],totalSpent:Z,lastActivity:M,customerInfo:c})}catch(c){console.error("Error loading customer activity:",c)}finally{m(!1)}},x=c=>{o(`/devices/${c}`),r()},n=()=>{o(`/devices?customer=${l}`),r()},v=()=>{o(`/lats/sales-reports?customer=${l}`),r()},g=()=>{o(`/customers/${l}`),r()};return d?e.jsx("div",{className:"fixed inset-0 z-[100000] flex items-center justify-center bg-black/50 backdrop-blur-sm",children:e.jsxs("div",{className:"bg-white rounded-2xl p-8 shadow-2xl",children:[e.jsx(mt,{className:"w-8 h-8 animate-spin text-blue-500 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Loading activity..."})]})}):e.jsx("div",{className:"fixed inset-0 z-[100000] flex items-center justify-center bg-black/30 p-4",children:e.jsxs("div",{className:"bg-white rounded-lg shadow-xl w-full max-w-4xl max-h-[90vh] overflow-hidden flex flex-col",children:[e.jsxs("div",{className:"bg-white border-b px-6 py-4 flex items-center justify-between",children:[e.jsx("div",{children:e.jsx("h2",{className:"text-xl font-semibold text-gray-900",children:t})}),e.jsx("button",{onClick:r,className:"p-1.5 hover:bg-gray-100 rounded transition-colors",children:e.jsx(nt,{size:20,className:"text-gray-500"})})]}),e.jsxs("div",{className:"grid grid-cols-6 gap-px bg-gray-200 border-b",children:[e.jsxs("div",{className:"bg-white p-3 text-center",children:[e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:s.devices.length}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Devices"})]}),e.jsxs("div",{className:"bg-white p-3 text-center",children:[e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:s.sales.length}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Sales"})]}),e.jsxs("div",{className:"bg-white p-3 text-center",children:[e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:s.payments.length}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Payments"})]}),e.jsxs("div",{className:"bg-white p-3 text-center",children:[e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:s.appointments.length}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Appts"})]}),e.jsxs("div",{className:"bg-white p-3 text-center",children:[e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:s.messages.length}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Messages"})]}),e.jsxs("div",{className:"bg-white p-3 text-center",children:[e.jsx("p",{className:"text-xs font-medium text-gray-900",children:s.lastActivity}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Last"})]})]}),e.jsx("div",{className:"border-b bg-white px-4",children:e.jsx("div",{className:"flex gap-1 overflow-x-auto",children:[{key:"overview",label:"All"},{key:"devices",label:`Devices (${s.devices.length})`},{key:"sales",label:`Sales (${s.sales.length})`},{key:"payments",label:`Payments (${s.payments.length})`},{key:"appointments",label:`Appts (${s.appointments.length})`},{key:"notes",label:`Notes (${s.notes.length})`},{key:"messages",label:`Messages (${s.messages.length})`}].map(c=>e.jsx("button",{onClick:()=>i(c.key),className:`px-3 py-2 text-sm font-medium border-b-2 transition-colors whitespace-nowrap ${u===c.key?"border-blue-600 text-blue-600":"border-transparent text-gray-500 hover:text-gray-700"}`,children:c.label},c.key))})}),e.jsxs("div",{className:"flex-1 overflow-y-auto p-6 space-y-6",children:[u==="overview"&&e.jsxs(e.Fragment,{children:[s.customerInfo&&e.jsx("div",{className:"bg-gray-50 rounded p-4 border",children:e.jsxs("div",{className:"grid grid-cols-3 gap-4 text-sm",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Phone:"})," ",e.jsx("span",{className:"font-medium ml-1",children:s.customerInfo.phone||"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Email:"})," ",e.jsx("span",{className:"font-medium ml-1",children:s.customerInfo.email||"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"City:"})," ",e.jsx("span",{className:"font-medium ml-1",children:s.customerInfo.city||"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Loyalty:"})," ",e.jsx("span",{className:"font-medium ml-1 capitalize",children:s.customerInfo.loyalty_level||"Bronze"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Points:"})," ",e.jsx("span",{className:"font-medium ml-1",children:s.customerInfo.points||0})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-gray-500",children:"Total:"})," ",e.jsxs("span",{className:"font-medium ml-1",children:["TZS ",s.totalSpent.toLocaleString()]})]})]})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-sm font-medium text-gray-500 mb-3",children:"Activity Timeline"}),e.jsxs("div",{className:"space-y-2",children:[[...s.devices.map(c=>({type:"device",data:c,date:new Date(c.created_at)})),...s.sales.map(c=>({type:"sale",data:c,date:new Date(c.created_at)})),...s.payments.map(c=>({type:"payment",data:c,date:new Date(c.payment_date)})),...s.appointments.map(c=>({type:"appointment",data:c,date:new Date(c.appointment_date)})),...s.notes.map(c=>({type:"note",data:c,date:new Date(c.created_at)})),...s.messages.map(c=>({type:"message",data:c,date:new Date(c.created_at)}))].sort((c,f)=>f.date.getTime()-c.date.getTime()).map((c,f)=>{if(c.type==="device"){const b=c.data;return e.jsxs("div",{onClick:()=>x(b.id),className:"border-l-2 border-blue-500 pl-3 py-2 hover:bg-gray-50 cursor-pointer",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(oe,{className:"text-blue-500",size:16}),e.jsx("span",{className:"font-medium text-gray-900",children:b.model||b.device_name}),e.jsx("span",{className:"text-xs text-gray-500",children:b.status})]}),e.jsx("p",{className:"text-sm text-gray-600 mt-0.5 ml-6",children:b.problem_description||b.issue_description}),e.jsx("p",{className:"text-xs text-gray-400 mt-0.5 ml-6",children:c.date.toLocaleString()})]},`device-${b.id}-${f}`)}if(c.type==="sale"){const b=c.data;return e.jsxs("div",{className:"border-l-2 border-green-500 pl-3 py-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(Y,{className:"text-green-500",size:16}),e.jsxs("span",{className:"font-medium text-gray-900",children:["Sale #",b.id]})]}),e.jsxs("span",{className:"font-semibold text-green-600",children:["TZS ",(b.total_amount||0).toLocaleString()]})]}),e.jsxs("p",{className:"text-xs text-gray-400 mt-0.5 ml-6",children:[b.payment_method," â€¢ ",c.date.toLocaleString()]})]},`sale-${b.id}-${f}`)}if(c.type==="payment"){const b=c.data;return e.jsxs("div",{className:"border-l-2 border-purple-500 pl-3 py-2",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(me,{className:"text-purple-500",size:16}),e.jsx("span",{className:"font-medium text-gray-900",children:b.method||"Cash"})]}),e.jsxs("span",{className:"font-semibold text-purple-600",children:["TZS ",(b.amount||0).toLocaleString()]})]}),e.jsx("p",{className:"text-xs text-gray-400 mt-0.5 ml-6",children:c.date.toLocaleString()})]},`payment-${b.id}-${f}`)}if(c.type==="appointment"){const b=c.data;return e.jsxs("div",{className:"border-l-2 border-cyan-500 pl-3 py-2",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(ue,{className:"text-cyan-500",size:16}),e.jsx("span",{className:"font-medium text-gray-900",children:b.title}),e.jsx("span",{className:"text-xs text-gray-500",children:b.status})]}),e.jsx("p",{className:"text-xs text-gray-400 mt-0.5 ml-6",children:c.date.toLocaleString()})]},`apt-${b.id}-${f}`)}if(c.type==="note"){const b=c.data;return e.jsx("div",{className:"border-l-2 border-amber-500 pl-3 py-2",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(ge,{className:"text-amber-500 mt-0.5",size:16}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm text-gray-800",children:b.note}),e.jsx("p",{className:"text-xs text-gray-400 mt-0.5",children:c.date.toLocaleString()})]})]})},`note-${b.id}-${f}`)}if(c.type==="message"){const b=c.data;return e.jsx("div",{className:`border-l-2 pl-3 py-2 ${b.direction==="outbound"?"border-blue-500":"border-indigo-500"}`,children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx(ne,{className:b.direction==="outbound"?"text-blue-500":"text-indigo-500",size:16}),e.jsxs("div",{className:"flex-1",children:[e.jsx("p",{className:"text-sm text-gray-800",children:b.message}),e.jsxs("p",{className:"text-xs text-gray-400 mt-0.5",children:[b.direction==="outbound"?"Sent":"Received"," â€¢ ",b.channel," â€¢ ",c.date.toLocaleString()]})]})]})},`msg-${b.id}-${f}`)}return null}),s.devices.length===0&&s.sales.length===0&&s.payments.length===0&&s.appointments.length===0&&s.notes.length===0&&s.messages.length===0&&e.jsx("div",{className:"text-center py-12 text-gray-400",children:e.jsx("p",{className:"text-sm",children:"No activity found"})})]})]})]}),u==="devices"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-800 flex items-center gap-2",children:[e.jsx(oe,{className:"text-blue-500",size:20}),"Devices (",s.devices.length,")"]}),s.devices.length>0&&e.jsx("button",{onClick:n,className:"text-sm text-blue-600 hover:text-blue-700 font-medium",children:"View All â†’"})]}),s.devices.length>0?e.jsx("div",{className:"space-y-2",children:s.devices.map(c=>e.jsx("div",{onClick:()=>x(c.id),className:"bg-white border border-gray-200 rounded-lg p-4 hover:border-blue-300 hover:shadow-md transition-all cursor-pointer",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-800",children:c.model||c.device_name}),e.jsx("p",{className:"text-sm text-gray-600",children:c.problem_description||c.issue_description||"No issue specified"}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:["Serial: ",c.serial_number||"N/A"]})]}),e.jsxs("div",{className:"text-right",children:[e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${c.status==="active"||c.status==="in-progress"?"bg-blue-100 text-blue-700":c.status==="done"||c.status==="completed"?"bg-green-100 text-green-700":c.status==="pending"?"bg-yellow-100 text-yellow-700":"bg-gray-100 text-gray-700"}`,children:c.status}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:new Date(c.created_at).toLocaleDateString()})]})]})},c.id))}):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(te,{size:48,className:"mx-auto mb-2 text-gray-300"}),e.jsx("p",{children:"No devices found"})]})]}),u==="sales"&&e.jsxs("div",{children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-800 flex items-center gap-2",children:[e.jsx(Y,{className:"text-green-500",size:20}),"Recent Sales (",s.sales.length,")"]}),s.sales.length>0&&e.jsx("button",{onClick:v,className:"text-sm text-blue-600 hover:text-blue-700 font-medium",children:"View All â†’"})]}),s.sales.length>0?e.jsx("div",{className:"space-y-2",children:s.sales.map(c=>e.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-4 hover:border-green-300 hover:shadow-md transition-all",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-semibold text-gray-800",children:["Sale #",c.id]}),e.jsx("p",{className:"text-sm text-gray-600",children:c.customer_name||"Walk-in"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:new Date(c.created_at).toLocaleDateString()})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-lg font-bold text-green-600",children:["TZS ",(c.total_amount||0).toLocaleString()]}),e.jsx("p",{className:"text-xs text-gray-500",children:c.payment_method||"Cash"})]})]})},c.id))}):e.jsxs("div",{className:"text-center py-8 text-gray-500",children:[e.jsx(Y,{size:48,className:"mx-auto mb-2 text-gray-300"}),e.jsx("p",{children:"No sales found"})]})]}),u==="payments"&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-800 mb-4 flex items-center gap-2",children:[e.jsx(me,{className:"text-purple-500",size:20}),"All Payments (",s.payments.length,")"]}),s.payments.length>0?e.jsx("div",{className:"space-y-2",children:s.payments.map(c=>e.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-800",children:c.method||"Cash"}),e.jsx("p",{className:"text-xs text-gray-500",children:new Date(c.payment_date).toLocaleDateString()}),c.notes&&e.jsx("p",{className:"text-xs text-gray-400 mt-1",children:c.notes})]}),e.jsxs("div",{className:"text-right",children:[e.jsxs("p",{className:"text-lg font-bold text-purple-600",children:["TZS ",(c.amount||0).toLocaleString()]}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${c.status==="completed"?"bg-green-100 text-green-700":c.status==="pending"?"bg-yellow-100 text-yellow-700":"bg-gray-100 text-gray-700"}`,children:c.status||"completed"})]})]})},c.id))}):e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(me,{size:48,className:"mx-auto mb-2 text-gray-300"}),e.jsx("p",{children:"No payments found"})]})]}),u==="appointments"&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-800 mb-4 flex items-center gap-2",children:[e.jsx(ue,{className:"text-cyan-500",size:20}),"All Appointments (",s.appointments.length,")"]}),s.appointments.length>0?e.jsx("div",{className:"space-y-2",children:s.appointments.map(c=>e.jsx("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-800",children:c.title}),e.jsx("p",{className:"text-sm text-gray-600",children:c.description||"No description"}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:new Date(c.appointment_date).toLocaleString()})]}),e.jsx("span",{className:`px-3 py-1 rounded-full text-xs font-medium ${c.status==="scheduled"?"bg-blue-100 text-blue-700":c.status==="completed"?"bg-green-100 text-green-700":c.status==="cancelled"?"bg-red-100 text-red-700":"bg-gray-100 text-gray-700"}`,children:c.status})]})},c.id))}):e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(ue,{size:48,className:"mx-auto mb-2 text-gray-300"}),e.jsx("p",{children:"No appointments found"})]})]}),u==="notes"&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-800 mb-4 flex items-center gap-2",children:[e.jsx(ge,{className:"text-amber-500",size:20}),"All Notes (",s.notes.length,")"]}),s.notes.length>0?e.jsx("div",{className:"space-y-2",children:s.notes.map(c=>e.jsxs("div",{className:"bg-white border border-gray-200 rounded-lg p-4",children:[e.jsx("p",{className:"text-gray-800",children:c.note}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:new Date(c.created_at).toLocaleString()})]},c.id))}):e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(ge,{size:48,className:"mx-auto mb-2 text-gray-300"}),e.jsx("p",{children:"No notes found"})]})]}),u==="messages"&&e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-bold text-gray-800 mb-4 flex items-center gap-2",children:[e.jsx(ne,{className:"text-indigo-500",size:20}),"All Messages (",s.messages.length,")"]}),s.messages.length>0?e.jsx("div",{className:"space-y-2",children:s.messages.map(c=>e.jsxs("div",{className:`border rounded-lg p-4 ${c.direction==="outbound"?"bg-blue-50 border-blue-200 ml-8":"bg-white border-gray-200 mr-8"}`,children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("span",{className:`text-xs font-medium ${c.direction==="outbound"?"text-blue-700":"text-gray-700"}`,children:[c.direction==="outbound"?"Sent":"Received"," via ",c.channel]}),e.jsx("span",{className:`text-xs px-2 py-0.5 rounded-full ${c.status==="delivered"?"bg-green-100 text-green-700":c.status==="read"?"bg-blue-100 text-blue-700":c.status==="failed"?"bg-red-100 text-red-700":"bg-gray-100 text-gray-700"}`,children:c.status})]}),e.jsx("p",{className:"text-gray-800",children:c.message}),e.jsx("p",{className:"text-xs text-gray-500 mt-2",children:new Date(c.created_at).toLocaleString()})]},c.id))}):e.jsxs("div",{className:"text-center py-12 text-gray-500",children:[e.jsx(ne,{size:48,className:"mx-auto mb-2 text-gray-300"}),e.jsx("p",{children:"No messages found"})]})]})]}),e.jsxs("div",{className:"border-t px-6 py-3 flex gap-2 bg-white",children:[e.jsx("button",{onClick:g,className:"px-4 py-2 bg-blue-600 text-white text-sm rounded hover:bg-blue-700 transition-colors",children:"View Profile"}),e.jsx("button",{onClick:r,className:"px-4 py-2 border text-sm rounded hover:bg-gray-50 transition-colors",children:"Close"})]})]})})},Ls=({query:l,filter:t,onFilterChange:r,isLoading:o,userRole:d,devices:m,customers:u})=>{const i=ut(),[s,p]=R.useState([]),[h,x]=R.useState(!1),[n,v]=R.useState(null),[g,c]=R.useState(0),f=R.useRef([]),[b,A]=R.useState(null),[k,C]=R.useState(null),[j,F]=R.useState(new Set),[B,D]=R.useState(new Set),E=R.useMemo(()=>new _s(d),[d]);R.useEffect(()=>{if(!l.trim()){p([]);return}const N=setTimeout(async()=>{x(!0),v(null);try{const L=(await E.search(l)).map(T=>({...T,icon:O(T.type)}));p(L)}catch(_){console.error("Search error:",_),v("An error occurred while searching. Please try again."),p([])}finally{x(!1)}},300);return()=>clearTimeout(N)},[l,E]),R.useEffect(()=>{const a=s.filter(N=>{var _;return N.type==="product"&&((_=N.metadata)==null?void 0:_.variants)&&N.metadata.variants.length>0});a.length>0&&D(N=>{const _=new Set(N);return a.forEach(L=>{_.add(L.id)}),_})},[s]);const O=a=>{switch(a){case"device":return e.jsx(oe,{size:20,className:"text-blue-600"});case"customer":return e.jsx(de,{size:20,className:"text-green-600"});case"product":return e.jsx(te,{size:20,className:"text-purple-600"});case"sale":return e.jsx(Y,{size:20,className:"text-amber-600"});case"payment":return e.jsx(me,{size:20,className:"text-emerald-600"});case"loyalty":return e.jsx(ot,{size:20,className:"text-yellow-600"});case"inventory":return e.jsx(ct,{size:20,className:"text-orange-600"});case"report":return e.jsx(lt,{size:20,className:"text-indigo-600"});case"page":return e.jsx(Pt,{size:20,className:"text-cyan-600"});case"action":return e.jsx($t,{size:20,className:"text-pink-600"});default:return e.jsx(ge,{size:20,className:"text-gray-600"})}},Z=a=>{switch(a){case"device":return{border:"border-blue-200/40",borderHover:"hover:border-blue-300/60",iconBg:"bg-blue-50",selectedIconBg:"bg-blue-100",badgeBg:"bg-blue-100",badgeText:"text-blue-700",selectedBorder:"border-blue-400",selectedBg:"bg-blue-50",selectedBadgeBg:"bg-blue-100",selectedBadgeText:"text-blue-700",hoverBorder:"hover:border-blue-400"};case"customer":return{border:"border-green-200/40",borderHover:"hover:border-green-300/60",iconBg:"bg-green-50",selectedIconBg:"bg-green-100",badgeBg:"bg-green-100",badgeText:"text-green-700",selectedBorder:"border-green-400",selectedBg:"bg-green-50",selectedBadgeBg:"bg-green-100",selectedBadgeText:"text-green-700",hoverBorder:"hover:border-green-400"};case"product":return{border:"border-purple-200/40",borderHover:"hover:border-purple-300/60",iconBg:"bg-purple-50",selectedIconBg:"bg-purple-100",badgeBg:"bg-purple-100",badgeText:"text-purple-700",selectedBorder:"border-purple-400",selectedBg:"bg-purple-50",selectedBadgeBg:"bg-purple-100",selectedBadgeText:"text-purple-700",hoverBorder:"hover:border-purple-400"};case"sale":return{border:"border-amber-200/40",borderHover:"hover:border-amber-300/60",iconBg:"bg-amber-50",selectedIconBg:"bg-amber-100",badgeBg:"bg-amber-100",badgeText:"text-amber-700",selectedBorder:"border-amber-400",selectedBg:"bg-amber-50",selectedBadgeBg:"bg-amber-100",selectedBadgeText:"text-amber-700",hoverBorder:"hover:border-amber-400"};case"payment":return{border:"border-emerald-200/40",borderHover:"hover:border-emerald-300/60",iconBg:"bg-emerald-50",selectedIconBg:"bg-emerald-100",badgeBg:"bg-emerald-100",badgeText:"text-emerald-700",selectedBorder:"border-emerald-400",selectedBg:"bg-emerald-50",selectedBadgeBg:"bg-emerald-100",selectedBadgeText:"text-emerald-700",hoverBorder:"hover:border-emerald-400"};case"loyalty":return{border:"border-yellow-200/40",borderHover:"hover:border-yellow-300/60",iconBg:"bg-yellow-50",selectedIconBg:"bg-yellow-100",badgeBg:"bg-yellow-100",badgeText:"text-yellow-700",selectedBorder:"border-yellow-400",selectedBg:"bg-yellow-50",selectedBadgeBg:"bg-yellow-100",selectedBadgeText:"text-yellow-700",hoverBorder:"hover:border-yellow-400"};case"inventory":return{border:"border-orange-200/40",borderHover:"hover:border-orange-300/60",iconBg:"bg-orange-50",selectedIconBg:"bg-orange-100",badgeBg:"bg-orange-100",badgeText:"text-orange-700",selectedBorder:"border-orange-400",selectedBg:"bg-orange-50",selectedBadgeBg:"bg-orange-100",selectedBadgeText:"text-orange-700",hoverBorder:"hover:border-orange-400"};case"report":return{border:"border-indigo-200/40",borderHover:"hover:border-indigo-300/60",iconBg:"bg-indigo-50",selectedIconBg:"bg-indigo-100",badgeBg:"bg-indigo-100",badgeText:"text-indigo-700",selectedBorder:"border-indigo-400",selectedBg:"bg-indigo-50",selectedBadgeBg:"bg-indigo-100",selectedBadgeText:"text-indigo-700",hoverBorder:"hover:border-indigo-400"};case"page":return{border:"border-cyan-200/40",borderHover:"hover:border-cyan-300/60",iconBg:"bg-cyan-50",selectedIconBg:"bg-cyan-100",badgeBg:"bg-cyan-100",badgeText:"text-cyan-700",selectedBorder:"border-cyan-400",selectedBg:"bg-cyan-50",selectedBadgeBg:"bg-cyan-100",selectedBadgeText:"text-cyan-700",hoverBorder:"hover:border-cyan-400"};case"action":return{border:"border-pink-200/40",borderHover:"hover:border-pink-300/60",iconBg:"bg-pink-50",selectedIconBg:"bg-pink-100",badgeBg:"bg-pink-100",badgeText:"text-pink-700",selectedBorder:"border-pink-400",selectedBg:"bg-pink-50",selectedBadgeBg:"bg-pink-100",selectedBadgeText:"text-pink-700",hoverBorder:"hover:border-pink-400"};default:return{border:"border-gray-200/40",borderHover:"hover:border-gray-300/60",iconBg:"bg-gray-50",selectedIconBg:"bg-gray-100",badgeBg:"bg-gray-100",badgeText:"text-gray-700",selectedBorder:"border-gray-400",selectedBg:"bg-gray-50",selectedBadgeBg:"bg-gray-200",selectedBadgeText:"text-gray-700",hoverBorder:"hover:border-gray-400"}}},I=R.useCallback((a,N)=>{if(!N)return a;const _=N.split(" ").filter(H=>H.length>1);if(_.length===0)return a;const L=[];let T=0;const ae=new RegExp(`(${_.map(H=>H.replace(/[.*+?^${}()|[\]\\]/g,"\\$&")).join("|")})`,"gi");let Q;for(;(Q=ae.exec(a))!==null;)Q.index>T&&L.push({text:a.slice(T,Q.index),isHighlighted:!1}),L.push({text:Q[0],isHighlighted:!0}),T=Q.index+Q[0].length;return T<a.length&&L.push({text:a.slice(T),isHighlighted:!1}),L.length===0?a:e.jsx(e.Fragment,{children:L.map((H,ce)=>H.isHighlighted?e.jsx("mark",{className:"bg-yellow-300/40 text-inherit font-semibold px-0.5 rounded-sm",children:H.text},ce):e.jsx("span",{children:H.text},ce))})},[]),M=R.useMemo(()=>t==="all"?s:s.filter(a=>a.type===t),[s,t]),S=R.useMemo(()=>{const a=[{key:"all",label:"All Results",count:s.length}],N=s.reduce((_,L)=>(_[L.type]=(_[L.type]||0)+1,_),{});return Object.entries(N).forEach(([_,L])=>{const T={device:"Devices",customer:"Customers",product:"Products",sale:"Sales",payment:"Payments",loyalty:"Loyalty",inventory:"Inventory",report:"Reports",page:"Pages",action:"Actions"};a.push({key:_,label:T[_]||_,count:L})}),a},[s]);R.useEffect(()=>{c(0),f.current=[]},[M]),R.useEffect(()=>{const a=N=>{if(M.length!==0)switch(N.key){case"ArrowDown":N.preventDefault(),c(_=>Math.min(_+1,M.length-1));break;case"ArrowUp":N.preventDefault(),c(_=>Math.max(_-1,0));break;case"Enter":if(N.preventDefault(),M[g]){const _=M[g];k===_.id?C(null):C(_.id)}break;case"Escape":N.preventDefault(),k&&C(null);break}};return window.addEventListener("keydown",a),()=>window.removeEventListener("keydown",a)},[M,g,k]),R.useEffect(()=>{var a;f.current[g]&&((a=f.current[g])==null||a.scrollIntoView({behavior:"smooth",block:"nearest"}))},[g]);const U=(a,N)=>{c(N),k===a.id?C(null):C(a.id)},se=a=>{a.type==="customer"?A({id:a.id,name:a.title}):i(a.url)};return h?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsxs("div",{className:"text-center bg-white rounded-xl p-8 border border-gray-100",children:[e.jsx(mt,{size:28,className:"animate-spin text-blue-500 mx-auto mb-3"}),e.jsx("p",{className:"text-gray-600 font-medium text-sm",children:"Searching..."})]})}):n?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsxs("div",{className:"text-center bg-white rounded-xl p-8 border border-gray-100",children:[e.jsx(Ye,{size:28,className:"text-red-500 mx-auto mb-3"}),e.jsx("p",{className:"text-red-600 mb-1 font-medium text-sm",children:"Search Error"}),e.jsx("p",{className:"text-gray-500 text-xs",children:n})]})}):e.jsxs(e.Fragment,{children:[b&&e.jsx(As,{customerId:b.id,customerName:b.name,onClose:()=>A(null)}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"sticky top-0 z-10 bg-white pb-3 pt-2 -mx-6 px-6 border-b border-gray-100 shadow-sm",children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsxs("div",{children:[e.jsxs("h2",{className:"text-sm font-semibold text-gray-700",children:["Results for ",e.jsxs("span",{className:"text-gray-900",children:['"',l,'"']})]}),e.jsxs("p",{className:"text-gray-500 mt-0.5 text-xs",children:[M.length," result",M.length!==1?"s":""]})]})}),S.length>1&&e.jsx("div",{className:"inline-flex items-center bg-gray-100 rounded-lg p-1 overflow-x-auto scrollbar-hide",children:S.map(a=>e.jsxs("button",{onClick:()=>r(a.key),className:`px-3 py-1 rounded-md text-xs font-medium whitespace-nowrap transition-all duration-150 ${t===a.key?"bg-white text-gray-900 shadow-sm":"text-gray-600 hover:text-gray-900"}`,children:[a.label,e.jsx("span",{className:`ml-1.5 px-1.5 py-0.5 rounded-md text-xs ${t===a.key?"bg-gray-100 text-gray-600":"bg-gray-200/60 text-gray-500"}`,children:a.count})]},a.key))})]}),M.length>0?e.jsx("div",{className:"space-y-3",children:M.map((a,N)=>{var H,ce,Se,ke,Ce,De,Be,Ee,Le,$e,Pe,Re,Ie,Me,Te,Fe,ze,qe,Ue,Ve,Oe,Ze;const _=k===a.id,L=N===g;Z(a.type);const T=()=>{var y,$,q;return((y=a.metadata)==null?void 0:y.status)==="complete"||(($=a.metadata)==null?void 0:$.status)==="completed"||((q=a.metadata)==null?void 0:q.status)==="paid"?"border-green-200 hover:border-green-300/30":a.type==="product"?"border-purple-200 hover:border-purple-300/30":a.type==="device"?"border-blue-200 hover:border-blue-300/30":a.type==="sale"?"border-amber-200 hover:border-amber-300/30":"border-gray-200 hover:border-gray-300/30"},ae=()=>{var $,q;const y=(q=($=a.metadata)==null?void 0:$.status)==null?void 0:q.toLowerCase();return y==="complete"||y==="completed"?e.jsxs("span",{className:"inline-flex items-center gap-2 px-4 py-2 rounded-lg text-base font-bold bg-green-500 text-white shadow-sm flex-shrink-0",children:[e.jsx(he,{className:"w-5 h-5"}),"Complete"]}):y==="active"||y==="in-progress"||y==="pending"?e.jsxs("span",{className:"inline-flex items-center gap-2 px-4 py-2 rounded-lg text-base font-bold text-green-600 bg-green-100 flex items-center gap-2 flex-shrink-0",children:[e.jsx(he,{className:"w-4 h-4"}),e.jsx("span",{children:"ACTIVE"})]}):y==="paid"?e.jsxs("span",{className:"inline-flex items-center gap-1.5 px-5 py-3 rounded-xl text-base font-bold shadow-sm bg-green-500 text-white",children:[e.jsx(he,{className:"w-5 h-5"}),"Paid"]}):y==="partial"?e.jsxs("span",{className:"inline-flex items-center gap-1.5 px-5 py-3 rounded-xl text-base font-bold shadow-sm bg-yellow-500 text-white",children:[e.jsx(X,{className:"w-5 h-5"}),"Partial"]}):null},Q=y=>y?(y instanceof Date?y:new Date(y)).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"}):null;return e.jsxs("div",{ref:y=>f.current[N]=y,onMouseEnter:()=>c(N),className:`
                  border-2 rounded-2xl bg-white shadow-sm transition-all duration-300 cursor-pointer
                  ${T()}
                  ${L?"ring-2 ring-blue-400":""}
                `,children:[e.jsxs("div",{className:"flex items-start justify-between p-6 cursor-pointer",onClick:()=>U(a,N),children:[e.jsxs("div",{className:"flex items-start gap-3 flex-1 min-w-0",children:[e.jsx("div",{className:"w-7 h-7 rounded-lg flex items-center justify-center transition-all flex-shrink-0 bg-gray-200 hover:bg-gray-300 text-gray-600",children:e.jsx(Je,{className:`w-5 h-5 transition-transform duration-200 ${_?"rotate-180":""}`})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4 flex-wrap",children:[e.jsx("h3",{className:"text-2xl font-bold text-gray-900 truncate",children:I(a.title,l)}),a.type==="product"&&((H=a.metadata)==null?void 0:H.stock)!==void 0&&e.jsx("div",{className:`p-2 rounded-full border-2 border-white shadow-lg flex items-center justify-center w-10 h-10 flex-shrink-0 ${a.metadata.stock<=0||a.metadata.stock<=5?"bg-gradient-to-r from-red-500 to-red-600":a.metadata.stock<=10?"bg-gradient-to-r from-orange-500 to-orange-600":"bg-gradient-to-r from-green-500 to-emerald-500"}`,children:e.jsx("span",{className:"text-sm font-bold text-white",children:a.metadata.stock>=1e3?`${(a.metadata.stock/1e3).toFixed(1)}K`:a.metadata.stock})}),a.type==="customer"&&((ce=a.metadata)==null?void 0:ce.isActive)!==void 0&&e.jsxs("div",{className:`inline-flex items-center gap-1.5 px-3 py-1.5 rounded-full text-xs font-medium flex-shrink-0 ${a.metadata.isActive?"bg-green-100 text-green-800 border border-green-200":"bg-red-100 text-red-800 border border-red-200"}`,children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${a.metadata.isActive?"bg-green-500":"bg-red-500"}`}),a.metadata.isActive?"Active":"Inactive"]}),ae()]}),e.jsxs("div",{className:"flex items-center gap-3 flex-wrap",children:[a.subtitle&&e.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 rounded-lg bg-blue-50 text-blue-700 border border-blue-200 flex-shrink-0 cursor-pointer hover:bg-blue-100 transition-colors",onClick:y=>y.stopPropagation(),children:[a.type==="customer"?e.jsx(de,{className:"w-5 h-5"}):a.type==="sale"?e.jsx(de,{className:"w-5 h-5"}):e.jsx(te,{className:"w-5 h-5"}),e.jsx("span",{className:"text-base font-semibold truncate max-w-[140px]",children:I(a.subtitle,l)})]}),(a.createdAt||((Se=a.metadata)==null?void 0:Se.date))&&e.jsxs("div",{className:"inline-flex items-center gap-2 px-4 py-2 rounded-lg bg-gray-50 border border-gray-200",children:[e.jsx(ue,{className:"w-5 h-5 text-gray-600"}),e.jsx("span",{className:"text-base font-medium text-gray-600",children:Q(a.createdAt||((ke=a.metadata)==null?void 0:ke.date))||"N/A"})]})]})]})]}),(a.type==="product"||a.type==="sale")&&e.jsx("div",{className:"ml-4 flex-shrink-0",children:e.jsxs("div",{className:"flex flex-col items-end",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx(dt,{className:"w-5 h-5 text-gray-400"}),e.jsx("span",{className:"text-sm text-gray-500 font-medium uppercase tracking-wide",children:a.type==="product"?"Price":"Total Amount"})]}),e.jsx("div",{className:"flex flex-col items-end",children:e.jsx("span",{className:"text-4xl font-bold text-gray-900 leading-tight",children:(Ce=a.metadata)!=null&&Ce.hasPrice&&a.metadata.price!=null?`TSh ${a.metadata.price.toLocaleString("en-US",{useGrouping:!0,maximumFractionDigits:2})}`:((De=a.metadata)==null?void 0:De.amount)!=null?`TSh ${a.metadata.amount.toLocaleString("en-US",{useGrouping:!0,maximumFractionDigits:2})}`:e.jsx("span",{className:"text-gray-400 text-2xl font-normal",children:"No price set"})})})]})})]}),k===a.id?e.jsx("div",{className:"px-6 pb-6 pt-0",children:e.jsxs("div",{className:"space-y-6",children:[a.type==="product"&&a.metadata&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-sm font-bold text-gray-900 uppercase tracking-wider",children:"â€¢ PRODUCT DETAILS"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsx("div",{className:"bg-white rounded-2xl border border-gray-200 overflow-hidden shadow-sm",children:e.jsxs("div",{className:"p-5",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-8 h-8 rounded-xl bg-purple-500/10 border border-purple-200/50 flex items-center justify-center",children:e.jsx(te,{size:16,className:"text-purple-600"})}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-semibold text-gray-900",children:"Basic Information"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Product details and identifiers"})]})]}),e.jsxs("div",{className:"space-y-4",children:[a.metadata.barcode&&e.jsxs("div",{className:"p-3 bg-white/60 rounded-xl border border-gray-100/50",children:[e.jsx("div",{className:"flex items-center gap-2 mb-2",children:e.jsx("span",{className:"text-xs font-medium text-gray-700 uppercase tracking-wide",children:"Barcode"})}),e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:a.metadata.barcode})]}),a.metadata.categoryName&&e.jsxs("div",{className:"p-3 bg-white/60 rounded-xl border border-gray-100/50",children:[e.jsx("div",{className:"flex items-center gap-2 mb-2",children:e.jsx("span",{className:"text-xs font-medium text-gray-700 uppercase tracking-wide",children:"Category"})}),e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:a.metadata.categoryName})]})]})]})}),e.jsx("div",{className:"bg-white rounded-2xl border border-gray-200 overflow-hidden shadow-sm",children:e.jsxs("div",{className:"p-5",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-8 h-8 rounded-xl bg-green-500/10 border border-green-200/50 flex items-center justify-center",children:e.jsx(Y,{size:16,className:"text-green-600"})}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-semibold text-gray-900",children:"Pricing & Inventory"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Financial and stock information"})]})]}),e.jsxs("div",{className:"space-y-4",children:[a.metadata.hasPrice&&a.metadata.price!=null?e.jsxs("div",{className:"p-3 bg-white/60 rounded-xl border border-gray-100/50",children:[e.jsx("div",{className:"flex items-center gap-2 mb-2",children:e.jsx("span",{className:"text-xs font-medium text-gray-700 uppercase tracking-wide",children:"Selling Price"})}),e.jsxs("p",{className:"text-lg font-bold text-green-600",children:["TZS ",a.metadata.price.toLocaleString("en-US",{useGrouping:!0,maximumFractionDigits:2})]})]}):e.jsxs("div",{className:"p-3 bg-white/60 rounded-xl border border-gray-100/50",children:[e.jsx("div",{className:"flex items-center gap-2 mb-2",children:e.jsx("span",{className:"text-xs font-medium text-gray-700 uppercase tracking-wide",children:"Selling Price"})}),e.jsx("p",{className:"text-sm font-medium text-gray-400 italic",children:"No price set"})]}),a.metadata.variantId&&e.jsxs("div",{className:"p-3 bg-white/60 rounded-xl border border-gray-100/50",children:[e.jsx("div",{className:"flex items-center gap-2 mb-2",children:e.jsx("span",{className:"text-xs font-medium text-gray-700 uppercase tracking-wide",children:"Variant ID"})}),e.jsx("p",{className:"text-xs font-mono text-gray-600 break-all",children:a.metadata.variantId})]})]})]})})]}),a.metadata.variants&&a.metadata.variants.length>0&&e.jsx("div",{className:"bg-white rounded-2xl border border-gray-200 overflow-hidden shadow-sm",children:e.jsxs("div",{className:"p-5",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4 cursor-pointer",onClick:()=>{D(y=>{const $=new Set(y);return $.has(a.id)?$.delete(a.id):$.add(a.id),$})},children:[e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("div",{className:"w-8 h-8 rounded-xl bg-blue-500/10 border border-blue-200/50 flex items-center justify-center",children:e.jsx(te,{size:16,className:"text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-semibold text-gray-900",children:"Product Variants"}),e.jsxs("p",{className:"text-xs text-gray-500",children:[a.metadata.variantCount," variant",a.metadata.variantCount!==1?"s":""," with children"]})]})]}),e.jsx("button",{onClick:y=>{y.stopPropagation(),D($=>{const q=new Set($);return q.has(a.id)?q.delete(a.id):q.add(a.id),q})},className:"flex items-center justify-center w-8 h-8 rounded-lg bg-gray-100 hover:bg-gray-200 transition-colors text-gray-600 hover:text-gray-900",title:B.has(a.id)?"Maximize":"Minimize",children:B.has(a.id)?e.jsx(_t,{size:16}):e.jsx(At,{size:16})})]}),!B.has(a.id)&&e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-3",children:a.metadata.variants.map(y=>{const $=`${a.id}-${y.id}`,q=j.has($),re=y.children&&y.children.length>0;return e.jsxs("div",{className:`border rounded-lg overflow-hidden relative cursor-pointer ${re?"border-purple-300 bg-purple-50/30":"border-gray-200"}`,onClick:()=>{B.has(a.id)&&D(z=>{const le=new Set(z);return le.delete(a.id),le})},children:[y.quantity!==null&&y.quantity!==void 0&&e.jsx("div",{className:`absolute top-1 right-1 p-1 rounded-full border-2 border-white shadow-lg flex items-center justify-center z-20 w-7 h-7 ${y.quantity<=0||y.quantity<=5?"bg-gradient-to-r from-red-500 to-red-600":y.quantity<=10?"bg-gradient-to-r from-orange-500 to-orange-600":"bg-gradient-to-r from-green-500 to-emerald-500"}`,children:e.jsx("span",{className:"text-[10px] font-bold text-white",children:y.quantity>=1e3?`${(y.quantity/1e3).toFixed(1)}K`:y.quantity})}),e.jsx("div",{className:`p-3 transition-colors cursor-pointer ${re?"bg-purple-50/50 hover:bg-purple-100/50":"bg-gray-50 hover:bg-gray-100 cursor-default"}`,onClick:z=>{z.stopPropagation(),re&&F(le=>{const ie=new Set(le);return ie.has($)?ie.delete($):ie.add($),ie})},children:e.jsx("div",{className:"flex items-center justify-between",children:e.jsxs("div",{className:"flex items-center gap-3 flex-1 min-w-0",children:[re&&e.jsx(Je,{className:`w-4 h-4 text-gray-500 transition-transform flex-shrink-0 ${q?"rotate-180":""}`}),!re&&e.jsx("div",{className:"w-4 h-4 flex-shrink-0"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"flex items-center gap-2 mb-1",children:e.jsx("span",{className:"text-sm font-semibold text-gray-900 truncate",children:y.variant_name||y.name||"Unnamed Variant"})}),e.jsx("div",{className:"flex items-center gap-4 text-xs text-gray-600",children:y.selling_price!==null&&y.selling_price!==void 0&&e.jsxs("span",{children:["Price: TZS ",Number(y.selling_price).toLocaleString("en-US",{useGrouping:!0,maximumFractionDigits:2})]})})]})]})})}),re&&q&&e.jsx("div",{className:"border-t border-gray-200 bg-gray-50/50",children:e.jsx("div",{className:"p-3 pl-4",children:e.jsx("ul",{className:"space-y-2",children:y.children.map((z,le)=>{var He,Ke,We,Ge;const ie=((He=z.variant_attributes)==null?void 0:He.imei)||((Ke=z.attributes)==null?void 0:Ke.imei)||z.imei,vt=((We=z.variant_attributes)==null?void 0:We.serial_number)||((Ge=z.attributes)==null?void 0:Ge.serial_number)||z.serial_number||z.serialNumber,Qe=ie||vt||z.name||z.variant_name;return e.jsxs("li",{className:"flex items-center gap-2 p-2 bg-white rounded-lg border border-gray-200 hover:bg-gray-50 transition-colors",children:[z.variant_type==="imei_child"&&e.jsx("span",{className:"px-2 py-0.5 text-xs font-medium bg-purple-100 text-purple-700 rounded flex-shrink-0",children:"IMEI"}),!z.variant_type||z.variant_type!=="imei_child"?e.jsx("span",{className:"px-2 py-0.5 text-xs font-medium bg-gray-100 text-gray-700 rounded flex-shrink-0",children:"Serial"}):null,Qe&&e.jsx("span",{className:"font-mono text-sm text-gray-900",children:Qe})]},z.id)})})})})]},y.id)})})]})}),(a.createdAt||a.updatedAt)&&e.jsx("div",{className:"bg-white rounded-2xl border border-gray-200 overflow-hidden shadow-sm",children:e.jsxs("div",{className:"p-5",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-8 h-8 rounded-xl bg-orange-500/10 border border-orange-200/50 flex items-center justify-center",children:e.jsx(X,{size:16,className:"text-orange-600"})}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-semibold text-gray-900",children:"Timestamps"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Creation and update dates"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.createdAt&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1",children:"Created"}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:new Date(a.createdAt).toLocaleString()})]}),a.updatedAt&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1",children:"Last Updated"}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:new Date(a.updatedAt).toLocaleString()})]})]})]})})]})]}),a.type==="device"&&a.metadata&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-sm font-bold text-gray-900 uppercase tracking-wider",children:"â€¢ DEVICE DETAILS"}),e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"bg-white rounded-2xl border border-gray-200 overflow-hidden shadow-sm",children:[e.jsxs("div",{className:"p-5 border-b border-gray-100/60",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-8 h-8 rounded-xl bg-blue-500/10 border border-blue-200/50 flex items-center justify-center",children:e.jsx(oe,{size:16,className:"text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-semibold text-gray-900",children:"Device Information"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Device model and identifiers"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.metadata.serialNumber&&e.jsxs("div",{className:"p-3 bg-white/60 rounded-xl border border-gray-100/50",children:[e.jsx("div",{className:"flex items-center gap-2 mb-2",children:e.jsx("span",{className:"text-xs font-medium text-gray-700 uppercase tracking-wide",children:"Serial Number"})}),e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:a.metadata.serialNumber})]}),a.id&&e.jsxs("div",{className:"p-3 bg-white/60 rounded-xl border border-gray-100/50",children:[e.jsx("div",{className:"flex items-center gap-2 mb-2",children:e.jsx("span",{className:"text-xs font-medium text-gray-700 uppercase tracking-wide",children:"Device ID"})}),e.jsx("p",{className:"text-xs font-mono text-gray-600 break-all",children:a.id})]})]})]}),a.metadata.issue&&e.jsxs("div",{className:"p-5 border-b border-gray-100/60",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-8 h-8 rounded-xl bg-red-500/10 border border-red-200/50 flex items-center justify-center",children:e.jsx(Ye,{size:16,className:"text-red-600"})}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-semibold text-gray-900",children:"Problem Description"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Reported issue details"})]})]}),e.jsx("div",{className:"p-4 bg-white/60 rounded-xl border border-gray-100/50",children:e.jsx("p",{className:"text-sm text-gray-900 leading-relaxed",children:a.metadata.issue})})]}),e.jsxs("div",{className:"p-5",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-8 h-8 rounded-xl bg-orange-500/10 border border-orange-200/50 flex items-center justify-center",children:e.jsx(X,{size:16,className:"text-orange-600"})}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-semibold text-gray-900",children:"Timeline"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Important dates"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-3",children:[a.createdAt&&e.jsxs("div",{className:"p-3 bg-white/60 rounded-xl border border-gray-100/50",children:[e.jsx("div",{className:"text-xs opacity-60 mb-0.5",children:"Created"}),e.jsx("div",{className:"text-sm font-medium",children:new Date(a.createdAt).toLocaleString()})]}),a.updatedAt&&e.jsxs("div",{className:"p-3 bg-white/60 rounded-xl border border-gray-100/50",children:[e.jsx("div",{className:"text-xs opacity-60 mb-0.5",children:"Last Updated"}),e.jsx("div",{className:"text-sm font-medium",children:new Date(a.updatedAt).toLocaleString()})]}),a.metadata.expectedReturnDate&&e.jsxs("div",{className:"p-3 bg-white/60 rounded-xl border border-gray-100/50",children:[e.jsx("div",{className:"text-xs opacity-60 mb-0.5",children:"Expected Return"}),e.jsx("div",{className:"text-sm font-medium",children:new Date(a.metadata.expectedReturnDate).toLocaleDateString()})]})]})]})]})})]}),a.type==="sale"&&a.metadata&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-sm font-bold text-gray-900 uppercase tracking-wider",children:"â€¢ SALE DETAILS"}),e.jsxs("div",{className:"space-y-4",children:[e.jsx("div",{className:"bg-white rounded-2xl border border-gray-200 overflow-hidden shadow-sm",children:e.jsxs("div",{className:"p-5 border-b border-gray-100",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-8 h-8 rounded-xl bg-amber-500/10 border border-amber-200/50 flex items-center justify-center",children:e.jsx(Y,{size:16,className:"text-amber-600"})}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-semibold text-gray-900",children:"Sale Information"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Transaction details"})]})]}),e.jsxs("div",{className:"space-y-4",children:[a.metadata.amount!==void 0&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1",children:"TOTAL AMOUNT"}),e.jsxs("p",{className:"text-3xl font-bold text-green-600",children:["TZS ",a.metadata.amount.toLocaleString("en-US",{useGrouping:!0,maximumFractionDigits:2})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.metadata.customer&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1",children:"CUSTOMER"}),e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:a.metadata.customer})]}),a.id&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1",children:"SALE ID"}),e.jsx("p",{className:"text-xs font-mono text-gray-600 break-all",children:a.id})]})]})]})]})}),(a.createdAt||a.updatedAt)&&e.jsx("div",{className:"bg-white rounded-2xl border border-gray-200 overflow-hidden shadow-sm",children:e.jsxs("div",{className:"p-5",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-8 h-8 rounded-xl bg-orange-500/10 border border-orange-200/50 flex items-center justify-center",children:e.jsx(X,{size:16,className:"text-orange-600"})}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-semibold text-gray-900",children:"Timestamps"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Creation and update dates"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[a.createdAt&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1",children:"Created"}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:new Date(a.createdAt).toLocaleString()})]}),a.updatedAt&&e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-medium text-gray-500 uppercase tracking-wide mb-1",children:"Last Updated"}),e.jsx("div",{className:"text-sm font-semibold text-gray-900",children:new Date(a.updatedAt).toLocaleString()})]})]})]})})]})]}),a.type!=="customer"&&a.type!=="product"&&a.type!=="device"&&a.type!=="sale"&&a.metadata&&Object.keys(a.metadata).length>0&&e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-medium mb-2 text-gray-700",children:"All Details"}),e.jsxs("div",{className:"grid grid-cols-2 gap-2",children:[Object.entries(a.metadata).map(([y,$])=>$==null||$===""||(y.toLowerCase()==="price"||y.toLowerCase()==="amount")&&a.type!=="product"&&a.type!=="sale"?null:e.jsxs("div",{className:"p-2 rounded-lg bg-gray-50",children:[e.jsx("div",{className:"text-xs opacity-60 mb-0.5 capitalize",children:y.replace(/([A-Z])/g," $1").trim()}),e.jsx("div",{className:"text-sm font-medium",children:typeof $=="object"?JSON.stringify($):String($)})]},y)),a.id&&e.jsxs("div",{className:"p-2 rounded-lg bg-gray-50",children:[e.jsx("div",{className:"text-xs opacity-60 mb-0.5",children:"ID"}),e.jsx("div",{className:"text-xs font-mono text-gray-600 break-all",children:a.id})]}),a.createdAt&&e.jsxs("div",{className:"p-2 rounded-lg bg-gray-50",children:[e.jsx("div",{className:"text-xs opacity-60 mb-0.5",children:"Created"}),e.jsx("div",{className:"text-sm font-medium",children:new Date(a.createdAt).toLocaleString()})]}),a.updatedAt&&e.jsxs("div",{className:"p-2 rounded-lg bg-gray-50",children:[e.jsx("div",{className:"text-xs opacity-60 mb-0.5",children:"Last Updated"}),e.jsx("div",{className:"text-sm font-medium",children:new Date(a.updatedAt).toLocaleString()})]})]})]}),a.type==="customer"&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("h4",{className:"text-sm font-bold text-gray-900 uppercase tracking-wider",children:"â€¢ CUSTOMER DETAILS"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-4",children:[e.jsx("div",{className:"bg-white rounded-2xl border border-gray-200 overflow-hidden shadow-sm",children:e.jsxs("div",{className:"p-5",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-8 h-8 rounded-xl bg-blue-500/10 border border-blue-200/50 flex items-center justify-center",children:e.jsx(ne,{size:16,className:"text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-semibold text-gray-900",children:"Contact Information"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Primary contact details"})]})]}),e.jsxs("div",{className:"space-y-4",children:[(((Be=a.metadata)==null?void 0:Be.phone)||a.subtitle)&&e.jsxs("div",{className:"p-3 bg-white/60 rounded-xl border border-gray-100/50",children:[e.jsx("div",{className:"flex items-center gap-2 mb-2",children:e.jsx("span",{className:"text-xs font-medium text-gray-700 uppercase tracking-wide",children:"Phone"})}),e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:((Ee=a.metadata)==null?void 0:Ee.phone)||a.subtitle||"No phone"})]}),((Le=a.metadata)==null?void 0:Le.email)&&e.jsxs("div",{className:"p-3 bg-white/60 rounded-xl border border-gray-100/50",children:[e.jsx("div",{className:"flex items-center gap-2 mb-2",children:e.jsx("span",{className:"text-xs font-medium text-gray-700 uppercase tracking-wide",children:"Email"})}),e.jsx("p",{className:"text-sm font-semibold text-gray-900 truncate",children:a.metadata.email||"No email"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[(($e=a.metadata)==null?void 0:$e.city)&&e.jsxs("div",{className:"p-3 bg-white/60 rounded-xl border border-gray-100/50",children:[e.jsx("div",{className:"flex items-center gap-2 mb-2",children:e.jsx("span",{className:"text-xs font-medium text-gray-700 uppercase tracking-wide",children:"City"})}),e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:a.metadata.city})]}),((Pe=a.metadata)==null?void 0:Pe.whatsapp)&&e.jsxs("div",{className:"p-3 bg-white/60 rounded-xl border border-gray-100/50",children:[e.jsx("div",{className:"flex items-center gap-2 mb-2",children:e.jsx("span",{className:"text-xs font-medium text-gray-700 uppercase tracking-wide",children:"WhatsApp"})}),e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:a.metadata.whatsapp})]})]}),((Re=a.metadata)==null?void 0:Re.location)&&e.jsxs("div",{className:"p-3 bg-white/60 rounded-xl border border-gray-100/50",children:[e.jsx("div",{className:"flex items-center gap-2 mb-2",children:e.jsx("span",{className:"text-xs font-medium text-gray-700 uppercase tracking-wide",children:"Address"})}),e.jsx("p",{className:"text-sm font-semibold text-gray-900 truncate",children:a.metadata.location})]})]})]})}),e.jsx("div",{className:"bg-white rounded-2xl border border-gray-200 overflow-hidden shadow-sm",children:e.jsxs("div",{className:"p-5",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-8 h-8 rounded-xl bg-green-500/10 border border-green-200/50 flex items-center justify-center",children:e.jsx(Y,{size:16,className:"text-green-600"})}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-semibold text-gray-900",children:"Customer Metrics"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Lifetime value and engagement"})]})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex gap-4 items-stretch",children:[((Ie=a.metadata)==null?void 0:Ie.loyaltyLevel)&&e.jsxs("div",{className:"flex-1 p-3 bg-white/60 rounded-xl border border-gray-100/50",children:[e.jsx("div",{className:"flex items-center gap-2 mb-2",children:e.jsx("span",{className:"text-xs font-medium text-gray-700 uppercase tracking-wide",children:"Loyalty Level"})}),e.jsx("p",{className:"text-sm font-semibold text-gray-900 capitalize",children:a.metadata.loyaltyLevel})]}),((Me=a.metadata)==null?void 0:Me.totalSpent)!==void 0&&e.jsxs("div",{className:"ml-auto p-3 bg-white/60 rounded-xl border border-gray-100/50",children:[e.jsx("div",{className:"flex items-center gap-2 mb-2",children:e.jsx("span",{className:"text-xs font-medium text-gray-700 uppercase tracking-wide",children:"Total Spent"})}),e.jsxs("p",{className:"text-lg font-bold text-green-600",children:["TZS ",Number(a.metadata.totalSpent).toLocaleString("en-US",{useGrouping:!0,maximumFractionDigits:2})]})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[((Te=a.metadata)==null?void 0:Te.points)!==void 0&&e.jsxs("div",{className:"p-3 bg-white/60 rounded-xl border border-gray-100/50",children:[e.jsx("div",{className:"flex items-center gap-2 mb-2",children:e.jsx("span",{className:"text-xs font-medium text-gray-700 uppercase tracking-wide",children:"Loyalty Points"})}),e.jsx("p",{className:"text-lg font-bold text-blue-600",children:a.metadata.points.toLocaleString()})]}),((Fe=a.metadata)==null?void 0:Fe.totalPurchases)!==void 0&&e.jsxs("div",{className:"p-3 bg-white/60 rounded-xl border border-gray-100/50",children:[e.jsx("div",{className:"flex items-center gap-2 mb-2",children:e.jsx("span",{className:"text-xs font-medium text-gray-700 uppercase tracking-wide",children:"Total Orders"})}),e.jsx("p",{className:"text-lg font-bold text-purple-600",children:a.metadata.totalPurchases})]})]})]})]})})]}),(((ze=a.metadata)==null?void 0:ze.lastVisit)||((qe=a.metadata)==null?void 0:qe.joinedDate)||((Ue=a.metadata)==null?void 0:Ue.colorTag))&&e.jsx("div",{className:"bg-white rounded-2xl border border-gray-200 overflow-hidden shadow-sm",children:e.jsxs("div",{className:"p-5",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-8 h-8 rounded-xl bg-orange-500/10 border border-orange-200/50 flex items-center justify-center",children:e.jsx(X,{size:16,className:"text-orange-600"})}),e.jsxs("div",{children:[e.jsx("h5",{className:"text-sm font-semibold text-gray-900",children:"Additional Information"}),e.jsx("p",{className:"text-xs text-gray-500",children:"Activity and tags"})]})]}),e.jsxs("div",{className:"flex gap-4 items-stretch",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4 flex-1",children:[((Ve=a.metadata)==null?void 0:Ve.lastVisit)&&e.jsxs("div",{className:"p-3 bg-white/60 rounded-xl border border-gray-100/50",children:[e.jsx("div",{className:"flex items-center gap-2 mb-2",children:e.jsx("span",{className:"text-xs font-medium text-gray-700 uppercase tracking-wide",children:"Last Visit"})}),e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:new Date(a.metadata.lastVisit).toLocaleDateString("en-US",{month:"short",day:"numeric",year:"numeric"})})]}),((Oe=a.metadata)==null?void 0:Oe.joinedDate)&&e.jsxs("div",{className:"p-3 bg-white/60 rounded-xl border border-gray-100/50",children:[e.jsx("div",{className:"flex items-center gap-2 mb-2",children:e.jsx("span",{className:"text-xs font-medium text-gray-700 uppercase tracking-wide",children:"Member Since"})}),e.jsx("p",{className:"text-sm font-semibold text-gray-900",children:new Date(a.metadata.joinedDate).toLocaleDateString("en-US",{month:"short",year:"numeric"})})]})]}),((Ze=a.metadata)==null?void 0:Ze.colorTag)&&a.metadata.colorTag!=="basic"&&e.jsx("div",{className:"flex flex-col gap-2",children:e.jsx("span",{className:`inline-flex items-center gap-1.5 px-2 py-1 rounded-full text-xs font-medium ${a.metadata.colorTag==="vip"?"bg-purple-100 text-purple-800":a.metadata.colorTag==="complainer"?"bg-red-100 text-red-800":a.metadata.colorTag==="purchased"?"bg-green-100 text-green-800":"bg-gray-100 text-gray-800"}`,children:a.metadata.colorTag})})]})]})})]})]}),e.jsxs("div",{className:"pt-6 border-t border-gray-200",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-900 mb-4",children:"Actions"}),e.jsxs("div",{className:"grid grid-cols-3 gap-3",children:[e.jsxs("button",{onClick:y=>{y.stopPropagation(),se(a)},className:"flex items-center justify-center gap-2 px-4 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl transition-all shadow-sm hover:shadow-md font-medium text-sm",children:[e.jsx(St,{className:"w-4 h-4"}),"View"]}),(a.type==="customer"||a.type==="device")&&e.jsxs("button",{onClick:y=>{y.stopPropagation(),a.type==="customer"?i(`/customers/${a.id}/edit`):a.type==="device"&&i(`/devices/${a.id}/edit`)},className:"flex items-center justify-center gap-2 px-4 py-3 bg-green-600 hover:bg-green-700 text-white rounded-xl transition-all shadow-sm hover:shadow-md font-medium text-sm",children:[e.jsx(Xe,{className:"w-4 h-4"}),"Edit"]}),(a.type==="customer"||a.type==="device")&&e.jsxs("button",{onClick:y=>{y.stopPropagation(),window.confirm(`Are you sure you want to delete this ${a.type}?`)&&console.log("Delete",a.type,a.id)},className:"flex items-center justify-center gap-2 px-4 py-3 bg-red-600 hover:bg-red-700 text-white rounded-xl transition-all shadow-sm hover:shadow-md font-medium text-sm",children:[e.jsx(kt,{className:"w-4 h-4"}),"Delete"]}),a.type==="product"&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:y=>{y.stopPropagation(),i(`/lats/unified-inventory?edit=${a.id}`)},className:"flex items-center justify-center gap-2 px-4 py-3 bg-green-600 hover:bg-green-700 text-white rounded-xl transition-all shadow-sm hover:shadow-md font-medium text-sm",children:[e.jsx(Xe,{className:"w-4 h-4"}),"Edit"]}),e.jsxs("button",{onClick:y=>{y.stopPropagation(),i(`/pos?product=${a.id}`)},className:"flex items-center justify-center gap-2 px-4 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl transition-all shadow-sm hover:shadow-md font-medium text-sm",children:[e.jsx(Ct,{className:"w-4 h-4"}),"Add to POS"]})]}),a.type==="customer"&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:y=>{var q;y.stopPropagation();const $=`/sms?customer=${a.id}&phone=${((q=a.metadata)==null?void 0:q.phone)||""}&name=${encodeURIComponent(a.title)}`;i($)},className:"flex items-center justify-center gap-2 px-4 py-3 bg-blue-500 hover:bg-blue-600 text-white rounded-xl transition-all shadow-sm hover:shadow-md font-medium text-sm",children:[e.jsx(ne,{className:"w-4 h-4"}),"Send SMS"]}),e.jsxs("button",{onClick:y=>{y.stopPropagation(),i(`/lats/loyalty?customer=${a.id}`)},className:"flex items-center justify-center gap-2 px-4 py-3 bg-purple-600 hover:bg-purple-700 text-white rounded-xl transition-all shadow-sm hover:shadow-md font-medium text-sm",children:[e.jsx(Dt,{className:"w-4 h-4"}),"Points"]})]}),a.type==="sale"&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:y=>{y.stopPropagation(),window.open(`/lats/sales-reports/${a.id}/receipt`,"_blank")},className:"flex items-center justify-center gap-2 px-4 py-3 bg-green-600 hover:bg-green-700 text-white rounded-xl transition-all shadow-sm hover:shadow-md font-medium text-sm",children:[e.jsx(Bt,{className:"w-4 h-4"}),"Print Receipt"]}),e.jsxs("button",{onClick:y=>{y.stopPropagation(),navigator.clipboard.writeText(a.id)},className:"flex items-center justify-center gap-2 px-4 py-3 bg-gray-600 hover:bg-gray-700 text-white rounded-xl transition-all shadow-sm hover:shadow-md font-medium text-sm",children:[e.jsx(et,{className:"w-4 h-4"}),"Copy ID"]})]}),a.type==="device"&&e.jsxs(e.Fragment,{children:[e.jsxs("button",{onClick:y=>{y.stopPropagation(),i(`/devices/${a.id}`)},className:"flex items-center justify-center gap-2 px-4 py-3 bg-blue-600 hover:bg-blue-700 text-white rounded-xl transition-all shadow-sm hover:shadow-md font-medium text-sm",children:[e.jsx(he,{className:"w-4 h-4"}),"Update Status"]}),e.jsxs("button",{onClick:y=>{y.stopPropagation(),navigator.clipboard.writeText(a.id)},className:"flex items-center justify-center gap-2 px-4 py-3 bg-gray-600 hover:bg-gray-700 text-white rounded-xl transition-all shadow-sm hover:shadow-md font-medium text-sm",children:[e.jsx(et,{className:"w-4 h-4"}),"Copy ID"]})]}),e.jsxs("button",{onClick:y=>{y.stopPropagation(),navigator.share?navigator.share({title:a.title,text:a.description||a.subtitle||"",url:window.location.origin+a.url}):navigator.clipboard.writeText(window.location.origin+a.url)},className:"flex items-center justify-center gap-2 px-4 py-3 bg-indigo-600 hover:bg-indigo-700 text-white rounded-xl transition-all shadow-sm hover:shadow-md font-medium text-sm",children:[e.jsx(Et,{className:"w-4 h-4"}),"Share"]})]})]})]})}):null]},`${a.type}-${a.id}-${N}`)})}):e.jsx("div",{className:"text-center py-12",children:e.jsxs("div",{className:"bg-white rounded-xl p-8 border border-gray-100 inline-block",children:[e.jsx("div",{className:"inline-flex items-center justify-center w-12 h-12 rounded-full bg-gray-50 mb-3",children:e.jsx(Lt,{size:24,className:"text-gray-400"})}),e.jsx("h3",{className:"text-sm font-medium text-gray-700 mb-1",children:"No results found"}),e.jsx("p",{className:"text-gray-500 text-xs",children:"Try adjusting your search terms or filters"})]})})]})]})};export{Es as S,Ls as a};
